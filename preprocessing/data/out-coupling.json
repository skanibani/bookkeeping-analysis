[{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/application.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./utilities","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":42},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./database","line":15,"column":18,"nodeType":"CallExpression","endLine":15,"endColumn":39},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./server","line":16,"column":16,"nodeType":"CallExpression","endLine":16,"endColumn":35}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { Logger } = require('./utilities');\nconst database = require('./database');\nconst server = require('./server');\n\n/**\n * Bookkeeping Application\n */\nclass BookkeepingApplication {\n    /**\n     * Creates a new `Bookkeeping Application` instance.\n     */\n    constructor() {\n        this.logger = Logger('APPLICATION');\n        this.server = server;\n        this.database = database;\n    }\n\n    /**\n     * Returns wether or not to the application is in test mode.\n     *\n     * @returns {Boolean} Wether or not to the application is in test mode.\n     */\n    isInTestMode() {\n        return process.env.NODE_ENV === 'test';\n    }\n\n    /**\n     * Causes the application to be scheduled for execution.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async run() {\n        this.logger.info('Starting...');\n\n        try {\n            await this.database.connect();\n\n            if (this.isInTestMode()) {\n                await this.database.dropAllTables();\n            }\n\n            await this.database.migrate();\n\n            if (this.isInTestMode()) {\n                await this.database.seed();\n            }\n\n            await this.server.listen();\n        } catch (error) {\n            this.logger.error(`Error while starting: ${error}`);\n            return this.stop();\n        }\n\n        this.logger.info('Started');\n    }\n\n    /**\n     * Begins the process of terminating the application. Calling this method terminates the process.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async stop() {\n        this.logger.info('Stopping...');\n\n        try {\n            await this.database.disconnect();\n            await this.server.close();\n        } catch (error) {\n            this.logger.error(`Error while stopping: ${error}`);\n            process.exit(1);\n        }\n\n        this.logger.info('Stopped');\n        if (!this.isInTestMode()) {\n            process.exit(0);\n        }\n    }\n}\n\nmodule.exports = new BookkeepingApplication();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/config/database.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/config/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./database","line":14,"column":18,"nodeType":"CallExpression","endLine":14,"endColumn":39},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./jwt","line":15,"column":13,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./openid","line":16,"column":16,"nodeType":"CallExpression","endLine":16,"endColumn":35}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst database = require('./database');\nconst jwt = require('./jwt');\nconst openId = require('./openid');\n\nmodule.exports = {\n    DatabaseConfig: database,\n    JwtConfig: jwt,\n    OpenIdConfig: openId,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/config/jwt.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/config/openid.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/AttachmentAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/FlpAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/FlpRunsAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/LogAdapter.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./AttachmentAdapter","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./SubsystemAdapter","line":15,"column":26,"nodeType":"CallExpression","endLine":15,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./TagAdapter","line":16,"column":20,"nodeType":"CallExpression","endLine":16,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./UserAdapter","line":17,"column":21,"nodeType":"CallExpression","endLine":17,"endColumn":45}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst AttachmentAdapter = require('./AttachmentAdapter');\nconst SubsystemAdapter = require('./SubsystemAdapter');\nconst TagAdapter = require('./TagAdapter');\nconst UserAdapter = require('./UserAdapter');\n\n/**\n * LogAdapter\n */\nclass LogAdapter {\n    /**\n     * Converts the given database object to an entity object.\n     *\n     * @param {Object} databaseObject Object to convert.\n     * @returns {Object} Converted entity object.\n     */\n    static toEntity(databaseObject) {\n        const {\n            id,\n            title,\n            text,\n            user,\n            createdAt,\n            origin,\n            subtype,\n            rootLogId,\n            parentLogId,\n            replies,\n            tags,\n            runs,\n            subsystems,\n            attachments,\n        } = databaseObject;\n\n        const entityObject = {\n            id: id,\n            title: title,\n            text: text,\n            author: UserAdapter.toEntity(user),\n            createdAt: new Date(createdAt).getTime(),\n            origin: origin,\n            subtype: subtype,\n            rootLogId: rootLogId || id,\n            parentLogId: parentLogId || id,\n        };\n\n        if (replies) {\n            entityObject.replies = replies;\n        }\n\n        if (tags) {\n            entityObject.tags = tags.map(TagAdapter.toEntity);\n        } else {\n            entityObject.tags = [];\n        }\n\n        if (runs) {\n            entityObject.runs = runs.map(({ id, runNumber }) => ({ id, runNumber }));\n        } else {\n            entityObject.runs = [];\n        }\n\n        if (subsystems) {\n            entityObject.subsystems = subsystems.map(SubsystemAdapter.toEntity);\n        } else {\n            entityObject.subsystems = [];\n        }\n\n        if (attachments) {\n            entityObject.attachments = attachments.map(AttachmentAdapter.toEntity);\n        } else {\n            entityObject.attachments = [];\n        }\n\n        return entityObject;\n    }\n\n    /**\n     * Converts the given entity object to a database object.\n     *\n     * @param {Object} entityObject Object to convert.\n     * @returns {Object} Converted database object.\n     */\n    static toDatabase(entityObject) {\n        const databaseObject = {\n            id: entityObject.id,\n            userId: entityObject.userId,\n            title: entityObject.title,\n            text: entityObject.text,\n            tags: entityObject.tags,\n            subtype: 'run',\n            origin: 'process',\n        };\n\n        if (entityObject.rootLogId) {\n            databaseObject.rootLogId = entityObject.rootLogId;\n        }\n\n        if (entityObject.parentLogId) {\n            databaseObject.parentLogId = entityObject.parentLogId;\n        }\n\n        return databaseObject;\n    }\n}\n\nmodule.exports = LogAdapter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/LogRunsAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/LogTagsAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/RunAdapter.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./TagAdapter","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst TagAdapter = require('./TagAdapter');\n\n/**\n * RunAdapter\n */\nclass RunAdapter {\n    /**\n     * Converts the given database object to an entity object.\n     *\n     * @param {Object} databaseObject Object to convert.\n     * @returns {Object} Converted entity object.\n     */\n    static toEntity(databaseObject) {\n        const {\n            id,\n            runNumber,\n            timeO2Start,\n            timeO2End,\n            timeTrgStart,\n            timeTrgEnd,\n            activityId,\n            runType,\n            runQuality,\n            nDetectors,\n            nFlps,\n            nEpns,\n            nSubtimeframes,\n            bytesReadOut,\n            tags,\n        } = databaseObject;\n\n        const entityObject = {\n            id: id,\n            runNumber: runNumber,\n            timeO2Start: new Date(timeO2Start).getTime(),\n            timeO2End: new Date(timeO2End).getTime(),\n            timeTrgStart: new Date(timeTrgStart).getTime(),\n            timeTrgEnd: new Date(timeTrgEnd).getTime(),\n            activityId: activityId,\n            runType: runType,\n            runQuality: runQuality,\n            nDetectors: nDetectors,\n            nFlps: nFlps,\n            nEpns: nEpns,\n            nSubtimeframes: nSubtimeframes,\n            bytesReadOut: bytesReadOut,\n        };\n\n        if (tags) {\n            entityObject.tags = tags.map(TagAdapter.toEntity);\n        } else {\n            entityObject.tags = [];\n        }\n\n        return entityObject;\n    }\n\n    /**\n     * Converts the given entity object to a database object.\n     *\n     * @param {Object} entityObject Object to convert.\n     * @returns {Object} Converted database object.\n     */\n    static toDatabase(entityObject) {\n        const databaseObject = {\n            runNumber: entityObject.runNumber,\n            timeO2Start: entityObject.timeO2Start,\n            timeO2End: entityObject.timeO2End,\n            timeTrgStart: entityObject.timeTrgStart,\n            timeTrgEnd: entityObject.timeTrgEnd,\n            activityId: entityObject.activityId,\n            runType: entityObject.runType,\n            runQuality: entityObject.runQuality,\n            nDetectors: entityObject.nDetectors,\n            nFlps: entityObject.nFlps,\n            nEpns: entityObject.nEpns,\n            nSubtimeframes: entityObject.nSubtimeframes,\n            bytesReadOut: entityObject.bytesReadOut,\n            tags: entityObject.tags,\n        };\n\n        return databaseObject;\n    }\n}\n\nmodule.exports = RunAdapter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/SubsystemAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/TagAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/UserAdapter.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/adapters/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./AttachmentAdapter","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./LogAdapter","line":15,"column":20,"nodeType":"CallExpression","endLine":15,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./LogTagsAdapter","line":16,"column":24,"nodeType":"CallExpression","endLine":16,"endColumn":51},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./RunAdapter","line":17,"column":20,"nodeType":"CallExpression","endLine":17,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./FlpAdapter","line":18,"column":20,"nodeType":"CallExpression","endLine":18,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./SubsystemAdapter","line":19,"column":26,"nodeType":"CallExpression","endLine":19,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./TagAdapter","line":20,"column":20,"nodeType":"CallExpression","endLine":20,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./UserAdapter","line":21,"column":21,"nodeType":"CallExpression","endLine":21,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./LogRunsAdapter","line":22,"column":24,"nodeType":"CallExpression","endLine":22,"endColumn":51},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./FlpRunsAdapter","line":23,"column":24,"nodeType":"CallExpression","endLine":23,"endColumn":51}],"errorCount":10,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst AttachmentAdapter = require('./AttachmentAdapter');\nconst LogAdapter = require('./LogAdapter');\nconst LogTagsAdapter = require('./LogTagsAdapter');\nconst RunAdapter = require('./RunAdapter');\nconst FlpAdapter = require('./FlpAdapter');\nconst SubsystemAdapter = require('./SubsystemAdapter');\nconst TagAdapter = require('./TagAdapter');\nconst UserAdapter = require('./UserAdapter');\nconst LogRunsAdapter = require('./LogRunsAdapter');\nconst FlpRunsAdapter = require('./FlpRunsAdapter');\n\nmodule.exports = {\n    AttachmentAdapter,\n    LogAdapter,\n    LogTagsAdapter,\n    RunAdapter,\n    FlpAdapter,\n    SubsystemAdapter,\n    TagAdapter,\n    UserAdapter,\n    LogRunsAdapter,\n    FlpRunsAdapter,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"cls-hooked","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":34},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":16,"column":23,"nodeType":"CallExpression","endLine":16,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"umzug","line":17,"column":15,"nodeType":"CallExpression","endLine":17,"endColumn":31},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../config","line":18,"column":28,"nodeType":"CallExpression","endLine":18,"endColumn":48},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":19,"column":20,"nodeType":"CallExpression","endLine":19,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./models","line":49,"column":16,"nodeType":"CallExpression","endLine":49,"endColumn":35},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./repositories","line":56,"column":16,"nodeType":"CallExpression","endLine":56,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tables","line":63,"column":16,"nodeType":"CallExpression","endLine":63,"endColumn":35},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./utilities","line":70,"column":16,"nodeType":"CallExpression","endLine":70,"endColumn":38}],"errorCount":10,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst cls = require('cls-hooked');\nconst path = require('path');\nconst { Sequelize } = require('sequelize');\nconst Umzug = require('umzug');\nconst { DatabaseConfig } = require('../config');\nconst { Logger } = require('../utilities');\n\n/**\n * Sequelize implementation of the Database.\n */\nclass SequelizeDatabase {\n    /**\n     * Creates a new `Sequelize Database` instance.\n     */\n    constructor() {\n        this.logger = Logger('DATABASE');\n        this.namespace = cls.createNamespace('sequelize');\n        Sequelize.useCLS(this.namespace);\n\n        this.sequelize = new Sequelize(DatabaseConfig.database, DatabaseConfig.username, DatabaseConfig.password, {\n            host: DatabaseConfig.host,\n            port: DatabaseConfig.port,\n            dialect: DatabaseConfig.dialect,\n            dialectOptions: DatabaseConfig.dialectOptions,\n            logging: DatabaseConfig.logging ? this.logger.debug.bind(this.logger) : NaN,\n            define: {\n                underscored: true,\n            },\n        });\n    }\n\n    /**\n     * Returns all available models.\n     */\n    get models() {\n        return require('./models')(this.sequelize);\n    }\n\n    /**\n     * Returns all available repositories.\n     */\n    get repositories() {\n        return require('./repositories');\n    }\n\n    /**\n     * Returns all available tables.\n     */\n    get tables() {\n        return require('./tables')(this.sequelize);\n    }\n\n    /**\n     * Returns all available utilities.\n     */\n    get utilities() {\n        return require('./utilities')(this.sequelize);\n    }\n\n    /**\n     * Performs connection to the database.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async connect() {\n        this.logger.info('Starting...');\n\n        try {\n            await this.sequelize.authenticate();\n        } catch (error) {\n            this.logger.error(`Error while starting: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Started');\n    }\n\n    /**\n     * Performs disconnect to the database.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async disconnect() {\n        this.logger.info('Stopping...');\n\n        try {\n            await this.sequelize.close();\n        } catch (error) {\n            this.logger.error(`Error while stopping: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Stopped');\n    }\n\n    /**\n     * Drops all tables.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async dropAllTables() {\n        this.logger.warn('Dropping all tables!');\n\n        try {\n            await this.sequelize.getQueryInterface().dropAllTables();\n        } catch (error) {\n            this.logger.error(`Error while dropping all tables: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Dropped all tables!');\n    }\n\n    /**\n     * Executes every *pending* migrations.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async migrate() {\n        this.logger.info('Executing pending migrations...');\n\n        try {\n            const umzug = new Umzug({\n                migrations: {\n                    params: [this.sequelize.getQueryInterface(), Sequelize],\n                    path: path.join(__dirname, 'migrations'),\n                },\n                storage: 'sequelize',\n                storageOptions: {\n                    sequelize: this.sequelize,\n                },\n            });\n\n            await umzug.up();\n        } catch (error) {\n            this.logger.error(`Error while executing migrations: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Executed pending migrations');\n    }\n\n    /**\n     * Executes every *pending* seed.\n     *\n     * @returns {Promise} Promise object represents the outcome.\n     */\n    async seed() {\n        this.logger.info('Executing seeders...');\n\n        try {\n            const umzug = new Umzug({\n                migrations: {\n                    params: [this.sequelize.getQueryInterface(), Sequelize],\n                    path: path.join(__dirname, 'seeders'),\n                },\n                storage: 'none',\n            });\n\n            await umzug.up();\n        } catch (error) {\n            this.logger.error(`Error while executing seeders: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Executed seeders');\n    }\n}\n\nmodule.exports = new SequelizeDatabase();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200505195925-create-log.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200505205233-create-user.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200505214213-create-run.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200506003500-create-tag.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200506004950-create-flp-roles.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200506093229-create-epn-role-session.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200507202304-create-log-runs.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200507230653-create-log-tags.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200508115356-add-associations.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200508120618-create-run_tags.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200508154634-log-indexes.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200511132541-log-tags-relation.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200511132542-log-runs-relation.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200525101348-create-subsystem.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200525135006-log-subsystems-relation.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200621102228-user.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200623201423-create-attachment.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200623201424-attachment-indexes.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200724114841-add-run-number.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200914120527-logs-remove-user-constraint.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20200921180609-add-flp-readout-bytes.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20201021084028-create-flp-runs.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20201021084436-flp-runs-relation.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/migrations/20201121200636-run-tags-relation.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/attachment.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const Attachment = sequelize.define('Attachment', {\n        fileName: {\n            allowNull: false,\n            type: Sequelize.STRING,\n        },\n        size: {\n            allowNull: false,\n            type: Sequelize.INTEGER,\n        },\n        mimeType: {\n            allowNull: false,\n            type: Sequelize.STRING,\n        },\n        originalName: {\n            allowNull: false,\n            type: Sequelize.STRING,\n        },\n        path: {\n            allowNull: false,\n            type: Sequelize.STRING,\n        },\n        encoding: {\n            allowNull: false,\n            type: Sequelize.STRING,\n        },\n    }, {\n        indexes: [\n            {\n                name: 'attachments_mime_type_idx',\n                fields: ['mime_type'],\n            },\n        ],\n    });\n\n    Attachment.associate = (models) => {\n        Attachment.belongsTo(models.Log, { as: 'log' });\n    };\n\n    return Attachment;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/epnrolesession.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const EpnRoleSession = sequelize.define('EpnRoleSession', {\n        name: {\n            type: Sequelize.STRING,\n        },\n        sessionNumber: {\n            type: Sequelize.INTEGER,\n        },\n        epnHostname: {\n            type: Sequelize.STRING,\n        },\n        nSubtimeframes: {\n            type: Sequelize.INTEGER,\n        },\n        bytesIn: {\n            type: Sequelize.INTEGER,\n        },\n        bytesOut: {\n            type: Sequelize.INTEGER,\n        },\n        sessionStart: {\n            type: Sequelize.DATE,\n        },\n        sessionEnd: {\n            type: Sequelize.DATE,\n        },\n    });\n\n    return EpnRoleSession;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/flprole.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const FlpRoles = sequelize.define('FlpRoles', {\n        name: {\n            type: Sequelize.STRING,\n        },\n        hostname: {\n            type: Sequelize.STRING,\n        },\n        nTimeframes: {\n            type: Sequelize.INTEGER,\n        },\n        bytesProcessed: {\n            type: Sequelize.INTEGER,\n        },\n        bytesEquipmentReadOut: {\n            type: Sequelize.INTEGER,\n        },\n        bytesRecordingReadOut: {\n            type: Sequelize.INTEGER,\n        },\n        bytesFairMQReadOut: {\n            type: Sequelize.INTEGER,\n        },\n    });\n\n    FlpRoles.associate = (models) => {\n        FlpRoles.belongsToMany(models.Run, { as: 'runs', through: 'flp_runs' });\n    };\n\n    return FlpRoles;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./attachment","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./epnrolesession","line":15,"column":24,"nodeType":"CallExpression","endLine":15,"endColumn":51},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flprole","line":16,"column":18,"nodeType":"CallExpression","endLine":16,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./log","line":17,"column":13,"nodeType":"CallExpression","endLine":17,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./run","line":18,"column":13,"nodeType":"CallExpression","endLine":18,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystem","line":19,"column":19,"nodeType":"CallExpression","endLine":19,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tag","line":20,"column":13,"nodeType":"CallExpression","endLine":20,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./user","line":21,"column":14,"nodeType":"CallExpression","endLine":21,"endColumn":31}],"errorCount":8,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Attachment = require('./attachment');\nconst EpnRoleSession = require('./epnrolesession');\nconst FlpRoles = require('./flprole');\nconst Log = require('./log');\nconst Run = require('./run');\nconst Subsystem = require('./subsystem');\nconst Tag = require('./tag');\nconst User = require('./user');\n\nmodule.exports = (sequelize) => {\n    const models = {\n        Attachment: Attachment(sequelize),\n        EpnRoleSessionkey: EpnRoleSession(sequelize),\n        FlpRoles: FlpRoles(sequelize),\n        Log: Log(sequelize),\n        Run: Run(sequelize),\n        Subsystem: Subsystem(sequelize),\n        Tag: Tag(sequelize),\n        User: User(sequelize),\n    };\n\n    Object.entries(models).forEach(([_key, model]) => {\n        if (model.associate) {\n            model.associate(sequelize.models);\n        }\n    });\n\n    return models;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/log.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const Log = sequelize.define('Log', {\n        title: {\n            allowNull: false,\n            type: Sequelize.STRING,\n        },\n        text: {\n            allowNull: false,\n            type: Sequelize.TEXT,\n        },\n        subtype: {\n            allowNull: false,\n            type: Sequelize.ENUM('run', 'subsystem', 'announcement', 'intervention', 'comment'),\n        },\n        origin: {\n            allowNull: false,\n            type: Sequelize.ENUM('human', 'process'),\n        },\n        announcementValidUntil: {\n            type: Sequelize.DATE,\n        },\n    }, {\n        indexes: [\n            {\n                name: 'logs_subtype_idx',\n                fields: ['subtype'],\n            },\n            {\n                name: 'logs_origin_idx',\n                fields: ['origin'],\n            },\n        ],\n    });\n\n    Log.associate = (models) => {\n        Log.belongsTo(models.User, { as: 'user' });\n        Log.belongsTo(models.Log, { as: 'rootLog' });\n        Log.belongsTo(models.Log, { as: 'parentLog' });\n\n        Log.belongsToMany(models.Run, { as: 'runs', through: 'log_runs' });\n        Log.belongsToMany(models.Tag, { as: 'tags', through: 'log_tags' });\n        Log.belongsToMany(models.Subsystem, { as: 'subsystems', through: 'log_subsystems' });\n\n        Log.hasMany(models.Attachment, { as: 'attachments', foreignKey: 'log_id' });\n    };\n\n    return Log;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/run.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const Run = sequelize.define('Run', {\n        runNumber: {\n            type: Sequelize.INTEGER,\n        },\n        timeO2Start: {\n            type: Sequelize.DATE,\n        },\n        timeO2End: {\n            type: Sequelize.DATE,\n        },\n        timeTrgStart: {\n            type: Sequelize.DATE,\n        },\n        timeTrgEnd: {\n            type: Sequelize.DATE,\n        },\n        activityId: {\n            type: Sequelize.STRING,\n        },\n        runType: {\n            type: Sequelize.ENUM('physics', 'cosmics', 'technical'),\n        },\n        runQuality: {\n            type: Sequelize.ENUM('good', 'bad', 'unknown'),\n        },\n        nDetectors: {\n            type: Sequelize.INTEGER,\n        },\n        nFlps: {\n            type: Sequelize.INTEGER,\n        },\n        nEpns: {\n            type: Sequelize.INTEGER,\n        },\n        nSubtimeframes: {\n            type: Sequelize.INTEGER,\n        },\n        bytesReadOut: {\n            type: Sequelize.INTEGER,\n        },\n    });\n\n    Run.associate = (models) => {\n        Run.belongsToMany(models.Log, { through: 'log_runs' });\n        Run.belongsToMany(models.FlpRoles, { through: 'flp_runs' });\n        Run.belongsToMany(models.Tag, { through: 'run_tags', as: 'tags' });\n    };\n\n    return Run;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/subsystem.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const Subsystem = sequelize.define('Subsystem', {\n        name: {\n            type: Sequelize.STRING,\n        },\n    });\n\n    Subsystem.associate = (models) => {\n        Subsystem.belongsToMany(models.Log, { as: 'logs', through: 'log_subsystems' });\n    };\n\n    return Subsystem;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/tag.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const Tag = sequelize.define('Tag', {\n        text: {\n            type: Sequelize.STRING,\n        },\n    });\n\n    Tag.associate = (models) => {\n        Tag.belongsToMany(models.Log, { through: 'log_tags' });\n        Tag.belongsToMany(models.Run, { through: 'run_tags' });\n    };\n\n    return Tag;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/models/user.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const User = sequelize.define('User', {\n        externalId: {\n            type: Sequelize.INTEGER,\n        },\n        name: {\n            type: Sequelize.STRING,\n        },\n    }, {\n        indexes: [\n            {\n                name: 'users_external_id_idx',\n                fields: ['external_id'],\n            },\n        ],\n    });\n\n    User.associate = (models) => {\n        User.hasMany(models.Log, { foreignKey: 'userId', as: 'logs' });\n    };\n\n    return User;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/AttachmentRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../adapters","line":14,"column":31,"nodeType":"CallExpression","endLine":14,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":19,"column":5,"nodeType":"CallExpression","endLine":19,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":20,"column":20,"nodeType":"CallExpression","endLine":20,"endColumn":43}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { AttachmentAdapter } = require('../adapters');\nconst {\n    models: {\n        Attachment,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Attachment repository\n */\nclass AttachmentRepository extends Repository {\n    /**\n     * Creates a new `AttachmentRepository` instance.\n     */\n    constructor() {\n        super(Attachment);\n    }\n\n    /**\n     * Bulk insert entities.\n     *\n     * @param {Array} entities List of entities to insert.\n     * @returns {Promise} Promise object represents the just inserted Attachments.\n     */\n    async bulkInsert(entities) {\n        entities = Array.isArray(entities) ? entities : [entities];\n\n        const results = await Attachment.bulkCreate(entities.map(AttachmentAdapter.toDatabase), { returning: true });\n        return results.map(AttachmentAdapter.toEntity);\n    }\n}\n\nmodule.exports = new AttachmentRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/FlpRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":22,"column":20,"nodeType":"CallExpression","endLine":22,"endColumn":43}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    models: {\n        FlpRoles,\n    },\n    utilities: {\n        QueryBuilder,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the FlpRepository.\n */\nclass FlpRepository extends Repository {\n    /**\n     * Creates a new `FlpRepository` instance.\n     */\n    constructor() {\n        super(FlpRoles);\n    }\n\n    /**\n     * Adds a count of root flp by their amount of children onto every applicable flp.\n     *\n     * @param {Array} rows The collection of rows already fetched\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async addChildrenCountByRootFlp(rows, queryBuilder = new QueryBuilder()) {\n        const rootFlpIds = [...new Set(rows.map((row) => row.rootFlpId))];\n        queryBuilder\n            .where('rootFlpId').oneOf(...rootFlpIds)\n            .set('group', ['rootFlpId']);\n\n        const replies = await this.count(queryBuilder);\n        replies.forEach(({ rootFlpId, count }) => {\n            const rowToAttachTo = rows.find(({ id }) => id === rootFlpId);\n            if (rowToAttachTo) {\n                rowToAttachTo.replies = count;\n            }\n        });\n\n        return rows;\n    }\n\n    /**\n     * Returns all entities.\n     *\n     * @param {Object} runId The QueryBuilder to use.\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async findAllByRunId(runId, queryBuilder = new QueryBuilder()) {\n        queryBuilder\n            .setModel(FlpRoles)\n            .include('runs')\n            .whereAssociation('runs', 'id').is(runId);\n\n        return this.findAll(queryBuilder);\n    }\n}\n\nmodule.exports = new FlpRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/FlpRunNumberRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../adapters","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":50},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"..","line":19,"column":5,"nodeType":"CallExpression","endLine":19,"endColumn":18},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":20,"column":20,"nodeType":"CallExpression","endLine":20,"endColumn":43}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { FlpRunsAdapter } = require('../adapters');\nconst {\n    tables: {\n        FlpRuns,\n    },\n} = require('..');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the FlpRunsRepository.\n */\nclass FlpRunsRepository extends Repository {\n    /**\n     * Creates a new `FlpRunsRepository` instance.\n     */\n    constructor() {\n        super(FlpRuns);\n    }\n\n    /**\n     * Bulk insert entities.\n     *\n     * @param {Array} entities List of entities to insert.\n     * @returns {Promise} Promise object represents the just inserted run numbers.\n     */\n    async bulkInsert(entities) {\n        entities = Array.isArray(entities) ? entities : [entities];\n\n        const results = await FlpRuns.bulkCreate(entities.map(FlpRunsAdapter.toDatabase), { returning: true });\n        return results.map(FlpRunsAdapter.toEntity);\n    }\n}\n\nmodule.exports = new FlpRunsRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/LogRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":22,"column":20,"nodeType":"CallExpression","endLine":22,"endColumn":43}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    models: {\n        Log,\n    },\n    utilities: {\n        QueryBuilder,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the LogRepository.\n */\nclass LogRepository extends Repository {\n    /**\n     * Creates a new `LogRepository` instance.\n     */\n    constructor() {\n        super(Log);\n    }\n\n    /**\n     * Adds a count of root log by their amount of children onto every applicable log.\n     *\n     * @param {Array} rows The collection of rows already fetched\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async addChildrenCountByRootLog(rows, queryBuilder = new QueryBuilder()) {\n        const rootLogIds = [...new Set(rows.map((row) => row.rootLogId))];\n        queryBuilder\n            .where('rootLogId').oneOf(...rootLogIds)\n            .set('group', ['rootLogId']);\n\n        const replies = await this.count(queryBuilder);\n        replies.forEach(({ rootLogId, count }) => {\n            const rowToAttachTo = rows.find(({ id }) => id === rootLogId);\n            if (rowToAttachTo) {\n                rowToAttachTo.replies = count;\n            }\n        });\n\n        return rows;\n    }\n\n    /**\n     * Returns all entities.\n     *\n     * @param {Object} runId The QueryBuilder to use.\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async findAllByRunId(runId, queryBuilder = new QueryBuilder()) {\n        queryBuilder\n            .setModel(Log)\n            .include('user')\n            .include('tags')\n            .whereAssociation('runs', 'id').is(runId);\n\n        return this.findAll(queryBuilder);\n    }\n\n    /**\n     * Returns all entities.\n     *\n     * @param {Object} subsystemId The QueryBuilder to use.\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async findAllBySubsystemId(subsystemId, queryBuilder = new QueryBuilder()) {\n        queryBuilder\n            .setModel(Log)\n            .include('user')\n            .include('tags')\n            .whereAssociation('subsystems', 'id').is(subsystemId);\n\n        return this.findAll(queryBuilder);\n    }\n}\n\nmodule.exports = new LogRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/LogRunNumberRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../adapters","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":50},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"..","line":19,"column":5,"nodeType":"CallExpression","endLine":19,"endColumn":18},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":20,"column":20,"nodeType":"CallExpression","endLine":20,"endColumn":43}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { LogRunsAdapter } = require('../adapters');\nconst {\n    tables: {\n        LogRuns,\n    },\n} = require('..');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the LogRunsRepository.\n */\nclass LogRunsRepository extends Repository {\n    /**\n     * Creates a new `LogRunsRepository` instance.\n     */\n    constructor() {\n        super(LogRuns);\n    }\n\n    /**\n     * Bulk insert entities.\n     *\n     * @param {Array} entities List of entities to insert.\n     * @returns {Promise} Promise object represents the just inserted run numbers.\n     */\n    async bulkInsert(entities) {\n        entities = Array.isArray(entities) ? entities : [entities];\n\n        const results = await LogRuns.bulkCreate(entities.map(LogRunsAdapter.toDatabase), { returning: true });\n        return results.map(LogRunsAdapter.toEntity);\n    }\n}\n\nmodule.exports = new LogRunsRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/LogRunsRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../adapters","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":50},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"..","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":18},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":23,"column":20,"nodeType":"CallExpression","endLine":23,"endColumn":43}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { LogRunsAdapter } = require('../adapters');\nconst {\n    tables: {\n        LogRuns,\n    },\n    utilities: {\n        QueryBuilder,\n    },\n} = require('..');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the LogTagsRepository.\n */\nclass LogRunsRepository extends Repository {\n    /**\n     * Creates a new `LogTagsRepository` instance.\n     */\n    constructor() {\n        super(LogRuns);\n    }\n\n    /**\n     * Returns log tag rows by grouping them by log id\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full data\n     */\n    async findAllAndGroup(queryBuilder = new QueryBuilder()) {\n        const result = await this.findAll(queryBuilder);\n\n        const groupedResult = result.reduce((accumulator, currentValue) => {\n            if (accumulator[currentValue.logId]) {\n                accumulator[currentValue.logId].push(currentValue.runId);\n            } else {\n                accumulator[currentValue.logId] = [currentValue.runId];\n            }\n            return accumulator;\n        }, {});\n\n        return Object.entries(groupedResult).map(([key, value]) => ({ logId: key, runIds: value }));\n    }\n\n    /**\n     * Bulk insert entities.\n     *\n     * @param {Array} entities List of entities to insert.\n     * @returns {Promise} Promise object represents the recently inserted LogTags.\n     */\n    async bulkInsert(entities) {\n        const results = await LogRuns.bulkCreate(entities.map(LogRunsAdapter.toDatabase), { returning: true });\n        return results.map(LogRunsAdapter.toEntity);\n    }\n}\n\nmodule.exports = new LogRunsRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/LogTagsRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../adapters","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":50},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"..","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":18},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":23,"column":20,"nodeType":"CallExpression","endLine":23,"endColumn":43}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { LogTagsAdapter } = require('../adapters');\nconst {\n    tables: {\n        LogTags,\n    },\n    utilities: {\n        QueryBuilder,\n    },\n} = require('..');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the LogTagsRepository.\n */\nclass LogTagsRepository extends Repository {\n    /**\n     * Creates a new `LogTagsRepository` instance.\n     */\n    constructor() {\n        super(LogTags);\n    }\n\n    /**\n     * Returns log tag rows by grouping them by log id\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full data\n     */\n    async findAllAndGroup(queryBuilder = new QueryBuilder()) {\n        const result = await this.findAll(queryBuilder);\n\n        const groupedResult = result.reduce((accumulator, currentValue) => {\n            if (accumulator[currentValue.logId]) {\n                accumulator[currentValue.logId].push(currentValue.tagId);\n            } else {\n                accumulator[currentValue.logId] = [currentValue.tagId];\n            }\n            return accumulator;\n        }, {});\n\n        return Object.entries(groupedResult).map(([key, value]) => ({ logId: key, tagIds: value }));\n    }\n\n    /**\n     * Bulk insert entities.\n     *\n     * @param {Array} entities List of entities to insert.\n     * @returns {Promise} Promise object represents the recently inserted LogTags.\n     */\n    async bulkInsert(entities) {\n        const results = await LogTags.bulkCreate(entities.map(LogTagsAdapter.toDatabase), { returning: true });\n        return results.map(LogTagsAdapter.toEntity);\n    }\n}\n\nmodule.exports = new LogTagsRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/Repository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":19}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    utilities: {\n        QueryBuilder,\n    },\n} = require('../');\n\n/**\n * Sequelize implementation of the Repository.\n */\nclass Repository {\n    /**\n     * Creates a new `Repository` instance.\n     *\n     * @param {*} model The database model to use.\n     */\n    constructor(model) {\n        this.model = model;\n    }\n\n    /**\n     * Returns the total number of entities.\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise<Number>} Promise object representing the total number of entities.\n     */\n    async count(queryBuilder = new QueryBuilder()) {\n        return this.model.count(queryBuilder.toImplementation());\n    }\n\n    /**\n     * Returns all entities.\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async findAll(queryBuilder = new QueryBuilder()) {\n        return this.model.findAll(queryBuilder.toImplementation());\n    }\n\n    /**\n     * Returns all entities.\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise} Promise object representing the full mock data\n     */\n    async findAndCountAll(queryBuilder = new QueryBuilder()) {\n        queryBuilder.set('distinct', true);\n        return this.model.findAndCountAll(queryBuilder.toImplementation());\n    }\n\n    /**\n     * Returns a specific entity.\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise|Null} Promise object representing the full mock data\n     */\n    async findOne(queryBuilder = new QueryBuilder()) {\n        queryBuilder.limit(1);\n        return this.model.findOne(queryBuilder.toImplementation());\n    }\n\n    /**\n     * Insert entity.\n     *\n     * @param {Object} entity entity to insert.\n     * @returns {Promise} Promise object represents the just inserted this.model.\n     */\n    async insert(entity) {\n        return this.model.create(entity);\n    }\n\n    /**\n     * Removes a specific entity.\n     *\n     * @param {QueryBuilder} queryBuilder The QueryBuilder to use.\n     * @returns {Promise|Null} Promise object representing the full mock data\n     */\n    async removeOne(queryBuilder = new QueryBuilder()) {\n        queryBuilder.limit(1);\n\n        const entity = await this.findOne(queryBuilder);\n        if (entity) {\n            await this.model.destroy(queryBuilder.toImplementation());\n        }\n\n        return entity;\n    }\n}\n\nmodule.exports = Repository;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/RunRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":19,"column":20,"nodeType":"CallExpression","endLine":19,"endColumn":43}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    models: {\n        Run,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the RunRepository.\n */\nclass RunRepository extends Repository {\n    /**\n     * Creates a new `RunRepository` instance.\n     */\n    constructor() {\n        super(Run);\n    }\n}\n\nmodule.exports = new RunRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/RunTagsRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"..","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":18},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":19,"column":20,"nodeType":"CallExpression","endLine":19,"endColumn":43}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    tables: {\n        RunTags,\n    },\n} = require('..');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the RunTagsRepository.\n */\nclass RunTagsRepository extends Repository {\n    /**\n     * Creates a new `RunTagsRepository` instance.\n     */\n    constructor() {\n        super(RunTags);\n    }\n\n    /**\n     * Remove all tags & runs relations by run id\n     * @param {number} runId  - run ID to delete tags for\n     * @return {Promise<void>} - delete result\n     */\n    async removeById(runId) {\n        return await RunTags.sequelize.getQueryInterface().bulkDelete('run_tags', { run_id: runId });\n    }\n\n    /**\n     * Update run tags by runNumber\n     * @param {Array} entities - Tags & runId to associate\n     * @return {*} Result of updating\n     */\n    async updateMany(entities) {\n        return await RunTags.bulkCreate(entities, { returning: true });\n    }\n}\n\nmodule.exports = new RunTagsRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/SubsystemRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":19,"column":20,"nodeType":"CallExpression","endLine":19,"endColumn":43}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    models: {\n        Subsystem,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the SubsystemRepository.\n */\nclass SubsystemRepository extends Repository {\n    /**\n     * Creates a new `SubsystemRepository` instance.\n     */\n    constructor() {\n        super(Subsystem);\n    }\n}\n\nmodule.exports = new SubsystemRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/TagRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":19,"column":20,"nodeType":"CallExpression","endLine":19,"endColumn":43}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    models: {\n        Tag,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the TagRepository.\n */\nclass TagRepository extends Repository {\n    /**\n     * Creates a new `TagRepository` instance.\n     */\n    constructor() {\n        super(Tag);\n    }\n}\n\nmodule.exports = new TagRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/UserRepository.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../adapters","line":14,"column":25,"nodeType":"CallExpression","endLine":14,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../","line":19,"column":5,"nodeType":"CallExpression","endLine":19,"endColumn":19},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Repository","line":20,"column":20,"nodeType":"CallExpression","endLine":20,"endColumn":43}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { UserAdapter } = require('../adapters');\nconst {\n    models: {\n        User,\n    },\n} = require('../');\nconst Repository = require('./Repository');\n\n/**\n * Sequelize implementation of the UserRepository.\n */\nclass UserRepository extends Repository {\n    /**\n     * Creates a new `UserRepository` instance.\n     */\n    constructor() {\n        super(User, UserAdapter);\n    }\n}\n\nmodule.exports = new UserRepository();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/repositories/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./AttachmentRepository","line":14,"column":30,"nodeType":"CallExpression","endLine":14,"endColumn":63},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./LogRepository","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./LogTagsRepository","line":16,"column":27,"nodeType":"CallExpression","endLine":16,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./RunRepository","line":17,"column":23,"nodeType":"CallExpression","endLine":17,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./SubsystemRepository","line":18,"column":29,"nodeType":"CallExpression","endLine":18,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./TagRepository","line":19,"column":23,"nodeType":"CallExpression","endLine":19,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./UserRepository","line":20,"column":24,"nodeType":"CallExpression","endLine":20,"endColumn":51},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./FlpRepository","line":21,"column":23,"nodeType":"CallExpression","endLine":21,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./LogRunsRepository","line":22,"column":27,"nodeType":"CallExpression","endLine":22,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./RunTagsRepository","line":23,"column":27,"nodeType":"CallExpression","endLine":23,"endColumn":57}],"errorCount":10,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst AttachmentRepository = require('./AttachmentRepository');\nconst LogRepository = require('./LogRepository');\nconst LogTagsRepository = require('./LogTagsRepository');\nconst RunRepository = require('./RunRepository');\nconst SubsystemRepository = require('./SubsystemRepository');\nconst TagRepository = require('./TagRepository');\nconst UserRepository = require('./UserRepository');\nconst FlpRepository = require('./FlpRepository');\nconst LogRunsRepository = require('./LogRunsRepository');\nconst RunTagsRepository = require('./RunTagsRepository');\n\nmodule.exports = {\n    AttachmentRepository,\n    LogRepository,\n    LogTagsRepository,\n    RunRepository,\n    SubsystemRepository,\n    TagRepository,\n    UserRepository,\n    FlpRepository,\n    LogRunsRepository,\n    RunTagsRepository,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200426144121-users.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200508094502-logs.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200511151010-tags.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200511151016-log-tags.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200606151010-subsystems.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200606301010-log-subsystems.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200713103855-runs.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200731155608-log-runs.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20200921181553-flps.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/seeders/20201021083549-flp-runs.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/tables/flpruns.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const FlpRuns = sequelize.define('FlpRuns', {\n        flpRoleId: {\n            type: Sequelize.INTEGER,\n        },\n        runId: {\n            type: Sequelize.INTEGER,\n        },\n    });\n\n    FlpRuns.removeAttribute('id');\n\n    return FlpRuns;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/tables/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./logtags","line":14,"column":17,"nodeType":"CallExpression","endLine":14,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./logruns","line":15,"column":17,"nodeType":"CallExpression","endLine":15,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flpruns","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./runtags","line":17,"column":17,"nodeType":"CallExpression","endLine":17,"endColumn":37}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst LogTags = require('./logtags');\nconst LogRuns = require('./logruns');\nconst FlpRuns = require('./flpruns');\nconst RunTags = require('./runtags');\n\nmodule.exports = (sequelize) => {\n    const models = {\n        LogTags: LogTags(sequelize),\n        LogRuns: LogRuns(sequelize),\n        FlpRuns: FlpRuns(sequelize),\n        RunTags: RunTags(sequelize),\n    };\n\n    Object.entries(models).forEach(([_key, model]) => {\n        if (model.associate) {\n            model.associate(sequelize.models);\n        }\n    });\n\n    return models;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/tables/logruns.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const LogRuns = sequelize.define('LogRuns', {\n        logId: {\n            type: Sequelize.INTEGER,\n        },\n        runId: {\n            type: Sequelize.INTEGER,\n        },\n    });\n\n    LogRuns.removeAttribute('id');\n\n    return LogRuns;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/tables/logtags.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const LogTags = sequelize.define('LogTags', {\n        logId: {\n            type: Sequelize.INTEGER,\n        },\n        tagId: {\n            type: Sequelize.INTEGER,\n        },\n    });\n\n    LogTags.removeAttribute('id');\n\n    return LogTags;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/tables/runtags.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const Sequelize = require('sequelize');\n\n    const RunTags = sequelize.define('RunTags', {\n        runId: {\n            type: Sequelize.INTEGER,\n        },\n        tagId: {\n            type: Sequelize.INTEGER,\n        },\n    });\n\n    RunTags.removeAttribute('id');\n\n    return RunTags;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/utilities/QueryBuilder.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"sequelize","line":15,"column":20,"nodeType":"CallExpression","endLine":15,"endColumn":40}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nmodule.exports = (sequelize) => {\n    const { Op } = require('sequelize');\n\n    /**\n     * Sequelize implementation of the WhereQueryBuilder.\n     */\n    class WhereQueryBuilder {\n        /**\n         * Creates a new `WhereQueryBuilder` instance.\n         *\n         * @param {QueryBuilder} queryBuilder The include expression.\n         * @param {String} column The target column.\n         */\n        constructor(queryBuilder, column) {\n            this.queryBuilder = queryBuilder;\n            this.column = column;\n\n            this.notFlag = false;\n        }\n\n        /**\n         * Sets an exact match filter using the provided value.\n         *\n         * @param {*} value The required value.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        is(value) {\n            let operation;\n\n            if (this.notFlag) {\n                operation = { [Op.ne]: value };\n            } else {\n                operation = { [Op.eq]: value };\n            }\n\n            return this._op(operation);\n        }\n\n        /**\n         * Sets an **AND** match filter using the provided values.\n         *\n         * @param  {...any} values The required values.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        allOf(...values) {\n            let operation;\n\n            if (this.notFlag) {\n                operation = { [Op.notIn]: values };\n            } else {\n                operation = { [Op.and]: values };\n            }\n\n            return this._op(operation);\n        }\n\n        /**\n         * Sets an **OR** match filter using the provided values.\n         *\n         * @param  {...any} values The required values.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        oneOf(...values) {\n            let operation;\n\n            if (this.notFlag) {\n                operation = { [Op.notIn]: values };\n            } else {\n                operation = { [Op.in]: values };\n            }\n\n            return this._op(operation);\n        }\n\n        /**\n         * Sets an range match filter using the provided values, note that this is an **inclusive** filter.\n         *\n         * @param {*} start The start value.\n         * @param {*} end The end value.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        between(start, end) {\n            let operation;\n\n            if (this.notFlag) {\n                operation = { [Op.notBetween]: [start, end] };\n            } else {\n                operation = { [Op.between]: [start, end] };\n            }\n\n            return this._op(operation);\n        }\n\n        /**\n         * Sets the **NOT** flag to `true` for the next filter condition.\n         *\n         * @returns {WhereQueryBuilder} The current WhereQueryBuilder instance.\n         */\n        not() {\n            this.notFlag = true;\n            return this;\n        }\n\n        /**\n         * Sets a starts with filter using the provided value.\n         *\n         * @param {symbol} value The start value.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        startsWith(value) {\n            if (!this.queryBuilder.options.where) {\n                this.queryBuilder.options.where = {};\n            }\n\n            if (this.notFlag) {\n                this.queryBuilder.options.where[this.column] = {\n                    [Op.notLike]: `${value}%`,\n                };\n            } else {\n                this.queryBuilder.options.where[this.column] = {\n                    [Op.startsWith]: value,\n                };\n            }\n\n            return this.queryBuilder;\n        }\n\n        /**\n         * Sets a ends with filter using the provided value.\n         *\n         * @param {symbol} value The end value.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        endsWith(value) {\n            if (!this.queryBuilder.options.where) {\n                this.queryBuilder.options.where = {};\n            }\n\n            if (this.notFlag) {\n                this.queryBuilder.options.where[this.column] = {\n                    [Op.notLike]: `%${value}`,\n                };\n            } else {\n                this.queryBuilder.options.where[this.column] = {\n                    [Op.endsWith]: value,\n                };\n            }\n\n            return this.queryBuilder;\n        }\n\n        /**\n         * Sets a substring filter using the provided value.\n         *\n         * @param {symbol} value The required value.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        substring(value) {\n            if (!this.queryBuilder.options.where) {\n                this.queryBuilder.options.where = {};\n            }\n\n            if (this.notFlag) {\n                this.queryBuilder.options.where[this.column] = {\n                    [Op.notLike]: `%${value}%`,\n                };\n            } else {\n                this.queryBuilder.options.where[this.column] = {\n                    [Op.substring]: value,\n                };\n            }\n\n            return this.queryBuilder;\n        }\n\n        /**\n         * Sets the operation.\n         *\n         * @param {Object} operation The Sequelize operation to use as where filter.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        _op(operation) {\n            if (!this.queryBuilder.options.where) {\n                this.queryBuilder.options.where = {};\n            }\n\n            this.queryBuilder.options.where[this.column] = operation;\n\n            return this.queryBuilder;\n        }\n    }\n\n    /**\n     * Sequelize implementation of the WhereAssociationQueryBuilder.\n     */\n    class WhereAssociationQueryBuilder extends WhereQueryBuilder {\n        /**\n         * Creates a new `WhereQueryBuilder` instance.\n         *\n         * @param {QueryBuilder} queryBuilder The include expression.\n         * @param {String} association The target association.\n         * @param {String} column The target column.\n         */\n        constructor(queryBuilder, association, column) {\n            super();\n\n            this.queryBuilder = queryBuilder;\n            this.association = association;\n            this.column = column;\n\n            this.associationName = this.queryBuilder.model.associations[this.association].toTarget.as;\n        }\n\n        /**\n         * Sets the operation.\n         *\n         * @param {Object} operation The Sequelize operation to use as where filter.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        _op(operation) {\n            this.queryBuilder.include({\n                model: sequelize.models[this.associationName],\n                as: this.association,\n                required: true,\n                through: {\n                    where: {\n                        [`${this.associationName}_${this.column}`]: operation,\n                    },\n                },\n            });\n\n            return this.queryBuilder;\n        }\n    }\n\n    /**\n     * Sequelize implementation of the QueryBuilder.\n     */\n    class QueryBuilder {\n        /**\n         * Creates a new `QueryBuilder` instance.\n         */\n        constructor() {\n            this.options = {};\n        }\n\n        /**\n         * The numbers of items to return.\n         *\n         * @param {*} expression The include expression.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        include(expression) {\n            if (!this.options.include) {\n                this.options.include = [];\n            }\n\n            this.options.include.push(expression);\n            return this;\n        }\n\n        /**\n         * The numbers of items to return.\n         *\n         * @param {Number} number The numbers of items to return.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        limit(number) {\n            this.options.limit = number;\n            return this;\n        }\n\n        /**\n         * The number of items to skip before starting to collect the result set.\n         *\n         * @param {Number} number  The number of items to skip.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        offset(number) {\n            this.options.offset = number;\n            return this;\n        }\n\n        /**\n         * Set the order of elements.\n         *\n         * @param {String} column The column to order by.\n         * @param {String} direction The direction to order by.\n         * @param {String} table Optional associated table to perform ordering operation on.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        orderBy(column, direction, table = null) {\n            if (!this.options.order) {\n                this.options.order = [];\n            }\n\n            this.options.order.push(table ? [table, column, direction] : [column, direction]);\n            return this;\n        }\n\n        /**\n         * Generic Key-Value pair setter.\n         *\n         * @param {*} key The key to set.\n         * @param {*} value The value of the key.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        set(key, value) {\n            this.options[key] = value;\n            return this;\n        }\n\n        /**\n         * Sets the Sequelize model.\n         *\n         * @param {*} model The Sequelize model to reference.\n         * @returns {QueryBuilder} The current QueryBuilder instance.\n         */\n        setModel(model) {\n            this.model = model;\n            return this;\n        }\n\n        /**\n         * Returns the implementation specific query.\n         *\n         * @returns {Object} Implementation specific query.\n         */\n        toImplementation() {\n            return this.options;\n        }\n\n        /**\n         * Adds a filter on the given column.\n         *\n         * @param {String} column The target column.\n         * @returns {WhereQueryBuilder} The WhereQueryBuilder instance.\n         */\n        where(column) {\n            return new WhereQueryBuilder(this, column);\n        }\n\n        /**\n         * Adds a filter on the given association with a column value pair.\n         *\n         * @param {String} association The target association.\n         * @param {String} column The target column.\n         * @param {*} value The required value.\n         * @returns {WhereAssociationQueryBuilder} The current QueryBuilder instance.\n         */\n        whereAssociation(association, column) {\n            return new WhereAssociationQueryBuilder(this, association, column);\n        }\n    }\n\n    return QueryBuilder;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/utilities/TransactionHelper.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../utilities","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { isPromise } = require('../../utilities');\n\nmodule.exports = (sequelize) => {\n    /**\n     * Sequelize implementation of the TransactionHelper.\n     */\n    class TransactionHelper {\n        /**\n         * Provides a transaction. This will handle committing or rolling back the transaction automatically.\n         *\n         * @param {Function} cb Callback for the transaction.\n         * @returns {Promise} Promise object represents ...\n         */\n        static async provide(cb) {\n            return sequelize.transaction(async () => isPromise(cb) ? await cb() : cb());\n        }\n    }\n\n    return TransactionHelper;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/database/utilities/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./QueryBuilder","line":14,"column":22,"nodeType":"CallExpression","endLine":14,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./TransactionHelper","line":15,"column":27,"nodeType":"CallExpression","endLine":15,"endColumn":57}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst QueryBuilder = require('./QueryBuilder');\nconst TransactionHelper = require('./TransactionHelper');\n\nmodule.exports = (sequelize) => ({\n    QueryBuilder: QueryBuilder(sequelize),\n    TransactionHelper: TransactionHelper(sequelize),\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/CreateAttachmentDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./FileDto","line":15,"column":17,"nodeType":"CallExpression","endLine":15,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":16,"column":21,"nodeType":"CallExpression","endLine":16,"endColumn":45}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst FileDto = require('./FileDto');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst BodyDto = Joi.object({\n    log: EntityIdDto,\n});\n\nconst FilesDto = Joi.array().items(FileDto);\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst CreateAttachmentDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    file: FileDto,\n    files: FilesDto,\n    params: Joi.object({}),\n}).xor('file', 'files');\n\nmodule.exports = CreateAttachmentDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/CreateFlpDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst BodyDto = Joi.object({\n    name: Joi.string()\n        .required(),\n    hostname: Joi.string()\n        .required(),\n    runNumber: EntityIdDto.optional(),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst CreateFlpDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: Joi.object({}),\n});\n\nmodule.exports = CreateFlpDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/CreateLogDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./FileDto","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\nconst FileDto = require('./FileDto');\n\nconst BodyDto = Joi.object({\n    title: Joi.string()\n        .required()\n        .min(3)\n        .max(140),\n    text: Joi.string()\n        .required()\n        .min(3),\n    tags: Joi.array()\n        .optional()\n        .items(Joi.number()),\n    parentLogId: EntityIdDto.optional(),\n    runNumbers: Joi.string().optional(),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst CreateLogDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    files: Joi.array().items(FileDto),\n    params: Joi.object({}),\n});\n\nmodule.exports = CreateLogDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/CreateSubsystemDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst BodyDto = Joi.object({\n    name: Joi.string()\n        .required(),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst CreateSubsystemDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: Joi.object({}),\n});\n\nmodule.exports = CreateSubsystemDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/CreateTagDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst BodyDto = Joi.object({\n    text: Joi.string()\n        .required()\n        .min(3)\n        .max(20),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst CreateTagDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: Joi.object({}),\n});\n\nmodule.exports = CreateTagDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/EndRunDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst BodyDto = Joi.object({\n    timeO2End: Joi.date(),\n    timeTrgEnd: Joi.date(),\n    runQuality: Joi.string().valid('good', 'bad', 'unknown'),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst ParamsDto = Joi.object({\n    runId: Joi.string(),\n});\n\nconst EndRunDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: ParamsDto,\n});\n\nmodule.exports = EndRunDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/EntityIdDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst EntityIdDto = Joi.number()\n    .integer()\n    .positive();\n\nmodule.exports = EntityIdDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/FileDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst FileDto = Joi.object({\n    mimetype: Joi.string().required(),\n    filename: Joi.string().required().min(3),\n    fieldname: Joi.string().required().min(3),\n    originalname: Joi.string().required().min(3),\n    encoding: Joi.string().required(),\n    size: Joi.number().required(),\n    destination: Joi.string(),\n    path: Joi.string().required(),\n});\n\nmodule.exports = FileDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAllFlpsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./PaginationDto","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst PaginationDto = require('./PaginationDto');\n\nconst SortDto = Joi.object({\n    id: Joi.string()\n        .valid('asc', 'desc'),\n    text: Joi.string()\n        .valid('asc', 'desc'),\n});\n\nconst QueryDto = Joi.object({\n    page: PaginationDto,\n    sort: SortDto,\n    token: Joi.string(),\n});\n\nconst GetAllFlpsDto = Joi.object({\n    body: Joi.object({}),\n    params: Joi.object({}),\n    query: QueryDto,\n});\n\nmodule.exports = GetAllFlpsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAllLogAttachmentsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst QueryDto = Joi.object({\n    mimetype: Joi.string(),\n    token: Joi.string(),\n});\n\nconst ParamsDto = Joi.object({\n    logId: EntityIdDto,\n});\n\nconst GetAllLogAttachmentsDto = Joi.object({\n    body: Joi.object({}),\n    query: QueryDto,\n    params: ParamsDto,\n});\n\nmodule.exports = GetAllLogAttachmentsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAllLogsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./PaginationDto","line":16,"column":23,"nodeType":"CallExpression","endLine":16,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\nconst PaginationDto = require('./PaginationDto');\n\nconst customJoi = Joi.extend((joi) => ({\n    base: joi.array(),\n    type: 'stringArray',\n    coerce: (value) => ({ value: value.split ? value.split(',') : value }),\n}));\n\nconst customDateFilterErrorMessages = {\n    'date.base': 'Creation date must be a real date and in format YYYY-MM-DD or YYYY/MM/DD',\n    'date.max': 'Creation date must be today ({#limit}) or earlier',\n    'date.min': 'Creation date \"to\" cannot be before the \"from\" date',\n};\nconst CreatedFilterDto = Joi.object({\n    from: Joi.date()\n        .max(new Date().setHours(0, 0, 0, 0))\n        .messages(customDateFilterErrorMessages),\n    to: Joi.date()\n        .max(new Date().setHours(23, 59, 59, 999))\n        .when('from', {\n            is: Joi.exist(),\n            then: Joi.date().min(Joi.ref('from')),\n        })\n        .messages(customDateFilterErrorMessages),\n});\n\nconst TagFilterDto = Joi.object({\n    values: customJoi.stringArray().items(EntityIdDto).single().required(),\n    operation: Joi.string().valid('and', 'or').required(),\n});\n\nconst RunFilterDto = Joi.object({\n    values: customJoi.stringArray().items(EntityIdDto).single().required(),\n    operation: Joi.string().valid('and', 'or').required(),\n});\n\nconst FilterDto = Joi.object({\n    title: Joi.string().trim(),\n    author: Joi.string().trim(),\n    created: CreatedFilterDto,\n    tag: TagFilterDto,\n    run: RunFilterDto,\n    origin: Joi.string()\n        .valid('human', 'process'),\n    parentLog: EntityIdDto,\n    rootLog: EntityIdDto,\n});\n\nconst SortDto = Joi.object({\n    id: Joi.string().valid('asc', 'desc'),\n    title: Joi.string().valid('asc', 'desc'),\n    author: Joi.string().valid('asc', 'desc'),\n    createdAt: Joi.string().valid('asc', 'desc'),\n    tags: Joi.string().valid('asc', 'desc'),\n    runs: Joi.string().valid('asc', 'desc'),\n}).xor('id', 'title', 'author', 'createdAt', 'tags', 'runs');\n\nconst QueryDto = Joi.object({\n    filter: FilterDto,\n    page: PaginationDto,\n    sort: SortDto,\n    token: Joi.string(),\n});\n\nconst GetAllLogsDto = Joi.object({\n    body: Joi.object({}),\n    params: Joi.object({}),\n    query: QueryDto,\n});\n\nmodule.exports = GetAllLogsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAllRunsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./PaginationDto","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst PaginationDto = require('./PaginationDto');\n\nconst SortDto = Joi.object({\n    id: Joi.string()\n        .valid('asc', 'desc'),\n    text: Joi.string()\n        .valid('asc', 'desc'),\n});\n\nconst QueryDto = Joi.object({\n    page: PaginationDto,\n    sort: SortDto,\n    token: Joi.string(),\n});\n\nconst GetAllRunsDto = Joi.object({\n    body: Joi.object({}),\n    params: Joi.object({}),\n    query: QueryDto,\n});\n\nmodule.exports = GetAllRunsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAllSubsystemsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./PaginationDto","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst PaginationDto = require('./PaginationDto');\n\nconst QueryDto = Joi.object({\n    page: PaginationDto,\n    token: Joi.string(),\n});\n\nconst GetAllSubsystemsDto = Joi.object({\n    body: Joi.object({}),\n    params: Joi.object({}),\n    query: QueryDto,\n});\n\nmodule.exports = GetAllSubsystemsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAllTagsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./PaginationDto","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst PaginationDto = require('./PaginationDto');\n\nconst QueryDto = Joi.object({\n    page: PaginationDto,\n    token: Joi.string(),\n});\n\nconst GetAllTagsDto = Joi.object({\n    body: Joi.object({}),\n    params: Joi.object({}),\n    query: QueryDto,\n});\n\nmodule.exports = GetAllTagsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetAttachmentDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst ParamsDto = Joi.object({\n    attachmentId: EntityIdDto,\n});\n\nconst GetLogAttachmentDto = Joi.object({\n    body: Joi.object({}),\n    query: QueryDto,\n    params: ParamsDto,\n});\n\nmodule.exports = GetLogAttachmentDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetFlpDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst ParamsDto = Joi.object({\n    flpId: EntityIdDto,\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst GetFlpDto = Joi.object({\n    body: Joi.object({}),\n    params: ParamsDto,\n    query: QueryDto,\n});\n\nmodule.exports = GetFlpDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetLogAttachmentDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst ParamsDto = Joi.object({\n    logId: EntityIdDto.required(),\n    attachmentId: EntityIdDto.required(),\n});\n\nconst QueryDto = Joi.object({\n    mimetype: Joi.string(),\n    token: Joi.string(),\n});\n\nconst GetLogAttachmentDto = Joi.object({\n    body: Joi.object({}),\n    params: ParamsDto,\n    query: QueryDto,\n});\n\nmodule.exports = GetLogAttachmentDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetLogDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst ParamsDto = Joi.object({\n    logId: EntityIdDto,\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst GetLogDto = Joi.object({\n    body: Joi.object({}),\n    params: ParamsDto,\n    query: QueryDto,\n});\n\nmodule.exports = GetLogDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetRunDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst ParamsDto = Joi.object({\n    runId: EntityIdDto,\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst GetRunDto = Joi.object({\n    body: Joi.object({}),\n    params: ParamsDto,\n    query: QueryDto,\n});\n\nmodule.exports = GetRunDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetSubsystemDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst ParamsDto = Joi.object({\n    subsystemId: EntityIdDto,\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst GetSubsystemDto = Joi.object({\n    body: Joi.object({}),\n    params: ParamsDto,\n    query: QueryDto,\n});\n\nmodule.exports = GetSubsystemDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/GetTagDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst ParamsDto = Joi.object({\n    tagId: EntityIdDto,\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst GetLogDto = Joi.object({\n    body: Joi.object({}),\n    params: ParamsDto,\n    query: QueryDto,\n});\n\nmodule.exports = GetLogDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/PaginationDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst PaginationDto = Joi.object({\n    limit: Joi.number()\n        .integer()\n        .min(1)\n        .max(100),\n    offset: Joi.number()\n        .integer()\n        .min(0),\n});\n\nmodule.exports = PaginationDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/StartRunDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\n\nconst BodyDto = Joi.object({\n    timeO2Start: Joi.date(),\n    timeTrgStart: Joi.date(),\n    activityId: Joi.string(),\n    runType: Joi.string()\n        .valid('physics', 'cosmics', 'technical'),\n    runQuality: Joi.string()\n        .valid('good', 'bad', 'unknown'),\n    nDetectors: Joi.number(),\n    nFlps: Joi.number(),\n    nEpns: Joi.number(),\n    nSubTimeFrames: Joi.number(),\n    bytesReadOut: Joi.number(),\n    runNumber: Joi.number(),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst StartRunDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: Joi.object({}),\n});\n\nmodule.exports = StartRunDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/UpdateFlpDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst OptionalPositiveIntegerDto = Joi.number()\n    .integer()\n    .positive()\n    .optional();\n\nconst BodyDto = Joi.object({\n    nTimeframes: OptionalPositiveIntegerDto,\n    bytesProcessed: OptionalPositiveIntegerDto,\n    bytesEquipmentReadOut: OptionalPositiveIntegerDto,\n    bytesRecordingReadOut: OptionalPositiveIntegerDto,\n    bytesFairMQReadOut: OptionalPositiveIntegerDto,\n});\n\nconst QueryDto = Joi.object({\n    flpName: Joi.string(),\n    runNumber: EntityIdDto,\n    token: Joi.string(),\n});\n\nconst ParamsDto = Joi.object({\n    flpName: Joi.string(),\n    runNumber: EntityIdDto,\n});\n\nconst CreateLogDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: ParamsDto,\n});\n\nmodule.exports = CreateLogDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/UpdateRunTagsDto.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"joi","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":27},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst Joi = require('joi');\nconst EntityIdDto = require('./EntityIdDto');\n\nconst BodyDto = Joi.object({\n    tags: Joi.array()\n        .required()\n        .items(Joi.number()),\n});\n\nconst QueryDto = Joi.object({\n    token: Joi.string(),\n});\n\nconst UpdateRunTagsDto = Joi.object({\n    query: QueryDto,\n    body: BodyDto,\n    params: Joi.object({\n        runId: EntityIdDto.required(),\n    }),\n});\n\nmodule.exports = UpdateRunTagsDto;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/dtos/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateAttachmentDto","line":14,"column":29,"nodeType":"CallExpression","endLine":14,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateFlpDto","line":15,"column":22,"nodeType":"CallExpression","endLine":15,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateLogDto","line":16,"column":22,"nodeType":"CallExpression","endLine":16,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateSubsystemDto","line":17,"column":28,"nodeType":"CallExpression","endLine":17,"endColumn":59},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateTagDto","line":18,"column":22,"nodeType":"CallExpression","endLine":18,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EntityIdDto","line":19,"column":21,"nodeType":"CallExpression","endLine":19,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllLogAttachmentsDto","line":20,"column":33,"nodeType":"CallExpression","endLine":20,"endColumn":69},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllLogsDto","line":21,"column":23,"nodeType":"CallExpression","endLine":21,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllRunsDto","line":22,"column":23,"nodeType":"CallExpression","endLine":22,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllSubsystemsDto","line":23,"column":29,"nodeType":"CallExpression","endLine":23,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllTagsDto","line":24,"column":23,"nodeType":"CallExpression","endLine":24,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllFlpsDto","line":25,"column":23,"nodeType":"CallExpression","endLine":25,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAttachmentDto","line":26,"column":26,"nodeType":"CallExpression","endLine":26,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogDto","line":27,"column":19,"nodeType":"CallExpression","endLine":27,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogAttachmentDto","line":28,"column":29,"nodeType":"CallExpression","endLine":28,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetRunDto","line":29,"column":19,"nodeType":"CallExpression","endLine":29,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./StartRunDto","line":30,"column":21,"nodeType":"CallExpression","endLine":30,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EndRunDto","line":31,"column":19,"nodeType":"CallExpression","endLine":31,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetSubsystemDto","line":32,"column":25,"nodeType":"CallExpression","endLine":32,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetTagDto","line":33,"column":19,"nodeType":"CallExpression","endLine":33,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetFlpDto","line":34,"column":19,"nodeType":"CallExpression","endLine":34,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./PaginationDto","line":35,"column":23,"nodeType":"CallExpression","endLine":35,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./UpdateFlpDto","line":36,"column":22,"nodeType":"CallExpression","endLine":36,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./UpdateRunTagsDto","line":37,"column":26,"nodeType":"CallExpression","endLine":37,"endColumn":55}],"errorCount":24,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateAttachmentDto = require('./CreateAttachmentDto');\nconst CreateFlpDto = require('./CreateFlpDto');\nconst CreateLogDto = require('./CreateLogDto');\nconst CreateSubsystemDto = require('./CreateSubsystemDto');\nconst CreateTagDto = require('./CreateTagDto');\nconst EntityIdDto = require('./EntityIdDto');\nconst GetAllLogAttachmentsDto = require('./GetAllLogAttachmentsDto');\nconst GetAllLogsDto = require('./GetAllLogsDto');\nconst GetAllRunsDto = require('./GetAllRunsDto');\nconst GetAllSubsystemsDto = require('./GetAllSubsystemsDto');\nconst GetAllTagsDto = require('./GetAllTagsDto');\nconst GetAllFlpsDto = require('./GetAllFlpsDto');\nconst GetAttachmentDto = require('./GetAttachmentDto');\nconst GetLogDto = require('./GetLogDto');\nconst GetLogAttachmentDto = require('./GetLogAttachmentDto');\nconst GetRunDto = require('./GetRunDto');\nconst StartRunDto = require('./StartRunDto');\nconst EndRunDto = require('./EndRunDto');\nconst GetSubsystemDto = require('./GetSubsystemDto');\nconst GetTagDto = require('./GetTagDto');\nconst GetFlpDto = require('./GetFlpDto');\nconst PaginationDto = require('./PaginationDto');\nconst UpdateFlpDto = require('./UpdateFlpDto');\nconst UpdateRunTagsDto = require('./UpdateRunTagsDto');\n\nmodule.exports = {\n    CreateAttachmentDto,\n    CreateFlpDto,\n    CreateLogDto,\n    CreateSubsystemDto,\n    CreateTagDto,\n    EntityIdDto,\n    GetAllLogAttachmentsDto,\n    GetAllLogsDto,\n    GetAllRunsDto,\n    GetAllSubsystemsDto,\n    GetAllTagsDto,\n    GetAllFlpsDto,\n    GetAttachmentDto,\n    GetLogDto,\n    GetLogAttachmentDto,\n    GetRunDto,\n    StartRunDto,\n    EndRunDto,\n    GetSubsystemDto,\n    GetTagDto,\n    GetFlpDto,\n    PaginationDto,\n    UpdateRunTagsDto,\n    UpdateFlpDto,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/domain/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../database/adapters","line":14,"column":18,"nodeType":"CallExpression","endLine":14,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./dtos","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":31}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst adapters = require('../database/adapters');\nconst dtos = require('./dtos');\n\nmodule.exports = {\n    adapters,\n    dtos,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/main.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./application","line":14,"column":21,"nodeType":"CallExpression","endLine":14,"endColumn":45}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst application = require('./application');\n\napplication.run();\n\n/*\n * 'SIGTERM' and 'SIGINT' have default handlers on non-Windows platforms that reset the terminal mode before exiting\n * with code 128 + signal number. If one of these signals has a listener installed, its default behavior will be removed\n * (Node.js will no longer exit).\n */\n['SIGTERM', 'SIGINT', 'SIGHUP'].forEach((event) => process.on(event, application.stop.bind(application)));\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/presentation/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./log","line":14,"column":13,"nodeType":"CallExpression","endLine":14,"endColumn":29}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst log = require('./log');\n\nmodule.exports = {\n    log,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/presentation/log/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./toTreeView","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst toTreeView = require('./toTreeView');\n\nmodule.exports = {\n    toTreeView,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/presentation/log/toTreeView.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/Model.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":84},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Logs/Logs.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Tags/Tags.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Runs/Runs.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Subsystems/Subsystems.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":59},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Flps/Flps.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":41}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { Loader, Observable, QueryRouter, sessionService } from '/js/src/index.js';\n\nimport Logs from './views/Logs/Logs.js';\nimport Tags from './views/Tags/Tags.js';\nimport Runs from './views/Runs/Runs.js';\nimport Subsystems from './views/Subsystems/Subsystems.js';\nimport Flps from './views/Flps/Flps.js';\n\n/**\n * Root of model tree\n * Handle global events: keyboard, websocket and router location change\n */\nexport default class Model extends Observable {\n    /**\n     * Load all sub-models and bind event handlers\n     * @param {Object} HyperMD The hyperMD object passed from HTML code\n     * @param {Object} window The window object from the HTML\n     * @param {Object} document The document object\n     * @param {Object} CompleteEmoji The CompleteEmoji object passed from HTML code\n     */\n    constructor(HyperMD, window, document, CompleteEmoji) {\n        super();\n        // Bind HyperMD, window and document\n        this.HyperMD = HyperMD;\n        this.document = document;\n        this.window = window;\n        this.CompleteEmoji = CompleteEmoji;\n\n        // Bind session\n        this.session = sessionService.get();\n        this.session.personid = parseInt(this.session.personid, 10);\n\n        // Bind models\n        this.loader = new Loader(this);\n        this.loader.bubbleTo(this);\n\n        this.logs = new Logs(this);\n        this.logs.bubbleTo(this);\n\n        this.runs = new Runs(this);\n        this.runs.bubbleTo(this);\n\n        this.subsystems = new Subsystems(this);\n        this.subsystems.bubbleTo(this);\n\n        this.tags = new Tags(this);\n        this.tags.bubbleTo(this);\n\n        this.flps = new Flps(this);\n        this.flps.bubbleTo(this);\n\n        // Setup router\n        this.router = new QueryRouter();\n        this.router.observe(this.handleLocationChange.bind(this));\n        this.router.bubbleTo(this);\n\n        // Init pages\n        this.handleLocationChange();\n        this.window.addEventListener('resize', () => this.notify());\n\n        // Navbar dropdown menus\n        this.dropdownMenu = false;\n\n        // Setup chunk size for Infinite scroll mode of overview pages\n        this.INFINITE_SCROLL_CHUNK_SIZE = 19;\n    }\n\n    /**\n     * Delegates sub-model actions depending on new location of the page\n     * @returns {vnode} The page to be loaded\n     */\n    async handleLocationChange() {\n        // Reset infinite scroll to prevent scroll listening on pages where it is disabled or not needed\n        window.onscroll = null;\n\n        switch (this.router.params.page) {\n            case 'home':\n                this.logs.fetchAllLogs();\n                this.runs.fetchAllRuns();\n                break;\n            case 'log-overview':\n                // Prevent loading extra rows when it's not necessary\n                if (!this.logs.isInfiniteScrollEnabled()) {\n                    this.logs.fetchAllLogs();\n                    this.tags.fetchAllTags();\n                    this.runs.fetchAllRuns();\n                }\n                break;\n            case 'log-detail':\n                this.logs.fetchOneLog(this.router.params.id);\n                this.logs.infiniteScrollEnabled = false;\n                break;\n            case 'log-create':\n                this.logs.setMarkdownBox('text', { location: 'logs', name: 'setText' });\n                this.tags.fetchAllTags();\n                break;\n            case 'run-overview':\n                // Prevent loading extra rows when it's not necessary\n                if (!this.runs.isInfiniteScrollEnabled()) {\n                    this.runs.fetchAllRuns();\n                }\n                break;\n            case 'run-detail':\n                if (this.router.params.panel) {\n                    await this.runs.fetchOneRun(this.router.params.id);\n                    await this.tags.fetchAllTags();\n                    switch (this.router.params.panel) {\n                        case 'logs':\n                            await this.runs.fetchLogsOfRun(this.router.params.id);\n                            break;\n                        case 'flps':\n                            await this.runs.fetchFlpsOfRun(this.router.params.id);\n                            break;\n                        default:\n                            break;\n                    }\n                }\n                break;\n            case 'run-export':\n                this.runs.fetchAllRuns();\n                break;\n            case 'tag-overview':\n                if (!this.runs.isInfiniteScrollEnabled()) {\n                    this.tags.fetchAllTags();\n                }\n                break;\n            case 'tag-detail':\n                if (this.router.params.panel) {\n                    await this.tags.fetchOneTag(this.router.params.id);\n                    switch (this.router.params.panel) {\n                        case 'logs':\n                            await this.tags.fetchLogsOfTag(this.router.params.id);\n                            break;\n                        default:\n                            break;\n                    }\n                }\n                break;\n            case 'tag-create':\n                break;\n            case 'subsystem-overview':\n                this.subsystems.fetchAllSubsystems();\n                break;\n            case 'subsystem-detail':\n                if (this.router.params.panel) {\n                    this.subsystems.fetchOneSubsystem(this.router.params.id);\n                    switch (this.router.params.panel) {\n                        case 'logs':\n                            this.subsystems.fetchLogsOfSubsystem(this.router.params.id);\n                            break;\n                        default:\n                            break;\n                    }\n                }\n                break;\n            case 'create-tag':\n                break;\n            case 'flp-overview':\n                // Prevent loading extra rows when it's not necessary\n                if (!this.flps.isInfiniteScrollEnabled()) {\n                    this.flps.fetchAllFlps();\n                }\n                break;\n            case 'flp-detail':\n                if (this.router.params.panel) {\n                    this.flps.fetchOneFlp(this.router.params.id);\n                }\n                break;\n            case 'about-overview':\n                break;\n            default:\n                this.router.go('?page=home');\n                break;\n        }\n    }\n\n    /**\n     * Toggle navbar overview dropdown\n     * @returns {undefined}\n     */\n    toggleOverviewDropdown() {\n        this.dropdownMenu = this.dropdownMenu === 'overview' ? false : 'overview';\n        this.notify();\n    }\n\n    /**\n     * Toggle navbar account dropdown\n     * @returns {undefined}\n     */\n    toggleAccountDropdown() {\n        this.dropdownMenu = this.dropdownMenu === 'account' ? false : 'account';\n        this.notify();\n    }\n\n    /**\n     * Clears all navbar dropdowns\n     * @returns {undefined}\n     */\n    clearDropdownMenu() {\n        this.dropdownMenu = false;\n        this.notify();\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/HyperMD/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror","line":12,"column":79,"nodeType":"CallExpression","endLine":12,"endColumn":100},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/fold/foldcode","line":12,"column":101,"nodeType":"CallExpression","endLine":12,"endColumn":142},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/fold/foldgutter","line":12,"column":143,"nodeType":"CallExpression","endLine":12,"endColumn":186},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/fold/markdown-fold","line":12,"column":187,"nodeType":"CallExpression","endLine":12,"endColumn":233},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/edit/closebrackets","line":12,"column":234,"nodeType":"CallExpression","endLine":12,"endColumn":280},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/lib/codemirror.css","line":12,"column":281,"nodeType":"CallExpression","endLine":12,"endColumn":321},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/fold/foldgutter.css","line":12,"column":322,"nodeType":"CallExpression","endLine":12,"endColumn":369},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./theme/hypermd-light.css","line":12,"column":370,"nodeType":"CallExpression","endLine":12,"endColumn":406},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/mode/markdown/markdown","line":12,"column":407,"nodeType":"CallExpression","endLine":12,"endColumn":451},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./mode/hypermd.css","line":12,"column":452,"nodeType":"CallExpression","endLine":12,"endColumn":481},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/mode/meta","line":12,"column":482,"nodeType":"CallExpression","endLine":12,"endColumn":513}],"errorCount":11,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/*!\n * HyperMD, copyright (c) by laobubu\n * Distributed under an MIT license: http://laobubu.net/HyperMD/LICENSE\n *\n * Break the Wall between writing and preview, in a Markdown Editor.\n *\n * HyperMD makes Markdown editor on web WYSIWYG, based on CodeMirror\n *\n * Homepage: http://laobubu.net/HyperMD/\n * Issues: https://github.com/laobubu/HyperMD/issues\n */\n!function(e,t){\"object\"==typeof exports&&\"undefined\"!=typeof module?t(exports,require(\"codemirror\"),require(\"codemirror/addon/fold/foldcode\"),require(\"codemirror/addon/fold/foldgutter\"),require(\"codemirror/addon/fold/markdown-fold\"),require(\"codemirror/addon/edit/closebrackets\"),require(\"codemirror/lib/codemirror.css\"),require(\"codemirror/addon/fold/foldgutter.css\"),require(\"./theme/hypermd-light.css\"),require(\"codemirror/mode/markdown/markdown\"),require(\"./mode/hypermd.css\"),require(\"codemirror/mode/meta\")):\"function\"==typeof define&&define.amd?define([\"exports\",\"codemirror\",\"codemirror/addon/fold/foldcode\",\"codemirror/addon/fold/foldgutter\",\"codemirror/addon/fold/markdown-fold\",\"codemirror/addon/edit/closebrackets\",\"codemirror/lib/codemirror.css\",\"codemirror/addon/fold/foldgutter.css\",\"./theme/hypermd-light.css\",\"codemirror/mode/markdown/markdown\",\"./mode/hypermd.css\",\"codemirror/mode/meta\"],t):t(e.HyperMD={},e.CodeMirror)}(this,function(e,U){\"use strict\";\"function\"!=typeof Object.assign&&Object.defineProperty(Object,\"assign\",{value:function(e,t){var n=arguments;if(null==e)throw new TypeError(\"Cannot convert undefined or null to object\");for(var r=Object(e),i=1;i<arguments.length;i++){var o=n[i];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])}return r},writable:!0,configurable:!0});var s=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=\"enabled\"),this.on_cb=e,this.off_cb=t,this.state=n,this.subkey=r};function d(t,n,r){n=~~n||5;var i=250;setTimeout(function e(){if(n--){try{if(t())return}catch(e){}setTimeout(e,i),i*=2}else r&&r()},0)}function h(e,t){var n=null,r=0,i=function(){e(),n=0},o=function(){var e=+new Date;if(n){if(e<r)return;clearTimeout(n)}n=setTimeout(i,t),r=e+100};return o.stop=function(){n&&(clearTimeout(n),n=0)},o}s.prototype.ON=function(e){return this.on_cb=e,this},s.prototype.OFF=function(e){return this.off_cb=e,this},s.prototype.set=function(e,t){var n=\"object\"==typeof e&&e?e[this.subkey]:e;t&&(n=!!n),n!==this.state&&((this.state=n)?this.on_cb&&this.on_cb(n):this.off_cb&&this.off_cb(n))},s.prototype.setBool=function(e){return this.set(e,!0)},s.prototype.bind=function(e,t,n){var r=this;return Object.defineProperty(e,t,{get:function(){return r.state},set:function(e){return r.set(e,n)},configurable:!0,enumerable:!0}),this};var t=U.addClass,n=U.rmClass,r=U.contains;function a(e,t){var n=new Array(t);if(n.fill)n.fill(e);else for(var r=0;r<t;r++)n[r]=e;return n}function $(e,t){for(var n=\"\";0<t--;)n+=e;return n}function m(e,t){for(var n,r=[e];n=r.shift();)for(var i=0;i<n.length;i++){var o=n[i];o&&o.nodeType==Node.ELEMENT_NODE&&(t(o),o.children&&0<o.children.length&&r.push(o.children))}}function p(r,i,o){var e=r.getBoundingClientRect(),a=e.width,l=e.height,s=h(function(){var e=r.getBoundingClientRect(),t=e.width,n=e.height;a==t&&l==n||(i(t,n,a,l),a=t,l=n,setTimeout(s,200))},100),t=null;var n=!1;var c=[];return o||m([r],function(e){var t,n=e.tagName,r=getComputedStyle(e);\"none\"!=(t=\"resize\",r.getPropertyValue(t)||\"\")&&(o=!0),/^(?:img|video)$/i.test(n)?(e.addEventListener(\"load\",s,!1),e.addEventListener(\"error\",s,!1)):/^(?:details|summary)$/i.test(n)&&e.addEventListener(\"click\",s,!1)}),o&&(t=setTimeout(function e(){t&&clearTimeout(t),n||(t=setTimeout(e,200)),s()},200)),{check:s,stop:function(){n=!0,s.stop(),t&&(clearTimeout(t),t=null);for(var e=0;e<c.length;e++)c[e][0].removeEventListener(c[e][1],s,!1)}}}function i(e){return\"function\"==typeof Symbol?Symbol(e):\"_\\n\"+e+\"\\n_\"+Math.floor(65535*Math.random()).toString(16)}var o=\"__hypermd__\",l={lineNumbers:!0,lineWrapping:!0,theme:\"hypermd-light\",mode:\"text/x-hypermd\",tabSize:4,autoCloseBrackets:!0,foldGutter:!0,gutters:[\"CodeMirror-linenumbers\",\"CodeMirror-foldgutter\",\"HyperMD-goback\"]},c={theme:\"default\"};function u(e,t){if(t>=e.display.viewTo)return null;if((t-=e.display.viewFrom)<0)return null;for(var n=e.display.view,r=0;r<n.length;r++)if((t-=n[r].size)<0)return r}function b(e,t){if(t>=e.display.viewFrom&&t<e.display.viewTo)return e.display.view[u(e,t)];var n=e.display.externalMeasured;return n&&t>=n.lineN&&t<n.lineN+n.size?n:void 0}function _(e,t,n){if(e.line==t)return{map:e.measure.map,cache:e.measure.cache,before:!1};for(var r=0;r<e.rest.length;r++)if(e.rest[r]==t)return{map:e.measure.maps[r],cache:e.measure.caches[r],before:!1};for(var i=0;i<e.rest.length;i++)if(e.rest[i].lineNo()>n)return{map:e.measure.maps[i],cache:e.measure.caches[i],before:!0}}var f=Object.freeze({findViewIndex:u,findViewForLine:b,mapFromLineView:_}),z=function(e){this.cm=e};function w(e,t,n){var r,i=t.line,o={line:i,ch:0},a={line:i,ch:t.ch},l=\"function\"==typeof n&&n,s=!l&&new RegExp(\"(?:^|\\\\s)\"+n+\"(?:\\\\s|$)\"),c=e.getLineTokens(i);for(r=0;r<c.length&&!(c[r].end>=t.ch);r++);if(r===c.length)return null;for(var d=r;d<c.length;d++){var h=c[d];if(l?!l(h):!s.test(h.type))break;a.ch=h.end}for(d=r;0<=d;d--){h=c[d];if(!(l?l(h):s.test(h.type))){o.ch=h.end;break}}return{from:o,to:a}}function g(e){return\"anchor\"in e&&(e=[e.head,e.anchor]),0<U.cmpPos(e[0],e[1])?[e[1],e[0]]:[e[0],e[1]]}function k(e,t){var n=e[0],r=e[1],i=t[0],o=t[1];return!(U.cmpPos(r,i)<0||0<U.cmpPos(n,o))}z.prototype.findNext=function(n,e,r){var i=this.lineNo,o=this.lineTokens,a=null,l=this.i_token+1,t=!1;if(!0===e?t=!0:\"number\"==typeof e&&(l=e),r)if(r.line>i)l=o.length;else if(r.line<i);else for(;l<o.length&&!(o[l].start>=r.ch);l++);for(;l<o.length;l++){var s=o[l];if(\"function\"==typeof n?n(s,o,l):n.test(s.type)){a=s;break}}if(!a&&t){var c=this.cm,d=Math.max(r?r.line:0,i+1);c.eachLine(d,c.lastLine()+1,function(e){if(i=e.lineNo(),o=c.getLineTokens(i),l=0,r&&i===r.line)for(;l<o.length&&!(o[l].start>=r.ch);l++);for(;l<o.length;l++){var t=o[l];if(\"function\"==typeof n?n(t,o,l):n.test(t.type))return a=t,!0}})}return a?{lineNo:i,token:a,i_token:l}:null},z.prototype.findPrev=function(e,t,n){var r=this.lineNo,i=this.lineTokens,o=null,a=this.i_token-1,l=!1;if(!0===t?l=!0:\"number\"==typeof t&&(a=t),n)if(n.line<r)a=-1;else if(n.line>r);else for(;a<i.length&&!(i[a].start>=n.ch);a++);for(a>=i.length&&(a=i.length-1);0<=a;a--){var s=i[a];if(\"function\"==typeof e?e(s,i,a):e.test(s.type)){o=s;break}}if(!o&&l){var c=this.cm,d=Math.min(n?n.line:c.lastLine(),r-1),h=c.firstLine();for(r=d+1;!o&&h<=--r;){c.getLineHandle(r);if(i=c.getLineTokens(r),a=0,n&&r===n.line)for(;a<i.length&&!(i[a].start>=n.ch);a++);for(a>=i.length&&(a=i.length-1);0<=a;a--){s=i[a];if(\"function\"==typeof e?e(s,i,a):e.test(s.type)){o=s;break}}}}return o?{lineNo:r,token:o,i_token:a}:null},z.prototype.expandRange=function(t,e){var n,r=this.cm;n=\"function\"==typeof t?t:(\"string\"==typeof t&&(t=new RegExp(\"(?:^|\\\\s)\"+t+\"(?:\\\\s|$)\")),function(e){return!!e&&t.test(e.type||\"\")});for(var i={lineNo:this.lineNo,i_token:this.i_token,token:this.lineTokens[this.i_token]},o=Object.assign({},i),a=!1,l=this.lineTokens,s=this.i_token;!a;){for(s>=l.length&&(s=l.length-1);0<=s;s--){var c=l[s];if(!n(c,l,s)){a=!0;break}i.i_token=s,i.token=c}if(a||!(e&&i.lineNo>r.firstLine()))break;s=(l=r.getLineTokens(--i.lineNo)).length-1}for(a=!1,l=this.lineTokens,s=this.i_token;!a;){for(s<0&&(s=0);s<l.length;s++){var d=l[s];if(!n(d,l,s)){a=!0;break}o.i_token=s,o.token=d}if(a||!(e&&o.lineNo<r.lastLine()))break;l=r.getLineTokens(++o.lineNo),s=0}return{from:i,to:o}},z.prototype.setPos=function(e,t,n){void 0===t?(t=e,e=this.line):\"number\"==typeof e&&(e=this.cm.getLineHandle(e));var r=e===this.line,i=0;n||!r?(this.line=e,this.lineNo=e.lineNo(),this.lineTokens=this.cm.getLineTokens(this.lineNo)):(i=this.i_token,this.lineTokens[i].start>t&&(i=0));for(var o=this.lineTokens;i<o.length&&!(o[i].end>t);i++);this.i_token=i},z.prototype.getToken=function(e){return\"number\"!=typeof e&&(e=this.i_token),this.lineTokens[e]},z.prototype.getTokenType=function(e){\"number\"!=typeof e&&(e=this.i_token);var t=this.lineTokens[e];return t&&t.type||\"\"};var v=function(e){var r=this;this.cm=e,this.caches=new Array,e.on(\"change\",function(e,t){var n=t.from.line;r.caches.length>n&&r.caches.splice(n)})};v.prototype.getTokenTypes=function(e,t){var n=t?t.state:{},r=e.state,i=\" \"+e.type+\" \";return{em:r.em?1:n.em?2:0,strikethrough:r.strikethrough?1:n.strikethrough?2:0,strong:r.strong?1:n.strong?2:0,code:r.code?1:n.code?2:0,linkText:r.linkText?3===r.hmdLinkType||6===r.hmdLinkType?1:0:n.linkText?2:0,linkHref:r.linkHref&&!r.linkText?1:r.linkHref||r.linkText||!n.linkHref||n.linkText?0:2,task:-1!==i.indexOf(\" formatting-task \")?3:0,hashtag:r.hmdHashtag?1:n.hmdHashtag?2:0}},v.prototype.extract=function(e,t){if(!t){var n=this.caches[e];if(n)return n}for(var r=this.cm.getLineTokens(e),i=this.cm.getLine(e),o=i.length,a=[],l={},s=0;s<r.length;s++){var c=r[s],d=this.getTokenTypes(c,r[s-1]);for(var h in d){var u=l[h];1&d[h]&&(u||(u={type:h,begin:c.start,end:o,head:c,head_i:s,tail:r[r.length-1],tail_i:r.length-1,text:i.slice(c.start)},a.push(u),l[h]=u)),2&d[h]&&u&&(u.tail=c,u.tail_i=s,u.end=c.end,u.text=u.text.slice(0,u.end-u.begin),l[h]=null)}}return this.caches[e]=a},v.prototype.findSpansAt=function(e){for(var t=this.extract(e.line),n=e.ch,r=[],i=0;i<t.length;i++){var o=t[i];if(o.begin>n)break;n>=o.begin&&o.end>=n&&r.push(o)}return r},v.prototype.findSpanWithTypeAt=function(e,t){for(var n=this.extract(e.line),r=e.ch,i=0;i<n.length;i++){var o=n[i];if(o.begin>r)break;if(r>=o.begin&&o.end>=r&&o.type===t)return o}return null};var y=i(\"LineSpanExtractor\");function T(e){return y in e?e[y]:e[y]=new v(e)}function x(r,i,o){return function(e){if(e.hmd||(e.hmd={}),e.hmd[r])return e.hmd[r];var t=new i(e);if(e.hmd[r]=t,o)for(var n in o)t[n]=o[n];return t}}var L=Object.freeze({Addon:function(e){},Getter:x}),W=/[^\\\\][$|]/,B=/^(?:[*\\-+]|^[0-9]+([.)]))\\s+/,X=/^((?:(?:aaas?|about|acap|adiumxtra|af[ps]|aim|apt|attachment|aw|beshare|bitcoin|bolo|callto|cap|chrome(?:-extension)?|cid|coap|com-eventbrite-attendee|content|crid|cvs|data|dav|dict|dlna-(?:playcontainer|playsingle)|dns|doi|dtn|dvb|ed2k|facetime|feed|file|finger|fish|ftp|geo|gg|git|gizmoproject|go|gopher|gtalk|h323|hcp|https?|iax|icap|icon|im|imap|info|ipn|ipp|irc[6s]?|iris(?:\\.beep|\\.lwz|\\.xpc|\\.xpcs)?|itms|jar|javascript|jms|keyparc|lastfm|ldaps?|magnet|mailto|maps|market|message|mid|mms|ms-help|msnim|msrps?|mtqp|mumble|mupdate|mvn|news|nfs|nih?|nntp|notes|oid|opaquelocktoken|palm|paparazzi|platform|pop|pres|proxy|psyc|query|res(?:ource)?|rmi|rsync|rtmp|rtsp|secondlife|service|session|sftp|sgn|shttp|sieve|sips?|skype|sm[bs]|snmp|soap\\.beeps?|soldat|spotify|ssh|steam|svn|tag|teamspeak|tel(?:net)?|tftp|things|thismessage|tip|tn3270|tv|udp|unreal|urn|ut2004|vemmi|ventrilo|view-source|webcal|wss?|wtai|wyciwyg|xcon(?:-userid)?|xfire|xmlrpc\\.beeps?|xmpp|xri|ymsgr|z39\\.50[rs]?):(?:\\/{1,3}|[a-z0-9%])|www\\d{0,3}[.]|[a-z0-9.\\-]+[.][a-z]{2,4}\\/)(?:[^\\s()<>]|\\([^\\s()<>]*\\))+(?:\\([^\\s()<>]*\\)|[^\\s`*!()\\[\\]{};:'\".,<>?]))/i,Y=/^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/,G=/^\\.{0,2}\\/[^\\>\\s]+/,V=/^(?:[-()/a-zA-Z0-9-----------\\u9FEF--]|[\\ud840-\\ud868][\\udc00-\\udfff]|\\ud869[\\udc00-\\uded6\\udf00-\\udfff]|[\\ud86a-\\ud86c][\\udc00-\\udfff]|\\ud86d[\\udc00-\\udf34\\udf40-\\udfff]|\\ud86e[\\udc00-\\udc1d])+/,Z=/^\\s*[^\\|].*?\\|.*[^|]\\s*$/,Q=/^\\s*[^\\|].*\\|/,J=/^\\s*\\|[^\\|]+\\|.+\\|\\s*$/,ee=/^\\s*\\|/,te={};function ne(e){e.hmdTable=0,e.hmdTableColumns=[],e.hmdTableID=null,e.hmdTableCol=e.hmdTableRow=0}te[1]=\"hmd-barelink\",te[6]=\"hmd-barelink2\",te[2]=\"hmd-barelink hmd-footref\",te[4]=\"hmd-footnote line-HyperMD-footnote\",te[7]=\"hmd-footref2\";var re=/^\\s+((\\d+[).]|[-*+])\\s+)?/,M={hr:\"line-HyperMD-hr line-background-HyperMD-hr-bg hr\",list1:\"list-1\",list2:\"list-2\",list3:\"list-3\",code:\"inline-code\",hashtag:\"hashtag meta\"};U.defineMode(\"hypermd\",function(j,e){var F={front_matter:!0,math:!0,table:!0,toc:!0,orgModeMarkup:!0,hashtag:!1,fencedCodeBlockHighlighting:!0,name:\"markdown\",highlightFormatting:!0,taskLists:!0,strikethrough:!0,emoji:!0,tokenTypeOverrides:M};Object.assign(F,e),F.tokenTypeOverrides!==M&&(F.tokenTypeOverrides=Object.assign({},M,F.tokenTypeOverrides)),F.name=\"markdown\";var P={htmlBlock:null},q=U.getMode(j,F),t=Object.assign({},q);function o(e,t){var n=t.hmdInnerExitChecker(e,t),r=t.hmdInnerStyle,i=(!n||!n.skipInnerMode)&&t.hmdInnerMode.token(e,t.hmdInnerState)||\"\";return r&&(i+=\" \"+r),n&&(n.style&&(i+=\" \"+n.style),n.endPos&&(e.pos=n.endPos),t.hmdInnerExitChecker=null,t.hmdInnerMode=null,t.hmdInnerState=null,t.hmdOverride=null),i.trim()||null}function $(n){return{token:function(e){var t=e.string.indexOf(n,e.start);return-1===t?e.skipToEnd():0===t?e.pos+=n.length:(e.pos=t,\"\\\\\"===e.string.charAt(t-1)&&e.pos++),null}}}function z(n,r){return r||(r={}),function(e,t){return e.string.substr(e.start,n.length)===n?(r.endPos=e.start+n.length,r):null}}function K(e,t,n,r){if(\"string\"==typeof n&&(n=U.getMode(j,n)),!(n&&\"null\"!==n.name||(n=\"endTag\"in r?$(r.endTag):\"function\"==typeof r.fallbackMode&&r.fallbackMode())))throw new Error(\"no mode\");t.hmdInnerExitChecker=\"endTag\"in r?z(r.endTag):r.exitChecker,t.hmdInnerStyle=r.style,t.hmdInnerMode=n,t.hmdOverride=o,t.hmdInnerState=U.startState(n);var i=r.style||\"\";return r.skipFirstToken||(i+=\" \"+n.token(e,t.hmdInnerState)),i.trim()}return t.startState=function(){var e=q.startState();return ne(e),e.hmdOverride=null,e.hmdInnerExitChecker=null,e.hmdInnerMode=null,e.hmdLinkType=0,e.hmdNextMaybe=F.front_matter?1:0,e.hmdNextState=null,e.hmdNextStyle=null,e.hmdNextPos=null,e.hmdHashtag=0,e},t.copyState=function(e){for(var t=q.copyState(e),n=0,r=[\"hmdLinkType\",\"hmdNextMaybe\",\"hmdTable\",\"hmdTableID\",\"hmdTableCol\",\"hmdTableRow\",\"hmdOverride\",\"hmdInnerMode\",\"hmdInnerStyle\",\"hmdInnerExitChecker\",\"hmdNextPos\",\"hmdNextState\",\"hmdNextStyle\",\"hmdHashtag\"];n<r.length;n+=1){var i=r[n];t[i]=e[i]}return t.hmdTableColumns=e.hmdTableColumns.slice(0),e.hmdInnerMode&&(t.hmdInnerState=U.copyState(e.hmdInnerMode,e.hmdInnerState)),t},t.blankLine=function(e){var t,n=e.hmdInnerMode;return n?n.blankLine&&(t=n.blankLine(e.hmdInnerState)):t=q.blankLine(e),t||(t=\"\"),-1===e.code&&(t+=\" line-HyperMD-codeblock line-background-HyperMD-codeblock-bg\"),ne(e),t.trim()||null},t.indent=function(e,t){var n=e.hmdInnerMode||q,r=n.indent;return\"function\"==typeof r?r.apply(n,arguments):U.Pass},t.innerMode=function(e){return e.hmdInnerMode?{mode:e.hmdInnerMode,state:e.hmdInnerState}:q.innerMode(e)},t.token=function(e,t){if(t.hmdOverride)return t.hmdOverride(e,t);if(1===t.hmdNextMaybe){if(\"---\"===e.string)return t.hmdNextMaybe=2,K(e,t,\"yaml\",{style:\"hmd-frontmatter\",fallbackMode:function(){return $(\"---\")},exitChecker:function(e,t){return\"---\"===e.string?(t.hmdNextMaybe=0,{endPos:3}):null}});t.hmdNextMaybe=0}var n,r=t.f===P.htmlBlock,i=-1===t.code,o=0===e.start,a=t.linkText,l=t.linkHref,s=!(i||r),c=s&&!(t.code||t.indentedCode||t.linkHref),d=\"\";if(s){if(F.math&&c&&(n=e.match(/^\\${1,2}/,!1))){var h=n[0],u=h.length;if(2===u||e.string.slice(e.pos).match(/[^\\\\]\\$/)){var f=U.getMode(j,{name:\"stex\"}),m=\"stex\"!==f.name;return d+=K(e,t,f,{style:\"math\",skipFirstToken:m,fallbackMode:function(){return $(h)},exitChecker:z(h,{style:\"formatting formatting-math formatting-math-end math-\"+u})}),m&&(e.pos+=n[0].length),d+=\" formatting formatting-math formatting-math-begin math-\"+u}}if(o&&F.orgModeMarkup&&(n=e.match(/^\\#\\+(\\w+\\:?)\\s*/)))return e.eol()||(t.hmdOverride=function(e,t){return e.skipToEnd(),t.hmdOverride=null,\"string hmd-orgmode-markup\"}),\"meta formatting-hmd-orgmode-markup hmd-orgmode-markup line-HyperMD-orgmode-markup\";if(o&&F.toc&&e.match(/^\\[TOCM?\\]\\s*$/i))return\"meta line-HyperMD-toc hmd-toc\";if(c&&!t.hmdLinkType&&(e.match(X)||e.match(Y)))return\"url\"}t.hmdNextState?(e.pos=t.hmdNextPos,d+=\" \"+(t.hmdNextStyle||\"\"),Object.assign(t,t.hmdNextState),t.hmdNextState=null,t.hmdNextStyle=null,t.hmdNextPos=null):d+=\" \"+(q.token(e,t)||\"\"),0!==t.hmdHashtag&&(d+=\" \"+F.tokenTypeOverrides.hashtag),!P.htmlBlock&&t.htmlState&&(P.htmlBlock=t.f);var p=t.f===P.htmlBlock,g=-1===t.code;s=s&&!(p||g),(c=c&&s&&!(t.code||t.indentedCode||t.linkHref))&&(n=e.current().match(W))&&(e.pos=e.start+n.index+1);var v=e.current();if(p!=r&&(p?(d+=\" hmd-html-begin\",P.htmlBlock=t.f):d+=\" hmd-html-end\"),(i||g)&&(t.localMode&&i||(d=d.replace(\"inline-code\",\"\")),d+=\" line-HyperMD-codeblock line-background-HyperMD-codeblock-bg\",g!==i&&(g?i||(d+=\" line-HyperMD-codeblock-begin line-background-HyperMD-codeblock-begin-bg\"):d+=\" line-HyperMD-codeblock-end line-background-HyperMD-codeblock-end-bg\")),s){var b=t.hmdTable;if(o&&b)(1==b?Q:ee).test(e.string)?(t.hmdTableCol=0,t.hmdTableRow++):ne(t);if(o&&t.header&&(/^(?:---+|===+)\\s*$/.test(e.string)&&t.prevLine&&t.prevLine.header?d+=\" line-HyperMD-header-line line-HyperMD-header-line-\"+t.header:d+=\" line-HyperMD-header line-HyperMD-header-\"+t.header),t.indentedCode&&(d+=\" hmd-indented-code\"),t.quote){if(e.eol()&&(d+=\" line-HyperMD-quote line-HyperMD-quote-\"+t.quote,/^ {0,3}\\>/.test(e.string)||(d+=\" line-HyperMD-quote-lazy\")),o&&(n=v.match(/^\\s+/)))return e.pos=n[0].length,(d+=\" hmd-indent-in-quote\").trim();/^>\\s+$/.test(v)&&\">\"!=e.peek()&&(e.pos=e.start+1,v=\">\",t.hmdOverride=function(e,t){return e.match(re),t.hmdOverride=null,\"hmd-indent-in-quote line-HyperMD-quote line-HyperMD-quote-\"+t.quote})}var _=(t.listStack[t.listStack.length-1]||0)+3,k=o&&/^\\s+$/.test(v)&&(!1!==t.list||e.indentation()<=_),y=t.list&&/formatting-list/.test(d);if(y||k&&(!1!==t.list||e.match(B,!1))){var w=t.listStack&&t.listStack.length||0;if(k){if(e.match(B,!1))!1===t.list&&w++;else{for(;0<w&&e.pos<t.listStack[w-1];)w--;if(!w)return d.trim()||null;d+=\" line-HyperMD-list-line-nobullet line-HyperMD-list-line line-HyperMD-list-line-\"+w}d+=\" hmd-list-indent hmd-list-indent-\"+w}else y&&(d+=\" line-HyperMD-list-line line-HyperMD-list-line-\"+w)}if(a!==t.linkText&&(a?(t.hmdLinkType in te&&(d+=\" \"+te[t.hmdLinkType]),4===t.hmdLinkType?t.hmdLinkType=5:t.hmdLinkType=0):(n=e.match(/^([^\\]]+)\\](\\(| ?\\[|\\:)?/,!1))?n[2]?\":\"===n[2]?t.hmdLinkType=4:\"[\"!==n[2]&&\" [\"!==n[2]||\"]\"!==e.string.charAt(e.pos+n[0].length)?t.hmdLinkType=3:t.hmdLinkType=6:\"^\"===n[1].charAt(0)?t.hmdLinkType=2:t.hmdLinkType=1:t.hmdLinkType=1),l!==t.linkHref&&(l?t.hmdLinkType&&(d+=\" \"+te[t.hmdLinkType],t.hmdLinkType=0):\"[\"===v&&\"]\"!==e.peek()&&(t.hmdLinkType=7)),0!==t.hmdLinkType&&(t.hmdLinkType in te&&(d+=\" \"+te[t.hmdLinkType]),5===t.hmdLinkType&&(/^(?:\\]\\:)?\\s*$/.test(v)||(X.test(v)||G.test(v)?d+=\" hmd-footnote-url\":d=d.replace(\"string url\",\"\"),t.hmdLinkType=0))),/formatting-escape/.test(d)&&1<v.length){var T=v.length-1,x=d.replace(\"formatting-escape\",\"escape\")+\" hmd-escape-char\";return t.hmdOverride=function(e,t){return e.pos+=T,t.hmdOverride=null,x.trim()},d+=\" hmd-escape-backslash\",e.pos-=T,d}if(!d.trim()&&F.table){var L=!1;if(\"|\"===v.charAt(0)&&(e.pos=e.start+1,v=\"|\",L=!0),L){if(!b){var M;if(Z.test(e.string)?b=1:J.test(e.string)&&(b=2),b){var C=e.lookAhead(1);if(2===b?J.test(C)?C=C.replace(/^\\s*\\|/,\"\").replace(/\\|\\s*$/,\"\"):b=0:1===b&&(Z.test(C)||(b=0)),b){M=C.split(\"|\");for(var O=0;O<M.length;O++){var H=M[O];if(/^\\s*--+\\s*:\\s*$/.test(H))H=\"right\";else if(/^\\s*:\\s*--+\\s*$/.test(H))H=\"left\";else if(/^\\s*:\\s*--+\\s*:\\s*$/.test(H))H=\"center\";else{if(!/^\\s*--+\\s*$/.test(H)){b=0;break}H=\"default\"}M[O]=H}}}b&&(t.hmdTable=b,t.hmdTableColumns=M,t.hmdTableID=\"T\"+e.lineOracle.line,t.hmdTableRow=t.hmdTableCol=0)}if(b){var S=t.hmdTableColumns.length-1;if(2===b&&(0===t.hmdTableCol&&/^\\s*\\|$/.test(e.string.slice(0,e.pos))||e.match(/^\\s*$/,!1)))d+=\" hmd-table-sep hmd-table-sep-dummy\";else if(t.hmdTableCol<S){var E=t.hmdTableRow,D=t.hmdTableCol++;0==D&&(d+=\" line-HyperMD-table_\"+t.hmdTableID+\" line-HyperMD-table-\"+b+\" line-HyperMD-table-row line-HyperMD-table-row-\"+E),d+=\" hmd-table-sep hmd-table-sep-\"+D}}}}if(b&&1===t.hmdTableRow&&/emoji/.test(d)&&(d=\"\"),c&&\"<\"===v){var N=null;if(e.match(/^\\![A-Z]+/)?N=\">\":e.match(\"?\")?N=\"?>\":e.match(\"![CDATA[\")&&(N=\"]]>\"),null!=N)return K(e,t,null,{endTag:N,style:(d+\" comment hmd-cdata-html\").trim()})}if(F.hashtag&&c)switch(t.hmdHashtag){case 0:if(\"#\"===v&&!t.linkText&&!t.image&&(o||/^\\s*$/.test(e.string.charAt(e.start-1)))){var A=e.string.slice(e.pos).replace(/\\\\./g,\"\");if(n=V.exec(A))for(/^\\d+$/.test(n[0])?t.hmdHashtag=0:t.hmdHashtag=1,A=A.slice(n[0].length);;){if(\"#\"===A[0]&&(1===A.length||!V.test(A[1]))){t.hmdHashtag=2;break}if(!(n=A.match(/^\\s+/))||!(n=(A=A.slice(n[0].length)).match(V)))break;A=A.slice(n[0].length)}t.hmdHashtag&&(d+=\" formatting formatting-hashtag hashtag-begin \"+F.tokenTypeOverrides.hashtag)}break;case 1:var R=!1;if(!/formatting/.test(d)&&!/^\\s*$/.test(v)){n=v.match(V);var I=v.length-(n?n[0].length:0);0<I&&(e.backUp(I),R=!0)}R||(R=e.eol()),R||(R=!V.test(e.peek())),R&&(d+=\" hashtag-end\",t.hmdHashtag=0);break;case 2:\"#\"===v&&(d=d.replace(/\\sformatting-header(?:-\\d+)?/g,\"\"),d+=\" formatting formatting-hashtag hashtag-end\",t.hmdHashtag=0)}}return d.trim()||null},t},\"hypermd\"),U.defineMIME(\"text/x-hypermd\",\"hypermd\");var C=Object.freeze({});var O={byDrop:!1,byPaste:!1,fileHandler:null},H={byPaste:!0,byDrop:!0};l.hmdInsertFile=H,U.defineOption(\"hmdInsertFile\",O,function(e,t){if(t&&\"boolean\"!=typeof t)\"function\"==typeof t&&(t={byDrop:!0,byPaste:!0,fileHandler:t});else{var n=!!t;t={byDrop:n,byPaste:n}}var r=E(e);for(var i in O)r[i]=i in t?t[i]:O[i]});var S=function(e){var o=this;this.cm=e,this.pasteHandle=function(e,t){o.doInsert(t.clipboardData||window.clipboardData,!0)&&t.preventDefault()},this.dropHandle=function(t,n){var r=o,i=(t=o.cm,!1);t.operation(function(){var e=t.coordsChar({left:n.clientX,top:n.clientY},\"window\");t.setCursor(e),i=r.doInsert(n.dataTransfer,!1)}),i&&n.preventDefault()},new s(function(){return o.cm.on(\"paste\",o.pasteHandle)},function(){return o.cm.off(\"paste\",o.pasteHandle)}).bind(this,\"byPaste\",!0),new s(function(){return o.cm.on(\"drop\",o.dropHandle)},function(){return o.cm.off(\"drop\",o.dropHandle)}).bind(this,\"byDrop\",!0)};S.prototype.doInsert=function(e,t){var a=this.cm;if(t&&e.types&&e.types.some(function(e){return\"text/\"===e.slice(0,5)}))return!1;if(!e||!e.files||0===e.files.length)return!1;var r=e.files,i=this.fileHandler,l=!1;return\"function\"==typeof i&&(a.operation(function(){a.replaceSelection(\".\");var e=a.getCursor(),t={line:e.line,ch:e.ch-1},n=document.createElement(\"span\"),o=a.markText(t,e,{replacedWith:n,clearOnEnter:!1,handleMouseEvents:!1});(l=i(r,{marker:o,cm:a,finish:function(r,i){return a.operation(function(){var e=o.find(),t=e.from,n=e.to;a.replaceRange(r,t,n),o.clear(),\"number\"==typeof i&&a.setCursor({line:t.line,ch:t.ch+i})})},setPlaceholder:function(e){0<n.childNodes.length&&n.removeChild(n.firstChild),n.appendChild(e),o.changed()},resize:function(){o.changed()}}))||o.clear()}),l)};var E=x(\"InsertFile\",S,O),D=Object.freeze({ajaxUpload:function(e,t,n,r){var i=new XMLHttpRequest,o=new FormData;for(var a in t)o.append(a,t[a]);i.onreadystatechange=function(){if(4==this.readyState){var e=i.responseText;try{e=JSON.parse(i.responseText)}catch(e){}/^20\\d/.test(i.status+\"\")?n(e,null):n(null,e)}},i.open(r||\"POST\",e,!0),i.send(o)},defaultOption:O,suggestedOption:H,InsertFile:S,getAddon:E});function N(e){var t=e=e.trim(),n=\"\",r=e.match(/^(\\S+)\\s+(\"(?:[^\"\\\\]+|\\\\.)+\"|[^\"\\s].*)/);return r&&(t=r[1],'\"'===(n=r[2]).charAt(0)&&(n=n.substr(1,n.length-2).replace(/\\\\\"/g,'\"'))),{url:t,title:n}}var A={hmdReadLink:function(e,t){return P(this).read(e,t)},hmdResolveURL:function(e,t){return P(this).resolve(e,t)},hmdSplitLink:N};for(var R in A)U.defineExtension(R,A[R]);var I={baseURI:\"\"},j={baseURI:\"\"};l.hmdReadLink=j,U.defineOption(\"hmdReadLink\",I,function(e,t){t&&\"string\"!=typeof t||(t={baseURI:t});var n=P(e);for(var r in I)n[r]=r in t?t[r]:I[r]});var F=function(e){var t=this;this.cm=e,this.cache={},e.on(\"changes\",h(function(){return t.rescan()},500)),this.rescan()};F.prototype.read=function(e,t){var n,r=this.cache[e.trim().toLowerCase()]||[];\"number\"!=typeof t&&(t=1e9);for(var i=0;i<r.length&&!((n=r[i]).line>t);i++);return n},F.prototype.rescan=function(){var e=this.cm,o=this.cache={};e.eachLine(function(e){var t=e.text,n=/^(?:>\\s+)*>?\\s{0,3}\\[([^\\]]+)\\]:\\s*(.+)$/.exec(t);if(n){var r=n[1].trim().toLowerCase(),i=n[2];o[r]||(o[r]=[]),o[r].push({line:e.lineNo(),content:i})}})},F.prototype.resolve=function(e,t){var n,r=/^(?:[\\w-]+\\:\\/*|\\/\\/)[^\\/]+/,i=/\\/[^\\/]+(?:\\/+\\.?)*$/;if(!e)return e;if(/^(([^<>()[\\]\\\\.,;:\\s@\\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(e))return\"mailto:\"+e;var o=\"\";if(!(t=t||this.baseURI)||r.test(e))return e;for((n=t.match(r))&&(o=n[0],t=t.slice(o.length));n=e.match(/^(\\.{1,2})([\\/\\\\]+)/);)e=e.slice(n[0].length),\"..\"==n[1]&&(t=t.replace(i,\"\"));return e=\"/\"===e.charAt(0)&&o?o+e:(/\\/$/.test(t)||(t+=\"/\"),o+t+e)};var P=x(\"ReadLink\",F,I),q=Object.freeze({splitLink:N,Extensions:A,defaultOption:I,suggestedOption:j,ReadLink:F,getAddon:P}),K=\"function\"==typeof marked?marked:function(e){return\"<pre>\"+(e=e.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/  /g,\" &nbsp;\"))+\"</pre>\"};function ie(e,t){return t?K(t):null}var oe={enabled:!1,xOffset:10,convertor:ie},ae={enabled:!0};l.hmdHover=ae,U.defineOption(\"hmdHover\",oe,function(e,t){t&&\"boolean\"!=typeof t?\"function\"==typeof t&&(t={enabled:!0,convertor:t}):t={enabled:!!t};var n=ce(e);for(var r in oe)n[r]=r in t?t[r]:oe[r]});var le=function(e){var t=this;this.cm=e,new s(function(){n.addEventListener(\"mouseenter\",a,!0)},function(){n.removeEventListener(\"mouseenter\",a,!0),t.hideInfo()}).bind(this,\"enabled\",!0);var n=e.display.lineDiv;this.lineDiv=n;var r=document.createElement(\"div\"),i=document.createElement(\"div\"),o=document.createElement(\"div\");r.setAttribute(\"style\",\"position:absolute;z-index:99\"),r.setAttribute(\"class\",\"HyperMD-hover\"),r.setAttribute(\"cm-ignore-events\",\"true\"),i.setAttribute(\"class\",\"HyperMD-hover-content\"),r.appendChild(i),o.setAttribute(\"class\",\"HyperMD-hover-indicator\"),r.appendChild(o),this.tooltipDiv=r,this.tooltipContentDiv=i,this.tooltipIndicator=o;var a=this.mouseenter.bind(this)};le.prototype.mouseenter=function(e){var t,n=this.cm,r=e.target,i=r.className;if(!(r==this.tooltipDiv||r.compareDocumentPosition&&8==(8&r.compareDocumentPosition(this.tooltipDiv))))if(\"SPAN\"===r.nodeName&&(t=i.match(/(?:^|\\s)cm-(hmd-barelink2?|hmd-footref2)(?:\\s|$)/))){var o=n.coordsChar({left:e.clientX,top:e.clientY},\"window\"),a=null,l=null,s=w(n,o,t[1]);s&&(a=(a=n.getRange(s.from,s.to)).slice(1,-1))&&(l=n.hmdReadLink(a,o.line)||null);var c=(this.convertor||ie)(a,l&&l.content||null);c?this.showInfo(c,r):this.hideInfo()}else this.hideInfo()},le.prototype.showInfo=function(e,t){var n=t.getBoundingClientRect(),r=this.lineDiv.getBoundingClientRect(),i=this.tooltipDiv,o=this.xOffset;this.tooltipContentDiv.innerHTML=e,i.style.left=n.left-r.left-o+\"px\",this.lineDiv.appendChild(i);var a=i.getBoundingClientRect();a.right>r.right&&(o=a.right-r.right,i.style.left=n.left-r.left-o+\"px\"),i.style.top=n.top-r.top-a.height+\"px\",this.tooltipIndicator.style.marginLeft=o+\"px\"},le.prototype.hideInfo=function(){this.tooltipDiv.parentElement==this.lineDiv&&this.lineDiv.removeChild(this.tooltipDiv)};var se,ce=x(\"Hover\",le,oe),de=Object.freeze({defaultConvertor:ie,defaultOption:oe,suggestedOption:ae,Hover:le,getAddon:ce}),he=function(e,t){var n=e.text,r=e.type,i=e.url,o=e.pos;if(\"url\"===r||\"link\"===r){var a=n.match(/\\[[^\\[\\]]+\\](?:\\[\\])?$/);a&&e.altKey?(\"[]\"===(n=a[0]).slice(-2)&&(n=n.slice(0,-2)),r=\"footref\"):(e.ctrlKey||e.altKey)&&i&&window.open(i,\"_blank\")}if(\"todo\"===r){var l=w(t,o,\"formatting-task\"),s=l.from,c=l.to,d=t.getRange(s,c);d=\"[ ]\"===d?\"[x]\":\"[ ]\",t.replaceRange(d,s,c)}if(\"footref\"===r&&(e.ctrlKey||e.altKey)){var h=n.slice(1,-1),u=t.hmdReadLink(h,o.line);u&&(ue(t,u.line,o),t.setCursor({line:u.line,ch:0}))}},ue=(se=null,function(e,t,n){var r,i,o=function(e){if(-1==e.options.gutters.indexOf(\"HyperMD-goback\"))return null;var t=document.createElement(\"div\");t.className=\"HyperMD-goback-button\",t.addEventListener(\"click\",function(){e.setCursor(se.find()),e.clearGutter(\"HyperMD-goback\"),se.clear(),se=null});var n=e.display.gutters.children;return n=(n=n[n.length-1]).offsetLeft+n.offsetWidth,t.style.width=n+\"px\",t.style.marginLeft=-n+\"px\",t}(e);o&&(o.innerHTML=n.line+1+\"\",r=e,i=n,se&&(r.clearGutter(\"HyperMD-goback\"),se.clear()),se=r.setBookmark(i),e.setGutterMarker(t,\"HyperMD-goback\",o))}),fe={enabled:!1,handler:null},me={enabled:!0};l.hmdClick=me,U.defineOption(\"hmdClick\",fe,function(e,t){t&&\"boolean\"!=typeof t?\"function\"==typeof t&&(t={enabled:!0,handler:t}):t={enabled:!!t};var n=ge(e);for(var r in fe)n[r]=r in t?t[r]:fe[r]});var pe=function(e){var y=this;this.cm=e,this._mouseMove_keyDetect=function(e){var t=y.el,n=t.className,r=n,i=\"HyperMD-with-alt\",o=\"HyperMD-with-ctrl\";!e.altKey&&0<=n.indexOf(i)&&(r=n.replace(i,\"\")),!e.ctrlKey&&0<=n.indexOf(o)&&(r=n.replace(o,\"\")),e.altKey||e.ctrlKey||(y._KeyDetectorActive=!1,t.removeEventListener(\"mousemove\",y._mouseMove_keyDetect,!1)),n!=r&&(t.className=r.trim())},this._keyDown=function(e){var t=e.keyCode||e.which,n=\"\";17==t&&(n=\"HyperMD-with-ctrl\"),18==t&&(n=\"HyperMD-with-alt\");var r=y.el;n&&-1==r.className.indexOf(n)&&(r.className+=\" \"+n),y._KeyDetectorActive||(y._KeyDetectorActive=!0,y.el.addEventListener(\"mousemove\",y._mouseMove_keyDetect,!1))},this._mouseUp=function(e){var t=y._cinfo;y.lineDiv.removeEventListener(\"mouseup\",y._mouseUp,!1),5<Math.abs(e.clientX-t.clientX)||5<Math.abs(e.clientY-t.clientY)||\"function\"==typeof y.handler&&!1===y.handler(t,y.cm)||he(t,y.cm)},this._mouseDown=function(e){var t=e.button,n=e.clientX,r=e.clientY,i=e.ctrlKey,o=e.altKey,a=e.shiftKey,l=y.cm;if(\"PRE\"!==e.target.tagName){var s,c,d,h,u=l.coordsChar({left:n,top:r},\"window\"),f=l.getTokenAt(u),m=f.state,p=\" \"+f.type+\" \",g=null;if(c=p.match(/\\s(image|link|url)\\s/)){g=c[1];var v,b=/\\shmd-barelink\\s/.test(p);if(m.linkText?(s=w(l,u,function(e){return e.state.linkText||/(?:\\s|^)link(?:\\s|$)/.test(e.type)}),g=\"link\"):s=w(l,u,g),/^(?:image|link)$/.test(g)&&!b){var _=w(l,{line:u.line,ch:s.to.ch+1},\"url\");_&&(s.to=_.to)}if(\")\"===(d=l.getRange(s.from,s.to).trim()).slice(-1)&&-1!==(v=d.lastIndexOf(\"](\")))h=N(d.slice(v+2,-1)).url;else if((c=d.match(/[^\\\\]\\]\\s?\\[([^\\]]+)\\]$/))||(c=d.match(/^\\[(.+)\\]\\s?\\[\\]$/))||(c=d.match(/^\\[(.+)\\](?:\\:\\s*)?$/))){b&&\"^\"===c[1].charAt(0)&&(g=\"footref\");var k=l.hmdReadLink(c[1],u.line);h=k?N(k.content).url:null}else((c=d.match(/^\\<(.+)\\>$/))||(c=d.match(/^\\((.+)\\)$/))||(c=[null,d]))&&(h=c[1]);h=l.hmdResolveURL(h)}else p.match(/\\sformatting-task\\s/)?(g=\"todo\",(s=w(l,u,\"formatting-task\")).to.ch=l.getLine(u.line).length,d=l.getRange(s.from,s.to),h=null):p.match(/\\shashtag/)&&(s=w(l,u,g=\"hashtag\"),d=l.getRange(s.from,s.to),h=null);null!==g&&(y._cinfo={type:g,text:d,url:h,pos:u,button:t,clientX:n,clientY:r,ctrlKey:i,altKey:o,shiftKey:a},y.lineDiv.addEventListener(\"mouseup\",y._mouseUp,!1))}},this.lineDiv=e.display.lineDiv;var t=this.el=e.getWrapperElement();new s(function(){y.lineDiv.addEventListener(\"mousedown\",y._mouseDown,!1),t.addEventListener(\"keydown\",y._keyDown,!1)},function(){y.lineDiv.removeEventListener(\"mousedown\",y._mouseDown,!1),t.removeEventListener(\"keydown\",y._keyDown,!1)}).bind(this,\"enabled\",!0)},ge=x(\"Click\",pe,fe),ve=Object.freeze({defaultClickHandler:he,defaultOption:fe,suggestedOption:me,Click:pe,getAddon:ge}),be={enabled:!1,convertor:null},_e={enabled:!0};l.hmdPaste=_e,U.defineOption(\"hmdPaste\",be,function(e,t){t&&\"boolean\"!=typeof t?\"function\"==typeof t&&(t={enabled:!0,convertor:t}):t={enabled:!!t};var n=Te(e);for(var r in be)n[r]=r in t?t[r]:be[r]});var ke,ye,we=function(e){var o=this;this.cm=e,this.pasteHandler=function(e,t){var n=t.clipboardData||window.clipboardData,r=o.convertor;if(r&&n&&-1!=n.types.indexOf(\"text/html\")){var i=r(n.getData(\"text/html\"));i&&(e.operation(e.replaceSelection.bind(e,i)),t.preventDefault())}},new s(function(){e.on(\"paste\",o.pasteHandler)},function(){e.off(\"paste\",o.pasteHandler)}).bind(this,\"enabled\",!0)},Te=x(\"Paste\",we,be),xe=Object.freeze({defaultOption:be,suggestedOption:_e,Paste:we,getAddon:Te}),Le=\"undefined\"==typeof Uint8Array?Array:Uint8Array;(ye=ke||(ke={})).OK=\"ok\",ye.CURSOR_INSIDE=\"ci\",ye.HAS_MARKERS=\"hm\";var Me={};function Ce(e,t,n,r){var i=Me;if(e in i&&!r)throw new Error(\"Folder \"+e+\" already registered\");He[e]=!1,Se[e]=!!n,i[e]=t}function Oe(t,n,r){t.operation(function(){var e=n.find().from;e={line:e.line,ch:e.ch+~~r},t.setCursor(e),t.focus(),n.clear()})}var He={},Se={};l.hmdFold=Se,c.hmdFold=!1,U.defineOption(\"hmdFold\",He,function(e,t){t&&\"boolean\"!=typeof t||(t=t?Se:He),\"customFolders\"in t&&(console.error(\"[HyperMD][Fold] `customFolders` is removed. To use custom folders, `registerFolder` first.\"),delete t.customFolders);var n=De(e);for(var r in Me)n.setStatus(r,t[r])});var Ee=function(t){function e(e){var u=this;t.call(this,e),this.cm=e,this._enabled={},this.folded={},this.startFold=h(this.startFoldImmediately.bind(this),100),this._quickFoldHint=[],e.on(\"changes\",function(e,t){for(var n=[],r=0,i=t;r<i.length;r+=1)for(var o=i[r],a=0,l=e.findMarks(o.from,o.to);a<l.length;a+=1){var s=l[a];s._hmd_fold_type&&n.push(s)}for(var c=0,d=n;c<d.length;c+=1){d[c].clear()}u.startFold()}),e.on(\"cursorActivity\",function(c){var d={};function t(e){var t=e.line;if(t in d)d[t].ch.push(e.ch);else{for(var n=c.getLineHandle(e.line),r=n.markedSpans||[],i=[],o=0;o<r.length;o++){var a=r[o].marker;if(\"_hmd_crange\"in a){var l=a._hmd_crange[0].line<t?0:a._hmd_crange[0].ch,s=a._hmd_crange[1].line>t?n.text.length:a._hmd_crange[1].ch;i.push([a,l,s])}}d[t]={lineNo:t,ch:[e.ch],markers:i}}}for(var e in c.listSelections().forEach(function(e){t(e.anchor),t(e.head)}),d){var n=d[e];if(n.markers.length)for(var r=0;r<n.ch.length;r++)for(var i=n.ch[r],o=0;o<n.markers.length;o++){var a=n.markers[o],l=a[0],s=a[1],h=a[2];s<=i&&i<=h&&(l.clear(),n.markers.splice(o,1),o--)}}u.startQuickFold()})}return t&&(e.__proto__=t),((e.prototype=Object.create(t&&t.prototype)).constructor=e).prototype.setStatus=function(e,t){e in Me&&!this._enabled[e]!=!t&&(this._enabled[e]=!!t,t?this.startFold():this.clear(e))},e.prototype.requestRange=function(e,t,n,r){r||(r=t),n||(n=e);var i=this.cm;if(0!==i.findMarks(e,t).length)return ke.HAS_MARKERS;this._quickFoldHint.push(e.line),this._lastCRange=[n,r];for(var o=i.listSelections(),a=0;a<o.length;a++){var l=g(o[a]);if(k(this._lastCRange,l)||k([e,t],l))return ke.CURSOR_INSIDE}return this._quickFoldHint.push(n.line),ke.OK},e.prototype.startFoldImmediately=function(e,t){var y=this,n=this.cm;e=e||n.firstLine(),t=(t||n.lastLine())+1,this._quickFoldHint=[],this.setPos(e,0,!0),n.operation(function(){return n.eachLine(e,t,function(e){var t=e.lineNo();if(!(t<y.lineNo)){t>y.lineNo&&y.setPos(t,0);var n=new Le(e.text.length),r=e.markedSpans;if(r)for(var i=0;i<r.length;++i)for(var o=r[i],a=null==o.from?0:o.from,l=null==o.to?n.length:o.to,s=a;s<l;s++)n[s]=1;for(var c=y.lineTokens;y.i_token<c.length;){for(var d,h=c[y.i_token],u=null,f=!0,m=h.start;m<h.end;m++)if(n[m]){f=!1;break}if(f)for(d in Me)if(y._enabled[d]&&(u=Me[d](y,h)))break;if(u){var p=u.find(),g=p.from,v=p.to;if((y.folded[d]||(y.folded[d]=[])).push(u),u._hmd_fold_type=d,u._hmd_crange=y._lastCRange,u.on(\"clear\",function(e,t){var n,r=y.folded[d];r&&-1!==(n=r.indexOf(u))&&r.splice(n,1),y._quickFoldHint.push(e.line)}),g.line>t||g.ch>h.start){y.i_token++;for(var b=g.line===t?g.ch:n.length,_=v.line===t?v.ch:n.length,k=b;k<_;k++)n[k]=1}else{if(v.line!==t)return void y.setPos(v.line,v.ch);y.setPos(v.ch)}}else y.i_token++}}})})},e.prototype.startQuickFold=function(){var e=this._quickFoldHint;if(0!==e.length){for(var t=e[0],n=t,r=0,i=e;r<i.length;r+=1){var o=i[r];o<t&&(t=o),n<o&&(n=o)}this.startFold.stop(),this.startFoldImmediately(t,n)}},e.prototype.clear=function(e){this.startFold.stop();var t=this.folded[e];if(t&&t.length)for(var n;n=t.pop();)n.clear()},e.prototype.clearAll=function(){for(var e in this.startFold.stop(),this.folded)for(var t,n=this.folded[e];t=n.pop();)t.clear()},e}(z),De=x(\"Fold\",Ee),Ne=Object.freeze({get RequestRangeResult(){return ke},folderRegistry:Me,registerFolder:Ce,breakMark:Oe,defaultOption:He,suggestedOption:Se,Fold:Ee,getAddon:De}),Ae=function(e,t){var n=e.cm,r=/\\bformatting-link-string\\b/;if(/\\bimage-marker\\b/.test(t.type)&&\"!\"===t.string){var i=e.lineNo,o=e.findNext(r),a=e.findNext(r,o.i_token+1),l={line:i,ch:t.start},s={line:i,ch:a.token.end},c=e.requestRange(l,s,l,l);if(c===ke.OK){var d,h,u=n.getRange({line:i,ch:o.token.start+1},{line:i,ch:a.token.start});if(\"]\"===a.token.string){var f=n.hmdReadLink(u,i);if(!f)return null;u=f.content}d=N(u).url,d=n.hmdResolveURL(d),h=n.getRange({line:i,ch:l.ch+2},{line:i,ch:o.token.start-1});var m=document.createElement(\"img\"),p=n.markText(l,s,{clearOnEnter:!0,collapsed:!0,replacedWith:m});return m.addEventListener(\"load\",function(){m.classList.remove(\"hmd-image-loading\"),p.changed()},!1),m.addEventListener(\"error\",function(){m.classList.remove(\"hmd-image-loading\"),m.classList.add(\"hmd-image-error\"),p.changed()},!1),m.addEventListener(\"click\",function(){return Oe(n,p)},!1),m.className=\"hmd-image hmd-image-loading\",m.src=d,m.title=h,p}}return null};Ce(\"image\",Ae,!0);var Re=Object.freeze({ImageFolder:Ae}),Ie=function(e,t){var n=e.cm;if(\"[\"!==t.string||!t.state.linkText||t.state.linkTitle||/\\bimage\\b/.test(t.type))return null;var r=T(n),i=r.findSpanWithTypeAt({line:e.lineNo,ch:t.start},\"linkText\");if(!i)return null;var o=r.findSpanWithTypeAt({line:e.lineNo,ch:i.end+1},\"linkHref\");if(!o)return null;var a={line:e.lineNo,ch:o.begin},l={line:e.lineNo,ch:o.end},s={line:e.lineNo,ch:i.begin};if(e.requestRange(a,l,s,a)!==ke.OK)return null;var c=n.getRange(a,l),d=N(c.substr(1,c.length-2)),h=d.url,u=d.title,f=document.createElement(\"span\");f.setAttribute(\"class\",\"hmd-link-icon\"),f.setAttribute(\"title\",h+\"\\n\"+u),f.setAttribute(\"data-url\",h);var m=n.markText(a,l,{collapsed:!0,replacedWith:f});return f.addEventListener(\"click\",function(){return Oe(n,m)},!1),m};Ce(\"link\",Ie,!0);var je=Object.freeze({LinkFolder:Ie}),Fe={};var Pe=function(e,t){return 0===t.start&&t.type&&-1!==t.type.indexOf(\"HyperMD-codeblock-begin\")&&/[-\\w]+\\s*$/.test(t.string)?Xe(e.cm).fold(e,t):null};Ce(\"code\",Pe,!0);var qe={},$e={};l.hmdFoldCode=$e,U.defineOption(\"hmdFoldCode\",qe,function(e,t){t&&\"boolean\"!=typeof t||(t=t?$e:qe);var n=Xe(e);for(var r in Fe)n.setStatus(r,t[r])});var ze=function(e){this.cm=e,this._enabled={},this.folded={}};ze.prototype.setStatus=function(e,t){e in Fe&&!this._enabled[e]!=!t&&(this._enabled[e]=!!t,t?De(this.cm).startFold():this.clear(e))},ze.prototype.clear=function(e){var t=this.folded[e];if(t&&t.length)for(var n;n=t.pop();)n.marker.clear()},ze.prototype.fold=function(e,t){var n=this;if(0!==t.start||!t.type||-1===t.type.indexOf(\"HyperMD-codeblock-begin\"))return null;var r,i,o=/([-\\w]+)\\s*$/.exec(t.string),a=o&&o[1].toLowerCase();if(!a)return null;var l=this.cm,s=Fe,c=this._enabled;for(var d in s){var h=s[d];if(c[d]&&h.pattern(a)){i=d,r=h.renderer;break}}if(!i)return null;var u={line:e.lineNo,ch:0},f=null,m=l.lastLine(),p=e.lineNo+1;do{var g=l.getTokenAt({line:p,ch:1});if(g&&g.type&&-1!==g.type.indexOf(\"HyperMD-codeblock-end\")){f={line:p,ch:g.end};break}}while(++p<m);if(!f)return null;if(e.requestRange(u,f)!==ke.OK)return null;var v=l.getRange({line:u.line+1,ch:0},{line:f.line,ch:0}),b={editor:l,lang:a,marker:null,lineWidget:null,el:null,break:Be,changed:Be},_=b.el=r(v,b);if(!_)return b.marker.clear(),null;var k=document.createElement(\"div\");k.className=Ke+i,k.style.minHeight=\"1em\",k.appendChild(_);var y=b.lineWidget=l.addLineWidget(f.line,k,{above:!1,coverGutter:!1,noHScroll:!1,showIfHidden:!1}),w=document.createElement(\"span\");w.className=Ue+i,w.textContent=\"<CODE>\";var T=b.marker=l.markText(u,f,{replacedWith:w});return k.addEventListener(\"mouseenter\",function(){return w.className=We+i},!1),k.addEventListener(\"mouseleave\",function(){return w.className=Ue+i},!1),b.changed=function(){y.changed()},b.break=function(){Oe(l,T)},w.addEventListener(\"click\",b.break,!1),T.on(\"clear\",function(){var e,t=n.folded[i];t&&-1!==(e=t.indexOf(b))&&t.splice(e,1),\"function\"==typeof b.onRemove&&b.onRemove(b),y.clear()}),i in this.folded?this.folded[i].push(b):this.folded[i]=[b],T};var Ke=\"hmd-fold-code-content hmd-fold-code-\",Ue=\"hmd-fold-code-stub hmd-fold-code-\",We=\"hmd-fold-code-stub highlight hmd-fold-code-\",Be=function(){},Xe=x(\"FoldCode\",ze,qe),Ye=Object.freeze({rendererRegistry:Fe,registerRenderer:function(t,e){if(t&&t.name&&t.renderer){var n=t.name,r=t.pattern,i=Fe;if(n in i&&!e)throw new Error(\"CodeRenderer \"+n+\" already exists\");if(\"string\"==typeof r){var o=r.toLowerCase();r=function(e){return e.toLowerCase()===o}}else r instanceof RegExp&&(r=function(e){return t.pattern.test(e)});var a={name:n,suggested:!!t.suggested,pattern:r,renderer:t.renderer};i[n]=a,qe[n]=!1,$e[n]=a.suggested}},CodeFolder:Pe,defaultOption:qe,suggestedOption:$e,FoldCode:ze,getAddon:Xe}),Ge=function(e,t){var n=/formatting-math-begin\\b/;if(!n.test(t.type))return null;var r=e.cm,i=e.lineNo,o=/math-2\\b/.test(t.type),a=o?2:1;if(2==a&&1==t.string.length){0;var l=e.lineTokens[e.i_token+1];if(!l||!n.test(l.type))return null}var s,c=e.findNext(/formatting-math-end\\b/,o),d={line:i,ch:t.start},h=!1;if(c)s={line:c.lineNo,ch:c.token.start+a};else{if(!o)return null;var u=r.lastLine();s={line:u,ch:r.getLine(u).length},h=!0}var f={line:d.line,ch:d.ch+a},m={line:s.line,ch:s.ch-(h?0:a)},p=r.getRange(f,m).trim(),g=tt(r),v=e.requestRange(d,s);if(v!==ke.OK)return v===ke.CURSOR_INSIDE&&(g.editingExpr=p),null;var b=Ve(r,d,s,p,a,1<a&&0==d.ch&&(h||s.ch>=r.getLine(s.line).length));return g.editingExpr=null,b};function Ve(e,t,n,r,i,o){var a=document.createElement(\"span\");a.setAttribute(\"class\",\"hmd-fold-math math-\"+(o?2:1)),a.setAttribute(\"title\",r);var l=document.createElement(\"span\");l.setAttribute(\"class\",\"hmd-fold-math-placeholder\"),l.textContent=r,a.appendChild(l);var s=e.markText(t,n,{replacedWith:a});a.addEventListener(\"click\",function(){return Oe(e,s,i)},!1);var c=tt(e).createRenderer(a,o?\"display\":\"\");return c.onChanged=function(){l&&(a.removeChild(l),l=null),s.changed()},s.on(\"clear\",function(){c.clear()}),s.mathRenderer=c,d(function(){return!!c.isReady()&&(c.startRender(r),!0)},5,function(){s.clear()}),s}Ce(\"math\",Ge,!0);var Ze=function(e,t){var n=this;this.container=e;var r=document.createElement(\"img\");r.setAttribute(\"class\",\"hmd-math-dumb\"),r.addEventListener(\"load\",function(){n.onChanged&&n.onChanged(n.last_expr)},!1),this.img=r,e.appendChild(r)};Ze.prototype.startRender=function(e){this.last_expr=e,this.img.src=\"https://latex.codecogs.com/gif.latex?\"+encodeURIComponent(e)},Ze.prototype.clear=function(){this.container.removeChild(this.img)},Ze.prototype.isReady=function(){return!0};var Qe={renderer:Ze,onPreview:null,onPreviewEnd:null},Je={};l.hmdFoldMath=Je,U.defineOption(\"hmdFoldMath\",Qe,function(e,t){t?\"function\"==typeof t&&(t={renderer:t}):t={};var n=tt(e);for(var r in Qe)n[r]=r in t?t[r]:Qe[r]});var et=function(e){var t=this;this.cm=e,new s(function(e){t.onPreview&&t.onPreview(e)},function(){t.onPreviewEnd&&t.onPreviewEnd()},null).bind(this,\"editingExpr\")};et.prototype.createRenderer=function(e,t){return new(this.renderer||Ze)(e,t)};var tt=x(\"FoldMath\",et,Qe),nt=Object.freeze({MathFolder:Ge,insertMathMark:Ve,DumbRenderer:Ze,defaultOption:Qe,suggestedOption:Je,FoldMath:et,getAddon:tt}),rt={},it=function(e){return e in rt},ot=function(e){var t=document.createElement(\"span\");return t.textContent=rt[e],t.title=e,t},at=function(e,t){if(!t.type||!/ formatting-emoji/.test(t.type))return null;var n=e.cm,r={line:e.lineNo,ch:t.start},i={line:e.lineNo,ch:t.end},o=t.string,a=dt(n);return a.isEmoji(o)?e.requestRange(r,i)!==ke.OK?null:a.foldEmoji(o,r,i):null};Ce(\"emoji\",at,!0);var lt={myEmoji:{},emojiRenderer:ot,emojiChecker:it},st={};l.hmdFoldEmoji=st,U.defineOption(\"hmdFoldEmoji\",lt,function(e,t){t||(t={});var n=dt(e);for(var r in lt)n[r]=r in t?t[r]:lt[r]});var ct=function(e){this.cm=e};ct.prototype.isEmoji=function(e){return e in this.myEmoji||this.emojiChecker(e)},ct.prototype.foldEmoji=function(e,t,n){var r=this.cm,i=e in this.myEmoji&&this.myEmoji[e](e)||this.emojiRenderer(e);if(!i||!i.tagName)return null;-1===i.className.indexOf(\"hmd-emoji\")&&(i.className+=\" hmd-emoji\");var o=r.markText(t,n,{replacedWith:i});return i.addEventListener(\"click\",Oe.bind(this,r,o,1),!1),\"img\"===i.tagName.toLowerCase()&&(i.addEventListener(\"load\",function(){return o.changed()},!1),i.addEventListener(\"dragstart\",function(e){return e.preventDefault()},!1)),o};var dt=x(\"FoldEmoji\",ct,lt);!function(e){for(var t,n=[\"smile:;laughing:;blush:;smiley:;relaxed:;smirk:;heart_eyes:;kissing_heart:;kissing_closed_eyes:;flushed:;relieved:;satisfied:;grin:;wink:;stuck_out_tongue_winking_eye:;stuck_out_tongue_closed_eyes:;grinning:;kissing:;kissing_smiling_eyes:;stuck_out_tongue:;sleeping:;worried:;frowning:;anguished:;open_mouth:;grimacing:;confused:;hushed:;expressionless:;unamused:;sweat_smile:;sweat:;disappointed_relieved:;weary:;pensive:;disappointed:;confounded:;fearful:;cold_sweat:;persevere:;cry:;sob:;joy:;astonished:;scream:;tired_face:;angry:;rage:;triumph:;sleepy:;yum:;mask:;sunglasses:;dizzy_face:;imp:;smiling_imp:;neutral_face:;no_mouth:;innocent:;alien:;yellow_heart:;blue_heart:;purple_heart:;heart:;green_heart:;broken_heart:;heartbeat:;heartpulse:;two_hearts:;revolving_hearts:;cupid:;sparkling_heart:;sparkles:;star:;star2:;dizzy:;boom:;collision:;anger:;exclamation:;question:;grey_exclamation:;grey_question:;zzz:;dash:;sweat_drops:;notes:;musical_note:;fire:;hankey:;poop:;shit:;\",\"+1:;thumbsup:;-1:;thumbsdown:;ok_hand:;punch:;facepunch:;fist:;v:;wave:;hand:;raised_hand:;open_hands:;point_up:;point_down:;point_left:;point_right:;raised_hands:;pray:;point_up_2:;clap:;muscle:;metal:;fu:;walking:;runner:;running:;couple:;family:;two_men_holding_hands:;two_women_holding_hands:;dancer:;dancers:;ok_woman:;no_good:;information_desk_person:;raising_hand:;bride_with_veil:;person_with_pouting_face:;person_frowning:;bow:;couplekiss::couplekiss:;couple_with_heart:;massage:;haircut:;nail_care:;boy:;girl:;woman:;man:;baby:;older_woman:;older_man:;person_with_blond_hair:;man_with_gua_pi_mao:;man_with_turban:;construction_worker:;cop:;angel:;princess:;smiley_cat:;smile_cat:;heart_eyes_cat:;kissing_cat:;smirk_cat:;scream_cat:;crying_cat_face:;joy_cat:;pouting_cat:;japanese_ogre:;japanese_goblin:;see_no_evil:;hear_no_evil:;speak_no_evil:;guardsman:;skull:;feet:;lips:;kiss:;droplet:;ear:;eyes:;nose:;tongue:;love_letter:;bust_in_silhouette:;busts_in_silhouette:;speech_balloon:;\",\"thought_balloon:;sunny:;umbrella:;cloud:;snowflake:;snowman:;zap:;cyclone:;foggy:;ocean:;cat:;dog:;mouse:;hamster:;rabbit:;wolf:;frog:;tiger:;koala:;bear:;pig:;pig_nose:;cow:;boar:;monkey_face:;monkey:;horse:;racehorse:;camel:;sheep:;elephant:;panda_face:;snake:;bird:;baby_chick:;hatched_chick:;hatching_chick:;chicken:;penguin:;turtle:;bug:;honeybee:;ant:;beetle:;snail:;octopus:;tropical_fish:;fish:;whale:;whale2:;dolphin:;cow2:;ram:;rat:;water_buffalo:;tiger2:;rabbit2:;dragon:;goat:;rooster:;dog2:;pig2:;mouse2:;ox:;dragon_face:;blowfish:;crocodile:;dromedary_camel:;leopard:;cat2:;poodle:;paw_prints:;bouquet:;cherry_blossom:;tulip:;four_leaf_clover:;rose:;sunflower:;hibiscus:;maple_leaf:;leaves:;fallen_leaf:;herb:;mushroom:;cactus:;palm_tree:;evergreen_tree:;deciduous_tree:;chestnut:;seedling:;blossom:;ear_of_rice:;shell:;globe_with_meridians:;sun_with_face:;full_moon_with_face:;new_moon_with_face:;new_moon:;waxing_crescent_moon:;first_quarter_moon:;waxing_gibbous_moon:;full_moon:;waning_gibbous_moon:;last_quarter_moon:;waning_crescent_moon:;last_quarter_moon_with_face:;\",\"first_quarter_moon_with_face:;moon:;earth_africa:;earth_americas:;earth_asia:;volcano:;milky_way:;partly_sunny:;bamboo:;gift_heart:;dolls:;school_satchel:;mortar_board:;flags:;fireworks:;sparkler:;wind_chime:;rice_scene:;jack_o_lantern:;ghost:;santa:;christmas_tree:;gift:;bell:;no_bell:;tanabata_tree:;tada:;confetti_ball:;balloon:;crystal_ball:;cd:;dvd:;floppy_disk:;camera:;video_camera:;movie_camera:;computer:;tv:;iphone:;phone:;telephone:;telephone_receiver:;pager:;fax:;minidisc:;vhs:;sound:;speaker:;mute:;loudspeaker:;mega:;hourglass:;hourglass_flowing_sand:;alarm_clock:;watch:;radio:;satellite:;loop:;mag:;mag_right:;unlock:;lock:;lock_with_ink_pen:;closed_lock_with_key:;key:;bulb:;flashlight:;high_brightness:;low_brightness:;electric_plug:;battery:;calling:;email:;mailbox:;postbox:;bath:;bathtub:;shower:;toilet:;wrench:;nut_and_bolt:;hammer:;seat:;moneybag:;yen:;dollar:;pound:;euro:;\",\"credit_card:;money_with_wings:;e-mail:;inbox_tray:;outbox_tray:;envelope:;incoming_envelope:;postal_horn:;mailbox_closed:;mailbox_with_mail:;mailbox_with_no_mail:;door:;smoking:;bomb:;gun:;hocho:;pill:;syringe:;page_facing_up:;page_with_curl:;bookmark_tabs:;bar_chart:;chart_with_upwards_trend:;chart_with_downwards_trend:;scroll:;clipboard:;calendar:;date:;card_index:;file_folder:;open_file_folder:;scissors:;pushpin:;paperclip:;black_nib:;pencil2:;straight_ruler:;triangular_ruler:;closed_book:;green_book:;blue_book:;orange_book:;notebook:;notebook_with_decorative_cover:;ledger:;books:;bookmark:;name_badge:;microscope:;telescope:;newspaper:;football:;basketball:;soccer:;baseball:;tennis:;8ball:;\",\"rugby_football:;bowling:;golf:;mountain_bicyclist:;bicyclist:;horse_racing:;snowboarder:;swimmer:;surfer:;ski:;spades:;hearts:;clubs:;diamonds:;gem:;ring:;trophy:;musical_score:;musical_keyboard:;violin:;space_invader:;video_game:;black_joker:;flower_playing_cards:;game_die:;dart:;mahjong:;clapper:;memo:;pencil:;book:;art:;microphone:;headphones:;trumpet:;saxophone:;guitar:;shoe:;sandal:;high_heel:;lipstick:;boot:;shirt:;tshirt:;necktie:;womans_clothes:;dress:;running_shirt_with_sash:;jeans:;kimono:;bikini:;ribbon:;tophat:;crown:;womans_hat:;mans_shoe:;closed_umbrella:;briefcase:;handbag:;pouch:;purse:;eyeglasses:;fishing_pole_and_fish:;coffee:;tea:;sake:;baby_bottle:;beer:;beers:;cocktail:;tropical_drink:;wine_glass:;fork_and_knife:;pizza:;hamburger:;fries:;poultry_leg:;meat_on_bone:;spaghetti:;curry:;fried_shrimp:;bento:;sushi:;fish_cake:;rice_ball:;rice_cracker:;rice:;\",\"ramen:;stew:;oden:;dango:;egg:;bread:;doughnut:;custard:;icecream:;ice_cream:;shaved_ice:;birthday:;cake:;cookie:;chocolate_bar:;candy:;lollipop:;honey_pot:;apple:;green_apple:;tangerine:;lemon:;cherries:;grapes:;watermelon:;strawberry:;peach:;melon:;banana:;pear:;pineapple:;sweet_potato:;eggplant:;tomato:;corn:;house:;house_with_garden:;school:;office:;post_office:;hospital:;bank:;convenience_store:;love_hotel:;hotel:;wedding:;church:;department_store:;european_post_office:;city_sunrise:;city_sunset:;japanese_castle:;european_castle:;tent:;factory:;tokyo_tower:;japan:;mount_fuji:;sunrise_over_mountains:;sunrise:;stars:;statue_of_liberty:;bridge_at_night:;carousel_horse:;rainbow:;ferris_wheel:;fountain:;roller_coaster:;ship:;speedboat:;boat:;sailboat:;rowboat:;anchor:;rocket:;airplane:;helicopter:;steam_locomotive:;tram:;mountain_railway:;bike:;aerial_tramway:;suspension_railway:;\",\"mountain_cableway:;tractor:;blue_car:;oncoming_automobile:;car:;red_car:;taxi:;oncoming_taxi:;articulated_lorry:;bus:;oncoming_bus:;rotating_light:;police_car:;oncoming_police_car:;fire_engine:;ambulance:;minibus:;truck:;train:;station:;train2:;bullettrain_front:;bullettrain_side:;light_rail:;monorail:;railway_car:;trolleybus:;ticket:;fuelpump:;vertical_traffic_light:;traffic_light:;warning:;construction:;beginner:;atm:;slot_machine:;busstop:;barber:;hotsprings:;checkered_flag:;crossed_flags:;izakaya_lantern:;moyai:;circus_tent:;performing_arts:;round_pushpin:;triangular_flag_on_post:;jp:;kr:;cn:;us:;fr:;es:;it:;ru:;gb:;uk:;de:;one:1;two:2;three:3;four:4;five:5;six:6;seven:7;eight:8;nine:9;keycap_ten:;\",\"1234:;zero:0;hash:#;symbols:;arrow_backward:;arrow_down:;arrow_forward:;arrow_left:;capital_abcd:;abcd:;abc:;arrow_lower_left:;arrow_lower_right:;arrow_right:;arrow_up:;arrow_upper_left:;arrow_upper_right:;arrow_double_down:;arrow_double_up:;arrow_down_small:;arrow_heading_down:;arrow_heading_up:;leftwards_arrow_with_hook:;arrow_right_hook:;left_right_arrow:;arrow_up_down:;arrow_up_small:;arrows_clockwise:;arrows_counterclockwise:;rewind:;fast_forward:;information_source:;ok:;twisted_rightwards_arrows:;repeat:;repeat_one:;new:;top:;up:;cool:;free:;ng:;cinema:;koko:;signal_strength:;u5272:;u5408:;u55b6:;u6307:;u6708:;u6709:;u6e80:;u7121:;u7533:;u7a7a:;u7981:;sa:;restroom:;mens:;womens:;baby_symbol:;no_smoking:;\",\"parking:;wheelchair:;metro:;baggage_claim:;accept:;wc:;potable_water:;put_litter_in_its_place:;secret:;congratulations:;m:;passport_control:;left_luggage:;customs:;ideograph_advantage:;cl:;sos:;id:;no_entry_sign:;underage:;no_mobile_phones:;do_not_litter:;non-potable_water:;no_bicycles:;no_pedestrians:;children_crossing:;no_entry:;eight_spoked_asterisk:;eight_pointed_black_star:;heart_decoration:;vs:;vibration_mode:;mobile_phone_off:;chart:;currency_exchange:;aries:;taurus:;gemini:;cancer:;leo:;virgo:;libra:;scorpius:;\",\"sagittarius:;capricorn:;aquarius:;pisces:;ophiuchus:;six_pointed_star:;negative_squared_cross_mark:;a:;b:;ab:;o2:;diamond_shape_with_a_dot_inside:;recycle:;end:;on:;soon:;clock1:;clock130:;clock10:;clock1030:;clock11:;clock1130:;clock12:;clock1230:;clock2:;clock230:;clock3:;clock330:;clock4:;clock430:;clock5:;clock530:;clock6:;clock630:;clock7:;clock730:;clock8:;clock830:;clock9:;clock930:;heavy_dollar_sign:;copyright:;registered:;tm:;x:;heavy_exclamation_mark:;bangbang:;interrobang:;o:;heavy_multiplication_x:;\",\"heavy_plus_sign:;heavy_minus_sign:;heavy_division_sign:;white_flower:;100:;heavy_check_mark:;ballot_box_with_check:;radio_button:;link:;curly_loop:;wavy_dash:;part_alternation_mark:;trident:;black_square::black_square:;white_square::white_square:;white_check_mark:;black_square_button:;white_square_button:;black_circle:;white_circle:;red_circle:;large_blue_circle:;large_blue_diamond:;large_orange_diamond:;small_blue_diamond:;small_orange_diamond:;small_red_triangle:;small_red_triangle_down:\"],r=/([-\\w]+:)([^;]+);/g,i=0;i<n.length;i++)for(r.lastIndex=0;t=r.exec(n[i]);)e[\":\"+t[1]]=t[2]}(rt);var ht=Object.freeze({defaultDict:rt,defaultChecker:it,defaultRenderer:ot,EmojiFolder:at,defaultOption:lt,suggestedOption:st,FoldEmoji:ct,getAddon:dt}),ut=function(e){return!/^<(?:br)/i.test(e)&&(!/<(?:script|style|link|meta)/i.test(e)&&(!/\\son\\w+\\s*=/i.test(e)&&!/src\\s*=\\s*[\"']?javascript:/i.test(e)))},ft=function(e,t,a){var n=/^<(\\w+)\\s*/.exec(e);if(!n)return null;for(var r,i=n[1],o=document.createElement(i),l=/([\\w\\:\\-]+)(?:\\s*=\\s*((['\"]).*?\\3|\\S+))?\\s*/g,s=l.lastIndex=n[0].length;(r=l.exec(e))&&!(r.index>s);){var c=r[1],d=r[2];d&&/^['\"]/.test(d)&&(d=d.slice(1,-1)),o.setAttribute(c,d),s=l.lastIndex}if(\"innerHTML\"in o){var h=e.indexOf(\">\",s)+1,u=e.length;(r=new RegExp(\"</\"+i+\"\\\\s*>\\\\s*$\",\"i\").exec(e))&&(u=r.index);var f=e.slice(h,u);f&&(o.innerHTML=f),m([o],function(e){var t=e.tagName.toLowerCase();\"a\"===t&&(e.getAttribute(\"target\")||e.setAttribute(\"target\",\"_blank\"));var n={a:[\"href\"],img:[\"src\"],iframe:[\"src\"]}[t];if(n)for(var r=0;r<n.length;r++){var i=n[r],o=e.getAttribute(i);o&&e.setAttribute(i,a.hmdResolveURL(o))}})}return o},mt=\"hmd-fold-html-stub\",pt=function(e,t){if(!t.type||!/ hmd-html-begin/.test(t.type))return null;var n=e.findNext(/ hmd-html-\\w+/,!0);if(!n||!/ hmd-html-end/.test(n.token.type)||/ hmd-html-unclosed/.test(n.token.type))return null;var r=e.cm,i={line:e.lineNo,ch:t.start},o={line:n.lineNo,ch:n.token.end},a=0!=i.ch||o.ch<r.getLine(o.line).length,l=_t(r),s=r.getRange(i,o);return l.checker(s,i,r)?e.requestRange(i,o)!==ke.OK?null:l.renderAndInsert(s,i,o,a):null};Ce(\"html\",pt,!1);var gt={checker:ut,renderer:ft,stubText:\"<HTML>\",isolatedTagName:/^(?:div|pre|form|table|iframe|ul|ol|input|textarea|p|summary|a)$/i},vt={};l.hmdFoldHTML=vt,U.defineOption(\"hmdFoldHTML\",gt,function(e,t){t?\"function\"==typeof t?t={checker:t}:\"object\"!=typeof t&&(console.warn(\"[HyperMD][FoldHTML] incorrect option value type\"),t={}):t={};var n=_t(e);for(var r in gt)n[r]=r in t?t[r]:gt[r];!n.isolatedTagName||n.isolatedTagName instanceof RegExp||(console.error(\"[HyperMD][FoldHTML] option isolatedTagName only accepts RegExp\"),n.isolatedTagName=gt.isolatedTagName)});var bt=function(e){this.cm=e};bt.prototype.renderAndInsert=function(e,t,n,r){var i,o,a=this.cm,l=this.makeStub(),s=this.renderer(e,t,a),c=function(){return Oe(a,o)};if(!s)return null;if(l.addEventListener(\"click\",c,!1),s.tagName.match(this.isolatedTagName||/^$/)||s.addEventListener(\"click\",c,!1),r){var d=document.createElement(\"span\");d.setAttribute(\"class\",\"hmd-fold-html\"),d.setAttribute(\"style\",\"display: inline-block\"),d.appendChild(l),d.appendChild(s),i=d,(h=p(s,function(e,t){var n=getComputedStyle(s),r=function(e){return n.getPropertyValue(e)},i=e<10||t<10||!/^relative|static$/i.test(r(\"position\"))||!/^none$/i.test(r(\"float\"));l.className=i?mt:\"hmd-fold-html-stub omittable\",o.changed()})).check(),setTimeout(function(){o.on(\"clear\",function(){h.stop()})},0)}else{i=l;var h,u=a.addLineWidget(n.line,s,{above:!1,coverGutter:!1,noHScroll:!1,showIfHidden:!1}),f=function(){return l.className=\"hmd-fold-html-stub highlight\"},m=function(){return l.className=mt};s.addEventListener(\"mouseenter\",f,!1),s.addEventListener(\"mouseleave\",m,!1),(h=p(s,function(){return u.changed()})).check(),setTimeout(function(){o.on(\"clear\",function(){h.stop(),u.clear(),s.removeEventListener(\"mouseenter\",f,!1),s.removeEventListener(\"mouseleave\",m,!1)})},0)}return o=a.markText(t,n,{replacedWith:i})},bt.prototype.makeStub=function(){var e=document.createElement(\"span\");return e.setAttribute(\"class\",mt),e.textContent=this.stubText||\"<HTML>\",e};var _t=x(\"FoldHTML\",bt,gt),kt=Object.freeze({defaultChecker:ut,defaultRenderer:ft,HTMLFolder:pt,defaultOption:gt,suggestedOption:vt,FoldHTML:bt,getAddon:_t}),yt={enabled:!1},wt={enabled:!0};l.hmdTableAlign=wt,c.hmdTableAlign=!1,U.defineOption(\"hmdTableAlign\",yt,function(e,t){var n=!!t;n&&\"boolean\"!=typeof t||(t={enabled:n});var r=xt(e);for(var i in yt)r[i]=i in t?t[i]:yt[i]});var Tt=function(e){var p=this;this.cm=e,this.styleEl=document.createElement(\"style\"),this.updateStyle=h(function(){if(p.enabled){var e=p.cm,t=p.measure(),n=p.makeCSS(t);n!==p._lastCSS&&(p.styleEl.textContent=p._lastCSS=n,e.refresh())}},100),this._procLine=function(e,t,n){if(n.querySelector(\".cm-hmd-table-sep\")){for(var r=n.firstElementChild,i=Array.prototype.slice.call(r.childNodes,0),o=e.getStateAfter(t.lineNo()),a=o.hmdTableColumns,l=o.hmdTableID,s=2===o.hmdTable?-1:0,c=p.makeColumn(s,a[s]||\"dummy\",l),d=c.firstElementChild,h=0,u=i;h<u.length;h+=1){var f=u[h],m=f.nodeType===Node.ELEMENT_NODE&&f.className||\"\";/cm-hmd-table-sep/.test(m)?(s++,c.appendChild(d),r.appendChild(c),r.appendChild(f),d=(c=p.makeColumn(s,a[s]||\"dummy\",l)).firstElementChild):d.appendChild(f)}c.appendChild(d),r.appendChild(c)}},new s(function(){e.on(\"renderLine\",p._procLine),e.on(\"update\",p.updateStyle),e.refresh(),document.head.appendChild(p.styleEl)},function(){e.off(\"renderLine\",p._procLine),e.off(\"update\",p.updateStyle),document.head.removeChild(p.styleEl)}).bind(this,\"enabled\",!0)};Tt.prototype.makeColumn=function(e,t,n){var r=document.createElement(\"span\");r.className=\"hmd-table-column hmd-table-column-\"+e+\" hmd-table-column-\"+t,r.setAttribute(\"data-column\",\"\"+e),r.setAttribute(\"data-table-id\",n);var i=document.createElement(\"span\");return i.className=\"hmd-table-column-content\",i.setAttribute(\"data-column\",\"\"+e),r.appendChild(i),r},Tt.prototype.measure=function(){for(var e=this.cm.display.lineDiv.querySelectorAll(\".hmd-table-column-content\"),t={},n=0;n<e.length;n++){var r=e[n],i=r.parentElement,o=i.getAttribute(\"data-table-id\"),a=~~i.getAttribute(\"data-column\"),l=r.offsetWidth+1;o in t||(t[o]=[]);for(var s=t[o];s.length<=a;)s.push(0);s[a]<l&&(s[a]=l)}return t},Tt.prototype.makeCSS=function(e){var t=[];for(var n in e)for(var r=e[n],i=\"pre.HyperMD-table-row.HyperMD-table_\"+n+\" .hmd-table-column-\",o=0;o<r.length;o++){var a=r[o];t.push(\"\"+i+o+\" { min-width: \"+(a+.5)+\"px }\")}return t.join(\"\\n\")};var xt=x(\"TableAlign\",Tt,yt),Lt=Object.freeze({defaultOption:yt,suggestedOption:wt,TableAlign:Tt,getAddon:xt}),Mt={source:null},Ct={source:\"function\"==typeof requirejs?\"~codemirror/\":\"https://cdn.jsdelivr.net/npm/codemirror/\"};l.hmdModeLoader=Ct,U.defineOption(\"hmdModeLoader\",Mt,function(e,t){t&&\"boolean\"!=typeof t?\"string\"!=typeof t&&\"function\"!=typeof t||(t={source:t}):t={source:t&&Ct.source||null};var n=Ht(e);for(var r in Mt)n[r]=r in t?t[r]:Mt[r]});var Ot=function(e){var l=this;this.cm=e,this._loadingModes={},this.rlHandler=function(e,t){var n=t.lineNo(),r=(t.text||\"\").match(/^```\\s*(\\S+)/);if(r){var i=r[1],o=U.findModeByName(i),a=o&&o.mode;!a||a in U.modes||l.startLoadMode(a,n)}},(new s).bind(this,\"source\").ON(function(){e.on(\"renderLine\",l.rlHandler)}).OFF(function(){e.off(\"renderLine\",l.rlHandler)})};Ot.prototype.touchLine=function(e){var t=this.cm.getLineHandle(e),n=t.text.length;this.cm.replaceRange(t.text.charAt(n-1),{line:e,ch:n-1},{line:e,ch:n})},Ot.prototype.startLoadMode=function(e,t){var n=this._loadingModes,r=this;if(0<=t&&e in n)n[e].push(t);else{0<=t&&(n[e]=[t]);var i=function(){console.log(\"[HyperMD] mode-loader loaded \"+e);var t=n[e];r.cm.operation(function(){for(var e=0;e<t.length;e++)r.touchLine(t[e])}),delete n[e]},o=function(){console.warn(\"[HyperMD] mode-loader failed to load mode \"+e+\" from \",a),-1!==t&&(console.log(\"[HyperMD] mode-loader will retry loading \"+e),setTimeout(function(){r.startLoadMode(e,0<=t?-3:t+1)},1e3))};if(\"function\"!=typeof this.source){var a=this.source+\"mode/\"+e+\"/\"+e+\".js\";if(\"function\"==typeof requirejs&&\"~\"===a.charAt(0))requirejs([a.slice(1,-3)],i);else{var l=document.createElement(\"script\");l.onload=i,l.onerror=o,l.src=a,document.head.appendChild(l)}}else this.source(e,i,o)}};var Ht=x(\"ModeLoader\",Ot,Mt),St=Object.freeze({defaultOption:Mt,suggestedOption:Ct,ModeLoader:Ot,getAddon:Ht});function Et(e,t){var n=\" \"+e.className+\" \",r=\" \"+t+\" \";return-1!==n.indexOf(r)&&(e.className=n.replace(r,\"\").trim(),!0)}function Dt(e,t){var n=\" \"+t+\" \";return-1===(\" \"+e.className+\" \").indexOf(n)&&(e.className=e.className+\" \"+t,!0)}var Nt={enabled:!1,line:!0,tokenTypes:\"em|strong|strikethrough|code|linkText|task\".split(\"|\")},At={enabled:!0};l.hmdHideToken=At,c.hmdHideToken=!1,U.defineOption(\"hmdHideToken\",Nt,function(e,t){t&&\"boolean\"!=typeof t?\"string\"==typeof t?t={enabled:!0,tokenTypes:t.split(\"|\")}:t instanceof Array&&(t={enabled:!0,tokenTypes:t}):t={enabled:!!t};var n=Ft(e);for(var r in Nt)n[r]=r in t?t[r]:Nt[r]});var Rt=\"hmd-hidden-token\",It=\"hmd-inactive-line\",jt=function(e){var r=this;this.cm=e,this.renderLineHandler=function(e,t,n){r.procLine(t,n)},this.cursorActivityHandler=function(e){r.update()},this.update=h(function(){return r.updateImmediately()},100),this._rangesInLine={},new s(function(){e.on(\"cursorActivity\",r.cursorActivityHandler),e.on(\"renderLine\",r.renderLineHandler),e.on(\"update\",r.update),r.update(),e.refresh()},function(){e.off(\"cursorActivity\",r.cursorActivityHandler),e.off(\"renderLine\",r.renderLineHandler),e.off(\"update\",r.update),r.update.stop(),e.refresh()}).bind(this,\"enabled\",!0)};jt.prototype.procLine=function(e,t){var n=this.cm,r=\"number\"==typeof e?e:e.lineNo();\"number\"==typeof e&&(e=n.getLineHandle(e));var i=this._rangesInLine[r]||[],o=b(n,r);if(!o||o.hidden||!o.measure)return!1;if(t||(t=o.text),!t)return!1;var u=_(o,e,r).map,f=u.length/3,a=!1;function l(e,t,n){for(var r=!1,i=n=n||0;i<f;i++){var o=u[3*i],a=(u[3*i+1],u[3*i+2]);if(o===e.head.start){if(/formatting-/.test(e.head.type)&&a.nodeType===Node.TEXT_NODE){var l=a.parentElement;(t?Dt(l,Rt):Et(l,Rt))&&(r=!0)}if(e.tail&&/formatting-/.test(e.tail.type))for(var s=i+1;s<f;s++){var c=u[3*s],d=(u[3*s+1],u[3*s+2]);if(c==e.tail.start&&d.nodeType===Node.TEXT_NODE){var h=d.parentElement;(t?Dt(h,Rt):Et(h,Rt))&&(r=!0)}if(c>=e.tail.end)break}}if(o>=e.begin)break}return r}0===i.length?Dt(t,It)&&(a=!0):Et(t,It)&&(a=!0);for(var s=T(n).extract(r),c=0,d=0;d<s.length;d++){var h=s[d];if(-1!==this.tokenTypes.indexOf(h.type)){for(var m=[{line:r,ch:h.begin},{line:r,ch:h.end}],p=h.begin;c<f&&u[3*c+1]<p;)c++;for(var g=!0,v=0;v<i.length;v++){if(k(m,i[v])){g=!1;break}}l(h,g,c)&&(a=!0)}}return a&&(delete o.measure.heights,o.measure.cache={}),a},jt.prototype.updateImmediately=function(){var r=this;this.update.stop();for(var i=this.cm,e=i.listSelections(),o={},a={},l=this._rangesInLine,t=0,n=e;t<n.length;t+=1){var s=g(n[t]),c=s[0].line,d=s[1].line;o[c]=o[d]=!0;for(var h=c;h<=d;h++)a[h]?a[h].push(s):a[h]=[s]}this._rangesInLine=a,i.operation(function(){for(var e in l)a[e]||r.procLine(~~e);var t=!1;for(var n in a){r.procLine(~~n)&&o[n]&&(t=!0)}t&&i.refresh()})};var Ft=x(\"HideToken\",jt,Nt),Pt=Object.freeze({defaultOption:Nt,suggestedOption:At,HideToken:jt,getAddon:Ft}),qt={enabled:!1},$t={enabled:!0};l.hmdCursorDebounce=$t,U.defineOption(\"hmdCursorDebounce\",qt,function(e,t){t&&\"boolean\"!=typeof t||(t={enabled:!!t});var n=Kt(e);for(var r in qt)n[r]=r in t?t[r]:qt[r]});var zt=function(e){var r=this;this.cm=e,this.mouseDownHandler=function(e,t){r.lastX=t.clientX,r.lastY=t.clientY;var n=r.mouseMoveSuppress;document.addEventListener(\"mousemove\",n,!0),r.lastTimeout&&clearTimeout(r.lastTimeout),r.lastTimeout=setTimeout(function(){document.removeEventListener(\"mousemove\",n,!0),r.lastTimeout=null},100)},this.mouseMoveSuppress=function(e){Math.abs(e.clientX-r.lastX)<=5&&Math.abs(e.clientY-r.lastY)<=5&&e.stopPropagation()},new s(function(){e.on(\"mousedown\",r.mouseDownHandler)},function(){e.off(\"mousedown\",r.mouseDownHandler)}).bind(this,\"enabled\",!0)},Kt=x(\"CursorDebounce\",zt,qt),Ut=Object.freeze({defaultOption:qt,suggestedOption:$t,CursorDebounce:zt,getAddon:Kt}),Wt=/^(\\s*)(>[> ]*|[*+-] \\[[x ]\\]\\s|[*+-]\\s|(\\d+)([.)]))(\\s*)/,Bt=/^(\\s*)(>[> ]*|[*+-] \\[[x ]\\]|[*+-]|(\\d+)[.)])(\\s*)$/,Xt=/[*+-]\\s/,Yt=/^(\\s*)([*+-]\\s|(\\d+)([.)]))(\\s*)/,Gt=function(e){return/hmd-table-sep/.test(e.type)&&!/hmd-table-sep-dummy/.test(e.type)};function Vt(e){if(e.getOption(\"disableInput\"))return U.Pass;for(var t=[],n=0,r=e.listSelections();n<r.length;n+=1){var i=r[n],o=i.head,a=i.empty(),l=e.getStateAfter(o.line),s=e.getLine(o.line),c=!1;if(!c){var d=!1!==l.list,h=l.quote,u=Wt.exec(s),f=/^\\s*$/.test(s.slice(0,o.ch));if(a&&(d||h)&&u&&!f)if(c=!0,Bt.test(s))/>\\s*$/.test(s)||e.replaceRange(\"\",{line:o.line,ch:0},{line:o.line,ch:o.ch+1}),t.push(\"\\n\");else{var m=u[1],p=u[5],g=!(Xt.test(u[2])||0<=u[2].indexOf(\">\")),v=g?parseInt(u[3],10)+1+u[4]:u[2].replace(\"x\",\" \");t.push(\"\\n\"+m+v+p),g&&nn(e,o)}}if(!c){var b=a?l.hmdTable:0;if(0!=b){if(!/^[\\s\\|]+$/.test(s)||o.line!==e.lastLine()&&e.getStateAfter(o.line+1).hmdTable===b){var _=$(\"  |  \",l.hmdTableColumns.length-1),k=\"\\n\";2===b&&(k+=\"| \",_+=\" |\"),0==l.hmdTableRow?e.setCursor({line:o.line+1,ch:e.getLine(o.line+1).length}):e.setCursor({line:o.line,ch:s.length}),e.replaceSelection(k),e.replaceSelection(_,\"start\")}else e.setCursor({line:o.line,ch:0}),e.replaceRange(\"\\n\",{line:o.line,ch:0},{line:o.line,ch:s.length});return void(c=!0)}if(a&&o.ch>=s.length&&!l.code&&!l.hmdInnerMode&&/^\\|.+\\|.+\\|$/.test(s)){for(var y=e.getLineTokens(o.line),w=\"|\",T=\"|\",x=1;x<y.length;x++){var L=y[x];\"|\"!==L.string||L.type&&L.type.trim().length||(w+=\" ------- |\",T+=\"   |\")}return e.setCursor({line:o.line,ch:s.length}),e.replaceSelection(\"\\n\"+w+\"\\n| \"),e.replaceSelection(T.slice(1)+\"\\n\",\"start\"),void(c=!0)}}if(c||a&&\"$$\"==s.slice(o.ch-2,o.ch)&&/math-end/.test(e.getTokenTypeAt(o))&&(t.push(\"\\n\"),c=!0),!c)return void e.execCommand(\"newlineAndIndent\")}e.replaceSelections(t)}function Zt(e){if(e.getOption(\"disableInput\"))return U.Pass;for(var t=e.listSelections(),n=a(\"\\n\",t.length),r=0;r<t.length;r++){var i=t[r].head,o=e.getStateAfter(i.line);!1!==o.list&&(n[r]+=$(\" \",o.listStack.slice(-1)[0]))}e.replaceSelections(n)}function Qt(e,t,n){if(n&&!(n<0)){var r=/^ */.exec(e.getLine(t))[0].length;r<n&&(n=r),0<n&&e.replaceRange(\"\",{line:t,ch:0},{line:t,ch:n})}}function Jt(e){for(var t,n=e.listSelections(),r=new z(e),i=0;i<n.length;i++){var o=n[i],a=o.head,l=o.anchor;!o.empty()&&0<U.cmpPos(a,l)?(l=(t=[a,l])[0],a=t[1]):l===a&&(l=o.anchor={ch:a.ch,line:a.line});var s=e.getStateAfter(a.line);if(s.hmdTable){r.setPos(a.line,a.ch);var c=2===s.hmdTable,d=a.line,h=e.getLine(d),u=0,f=0,m=r.findPrev(Gt);if(m){u=(p=r.findPrev(Gt,m.i_token-1))?p.token.end:0,f=m.token.start,0==u&&c&&(u+=h.match(/^\\s*\\|/)[0].length)}else{if(0==s.hmdTableRow)return;var p;2==s.hmdTableRow&&d--,d--,h=e.getLine(d),r.setPos(d,h.length),u=(p=r.findPrev(Gt)).token.end,f=h.length,c&&(f-=h.match(/\\|\\s*$/)[0].length)}return\" \"===h.charAt(u)&&(u+=1),0<u&&\" |\"===h.substr(u-1,2)&&u--,\" \"===h.charAt(f-1)&&(f-=1),void e.setSelection({line:d,ch:u},{line:d,ch:f})}if(0<s.listStack.length){for(var g=a.line;!Yt.test(e.getLine(g));){if(g--,!(0<e.getStateAfter(g).listStack.length)){g++;break}}for(var v=e.lastLine(),b=void 0;g<=l.line&&(b=Yt.exec(e.getLine(g)));g++){var _=e.getStateAfter(g).listStack,k=_.length,y=0;for(Qt(e,g,y=1==k?b[1].length:_[k-1]-(_[k-2]||0));++g<=v;){if(e.getStateAfter(g).listStack.length!==k){g=1/0;break}if(Yt.test(e.getLine(g))){g--;break}Qt(e,g,y)}}return}}e.execCommand(\"indentLess\")}function en(e){var t,n=e.listSelections(),r=[],i=[],o=[],a={},l=new z(e),s=!1,c=!1,d=!1,h=!0;function u(e){(r[p]=e)&&(c=!0)}function f(e){(i[p]=e)&&(d=!0)}function m(e){(o[p]=e)&&(h=!0)}for(var p=0;p<n.length;p++){r[p]=i[p]=o[p]=\"\";var g=n[p],v=g.head,b=g.anchor,_=g.empty();!_&&0<U.cmpPos(v,b)?(b=(t=[v,b])[0],v=t[1]):b===v&&(b=g.anchor={ch:v.ch,line:v.line});var k=e.getStateAfter(v.line),y=e.getLine(v.line);if(k.hmdTable){s=!0;var w=2===k.hmdTable,T=k.hmdTableColumns;l.setPos(v.line,v.ch);var x=l.findNext(Gt,l.i_token);if(x){var L=l.findNext(/hmd-table-sep/,x.i_token+1);v.ch=x.token.end,b.ch=L?L.token.start:y.length,b.ch>v.ch&&\" \"===y.charAt(v.ch)&&v.ch++,b.ch>v.ch&&\" \"===y.charAt(b.ch-1)&&b.ch--,m(b.ch>v.ch?e.getRange(v,b):\"\")}else{var M=0===k.hmdTableRow?2:1;if(v.line+M>e.lastLine()||e.getStateAfter(v.line+M).hmdTable!=k.hmdTable){v.ch=b.ch=y.length;var C=$(\"  |  \",T.length-1);0===k.hmdTableRow&&(b.line=v.line+=1,b.ch=v.ch=e.getLine(v.line).length),w?(u(\"\\n| \"),f(C+\" |\")):(u(\"\\n\"),f(C.trimRight())),m(\"\")}else{b.line=v.line+=M,l.setPos(v.line,0);var O=l.line.text,H=w&&l.findNext(/hmd-table-sep-dummy/,0),S=l.findNext(/hmd-table-sep/,H?H.i_token+1:1);v.ch=H?H.token.end:0,b.ch=S?S.token.start:O.length,b.ch>v.ch&&\" \"===O.charAt(v.ch)&&v.ch++,b.ch>v.ch&&\" \"===O.charAt(b.ch-1)&&b.ch--,m(b.ch>v.ch?e.getRange(v,b):\"\")}}}else if(0<k.listStack.length){for(var E=v.line,D=void 0;!(D=Yt.exec(e.getLine(E)));){if(E--,!(0<e.getStateAfter(E).listStack.length)){E++;break}}for(var N=e.firstLine(),A=e.lastLine();E<=b.line&&(D=Yt.exec(e.getLine(E)));E++){var R=e.getStateAfter(E).listStack,I=e.getStateAfter(E-1).listStack,j=R.length,F=\"\";for(N<E&&j<=I.length&&(F=j==I.length?$(\" \",I[j-1]-D[1].length):$(\" \",I[j]-D[0].length)),a[E]=F;++E<=A;){if(e.getStateAfter(E).listStack.length!==j){E=1/0;break}if(Yt.test(e.getLine(E))){E--;break}a[E]=F}}if(!_){h=!1;break}}else if(_)u(\"    \");else{m(e.getRange(v,b));for(var P=v.line;P<=b.line;P++)P in a||(a[P]=\"    \")}}for(var q in a)a[q]&&e.replaceRange(a[q],{line:~~q,ch:0});s&&e.setSelections(n),c&&e.replaceSelections(r),d&&e.replaceSelections(i,\"start\"),h&&e.replaceSelections(o,\"around\")}function tn(T,x,L){return function(e){var t;if(e.getOption(\"disableInput\"))return U.Pass;for(var n=new z(e),r=e.listSelections(),i=new Array(r.length),o=0;o<r.length;o++){var a=r[o],l=a.head,s=a.anchor,c=e.getStateAfter(l.line),d=a.empty();0<U.cmpPos(l,s)&&(s=(t=[l,s])[0],l=t[1]);var h=i[o]=d?\"\":e.getRange(l,s);if(d||T(e.getTokenAt(l).state)){var u=l.line;n.setPos(u,l.ch,!0);var f=n.lineTokens[n.i_token];f&&f.state;f&&!/^\\s*$/.test(f.string)||(f=n.lineTokens[--n.i_token]);var m=n.expandRange(function(e){return e&&(T(e.state)||x(e))}),p=m.from,g=m.to;if(g.i_token===p.i_token){var v=L();if(f&&!/^\\s*$/.test(f.string)){var b={line:u,ch:f.start},_={line:u,ch:f.end};return f=p.token,e.replaceRange(v+f.string+v,b,_),_.ch+=v.length,void e.setCursor(_)}i[o]=v}else x(g.token)&&e.replaceRange(\"\",{line:u,ch:g.token.start},{line:u,ch:g.token.end}),p.i_token!==g.i_token&&x(p.token)&&e.replaceRange(\"\",{line:u,ch:p.token.start},{line:u,ch:p.token.end})}else{var k=e.getTokenAt(l),y=k?k.state:c,w=L(y);i[o]=w+h+w}}e.replaceSelections(i)}}function nn(e,t){var n=Wt,r=t.line,i=0,o=0,a=n.exec(e.getLine(r)),l=a[1];do{var s=r+(i+=1),c=e.getLine(s),d=n.exec(c);if(d){var h=d[1],u=parseInt(a[3],10)+i-o,f=parseInt(d[3],10),m=f;if(l!==h||isNaN(f)){if(l.length>h.length)return;if(l.length<h.length&&1===i)return;o+=1}else u===f&&(m=f+1),f<u&&(m=u+1),e.replaceRange(c.replace(n,h+m+d[4]+d[5]),{line:s,ch:0},{line:s,ch:c.length})}}while(d)}Object.assign(U.commands,{hmdNewlineAndContinue:Vt,hmdNewline:Zt,hmdShiftTab:Jt,hmdTab:en});var rn=U.keyMap.default===U.keyMap.macDefault?\"Cmd\":\"Ctrl\",on={\"Shift-Tab\":\"hmdShiftTab\",Tab:\"hmdTab\",Enter:\"hmdNewlineAndContinue\",\"Shift-Enter\":\"hmdNewline\"};on[rn+\"-B\"]=tn(function(e){return e.strong},function(e){return/ formatting-strong /.test(e.type)},function(e){return $(e&&e.strong||\"*\",2)}),on[rn+\"-I\"]=tn(function(e){return e.em},function(e){return/ formatting-em /.test(e.type)},function(e){return e&&e.em||\"*\"}),on[rn+\"-D\"]=tn(function(e){return e.strikethrough},function(e){return/ formatting-strikethrough /.test(e.type)},function(e){return\"~~\"}),on.fallthrough=\"default\",on=U.normalizeKeyMap(on),U.keyMap.hypermd=on,l.keyMap=\"hypermd\";var an=Object.freeze({newlineAndContinue:Vt,newline:Zt,shiftTab:Jt,tab:en,wrapTexts:function(e,t,n){var r;if(e.getOption(\"disableInput\"))return U.Pass;var i=e.listSelections(),o=new Array(i.length),a=new Array(i.length),l=!1,s=!1,c=!1;n||(n=t);for(var d=t.length,h=n.length,u=0;u<i.length;u++){o[u]=a[u]=\"\";var f=i[u],m=f.head,p=f.anchor,g=e.getLine(m.line);if(f.empty())m.ch>=d&&g.substr(m.ch-d,d)===t?(c=!0,m.ch-=d):(s=!0,a[u]=t);else{l=!0,0<U.cmpPos(m,p)&&(p=(r=[m,p])[0],m=r[1]);var v=e.getRange(m,p);m.ch>=d&&m.line===p.line&&g.substr(m.ch-d,d)===t&&g.substr(p.ch,h)===n&&(c=!0,p.ch+=h,m.ch-=d,v=t+v+n),v.slice(0,d)===t&&v.slice(-h)===n?o[u]=v.slice(d,-h):o[u]=t+v+n}}c&&e.setSelections(i),s&&e.replaceSelections(a),l&&e.replaceSelections(o,\"around\")},createStyleToggler:tn,get keyMap(){return on}});e.cmpPos=U.cmpPos,e.Mode=C,e.InsertFile=D,e.ReadLink=q,e.Hover=de,e.Click=ve,e.Paste=xe,e.Fold=Ne,e.FoldImage=Re,e.FoldLink=je,e.FoldCode=Ye,e.FoldMath=nt,e.FoldEmoji=ht,e.FoldHTML=kt,e.TableAlign=Lt,e.ModeLoader=St,e.HideToken=Pt,e.CursorDebounce=Ut,e.KeyMap=an,e.Addon=L,e.FlipFlop=s,e.tryToRun=d,e.debounce=h,e.addClass=t,e.rmClass=n,e.contains=r,e.repeat=a,e.repeatStr=$,e.visitElements=m,e.watchSize=p,e.makeSymbol=i,e.suggestedEditorConfig=l,e.normalVisualConfig=c,e.fromTextArea=function(e,t){var n=Object.assign({},l,t),r=U.fromTextArea(e,n);return r[o]=!0,r},e.switchToNormal=function(e,t){if(e[o]){\"string\"==typeof t&&(t={theme:t});var n=Object.assign({},c,t);for(var r in n)e.setOption(r,n[r])}},e.switchToHyperMD=function(e,t){\"string\"==typeof t&&(t={theme:t});var n={};if(o in e){for(var r in c)n[r]=l[r];Object.assign(n,t)}else Object.assign(n,l,t),e[o]=!0;for(var i in n)e.setOption(i,n[i])},e.cm_internal=f,e.TokenSeeker=z,e.getEveryCharToken=function(e){var t=new Array(e.text.length),n=e.styles,r=0;if(n)for(var i=1;i<n.length;i+=2)for(var o=n[i],a=n[i+1];r<o;)t[r++]=a;else for(var l=(e.parent.cm||e.parent.parent.cm||e.parent.parent.parent.cm).getLineTokens(e.lineNo()),s=0;s<l.length;s++)for(var c=l[s].end,d=l[s].type;r<c;)t[r++]=d;return t},e.expandRange=w,e.orderedRange=g,e.rangesIntersect=k,e.getLineSpanExtractor=T,Object.defineProperty(e,\"__esModule\",{value:!0})});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/HyperMD/powerpack/fold-emoji-with-emojione.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"emojione","line":15,"column":93,"nodeType":"CallExpression","endLine":15,"endColumn":112},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../addon/fold-emoji","line":15,"column":114,"nodeType":"CallExpression","endLine":15,"endColumn":144},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"emojione/extras/css/emojione.min.css","line":15,"column":146,"nodeType":"CallExpression","endLine":15,"endColumn":193}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// HyperMD, copyright (c) by laobubu\n// Distributed under an MIT license: http://laobubu.net/HyperMD/LICENSE\n//\n// POWERPACK for \"addon/fold-emoji\"\n//\n// Use EmojiOne to lookup emojis and render emoji `:smile:` :smile:\n//\n// :warning: **License**:\n//\n// Please follow https://www.emojione.com/licenses/free if you use this powerpack.\n//  EmojiOne \n//\n\n(function (mod){ //[HyperMD] UMD patched!\n  /*commonjs*/  (\"object\"==typeof exports&&\"undefined\"!=typeof module) ? mod(null, exports, require(\"emojione\"), require(\"../addon/fold-emoji\"), require(\"emojione/extras/css/emojione.min.css\")) :\n  /*amd*/       (\"function\"==typeof define&&define.amd) ? define([\"require\",\"exports\",\"emojione\",\"../addon/fold-emoji\",\"emojione/extras/css/emojione.min.css\"], mod) :\n  /*plain env*/ mod(null, (this.HyperMD_PowerPack = this.HyperMD_PowerPack || {}, this.HyperMD_PowerPack[\"fold-emoji-with-emojione\"] = {}), emojione, HyperMD.FoldEmoji);\n})(function (require, exports, _emojione_module, fold_emoji_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    /** emojione doesn't have AMD declaration. load it from browser if needed */\n    var emojione = _emojione_module || this['emojione'] || window['emojione'];\n    exports.emojioneChecker = function (text) { return emojione.shortnameToUnicode(text) != text; };\n    exports.emojioneRenderer = function (text) {\n        var html = emojione.shortnameToImage(text);\n        if (!/^<img /i.test(html))\n            return null;\n        var attr = /([\\w-]+)=\"(.+?)\"/g;\n        var ans = document.createElement(\"img\");\n        var t;\n        while (t = attr.exec(html))\n            ans.setAttribute(t[1], t[2]);\n        return ans;\n    };\n    // Update default EmojiChecker and EmojiRenderer\n    if (emojione) {\n        fold_emoji_1.defaultOption.emojiChecker = exports.emojioneChecker;\n        fold_emoji_1.defaultOption.emojiRenderer = exports.emojioneRenderer;\n    }\n    else {\n        console.error(\"[HyperMD] PowerPack fold-emoji-with-emojione loaded, but emojione not found.\");\n    }\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/HyperMD/powerpack/fold-math-with-mathjax.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../addon/fold-math","line":25,"column":93,"nodeType":"CallExpression","endLine":25,"endColumn":122},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"mathjax","line":25,"column":124,"nodeType":"CallExpression","endLine":25,"endColumn":142}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// HyperMD, copyright (c) by laobubu\n// Distributed under an MIT license: http://laobubu.net/HyperMD/LICENSE\n//\n// POWERPACK for \"addon/fold-math\"\n//\n// Use MathJax to render TeX formulars.\n//\n// :warning: **Configuration Required**\n//\n// Before loading this module, make sure that you've finished [configuring MathJax](http://docs.mathjax.org/en/latest/configuration.html) like this:\n//\n// ```html\n// <script type=\"text/x-mathjax-config\">\n// MathJax.Hub.Config({\n//     jax: [\"input/TeX\", \"output/HTML-CSS\",\"output/NativeMML\",\"output/SVG\"],\n//     extensions: [\"MathMenu.js\",\"MathZoom.js\", \"AssistiveMML.js\", \"a11y/accessibility-menu.js\"],\n//     TeX: {\n//         extensions: [\"AMSmath.js\",\"AMSsymbols.js\",\"noErrors.js\",\"noUndefined.js\"]\n//     }\n// });\n// </script>\n// ```\n\n(function (mod){ //[HyperMD] UMD patched!\n  /*commonjs*/  (\"object\"==typeof exports&&\"undefined\"!=typeof module) ? mod(null, exports, require(\"../addon/fold-math\"), require(\"mathjax\")) :\n  /*amd*/       (\"function\"==typeof define&&define.amd) ? define([\"require\",\"exports\",\"../addon/fold-math\",\"mathjax\"], mod) :\n  /*plain env*/ mod(null, (this.HyperMD_PowerPack = this.HyperMD_PowerPack || {}, this.HyperMD_PowerPack[\"fold-math-with-mathjax\"] = {}), HyperMD.FoldMath);\n})(function (require, exports, fold_math_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    var MathJaxRenderer = /** @class */ (function () {\n        function MathJaxRenderer(div, mode) {\n            this.div = div;\n            this.mode = mode;\n            this.onChanged = null;\n            this.jax = null;\n            this._cleared = false;\n            this._renderingExpr = \"\"; // Currently rendering expr\n            var script = document.createElement(\"script\");\n            script.setAttribute(\"type\", mode ? 'math/tex; mode=' + mode : 'math/tex');\n            div.appendChild(script);\n            this.script = script;\n        }\n        MathJaxRenderer.prototype.clear = function () {\n            var script = this.script;\n            script.innerHTML = '';\n            if (this.jax)\n                this.jax.Remove();\n            this._cleared = true;\n        };\n        MathJaxRenderer.prototype.startRender = function (expr) {\n            if (this._cleared) {\n                return;\n            }\n            if (this._renderingExpr) {\n                // A new rendering job comes, while previous one is still in progress\n                // Do rendering later, in _TypesetDoneCB function\n                this._renderingExpr = expr;\n                return;\n            }\n            this._renderingExpr = expr;\n            var script = this.script;\n            script.innerHTML = expr;\n            if (this.jax) {\n                MathJax.Hub.Queue([\"Text\", this.jax, expr], [\"_TypesetDoneCB\", this, expr]);\n            }\n            else {\n                MathJax.Hub.Queue([\"Typeset\", MathJax.Hub, script], [\"_TypesetDoneCB\", this, expr]);\n            }\n        };\n        /** Callback for MathJax when typeset is done*/\n        MathJaxRenderer.prototype._TypesetDoneCB = function (finished_expr) {\n            if (this._cleared) {\n                return;\n            }\n            if (!this.jax)\n                this.jax = MathJax.Hub.getJaxFor(this.script);\n            if (this._renderingExpr !== finished_expr) {\n                // Current finished rendering job is out-of-date\n                // re-render with newest Tex expr\n                var expr_new = this._renderingExpr;\n                this._renderingExpr = \"\";\n                this.startRender(expr_new);\n                return;\n            }\n            // Rendering finished. Nothing wrong\n            this._renderingExpr = \"\";\n            if (typeof (this.onChanged) === 'function')\n                this.onChanged(finished_expr);\n        };\n        MathJaxRenderer.prototype.isReady = function () {\n            return MathJax.isReady;\n        };\n        return MathJaxRenderer;\n    }());\n    exports.MathJaxRenderer = MathJaxRenderer;\n    if (typeof MathJax !== \"object\") {\n        // MathJax not exists. Do nothing\n        console.error(\"[HyperMD] PowerPack fold-math-with-mathjax loaded, but MathJax not found.\");\n    }\n    else if (0 == MathJax.Hub.config.jax.length) {\n        // IF NOT FOUND, throw a warning\n        console.error(\"[HyperMD] Looks like MathJax is not configured.\\nPlease do this BEFORE loading MathJax.\\nSee http://docs.mathjax.org/en/latest/configuration.html\");\n        MathJax.isReady = false;\n    }\n    else {\n        // Use MathJaxRenderer as default MathRenderer\n        fold_math_1.defaultOption.renderer = MathJaxRenderer;\n    }\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/HyperMD/powerpack/hover-with-marked.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../addon/hover","line":10,"column":93,"nodeType":"CallExpression","endLine":10,"endColumn":118},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"marked","line":10,"column":120,"nodeType":"CallExpression","endLine":10,"endColumn":137}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// HyperMD, copyright (c) by laobubu\n// Distributed under an MIT license: http://laobubu.net/HyperMD/LICENSE\n//\n// POWERPACK for \"addon/hover\"\n//\n// Render tooltip Markdown to HTML, with marked\n//\n\n(function (mod){ //[HyperMD] UMD patched!\n  /*commonjs*/  (\"object\"==typeof exports&&\"undefined\"!=typeof module) ? mod(null, exports, require(\"../addon/hover\"), require(\"marked\")) :\n  /*amd*/       (\"function\"==typeof define&&define.amd) ? define([\"require\",\"exports\",\"../addon/hover\",\"marked\"], mod) :\n  /*plain env*/ mod(null, (this.HyperMD_PowerPack = this.HyperMD_PowerPack || {}, this.HyperMD_PowerPack[\"hover-with-marked\"] = {}), HyperMD.Hover, marked);\n})(function (require, exports, hover_1, marked) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    if (typeof marked == \"function\") {\n        // Use marked to render Hover tooltip content\n        hover_1.defaultOption.convertor = function (footnote, text) {\n            if (!text)\n                return null;\n            return marked(text);\n        };\n    }\n    else {\n        console.error(\"[HyperMD] PowerPack hover-with-marked loaded, but marked not found.\");\n    }\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/HyperMD/powerpack/insert-file-with-smms.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../addon/insert-file","line":19,"column":93,"nodeType":"CallExpression","endLine":19,"endColumn":124}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// HyperMD PowerPack \"insert-file-with-smms\"\n// This file is distributed under a WTFPL license http://www.wtfpl.net/\n//\n// POWERPACK for \"addon/paste\"\n//\n// Use http://sm.ms as the default destination when user wants to upload images.\n//\n// :bulb: **Hint**:\n//\n// Feel free to copy codes from this module, alter `Upload_One`,\n// and make a new `FileHandler` which uploads images to somewhere else.\n//\n// :warning: **Attribution Required**\n//\n// If you are using this PowerPack, please add \"Uploaded images are hosted by https://sm.ms\" to your app\n//  PowerPack  https://sm.ms \n\n(function (mod){ //[HyperMD] UMD patched!\n  /*commonjs*/  (\"object\"==typeof exports&&\"undefined\"!=typeof module) ? mod(null, exports, require(\"../addon/insert-file\")) :\n  /*amd*/       (\"function\"==typeof define&&define.amd) ? define([\"require\",\"exports\",\"../addon/insert-file\"], mod) :\n  /*plain env*/ mod(null, (this.HyperMD_PowerPack = this.HyperMD_PowerPack || {}, this.HyperMD_PowerPack[\"insert-file-with-smms\"] = {}), HyperMD.InsertFile);\n})(function (require, exports, insert_file_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    /**\n     * Upload one image.\n     *\n     * @param callback called when finished/error. if success, a `url` is given\n     */\n    function Upload_One(file, callback) {\n        insert_file_1.ajaxUpload('https://sm.ms/api/upload', {\n            smfile: file,\n            format: 'json'\n        }, function (o, e) {\n            var imgURL = (o && o.code == 'success') ? o.data.url : null;\n            callback(imgURL);\n        });\n    }\n    exports.Upload_One = Upload_One;\n    var spinGIF = 'data:image/gif;base64,R0lGODlhEAAQAMMMAAQEBIGBgby8vEJCQtzc3GJiYqCgoC8vL8zMzFRUVBkZGY+Pj+rq6nJycq2trQAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJDAAPACwAAAAAEAAQAAAEVvDJSat9rDV2JSOPcRzGg4AUUwxnkjACcKASMQwCFShATiG+CSERSBE4HYohsegQEEhDoXl5ohjQpOVpYSAnjECD9iA4gpNFACTIwRBJxmLx1Z60eEkEACH5BAkIAA8ALAEAAQAOAA4AAARQ8EnJQmAzM/LEOMJDYFRTEITFCMdAEkUSTotyIBMyT4wzb6SMBLFAOBoG4eQAGAiQSgkzAYyKFpzHRhmUGLAaBG7iWGDEWkRWaXBYM4RxJgIAIfkECQwADwAsAQABAA4ADgAABE/wScnWYjNPkZJ4BDYtQWgxyJCITFAQmXEMsEQg2iPgtpgjC4Qg8Mk9BooCsJhDNkBGm6HG8NkSgYxjmmkAAEyEA0OAOQCKmkYoEag15VwEACH5BAkIAA8ALAEAAQAOAA4AAARO8EnJjGMzT9IaeQQ2OcZHPkjRiI+xfJOQFCwBZwKi7RTCEI6bpjEIAHW8xmHByzB8ExbFgZQgoBOD4nAj+BCHA0IQFkoCAAAzxCMkEuYIACH5BAkMAA8ALAEAAQAOAA4AAARP8MmJ0LyXhcWwFEIHPsTWSY5BXEjTnA+zYsjsYTLDCDa2DCre7RFIGIYTBuJU7D0Elg8A0Lg4DoMZQQFQDQYIwSABI1gWCsWRALsQCg1nBAAh+QQJCAAPACwBAAEADgAOAAAETPDJSci82BlMkUQeYTgXyFzEsl0nVn2LwEkMwQzAMT9G4+C6WU/AWFhmtRbC0ZoIjg/CQbGSCBKFlvRADAQYiEKjWXsIDgOZDeltSiIAIfkECQwADwAsAQABAA4ADgAABE7wyUnIvI8gKTbOCuA8jMU43iMAQHMRzjg1ifUyErKkWPkUisGHExAAE0PVjmCwDZ0IwQfhJAwGslyjgSNdBYzFotRYXHyCREKaJIm7kwgAIfkEBQgADwAsAQABAA4ADgAABE3wSUlKITMzHABYmcQMh0AMA4ZgEnIo4MQgSCY4TJiLyB5mgUHj13IQgkMiwTjzEScEwY/AelQSUujCIGsUeg4Dg7FwaDCERqP6NJhDEQA7';\n    var errorPNG = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAAAP1BMVEWIioX29/bu7uz+//79/f3S0tL09PPy8vHw8O74+fjMAADU2ND6+vr39/bY3NW9vrzp6ubl5+Pi5N/e4duytLE6MtxfAAAAbUlEQVQY022PSRLDMAgEgZBhMXLW/781cqKDYrtvdPWBoRvNbOflD+qCZ7rQdX09H3dxcClvxeKQgX2LRSRFPGdhaRnmgiHcIgMw559wQ0Y2hrUheh+9YdQQaFFa1aCnf+jh0+sE77co0Xs3/wNPXARclYchfgAAAABJRU5ErkJggg==';\n    var supportBlobURL = typeof URL !== 'undefined';\n    /** ClassName for `<img>` placeholders */\n    var placeholderUploadingClass = \"hmd-file-uploading\";\n    var placeholderUploadedClass = \"hmd-file-uploaded\";\n    /**\n     * SmMsFileHandler FileHandler\n     *\n     * accepts and uploads images, then inserts as `![](image_url)`\n     */\n    exports.SmMsFileHandler = function (files, action) {\n        var unfinishedCount = 0;\n        /** a container for all uploading images */\n        var placeholderForAll = document.createElement(\"span\");\n        placeholderForAll.className = \"smms-hosted-items\";\n        action.setPlaceholder(placeholderForAll);\n        var uploads = [];\n        for (var i = 0; i < files.length; i++) {\n            var file = files[i];\n            if (!/image\\//.test(file.type))\n                continue;\n            var blobURL = supportBlobURL ? URL.createObjectURL(file) : spinGIF;\n            var name_1 = file.name.match(/[^\\\\\\/]+\\.\\w+$/)[0];\n            var placeholder = document.createElement(\"img\");\n            placeholder.onload = resize; // img size changed\n            placeholder.className = placeholderUploadingClass;\n            placeholder.src = blobURL;\n            placeholderForAll.appendChild(placeholder);\n            var task = {\n                blobURL: blobURL,\n                name: name_1,\n                url: null,\n                placeholder: placeholder,\n            };\n            uploads.push(task);\n            unfinishedCount++;\n            Upload_One(file, uploadCallback.bind(null, task));\n        }\n        return uploads.length > 0;\n        //----------------------------------------------------------------------------\n        function resize() { action.resize(); }\n        /** Once we uploaded a image, download it from server, preload for `fold` addon */\n        function uploadCallback(task, url) {\n            task.url = url || \"error\";\n            var placeholder = task.placeholder;\n            placeholder.className = placeholderUploadedClass;\n            var _preloadDone = preloadCallback.bind(null, task);\n            if (url) {\n                var img = document.createElement(\"img\");\n                img.addEventListener(\"load\", _preloadDone, false);\n                img.addEventListener(\"error\", _preloadDone, false);\n                img.src = url;\n            }\n            else {\n                placeholder.src = errorPNG;\n                _preloadDone();\n            }\n        }\n        function preloadCallback(task) {\n            if (supportBlobURL)\n                URL.revokeObjectURL(task.blobURL);\n            if (--unfinishedCount === 0) {\n                var texts = uploads.map(function (it) { return \"![\" + it.name + \"](\" + it.url + \")\"; });\n                action.finish(texts.join(\" \") + \" \");\n            }\n        }\n    };\n    insert_file_1.defaultOption.fileHandler = exports.SmMsFileHandler;\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/HyperMD/powerpack/paste-with-turndown.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"turndown","line":15,"column":93,"nodeType":"CallExpression","endLine":15,"endColumn":112},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../addon/paste","line":15,"column":114,"nodeType":"CallExpression","endLine":15,"endColumn":139}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// HyperMD, copyright (c) by laobubu\n// Distributed under an MIT license: http://laobubu.net/HyperMD/LICENSE\n//\n// POWERPACK for \"addon/paste\"\n//\n// This module provides `TurndownConvertor`, which can convert copied HTML into Markdown.\n//\n// :bulb: **Hint**:\n//\n// This module also supports GFM extensions (eg. tables) via [turndown-plugin-gfm](https://www.npmjs.com/package/turndown-plugin-gfm).\n// Load `turndown-plugin-gfm` after this module and it will be automatically used while pasting.\n//\n\n(function (mod){ //[HyperMD] UMD patched!\n  /*commonjs*/  (\"object\"==typeof exports&&\"undefined\"!=typeof module) ? mod(null, exports, require(\"turndown\"), require(\"../addon/paste\")) :\n  /*amd*/       (\"function\"==typeof define&&define.amd) ? define([\"require\",\"exports\",\"turndown\",\"../addon/paste\"], mod) :\n  /*plain env*/ mod(null, (this.HyperMD_PowerPack = this.HyperMD_PowerPack || {}, this.HyperMD_PowerPack[\"paste-with-turndown\"] = {}), TurndownService, HyperMD.Paste);\n})(function (require, exports, TurndownService, paste_1) {\n    \"use strict\";\n    Object.defineProperty(exports, \"__esModule\", { value: true });\n    exports.TurndownConvertor = function (html) {\n        // strip <a> without href\n        html = html.replace(/<a([^>]*)>(.*?)<\\/a>/ig, function (s, attrs, content) {\n            if (!/href=/i.test(attrs))\n                return content;\n            return s;\n        });\n        // maybe you don't need to convert, if there is no img/link/header...\n        if (!/\\<(?:hr|img|h\\d|strong|em|strikethrough|table|a|b|i|del)(?:\\s.*?|\\/)?\\>/i.test(html))\n            return null;\n        var turndownService = exports.getTurndownService();\n        if (turndownService)\n            return turndownService.turndown(html);\n        return null;\n    };\n    exports.getTurndownService = (function () {\n        var service = null;\n        return function () {\n            if (!service && typeof TurndownService === 'function') {\n                var opts = {\n                    \"headingStyle\": \"atx\",\n                    \"hr\": \"---\",\n                    \"bulletListMarker\": \"*\",\n                    \"codeBlockStyle\": \"fenced\",\n                    \"fence\": \"```\",\n                    \"emDelimiter\": \"*\",\n                    \"strongDelimiter\": \"**\",\n                    \"linkStyle\": \"inlined\",\n                    \"linkReferenceStyle\": \"collapsed\"\n                };\n                service = new TurndownService(opts);\n                if (typeof turndownPluginGfm !== 'undefined') {\n                    service.use(turndownPluginGfm.gfm);\n                }\n            }\n            return service;\n        };\n    })();\n    if (typeof TurndownService != \"undefined\") {\n        // Use this convertor as default convertor\n        paste_1.defaultOption.convertor = exports.TurndownConvertor;\n    }\n    else {\n        console.error(\"[HyperMD] PowerPack paste-with-turndown loaded, but turndown not found.\");\n    }\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/addon/fold/foldcode.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/addon/fold/foldcode.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(n){\"object\"==typeof exports&&\"object\"==typeof module?n(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],n):n(CodeMirror)}(function(n){\"use strict\";function o(o,e,t,i){if(t&&t.call){var l=t;t=null}else l=r(o,t,\"rangeFinder\");\"number\"==typeof e&&(e=n.Pos(e,0));var f=r(o,t,\"minFoldSize\");function d(n){var r=l(o,e);if(!r||r.to.line-r.from.line<f)return null;for(var t=o.findMarksAt(r.from),d=0;d<t.length;++d)if(t[d].__isFold&&\"fold\"!==i){if(!n)return null;r.cleared=!0,t[d].clear()}return r}var u=d(!0);if(r(o,t,\"scanUp\"))for(;!u&&e.line>o.firstLine();)e=n.Pos(e.line-1,0),u=d(!1);if(u&&!u.cleared&&\"unfold\"!==i){var a=function(n,o,e){var t=r(n,o,\"widget\");\"function\"==typeof t&&(t=t(e.from,e.to));if(\"string\"==typeof t){var i=document.createTextNode(t);(t=document.createElement(\"span\")).appendChild(i),t.className=\"CodeMirror-foldmarker\"}else t&&(t=t.cloneNode(!0));return t}(o,t,u);n.on(a,\"mousedown\",function(o){c.clear(),n.e_preventDefault(o)});var c=o.markText(u.from,u.to,{replacedWith:a,clearOnEnter:r(o,t,\"clearOnEnter\"),__isFold:!0});c.on(\"clear\",function(e,r){n.signal(o,\"unfold\",o,e,r)}),n.signal(o,\"fold\",o,u.from,u.to)}}n.newFoldFunction=function(n,e){return function(r,t){o(r,t,{rangeFinder:n,widget:e})}},n.defineExtension(\"foldCode\",function(n,e,r){o(this,n,e,r)}),n.defineExtension(\"isFolded\",function(n){for(var o=this.findMarksAt(n),e=0;e<o.length;++e)if(o[e].__isFold)return!0}),n.commands.toggleFold=function(n){n.foldCode(n.getCursor())},n.commands.fold=function(n){n.foldCode(n.getCursor(),null,\"fold\")},n.commands.unfold=function(n){n.foldCode(n.getCursor(),null,\"unfold\")},n.commands.foldAll=function(o){o.operation(function(){for(var e=o.firstLine(),r=o.lastLine();e<=r;e++)o.foldCode(n.Pos(e,0),null,\"fold\")})},n.commands.unfoldAll=function(o){o.operation(function(){for(var e=o.firstLine(),r=o.lastLine();e<=r;e++)o.foldCode(n.Pos(e,0),null,\"unfold\")})},n.registerHelper(\"fold\",\"combine\",function(){var n=Array.prototype.slice.call(arguments,0);return function(o,e){for(var r=0;r<n.length;++r){var t=n[r](o,e);if(t)return t}}}),n.registerHelper(\"fold\",\"auto\",function(n,o){for(var e=n.getHelpers(o,\"fold\"),r=0;r<e.length;r++){var t=e[r](n,o);if(t)return t}});var e={rangeFinder:n.fold.auto,widget:\"\",minFoldSize:0,scanUp:!1,clearOnEnter:!0};function r(n,o,r){if(o&&void 0!==o[r])return o[r];var t=n.options.foldOptions;return t&&void 0!==t[r]?t[r]:e[r]}n.defineOption(\"foldOptions\",null),n.defineExtension(\"foldOption\",function(n,o){return r(this,n,o)})});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/addon/fold/foldgutter.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./foldcode","line":7,"column":98,"nodeType":"CallExpression","endLine":7,"endColumn":119}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/addon/fold/foldgutter.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(t){\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"../../lib/codemirror\"),require(\"./foldcode\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\",\"./foldcode\"],t):t(CodeMirror)}(function(t){\"use strict\";t.defineOption(\"foldGutter\",!1,function(o,r,n){n&&n!=t.Init&&(o.clearGutter(o.state.foldGutter.options.gutter),o.state.foldGutter=null,o.off(\"gutterClick\",d),o.off(\"changes\",u),o.off(\"viewportChange\",l),o.off(\"fold\",c),o.off(\"unfold\",c),o.off(\"swapDoc\",u)),r&&(o.state.foldGutter=new e(function(t){!0===t&&(t={});null==t.gutter&&(t.gutter=\"CodeMirror-foldgutter\");null==t.indicatorOpen&&(t.indicatorOpen=\"CodeMirror-foldgutter-open\");null==t.indicatorFolded&&(t.indicatorFolded=\"CodeMirror-foldgutter-folded\");return t}(r)),a(o),o.on(\"gutterClick\",d),o.on(\"changes\",u),o.on(\"viewportChange\",l),o.on(\"fold\",c),o.on(\"unfold\",c),o.on(\"swapDoc\",u))});var o=t.Pos;function e(t){this.options=t,this.from=this.to=0}function r(t,e){for(var r=t.findMarks(o(e,0),o(e+1,0)),n=0;n<r.length;++n)if(r[n].__isFold){var i=r[n].find(-1);if(i&&i.line===e)return r[n]}}function n(t){if(\"string\"==typeof t){var o=document.createElement(\"div\");return o.className=t+\" CodeMirror-guttermarker-subtle\",o}return t.cloneNode(!0)}function i(t,e,i){var a=t.state.foldGutter.options,d=e-1,u=t.foldOption(a,\"minFoldSize\"),l=t.foldOption(a,\"rangeFinder\"),c=\"string\"==typeof a.indicatorFolded&&f(a.indicatorFolded),s=\"string\"==typeof a.indicatorOpen&&f(a.indicatorOpen);t.eachLine(e,i,function(e){++d;var i=null,f=e.gutterMarkers;if(f&&(f=f[a.gutter]),r(t,d)){if(c&&f&&c.test(f.className))return;i=n(a.indicatorFolded)}else{var p=o(d,0),m=l&&l(t,p);if(m&&m.to.line-m.from.line>=u){if(s&&f&&s.test(f.className))return;i=n(a.indicatorOpen)}}(i||f)&&t.setGutterMarker(e,a.gutter,i)})}function f(t){return new RegExp(\"(^|\\\\s)\"+t+\"(?:$|\\\\s)\\\\s*\")}function a(t){var o=t.getViewport(),e=t.state.foldGutter;e&&(t.operation(function(){i(t,o.from,o.to)}),e.from=o.from,e.to=o.to)}function d(t,e,n){var i=t.state.foldGutter;if(i){var f=i.options;if(n==f.gutter){var a=r(t,e);a?a.clear():t.foldCode(o(e,0),f)}}}function u(t){var o=t.state.foldGutter;if(o){var e=o.options;o.from=o.to=0,clearTimeout(o.changeUpdate),o.changeUpdate=setTimeout(function(){a(t)},e.foldOnChangeTimeSpan||600)}}function l(t){var o=t.state.foldGutter;if(o){var e=o.options;clearTimeout(o.changeUpdate),o.changeUpdate=setTimeout(function(){var e=t.getViewport();o.from==o.to||e.from-o.to>20||o.from-e.to>20?a(t):t.operation(function(){e.from<o.from&&(i(t,e.from,o.from),o.from=e.from),e.to>o.to&&(i(t,o.to,e.to),o.to=e.to)})},e.updateViewportTimeSpan||400)}}function c(t,o){var e=t.state.foldGutter;if(e){var r=o.line;r>=e.from&&r<e.to&&i(t,r,r+1)}}});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/addon/fold/markdown-fold.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/addon/fold/markdown-fold.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(e){\"object\"==typeof exports&&\"object\"==typeof module?e(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],e):e(CodeMirror)}(function(e){\"use strict\";e.registerHelper(\"fold\",\"markdown\",function(n,t){var r=100;function i(t){var r=n.getTokenTypeAt(e.Pos(t,0));return r&&/\\bheader\\b/.test(r)}function o(e,n,t){var o=n&&n.match(/^#+/);return o&&i(e)?o[0].length:(o=t&&t.match(/^[=\\-]+\\s*$/))&&i(e+1)?\"=\"==t[0]?1:2:r}var f=n.getLine(t.line),l=n.getLine(t.line+1),c=o(t.line,f,l);if(c!==r){for(var u=n.lastLine(),a=t.line,d=n.getLine(a+2);a<u&&!(o(a+1,l,d)<=c);)++a,l=d,d=n.getLine(a+2);return{from:e.Pos(t.line,f.length),to:e.Pos(a,n.getLine(a).length)}}})});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/addon/mode/overlay.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/addon/mode/overlay.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(e){\"object\"==typeof exports&&\"object\"==typeof module?e(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],e):e(CodeMirror)}(function(e){\"use strict\";e.overlayMode=function(o,r,a){return{startState:function(){return{base:e.startState(o),overlay:e.startState(r),basePos:0,baseCur:null,overlayPos:0,overlayCur:null,streamSeen:null}},copyState:function(a){return{base:e.copyState(o,a.base),overlay:e.copyState(r,a.overlay),basePos:a.basePos,baseCur:null,overlayPos:a.overlayPos,overlayCur:null}},token:function(e,n){return(e!=n.streamSeen||Math.min(n.basePos,n.overlayPos)<e.start)&&(n.streamSeen=e,n.basePos=n.overlayPos=e.start),e.start==n.basePos&&(n.baseCur=o.token(e,n.base),n.basePos=e.pos),e.start==n.overlayPos&&(e.pos=e.start,n.overlayCur=r.token(e,n.overlay),n.overlayPos=e.pos),e.pos=Math.min(n.basePos,n.overlayPos),null==n.overlayCur?n.baseCur:null!=n.baseCur&&n.overlay.combineTokens||a&&null==n.overlay.combineTokens?n.baseCur+\" \"+n.overlayCur:n.overlayCur},indent:o.indent&&function(e,r,a){return o.indent(e.base,r,a)},electricChars:o.electricChars,innerMode:function(e){return{state:e.base,mode:o}},blankLine:function(e){var n,t;return o.blankLine&&(n=o.blankLine(e.base)),r.blankLine&&(t=r.blankLine(e.overlay)),null==t?n:a&&null!=n?n+\" \"+t:t}}}});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/lib/codemirror.min.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/mode/javascript/javascript.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/mode/javascript/javascript.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(e){\"object\"==typeof exports&&\"object\"==typeof module?e(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],e):e(CodeMirror)}(function(e){\"use strict\";e.defineMode(\"javascript\",function(t,r){var n,a,i=t.indentUnit,o=r.statementIndent,c=r.jsonld,s=r.json||c,u=r.typescript,f=r.wordCharacters||/[\\w$\\xa1-\\uffff]/,l=function(){function e(e){return{type:e,style:\"keyword\"}}var t=e(\"keyword a\"),r=e(\"keyword b\"),n=e(\"keyword c\"),a=e(\"keyword d\"),i=e(\"operator\"),o={type:\"atom\",style:\"atom\"};return{if:e(\"if\"),while:t,with:t,else:r,do:r,try:r,finally:r,return:a,break:a,continue:a,new:e(\"new\"),delete:n,void:n,throw:n,debugger:e(\"debugger\"),var:e(\"var\"),const:e(\"var\"),let:e(\"var\"),function:e(\"function\"),catch:e(\"catch\"),for:e(\"for\"),switch:e(\"switch\"),case:e(\"case\"),default:e(\"default\"),in:i,typeof:i,instanceof:i,true:o,false:o,null:o,undefined:o,NaN:o,Infinity:o,this:e(\"this\"),class:e(\"class\"),super:e(\"atom\"),yield:n,export:e(\"export\"),import:e(\"import\"),extends:n,await:n}}(),d=/[+\\-*&%=<>!?|~^@]/,p=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)\"/;function m(e,t,r){return n=e,a=r,t}function v(e,t){var r,n=e.next();if('\"'==n||\"'\"==n)return t.tokenize=(r=n,function(e,t){var n,a=!1;if(c&&\"@\"==e.peek()&&e.match(p))return t.tokenize=v,m(\"jsonld-keyword\",\"meta\");for(;null!=(n=e.next())&&(n!=r||a);)a=!a&&\"\\\\\"==n;return a||(t.tokenize=v),m(\"string\",\"string\")}),t.tokenize(e,t);if(\".\"==n&&e.match(/^\\d[\\d_]*(?:[eE][+\\-]?[\\d_]+)?/))return m(\"number\",\"number\");if(\".\"==n&&e.match(\"..\"))return m(\"spread\",\"meta\");if(/[\\[\\]{}\\(\\),;\\:\\.]/.test(n))return m(n);if(\"=\"==n&&e.eat(\">\"))return m(\"=>\",\"operator\");if(\"0\"==n&&e.match(/^(?:x[\\dA-Fa-f_]+|o[0-7_]+|b[01_]+)n?/))return m(\"number\",\"number\");if(/\\d/.test(n))return e.match(/^[\\d_]*(?:n|(?:\\.[\\d_]*)?(?:[eE][+\\-]?[\\d_]+)?)?/),m(\"number\",\"number\");if(\"/\"==n)return e.eat(\"*\")?(t.tokenize=k,k(e,t)):e.eat(\"/\")?(e.skipToEnd(),m(\"comment\",\"comment\")):Le(e,t,1)?(function(e){for(var t,r=!1,n=!1;null!=(t=e.next());){if(!r){if(\"/\"==t&&!n)return;\"[\"==t?n=!0:n&&\"]\"==t&&(n=!1)}r=!r&&\"\\\\\"==t}}(e),e.match(/^\\b(([gimyus])(?![gimyus]*\\2))+\\b/),m(\"regexp\",\"string-2\")):(e.eat(\"=\"),m(\"operator\",\"operator\",e.current()));if(\"`\"==n)return t.tokenize=y,y(e,t);if(\"#\"==n&&\"!\"==e.peek())return e.skipToEnd(),m(\"meta\",\"meta\");if(\"#\"==n&&e.eatWhile(f))return m(\"variable\",\"property\");if(\"<\"==n&&e.match(\"!--\")||\"-\"==n&&e.match(\"->\"))return e.skipToEnd(),m(\"comment\",\"comment\");if(d.test(n))return\">\"==n&&t.lexical&&\">\"==t.lexical.type||(e.eat(\"=\")?\"!\"!=n&&\"=\"!=n||e.eat(\"=\"):/[<>*+\\-]/.test(n)&&(e.eat(n),\">\"==n&&e.eat(n))),\"?\"==n&&e.eat(\".\")?m(\".\"):m(\"operator\",\"operator\",e.current());if(f.test(n)){e.eatWhile(f);var a=e.current();if(\".\"!=t.lastType){if(l.propertyIsEnumerable(a)){var i=l[a];return m(i.type,i.style,a)}if(\"async\"==a&&e.match(/^(\\s|\\/\\*.*?\\*\\/)*[\\[\\(\\w]/,!1))return m(\"async\",\"keyword\",a)}return m(\"variable\",\"variable\",a)}}function k(e,t){for(var r,n=!1;r=e.next();){if(\"/\"==r&&n){t.tokenize=v;break}n=\"*\"==r}return m(\"comment\",\"comment\")}function y(e,t){for(var r,n=!1;null!=(r=e.next());){if(!n&&(\"`\"==r||\"$\"==r&&e.eat(\"{\"))){t.tokenize=v;break}n=!n&&\"\\\\\"==r}return m(\"quasi\",\"string-2\",e.current())}var w=\"([{}])\";function b(e,t){t.fatArrowAt&&(t.fatArrowAt=null);var r=e.string.indexOf(\"=>\",e.start);if(!(r<0)){if(u){var n=/:\\s*(?:\\w+(?:<[^>]*>|\\[\\])?|\\{[^}]*\\})\\s*$/.exec(e.string.slice(e.start,r));n&&(r=n.index)}for(var a=0,i=!1,o=r-1;o>=0;--o){var c=e.string.charAt(o),s=w.indexOf(c);if(s>=0&&s<3){if(!a){++o;break}if(0==--a){\"(\"==c&&(i=!0);break}}else if(s>=3&&s<6)++a;else if(f.test(c))i=!0;else if(/[\"'\\/`]/.test(c))for(;;--o){if(0==o)return;if(e.string.charAt(o-1)==c&&\"\\\\\"!=e.string.charAt(o-2)){o--;break}}else if(i&&!a){++o;break}}i&&!a&&(t.fatArrowAt=o)}}var x={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,this:!0,\"jsonld-keyword\":!0};function h(e,t,r,n,a,i){this.indented=e,this.column=t,this.type=r,this.prev=a,this.info=i,null!=n&&(this.align=n)}function g(e,t){for(var r=e.localVars;r;r=r.next)if(r.name==t)return!0;for(var n=e.context;n;n=n.prev)for(r=n.vars;r;r=r.next)if(r.name==t)return!0}var j={state:null,column:null,marked:null,cc:null};function M(){for(var e=arguments.length-1;e>=0;e--)j.cc.push(arguments[e])}function A(){return M.apply(null,arguments),!0}function V(e,t){for(var r=t;r;r=r.next)if(r.name==e)return!0;return!1}function E(e){var t=j.state;if(j.marked=\"def\",t.context)if(\"var\"==t.lexical.info&&t.context&&t.context.block){var n=function e(t,r){if(r){if(r.block){var n=e(t,r.prev);return n?n==r.prev?r:new I(n,r.vars,!0):null}return V(t,r.vars)?r:new I(r.prev,new T(t,r.vars),!1)}return null}(e,t.context);if(null!=n)return void(t.context=n)}else if(!V(e,t.localVars))return void(t.localVars=new T(e,t.localVars));r.globalVars&&!V(e,t.globalVars)&&(t.globalVars=new T(e,t.globalVars))}function z(e){return\"public\"==e||\"private\"==e||\"protected\"==e||\"abstract\"==e||\"readonly\"==e}function I(e,t,r){this.prev=e,this.vars=t,this.block=r}function T(e,t){this.name=e,this.next=t}var $=new T(\"this\",new T(\"arguments\",null));function C(){j.state.context=new I(j.state.context,j.state.localVars,!1),j.state.localVars=$}function _(){j.state.context=new I(j.state.context,j.state.localVars,!0),j.state.localVars=null}function O(){j.state.localVars=j.state.context.vars,j.state.context=j.state.context.prev}function q(e,t){var r=function(){var r=j.state,n=r.indented;if(\"stat\"==r.lexical.type)n=r.lexical.indented;else for(var a=r.lexical;a&&\")\"==a.type&&a.align;a=a.prev)n=a.indented;r.lexical=new h(n,j.stream.column(),e,null,r.lexical,t)};return r.lex=!0,r}function P(){var e=j.state;e.lexical.prev&&(\")\"==e.lexical.type&&(e.indented=e.lexical.indented),e.lexical=e.lexical.prev)}function S(e){return function t(r){return r==e?A():\";\"==e||\"}\"==r||\")\"==r||\"]\"==r?M():A(t)}}function N(e,t){return\"var\"==e?A(q(\"vardef\",t),be,S(\";\"),P):\"keyword a\"==e?A(q(\"form\"),F,N,P):\"keyword b\"==e?A(q(\"form\"),N,P):\"keyword d\"==e?j.stream.match(/^\\s*$/,!1)?A():A(q(\"stat\"),D,S(\";\"),P):\"debugger\"==e?A(S(\";\")):\"{\"==e?A(q(\"}\"),_,oe,P,O):\";\"==e?A():\"if\"==e?(\"else\"==j.state.lexical.info&&j.state.cc[j.state.cc.length-1]==P&&j.state.cc.pop()(),A(q(\"form\"),F,N,P,Ae)):\"function\"==e?A(Ie):\"for\"==e?A(q(\"form\"),Ve,N,P):\"class\"==e||u&&\"interface\"==t?(j.marked=\"keyword\",A(q(\"form\",\"class\"==e?e:t),Oe,P)):\"variable\"==e?u&&\"declare\"==t?(j.marked=\"keyword\",A(N)):u&&(\"module\"==t||\"enum\"==t||\"type\"==t)&&j.stream.match(/^\\s*\\w/,!1)?(j.marked=\"keyword\",\"enum\"==t?A(Je):\"type\"==t?A($e,S(\"operator\"),le,S(\";\")):A(q(\"form\"),xe,S(\"{\"),q(\"}\"),oe,P,P)):u&&\"namespace\"==t?(j.marked=\"keyword\",A(q(\"form\"),W,N,P)):u&&\"abstract\"==t?(j.marked=\"keyword\",A(N)):A(q(\"stat\"),Z):\"switch\"==e?A(q(\"form\"),F,S(\"{\"),q(\"}\",\"switch\"),_,oe,P,P,O):\"case\"==e?A(W,S(\":\")):\"default\"==e?A(S(\":\")):\"catch\"==e?A(q(\"form\"),C,U,N,P,O):\"export\"==e?A(q(\"stat\"),Ne,P):\"import\"==e?A(q(\"stat\"),We,P):\"async\"==e?A(N):\"@\"==t?A(W,N):M(q(\"stat\"),W,S(\";\"),P)}function U(e){if(\"(\"==e)return A(Ce,S(\")\"))}function W(e,t){return H(e,t,!1)}function B(e,t){return H(e,t,!0)}function F(e){return\"(\"!=e?M():A(q(\")\"),D,S(\")\"),P)}function H(e,t,r){if(j.state.fatArrowAt==j.stream.start){var n=r?R:Q;if(\"(\"==e)return A(C,q(\")\"),ae(Ce,\")\"),P,S(\"=>\"),n,O);if(\"variable\"==e)return M(C,xe,S(\"=>\"),n,O)}var a=r?J:G;return x.hasOwnProperty(e)?A(a):\"function\"==e?A(Ie,a):\"class\"==e||u&&\"interface\"==t?(j.marked=\"keyword\",A(q(\"form\"),_e,P)):\"keyword c\"==e||\"async\"==e?A(r?B:W):\"(\"==e?A(q(\")\"),D,S(\")\"),P,a):\"operator\"==e||\"spread\"==e?A(r?B:W):\"[\"==e?A(q(\"]\"),Ge,P,a):\"{\"==e?ie(te,\"}\",null,a):\"quasi\"==e?M(K,a):\"new\"==e?A(function(e){return function(t){return\".\"==t?A(e?Y:X):\"variable\"==t&&u?A(ke,e?J:G):M(e?B:W)}}(r)):\"import\"==e?A(W):A()}function D(e){return e.match(/[;\\}\\)\\],]/)?M():M(W)}function G(e,t){return\",\"==e?A(D):J(e,t,!1)}function J(e,t,r){var n=0==r?G:J,a=0==r?W:B;return\"=>\"==e?A(C,r?R:Q,O):\"operator\"==e?/\\+\\+|--/.test(t)||u&&\"!\"==t?A(n):u&&\"<\"==t&&j.stream.match(/^([^<>]|<[^<>]*>)*>\\s*\\(/,!1)?A(q(\">\"),ae(le,\">\"),P,n):\"?\"==t?A(W,S(\":\"),a):A(a):\"quasi\"==e?M(K,n):\";\"!=e?\"(\"==e?ie(B,\")\",\"call\",n):\".\"==e?A(ee,n):\"[\"==e?A(q(\"]\"),D,S(\"]\"),P,n):u&&\"as\"==t?(j.marked=\"keyword\",A(le,n)):\"regexp\"==e?(j.state.lastType=j.marked=\"operator\",j.stream.backUp(j.stream.pos-j.stream.start-1),A(a)):void 0:void 0}function K(e,t){return\"quasi\"!=e?M():\"${\"!=t.slice(t.length-2)?A(K):A(W,L)}function L(e){if(\"}\"==e)return j.marked=\"string-2\",j.state.tokenize=y,A(K)}function Q(e){return b(j.stream,j.state),M(\"{\"==e?N:W)}function R(e){return b(j.stream,j.state),M(\"{\"==e?N:B)}function X(e,t){if(\"target\"==t)return j.marked=\"keyword\",A(G)}function Y(e,t){if(\"target\"==t)return j.marked=\"keyword\",A(J)}function Z(e){return\":\"==e?A(P,N):M(G,S(\";\"),P)}function ee(e){if(\"variable\"==e)return j.marked=\"property\",A()}function te(e,t){return\"async\"==e?(j.marked=\"property\",A(te)):\"variable\"==e||\"keyword\"==j.style?(j.marked=\"property\",\"get\"==t||\"set\"==t?A(re):(u&&j.state.fatArrowAt==j.stream.start&&(r=j.stream.match(/^\\s*:\\s*/,!1))&&(j.state.fatArrowAt=j.stream.pos+r[0].length),A(ne))):\"number\"==e||\"string\"==e?(j.marked=c?\"property\":j.style+\" property\",A(ne)):\"jsonld-keyword\"==e?A(ne):u&&z(t)?(j.marked=\"keyword\",A(te)):\"[\"==e?A(W,ce,S(\"]\"),ne):\"spread\"==e?A(B,ne):\"*\"==t?(j.marked=\"keyword\",A(te)):\":\"==e?M(ne):void 0;var r}function re(e){return\"variable\"!=e?M(ne):(j.marked=\"property\",A(Ie))}function ne(e){return\":\"==e?A(B):\"(\"==e?M(Ie):void 0}function ae(e,t,r){function n(a,i){if(r?r.indexOf(a)>-1:\",\"==a){var o=j.state.lexical;return\"call\"==o.info&&(o.pos=(o.pos||0)+1),A(function(r,n){return r==t||n==t?M():M(e)},n)}return a==t||i==t?A():r&&r.indexOf(\";\")>-1?M(e):A(S(t))}return function(r,a){return r==t||a==t?A():M(e,n)}}function ie(e,t,r){for(var n=3;n<arguments.length;n++)j.cc.push(arguments[n]);return A(q(t,r),ae(e,t),P)}function oe(e){return\"}\"==e?A():M(N,oe)}function ce(e,t){if(u){if(\":\"==e)return A(le);if(\"?\"==t)return A(ce)}}function se(e,t){if(u&&(\":\"==e||\"in\"==t))return A(le)}function ue(e){if(u&&\":\"==e)return j.stream.match(/^\\s*\\w+\\s+is\\b/,!1)?A(W,fe,le):A(le)}function fe(e,t){if(\"is\"==t)return j.marked=\"keyword\",A()}function le(e,t){return\"keyof\"==t||\"typeof\"==t||\"infer\"==t?(j.marked=\"keyword\",A(\"typeof\"==t?B:le)):\"variable\"==e||\"void\"==t?(j.marked=\"type\",A(ve)):\"|\"==t||\"&\"==t?A(le):\"string\"==e||\"number\"==e||\"atom\"==e?A(ve):\"[\"==e?A(q(\"]\"),ae(le,\"]\",\",\"),P,ve):\"{\"==e?A(q(\"}\"),ae(pe,\"}\",\",;\"),P,ve):\"(\"==e?A(ae(me,\")\"),de,ve):\"<\"==e?A(ae(le,\">\"),le):void 0}function de(e){if(\"=>\"==e)return A(le)}function pe(e,t){return\"variable\"==e||\"keyword\"==j.style?(j.marked=\"property\",A(pe)):\"?\"==t||\"number\"==e||\"string\"==e?A(pe):\":\"==e?A(le):\"[\"==e?A(S(\"variable\"),se,S(\"]\"),pe):\"(\"==e?M(Te,pe):void 0}function me(e,t){return\"variable\"==e&&j.stream.match(/^\\s*[?:]/,!1)||\"?\"==t?A(me):\":\"==e?A(le):\"spread\"==e?A(me):M(le)}function ve(e,t){return\"<\"==t?A(q(\">\"),ae(le,\">\"),P,ve):\"|\"==t||\".\"==e||\"&\"==t?A(le):\"[\"==e?A(le,S(\"]\"),ve):\"extends\"==t||\"implements\"==t?(j.marked=\"keyword\",A(le)):\"?\"==t?A(le,S(\":\"),le):void 0}function ke(e,t){if(\"<\"==t)return A(q(\">\"),ae(le,\">\"),P,ve)}function ye(){return M(le,we)}function we(e,t){if(\"=\"==t)return A(le)}function be(e,t){return\"enum\"==t?(j.marked=\"keyword\",A(Je)):M(xe,ce,je,Me)}function xe(e,t){return u&&z(t)?(j.marked=\"keyword\",A(xe)):\"variable\"==e?(E(t),A()):\"spread\"==e?A(xe):\"[\"==e?ie(ge,\"]\"):\"{\"==e?ie(he,\"}\"):void 0}function he(e,t){return\"variable\"!=e||j.stream.match(/^\\s*:/,!1)?(\"variable\"==e&&(j.marked=\"property\"),\"spread\"==e?A(xe):\"}\"==e?M():\"[\"==e?A(W,S(\"]\"),S(\":\"),he):A(S(\":\"),xe,je)):(E(t),A(je))}function ge(){return M(xe,je)}function je(e,t){if(\"=\"==t)return A(B)}function Me(e){if(\",\"==e)return A(be)}function Ae(e,t){if(\"keyword b\"==e&&\"else\"==t)return A(q(\"form\",\"else\"),N,P)}function Ve(e,t){return\"await\"==t?A(Ve):\"(\"==e?A(q(\")\"),Ee,P):void 0}function Ee(e){return\"var\"==e?A(be,ze):\"variable\"==e?A(ze):M(ze)}function ze(e,t){return\")\"==e?A():\";\"==e?A(ze):\"in\"==t||\"of\"==t?(j.marked=\"keyword\",A(W,ze)):M(W,ze)}function Ie(e,t){return\"*\"==t?(j.marked=\"keyword\",A(Ie)):\"variable\"==e?(E(t),A(Ie)):\"(\"==e?A(C,q(\")\"),ae(Ce,\")\"),P,ue,N,O):u&&\"<\"==t?A(q(\">\"),ae(ye,\">\"),P,Ie):void 0}function Te(e,t){return\"*\"==t?(j.marked=\"keyword\",A(Te)):\"variable\"==e?(E(t),A(Te)):\"(\"==e?A(C,q(\")\"),ae(Ce,\")\"),P,ue,O):u&&\"<\"==t?A(q(\">\"),ae(ye,\">\"),P,Te):void 0}function $e(e,t){return\"keyword\"==e||\"variable\"==e?(j.marked=\"type\",A($e)):\"<\"==t?A(q(\">\"),ae(ye,\">\"),P):void 0}function Ce(e,t){return\"@\"==t&&A(W,Ce),\"spread\"==e?A(Ce):u&&z(t)?(j.marked=\"keyword\",A(Ce)):u&&\"this\"==e?A(ce,je):M(xe,ce,je)}function _e(e,t){return\"variable\"==e?Oe(e,t):qe(e,t)}function Oe(e,t){if(\"variable\"==e)return E(t),A(qe)}function qe(e,t){return\"<\"==t?A(q(\">\"),ae(ye,\">\"),P,qe):\"extends\"==t||\"implements\"==t||u&&\",\"==e?(\"implements\"==t&&(j.marked=\"keyword\"),A(u?le:W,qe)):\"{\"==e?A(q(\"}\"),Pe,P):void 0}function Pe(e,t){return\"async\"==e||\"variable\"==e&&(\"static\"==t||\"get\"==t||\"set\"==t||u&&z(t))&&j.stream.match(/^\\s+[\\w$\\xa1-\\uffff]/,!1)?(j.marked=\"keyword\",A(Pe)):\"variable\"==e||\"keyword\"==j.style?(j.marked=\"property\",A(Se,Pe)):\"number\"==e||\"string\"==e?A(Se,Pe):\"[\"==e?A(W,ce,S(\"]\"),Se,Pe):\"*\"==t?(j.marked=\"keyword\",A(Pe)):u&&\"(\"==e?M(Te,Pe):\";\"==e||\",\"==e?A(Pe):\"}\"==e?A():\"@\"==t?A(W,Pe):void 0}function Se(e,t){if(\"?\"==t)return A(Se);if(\":\"==e)return A(le,je);if(\"=\"==t)return A(B);var r=j.state.lexical.prev;return M(r&&\"interface\"==r.info?Te:Ie)}function Ne(e,t){return\"*\"==t?(j.marked=\"keyword\",A(De,S(\";\"))):\"default\"==t?(j.marked=\"keyword\",A(W,S(\";\"))):\"{\"==e?A(ae(Ue,\"}\"),De,S(\";\")):M(N)}function Ue(e,t){return\"as\"==t?(j.marked=\"keyword\",A(S(\"variable\"))):\"variable\"==e?M(B,Ue):void 0}function We(e){return\"string\"==e?A():\"(\"==e?M(W):M(Be,Fe,De)}function Be(e,t){return\"{\"==e?ie(Be,\"}\"):(\"variable\"==e&&E(t),\"*\"==t&&(j.marked=\"keyword\"),A(He))}function Fe(e){if(\",\"==e)return A(Be,Fe)}function He(e,t){if(\"as\"==t)return j.marked=\"keyword\",A(Be)}function De(e,t){if(\"from\"==t)return j.marked=\"keyword\",A(W)}function Ge(e){return\"]\"==e?A():M(ae(B,\"]\"))}function Je(){return M(q(\"form\"),xe,S(\"{\"),q(\"}\"),ae(Ke,\"}\"),P,P)}function Ke(){return M(xe,je)}function Le(e,t,r){return t.tokenize==v&&/^(?:operator|sof|keyword [bcd]|case|new|export|default|spread|[\\[{}\\(,;:]|=>)$/.test(t.lastType)||\"quasi\"==t.lastType&&/\\{\\s*$/.test(e.string.slice(0,e.pos-(r||0)))}return O.lex=!0,P.lex=!0,{startState:function(e){var t={tokenize:v,lastType:\"sof\",cc:[],lexical:new h((e||0)-i,0,\"block\",!1),localVars:r.localVars,context:r.localVars&&new I(null,null,!1),indented:e||0};return r.globalVars&&\"object\"==typeof r.globalVars&&(t.globalVars=r.globalVars),t},token:function(e,t){if(e.sol()&&(t.lexical.hasOwnProperty(\"align\")||(t.lexical.align=!1),t.indented=e.indentation(),b(e,t)),t.tokenize!=k&&e.eatSpace())return null;var r=t.tokenize(e,t);return\"comment\"==n?r:(t.lastType=\"operator\"!=n||\"++\"!=a&&\"--\"!=a?n:\"incdec\",function(e,t,r,n,a){var i=e.cc;for(j.state=e,j.stream=a,j.marked=null,j.cc=i,j.style=t,e.lexical.hasOwnProperty(\"align\")||(e.lexical.align=!0);;)if((i.length?i.pop():s?W:N)(r,n)){for(;i.length&&i[i.length-1].lex;)i.pop()();return j.marked?j.marked:\"variable\"==r&&g(e,n)?\"variable-2\":t}}(t,r,n,a,e))},indent:function(t,n){if(t.tokenize==k)return e.Pass;if(t.tokenize!=v)return 0;var a,c=n&&n.charAt(0),s=t.lexical;if(!/^\\s*else\\b/.test(n))for(var u=t.cc.length-1;u>=0;--u){var f=t.cc[u];if(f==P)s=s.prev;else if(f!=Ae)break}for(;(\"stat\"==s.type||\"form\"==s.type)&&(\"}\"==c||(a=t.cc[t.cc.length-1])&&(a==G||a==J)&&!/^[,\\.=+\\-*:?[\\(]/.test(n));)s=s.prev;o&&\")\"==s.type&&\"stat\"==s.prev.type&&(s=s.prev);var l=s.type,p=c==l;return\"vardef\"==l?s.indented+(\"operator\"==t.lastType||\",\"==t.lastType?s.info.length+1:0):\"form\"==l&&\"{\"==c?s.indented:\"form\"==l?s.indented+i:\"stat\"==l?s.indented+(function(e,t){return\"operator\"==e.lastType||\",\"==e.lastType||d.test(t.charAt(0))||/[,.]/.test(t.charAt(0))}(t,n)?o||i:0):\"switch\"!=s.info||p||0==r.doubleIndentSwitch?s.align?s.column+(p?0:1):s.indented+(p?0:i):s.indented+(/^(?:case|default)\\b/.test(n)?i:2*i)},electricInput:/^\\s*(?:case .*?:|default:|\\{|\\})$/,blockCommentStart:s?null:\"/*\",blockCommentEnd:s?null:\"*/\",blockCommentContinue:s?null:\" * \",lineComment:s?null:\"//\",fold:\"brace\",closeBrackets:\"()[]{}''\\\"\\\"``\",helperType:s?\"json\":\"javascript\",jsonldMode:c,jsonMode:s,expressionAllowed:Le,skipExpression:function(e){var t=e.cc[e.cc.length-1];t!=W&&t!=B||e.cc.pop()}}}),e.registerHelper(\"wordChars\",\"javascript\",/[\\w$]/),e.defineMIME(\"text/javascript\",\"javascript\"),e.defineMIME(\"text/ecmascript\",\"javascript\"),e.defineMIME(\"application/javascript\",\"javascript\"),e.defineMIME(\"application/x-javascript\",\"javascript\"),e.defineMIME(\"application/ecmascript\",\"javascript\"),e.defineMIME(\"application/json\",{name:\"javascript\",json:!0}),e.defineMIME(\"application/x-json\",{name:\"javascript\",json:!0}),e.defineMIME(\"application/ld+json\",{name:\"javascript\",jsonld:!0}),e.defineMIME(\"text/typescript\",{name:\"javascript\",typescript:!0}),e.defineMIME(\"application/typescript\",{name:\"javascript\",typescript:!0})});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/mode/markdown/markdown.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../xml/xml","line":7,"column":98,"nodeType":"CallExpression","endLine":7,"endColumn":119},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../meta","line":7,"column":120,"nodeType":"CallExpression","endLine":7,"endColumn":138}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/mode/markdown/markdown.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(t){\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"../../lib/codemirror\"),require(\"../xml/xml\"),require(\"../meta\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\",\"../xml/xml\",\"../meta\"],t):t(CodeMirror)}(function(t){\"use strict\";t.defineMode(\"markdown\",function(e,i){var n=t.getMode(e,\"text/html\"),u=\"null\"==n.name;void 0===i.highlightFormatting&&(i.highlightFormatting=!1),void 0===i.maxBlockquoteDepth&&(i.maxBlockquoteDepth=0),void 0===i.taskLists&&(i.taskLists=!1),void 0===i.strikethrough&&(i.strikethrough=!1),void 0===i.emoji&&(i.emoji=!1),void 0===i.fencedCodeBlockHighlighting&&(i.fencedCodeBlockHighlighting=!0),void 0===i.fencedCodeBlockDefaultMode&&(i.fencedCodeBlockDefaultMode=\"\"),void 0===i.xml&&(i.xml=!0),void 0===i.tokenTypeOverrides&&(i.tokenTypeOverrides={});var r={header:\"header\",code:\"comment\",quote:\"quote\",list1:\"variable-2\",list2:\"variable-3\",list3:\"keyword\",hr:\"hr\",image:\"image\",imageAltText:\"image-alt-text\",imageMarker:\"image-marker\",formatting:\"formatting\",linkInline:\"link\",linkEmail:\"link\",linkText:\"link\",linkHref:\"string\",em:\"em\",strong:\"strong\",strikethrough:\"strikethrough\",emoji:\"builtin\"};for(var a in r)r.hasOwnProperty(a)&&i.tokenTypeOverrides[a]&&(r[a]=i.tokenTypeOverrides[a]);var l=/^([*\\-_])(?:\\s*\\1){2,}\\s*$/,o=/^(?:[*\\-+]|^[0-9]+([.)]))\\s+/,h=/^\\[(x| )\\](?=\\s)/i,s=i.allowAtxHeaderWithoutSpace?/^(#+)/:/^(#+)(?: |$)/,g=/^ {0,3}(?:\\={1,}|-{2,})\\s*$/,m=/^[^#!\\[\\]*_\\\\<>` \"'(~:]+/,d=/^(~~~+|```+)[ \\t]*([\\w+#-]*)[^\\n`]*$/,f=/^\\s*\\[[^\\]]+?\\]:.*$/,c=/[!\"#$%&'()*+,\\-.\\/:;<=>?@\\[\\\\\\]^_`{|}~\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u0AF0\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E42\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC9\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDF3C-\\uDF3E]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]/;function k(t,e,i){return e.f=e.inline=i,i(t,e)}function F(t,e,i){return e.f=e.block=i,i(t,e)}function D(e){if(e.linkTitle=!1,e.linkHref=!1,e.linkText=!1,e.em=!1,e.strong=!1,e.strikethrough=!1,e.quote=0,e.indentedCode=!1,e.f==E){var i=u;if(!i){var r=t.innerMode(n,e.htmlState);i=\"xml\"==r.mode.name&&null===r.state.tagStart&&!r.state.context&&r.state.tokenize.isInText}i&&(e.f=S,e.block=p,e.htmlState=null)}return e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.prevLine=e.thisLine,e.thisLine={stream:null},null}function p(n,u){var a,m=n.column()===u.indentation,c=!(a=u.prevLine.stream)||!/\\S/.test(a.string),F=u.indentedCode,D=u.prevLine.hr,p=!1!==u.list,E=(u.listStack[u.listStack.length-1]||0)+3;u.indentedCode=!1;var C=u.indentation;if(null===u.indentationDiff&&(u.indentationDiff=u.indentation,p)){for(u.list=null;C<u.listStack[u.listStack.length-1];)u.listStack.pop(),u.listStack.length?u.indentation=u.listStack[u.listStack.length-1]:u.list=!1;!1!==u.list&&(u.indentationDiff=C-u.listStack[u.listStack.length-1])}var S=!(c||D||u.prevLine.header||p&&F||u.prevLine.fencedCodeEnd),v=(!1===u.list||D||c)&&u.indentation<=E&&n.match(l),B=null;if(u.indentationDiff>=4&&(F||u.prevLine.fencedCodeEnd||u.prevLine.header||c))return n.skipToEnd(),u.indentedCode=!0,r.code;if(n.eatSpace())return null;if(m&&u.indentation<=E&&(B=n.match(s))&&B[1].length<=6)return u.quote=0,u.header=B[1].length,u.thisLine.header=!0,i.highlightFormatting&&(u.formatting=\"header\"),u.f=u.inline,A(u);if(u.indentation<=E&&n.eat(\">\"))return u.quote=m?1:u.quote+1,i.highlightFormatting&&(u.formatting=\"quote\"),n.eatSpace(),A(u);if(!v&&!u.setext&&m&&u.indentation<=E&&(B=n.match(o))){var L=B[1]?\"ol\":\"ul\";return u.indentation=C+n.current().length,u.list=!0,u.quote=0,u.listStack.push(u.indentation),u.em=!1,u.strong=!1,u.code=!1,u.strikethrough=!1,i.taskLists&&n.match(h,!1)&&(u.taskList=!0),u.f=u.inline,i.highlightFormatting&&(u.formatting=[\"list\",\"list-\"+L]),A(u)}return m&&u.indentation<=E&&(B=n.match(d,!0))?(u.quote=0,u.fencedEndRE=new RegExp(B[1]+\"+ *$\"),u.localMode=i.fencedCodeBlockHighlighting&&function(i){if(t.findModeByName){var n=t.findModeByName(i);n&&(i=n.mime||n.mimes[0])}var u=t.getMode(e,i);return\"null\"==u.name?null:u}(B[2]||i.fencedCodeBlockDefaultMode),u.localMode&&(u.localState=t.startState(u.localMode)),u.f=u.block=x,i.highlightFormatting&&(u.formatting=\"code-block\"),u.code=-1,A(u)):u.setext||!(S&&p||u.quote||!1!==u.list||u.code||v||f.test(n.string))&&(B=n.lookAhead(1))&&(B=B.match(g))?(u.setext?(u.header=u.setext,u.setext=0,n.skipToEnd(),i.highlightFormatting&&(u.formatting=\"header\")):(u.header=\"=\"==B[0].charAt(0)?1:2,u.setext=u.header),u.thisLine.header=!0,u.f=u.inline,A(u)):v?(n.skipToEnd(),u.hr=!0,u.thisLine.hr=!0,r.hr):\"[\"===n.peek()?k(n,u,T):k(n,u,u.inline)}function E(e,i){var r=n.token(e,i.htmlState);if(!u){var a=t.innerMode(n,i.htmlState);(\"xml\"==a.mode.name&&null===a.state.tagStart&&!a.state.context&&a.state.tokenize.isInText||i.md_inside&&e.current().indexOf(\">\")>-1)&&(i.f=S,i.block=p,i.htmlState=null)}return r}function x(t,e){var n,u=e.listStack[e.listStack.length-1]||0,a=e.indentation<u,l=u+3;return e.fencedEndRE&&e.indentation<=l&&(a||t.match(e.fencedEndRE))?(i.highlightFormatting&&(e.formatting=\"code-block\"),a||(n=A(e)),e.localMode=e.localState=null,e.block=p,e.f=S,e.fencedEndRE=null,e.code=0,e.thisLine.fencedCodeEnd=!0,a?F(t,e,e.block):n):e.localMode?e.localMode.token(t,e.localState):(t.skipToEnd(),r.code)}function A(t){var e=[];if(t.formatting){e.push(r.formatting),\"string\"==typeof t.formatting&&(t.formatting=[t.formatting]);for(var n=0;n<t.formatting.length;n++)e.push(r.formatting+\"-\"+t.formatting[n]),\"header\"===t.formatting[n]&&e.push(r.formatting+\"-\"+t.formatting[n]+\"-\"+t.header),\"quote\"===t.formatting[n]&&(!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=t.quote?e.push(r.formatting+\"-\"+t.formatting[n]+\"-\"+t.quote):e.push(\"error\"))}if(t.taskOpen)return e.push(\"meta\"),e.length?e.join(\" \"):null;if(t.taskClosed)return e.push(\"property\"),e.length?e.join(\" \"):null;if(t.linkHref?e.push(r.linkHref,\"url\"):(t.strong&&e.push(r.strong),t.em&&e.push(r.em),t.strikethrough&&e.push(r.strikethrough),t.emoji&&e.push(r.emoji),t.linkText&&e.push(r.linkText),t.code&&e.push(r.code),t.image&&e.push(r.image),t.imageAltText&&e.push(r.imageAltText,\"link\"),t.imageMarker&&e.push(r.imageMarker)),t.header&&e.push(r.header,r.header+\"-\"+t.header),t.quote&&(e.push(r.quote),!i.maxBlockquoteDepth||i.maxBlockquoteDepth>=t.quote?e.push(r.quote+\"-\"+t.quote):e.push(r.quote+\"-\"+i.maxBlockquoteDepth)),!1!==t.list){var u=(t.listStack.length-1)%3;u?1===u?e.push(r.list2):e.push(r.list3):e.push(r.list1)}return t.trailingSpaceNewLine?e.push(\"trailing-space-new-line\"):t.trailingSpace&&e.push(\"trailing-space-\"+(t.trailingSpace%2?\"a\":\"b\")),e.length?e.join(\" \"):null}function C(t,e){if(t.match(m,!0))return A(e)}function S(e,u){var a=u.text(e,u);if(void 0!==a)return a;if(u.list)return u.list=null,A(u);if(u.taskList)return\" \"===e.match(h,!0)[1]?u.taskOpen=!0:u.taskClosed=!0,i.highlightFormatting&&(u.formatting=\"task\"),u.taskList=!1,A(u);if(u.taskOpen=!1,u.taskClosed=!1,u.header&&e.match(/^#+$/,!0))return i.highlightFormatting&&(u.formatting=\"header\"),A(u);var l=e.next();if(u.linkTitle){u.linkTitle=!1;var o=l;\"(\"===l&&(o=\")\");var s=\"^\\\\s*(?:[^\"+(o=(o+\"\").replace(/([.?*+^\\[\\]\\\\(){}|-])/g,\"\\\\$1\"))+\"\\\\\\\\]+|\\\\\\\\\\\\\\\\|\\\\\\\\.)\"+o;if(e.match(new RegExp(s),!0))return r.linkHref}if(\"`\"===l){var g=u.formatting;i.highlightFormatting&&(u.formatting=\"code\"),e.eatWhile(\"`\");var m=e.current().length;if(0!=u.code||u.quote&&1!=m){if(m==u.code){var d=A(u);return u.code=0,d}return u.formatting=g,A(u)}return u.code=m,A(u)}if(u.code)return A(u);if(\"\\\\\"===l&&(e.next(),i.highlightFormatting)){var f=A(u),k=r.formatting+\"-escape\";return f?f+\" \"+k:k}if(\"!\"===l&&e.match(/\\[[^\\]]*\\] ?(?:\\(|\\[)/,!1))return u.imageMarker=!0,u.image=!0,i.highlightFormatting&&(u.formatting=\"image\"),A(u);if(\"[\"===l&&u.imageMarker&&e.match(/[^\\]]*\\](\\(.*?\\)| ?\\[.*?\\])/,!1))return u.imageMarker=!1,u.imageAltText=!0,i.highlightFormatting&&(u.formatting=\"image\"),A(u);if(\"]\"===l&&u.imageAltText){i.highlightFormatting&&(u.formatting=\"image\");var f=A(u);return u.imageAltText=!1,u.image=!1,u.inline=u.f=B,f}if(\"[\"===l&&!u.image)return u.linkText&&e.match(/^.*?\\]/)?A(u):(u.linkText=!0,i.highlightFormatting&&(u.formatting=\"link\"),A(u));if(\"]\"===l&&u.linkText){i.highlightFormatting&&(u.formatting=\"link\");var f=A(u);return u.linkText=!1,u.inline=u.f=e.match(/\\(.*?\\)| ?\\[.*?\\]/,!1)?B:S,f}if(\"<\"===l&&e.match(/^(https?|ftps?):\\/\\/(?:[^\\\\>]|\\\\.)+>/,!1))return u.f=u.inline=v,i.highlightFormatting&&(u.formatting=\"link\"),(f=A(u))?f+=\" \":f=\"\",f+r.linkInline;if(\"<\"===l&&e.match(/^[^> \\\\]+@(?:[^\\\\>]|\\\\.)+>/,!1))return u.f=u.inline=v,i.highlightFormatting&&(u.formatting=\"link\"),(f=A(u))?f+=\" \":f=\"\",f+r.linkEmail;if(i.xml&&\"<\"===l&&e.match(/^(!--|\\?|!\\[CDATA\\[|[a-z][a-z0-9-]*(?:\\s+[a-z_:.\\-]+(?:\\s*=\\s*[^>]+)?)*\\s*(?:>|$))/i,!1)){var D=e.string.indexOf(\">\",e.pos);if(-1!=D){var p=e.string.substring(e.start,D);/markdown\\s*=\\s*('|\"){0,1}1('|\"){0,1}/.test(p)&&(u.md_inside=!0)}return e.backUp(1),u.htmlState=t.startState(n),F(e,u,E)}if(i.xml&&\"<\"===l&&e.match(/^\\/\\w*?>/))return u.md_inside=!1,\"tag\";if(\"*\"===l||\"_\"===l){for(var x=1,C=1==e.pos?\" \":e.string.charAt(e.pos-2);x<3&&e.eat(l);)x++;var L=e.peek()||\" \",T=!/\\s/.test(L)&&(!c.test(L)||/\\s/.test(C)||c.test(C)),M=!/\\s/.test(C)&&(!c.test(C)||/\\s/.test(L)||c.test(L)),q=null,b=null;if(x%2&&(u.em||!T||\"*\"!==l&&M&&!c.test(C)?u.em!=l||!M||\"*\"!==l&&T&&!c.test(L)||(q=!1):q=!0),x>1&&(u.strong||!T||\"*\"!==l&&M&&!c.test(C)?u.strong!=l||!M||\"*\"!==l&&T&&!c.test(L)||(b=!1):b=!0),null!=b||null!=q){i.highlightFormatting&&(u.formatting=null==q?\"strong\":null==b?\"em\":\"strong em\"),!0===q&&(u.em=l),!0===b&&(u.strong=l);d=A(u);return!1===q&&(u.em=!1),!1===b&&(u.strong=!1),d}}else if(\" \"===l&&(e.eat(\"*\")||e.eat(\"_\"))){if(\" \"===e.peek())return A(u);e.backUp(1)}if(i.strikethrough)if(\"~\"===l&&e.eatWhile(l)){if(u.strikethrough){i.highlightFormatting&&(u.formatting=\"strikethrough\");d=A(u);return u.strikethrough=!1,d}if(e.match(/^[^\\s]/,!1))return u.strikethrough=!0,i.highlightFormatting&&(u.formatting=\"strikethrough\"),A(u)}else if(\" \"===l&&e.match(/^~~/,!0)){if(\" \"===e.peek())return A(u);e.backUp(2)}if(i.emoji&&\":\"===l&&e.match(/^(?:[a-z_\\d+][a-z_\\d+-]*|\\-[a-z_\\d+][a-z_\\d+-]*):/)){u.emoji=!0,i.highlightFormatting&&(u.formatting=\"emoji\");var w=A(u);return u.emoji=!1,w}return\" \"===l&&(e.match(/^ +$/,!1)?u.trailingSpace++:u.trailingSpace&&(u.trailingSpaceNewLine=!0)),A(u)}function v(t,e){if(\">\"===t.next()){e.f=e.inline=S,i.highlightFormatting&&(e.formatting=\"link\");var n=A(e);return n?n+=\" \":n=\"\",n+r.linkInline}return t.match(/^[^>]+/,!0),r.linkInline}function B(t,e){if(t.eatSpace())return null;var n,u=t.next();return\"(\"===u||\"[\"===u?(e.f=e.inline=(n=\"(\"===u?\")\":\"]\",function(t,e){var u=t.next();if(u===n){e.f=e.inline=S,i.highlightFormatting&&(e.formatting=\"link-string\");var r=A(e);return e.linkHref=!1,r}return t.match(L[n]),e.linkHref=!0,A(e)}),i.highlightFormatting&&(e.formatting=\"link-string\"),e.linkHref=!0,A(e)):\"error\"}var L={\")\":/^(?:[^\\\\\\(\\)]|\\\\.|\\((?:[^\\\\\\(\\)]|\\\\.)*\\))*?(?=\\))/,\"]\":/^(?:[^\\\\\\[\\]]|\\\\.|\\[(?:[^\\\\\\[\\]]|\\\\.)*\\])*?(?=\\])/};function T(t,e){return t.match(/^([^\\]\\\\]|\\\\.)*\\]:/,!1)?(e.f=M,t.next(),i.highlightFormatting&&(e.formatting=\"link\"),e.linkText=!0,A(e)):k(t,e,S)}function M(t,e){if(t.match(/^\\]:/,!0)){e.f=e.inline=q,i.highlightFormatting&&(e.formatting=\"link\");var n=A(e);return e.linkText=!1,n}return t.match(/^([^\\]\\\\]|\\\\.)+/,!0),r.linkText}function q(t,e){return t.eatSpace()?null:(t.match(/^[^\\s]+/,!0),void 0===t.peek()?e.linkTitle=!0:t.match(/^(?:\\s+(?:\"(?:[^\"\\\\]|\\\\\\\\|\\\\.)+\"|'(?:[^'\\\\]|\\\\\\\\|\\\\.)+'|\\((?:[^)\\\\]|\\\\\\\\|\\\\.)+\\)))?/,!0),e.f=e.inline=S,r.linkHref+\" url\")}var b={startState:function(){return{f:p,prevLine:{stream:null},thisLine:{stream:null},block:p,htmlState:null,indentation:0,inline:S,text:C,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,code:0,em:!1,strong:!1,header:0,setext:0,hr:!1,taskList:!1,list:!1,listStack:[],quote:0,trailingSpace:0,trailingSpaceNewLine:!1,strikethrough:!1,emoji:!1,fencedEndRE:null}},copyState:function(e){return{f:e.f,prevLine:e.prevLine,thisLine:e.thisLine,block:e.block,htmlState:e.htmlState&&t.copyState(n,e.htmlState),indentation:e.indentation,localMode:e.localMode,localState:e.localMode?t.copyState(e.localMode,e.localState):null,inline:e.inline,text:e.text,formatting:!1,linkText:e.linkText,linkTitle:e.linkTitle,linkHref:e.linkHref,code:e.code,em:e.em,strong:e.strong,strikethrough:e.strikethrough,emoji:e.emoji,header:e.header,setext:e.setext,hr:e.hr,taskList:e.taskList,list:e.list,listStack:e.listStack.slice(0),quote:e.quote,indentedCode:e.indentedCode,trailingSpace:e.trailingSpace,trailingSpaceNewLine:e.trailingSpaceNewLine,md_inside:e.md_inside,fencedEndRE:e.fencedEndRE}},token:function(t,e){if(e.formatting=!1,t!=e.thisLine.stream){if(e.header=0,e.hr=!1,t.match(/^\\s*$/,!0))return D(e),null;if(e.prevLine=e.thisLine,e.thisLine={stream:t},e.taskList=!1,e.trailingSpace=0,e.trailingSpaceNewLine=!1,!e.localState&&(e.f=e.block,e.f!=E)){var i=t.match(/^\\s*/,!0)[0].replace(/\\t/g,\"    \").length;if(e.indentation=i,e.indentationDiff=null,i>0)return null}}return e.f(t,e)},innerMode:function(t){return t.block==E?{state:t.htmlState,mode:n}:t.localState?{state:t.localState,mode:t.localMode}:{state:t,mode:b}},indent:function(e,i,u){return e.block==E&&n.indent?n.indent(e.htmlState,i,u):e.localState&&e.localMode.indent?e.localMode.indent(e.localState,i,u):t.Pass},blankLine:D,getType:A,blockCommentStart:\"\\x3c!--\",blockCommentEnd:\"--\\x3e\",closeBrackets:\"()[]{}''\\\"\\\"``\",fold:\"markdown\"};return b},\"xml\"),t.defineMIME(\"text/markdown\",\"markdown\"),t.defineMIME(\"text/x-markdown\",\"markdown\")});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/mode/meta.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":94}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/mode/meta.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(e){\"object\"==typeof exports&&\"object\"==typeof module?e(require(\"../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../lib/codemirror\"],e):e(CodeMirror)}(function(e){\"use strict\";e.modeInfo=[{name:\"APL\",mime:\"text/apl\",mode:\"apl\",ext:[\"dyalog\",\"apl\"]},{name:\"PGP\",mimes:[\"application/pgp\",\"application/pgp-encrypted\",\"application/pgp-keys\",\"application/pgp-signature\"],mode:\"asciiarmor\",ext:[\"asc\",\"pgp\",\"sig\"]},{name:\"ASN.1\",mime:\"text/x-ttcn-asn\",mode:\"asn.1\",ext:[\"asn\",\"asn1\"]},{name:\"Asterisk\",mime:\"text/x-asterisk\",mode:\"asterisk\",file:/^extensions\\.conf$/i},{name:\"Brainfuck\",mime:\"text/x-brainfuck\",mode:\"brainfuck\",ext:[\"b\",\"bf\"]},{name:\"C\",mime:\"text/x-csrc\",mode:\"clike\",ext:[\"c\",\"h\",\"ino\"]},{name:\"C++\",mime:\"text/x-c++src\",mode:\"clike\",ext:[\"cpp\",\"c++\",\"cc\",\"cxx\",\"hpp\",\"h++\",\"hh\",\"hxx\"],alias:[\"cpp\"]},{name:\"Cobol\",mime:\"text/x-cobol\",mode:\"cobol\",ext:[\"cob\",\"cpy\"]},{name:\"C#\",mime:\"text/x-csharp\",mode:\"clike\",ext:[\"cs\"],alias:[\"csharp\",\"cs\"]},{name:\"Clojure\",mime:\"text/x-clojure\",mode:\"clojure\",ext:[\"clj\",\"cljc\",\"cljx\"]},{name:\"ClojureScript\",mime:\"text/x-clojurescript\",mode:\"clojure\",ext:[\"cljs\"]},{name:\"Closure Stylesheets (GSS)\",mime:\"text/x-gss\",mode:\"css\",ext:[\"gss\"]},{name:\"CMake\",mime:\"text/x-cmake\",mode:\"cmake\",ext:[\"cmake\",\"cmake.in\"],file:/^CMakeLists.txt$/},{name:\"CoffeeScript\",mimes:[\"application/vnd.coffeescript\",\"text/coffeescript\",\"text/x-coffeescript\"],mode:\"coffeescript\",ext:[\"coffee\"],alias:[\"coffee\",\"coffee-script\"]},{name:\"Common Lisp\",mime:\"text/x-common-lisp\",mode:\"commonlisp\",ext:[\"cl\",\"lisp\",\"el\"],alias:[\"lisp\"]},{name:\"Cypher\",mime:\"application/x-cypher-query\",mode:\"cypher\",ext:[\"cyp\",\"cypher\"]},{name:\"Cython\",mime:\"text/x-cython\",mode:\"python\",ext:[\"pyx\",\"pxd\",\"pxi\"]},{name:\"Crystal\",mime:\"text/x-crystal\",mode:\"crystal\",ext:[\"cr\"]},{name:\"CSS\",mime:\"text/css\",mode:\"css\",ext:[\"css\"]},{name:\"CQL\",mime:\"text/x-cassandra\",mode:\"sql\",ext:[\"cql\"]},{name:\"D\",mime:\"text/x-d\",mode:\"d\",ext:[\"d\"]},{name:\"Dart\",mimes:[\"application/dart\",\"text/x-dart\"],mode:\"dart\",ext:[\"dart\"]},{name:\"diff\",mime:\"text/x-diff\",mode:\"diff\",ext:[\"diff\",\"patch\"]},{name:\"Django\",mime:\"text/x-django\",mode:\"django\"},{name:\"Dockerfile\",mime:\"text/x-dockerfile\",mode:\"dockerfile\",file:/^Dockerfile$/},{name:\"DTD\",mime:\"application/xml-dtd\",mode:\"dtd\",ext:[\"dtd\"]},{name:\"Dylan\",mime:\"text/x-dylan\",mode:\"dylan\",ext:[\"dylan\",\"dyl\",\"intr\"]},{name:\"EBNF\",mime:\"text/x-ebnf\",mode:\"ebnf\"},{name:\"ECL\",mime:\"text/x-ecl\",mode:\"ecl\",ext:[\"ecl\"]},{name:\"edn\",mime:\"application/edn\",mode:\"clojure\",ext:[\"edn\"]},{name:\"Eiffel\",mime:\"text/x-eiffel\",mode:\"eiffel\",ext:[\"e\"]},{name:\"Elm\",mime:\"text/x-elm\",mode:\"elm\",ext:[\"elm\"]},{name:\"Embedded Javascript\",mime:\"application/x-ejs\",mode:\"htmlembedded\",ext:[\"ejs\"]},{name:\"Embedded Ruby\",mime:\"application/x-erb\",mode:\"htmlembedded\",ext:[\"erb\"]},{name:\"Erlang\",mime:\"text/x-erlang\",mode:\"erlang\",ext:[\"erl\"]},{name:\"Esper\",mime:\"text/x-esper\",mode:\"sql\"},{name:\"Factor\",mime:\"text/x-factor\",mode:\"factor\",ext:[\"factor\"]},{name:\"FCL\",mime:\"text/x-fcl\",mode:\"fcl\"},{name:\"Forth\",mime:\"text/x-forth\",mode:\"forth\",ext:[\"forth\",\"fth\",\"4th\"]},{name:\"Fortran\",mime:\"text/x-fortran\",mode:\"fortran\",ext:[\"f\",\"for\",\"f77\",\"f90\",\"f95\"]},{name:\"F#\",mime:\"text/x-fsharp\",mode:\"mllike\",ext:[\"fs\"],alias:[\"fsharp\"]},{name:\"Gas\",mime:\"text/x-gas\",mode:\"gas\",ext:[\"s\"]},{name:\"Gherkin\",mime:\"text/x-feature\",mode:\"gherkin\",ext:[\"feature\"]},{name:\"GitHub Flavored Markdown\",mime:\"text/x-gfm\",mode:\"gfm\",file:/^(readme|contributing|history).md$/i},{name:\"Go\",mime:\"text/x-go\",mode:\"go\",ext:[\"go\"]},{name:\"Groovy\",mime:\"text/x-groovy\",mode:\"groovy\",ext:[\"groovy\",\"gradle\"],file:/^Jenkinsfile$/},{name:\"HAML\",mime:\"text/x-haml\",mode:\"haml\",ext:[\"haml\"]},{name:\"Haskell\",mime:\"text/x-haskell\",mode:\"haskell\",ext:[\"hs\"]},{name:\"Haskell (Literate)\",mime:\"text/x-literate-haskell\",mode:\"haskell-literate\",ext:[\"lhs\"]},{name:\"Haxe\",mime:\"text/x-haxe\",mode:\"haxe\",ext:[\"hx\"]},{name:\"HXML\",mime:\"text/x-hxml\",mode:\"haxe\",ext:[\"hxml\"]},{name:\"ASP.NET\",mime:\"application/x-aspx\",mode:\"htmlembedded\",ext:[\"aspx\"],alias:[\"asp\",\"aspx\"]},{name:\"HTML\",mime:\"text/html\",mode:\"htmlmixed\",ext:[\"html\",\"htm\",\"handlebars\",\"hbs\"],alias:[\"xhtml\"]},{name:\"HTTP\",mime:\"message/http\",mode:\"http\"},{name:\"IDL\",mime:\"text/x-idl\",mode:\"idl\",ext:[\"pro\"]},{name:\"Pug\",mime:\"text/x-pug\",mode:\"pug\",ext:[\"jade\",\"pug\"],alias:[\"jade\"]},{name:\"Java\",mime:\"text/x-java\",mode:\"clike\",ext:[\"java\"]},{name:\"Java Server Pages\",mime:\"application/x-jsp\",mode:\"htmlembedded\",ext:[\"jsp\"],alias:[\"jsp\"]},{name:\"JavaScript\",mimes:[\"text/javascript\",\"text/ecmascript\",\"application/javascript\",\"application/x-javascript\",\"application/ecmascript\"],mode:\"javascript\",ext:[\"js\"],alias:[\"ecmascript\",\"js\",\"node\"]},{name:\"JSON\",mimes:[\"application/json\",\"application/x-json\"],mode:\"javascript\",ext:[\"json\",\"map\"],alias:[\"json5\"]},{name:\"JSON-LD\",mime:\"application/ld+json\",mode:\"javascript\",ext:[\"jsonld\"],alias:[\"jsonld\"]},{name:\"JSX\",mime:\"text/jsx\",mode:\"jsx\",ext:[\"jsx\"]},{name:\"Jinja2\",mime:\"text/jinja2\",mode:\"jinja2\",ext:[\"j2\",\"jinja\",\"jinja2\"]},{name:\"Julia\",mime:\"text/x-julia\",mode:\"julia\",ext:[\"jl\"]},{name:\"Kotlin\",mime:\"text/x-kotlin\",mode:\"clike\",ext:[\"kt\"]},{name:\"LESS\",mime:\"text/x-less\",mode:\"css\",ext:[\"less\"]},{name:\"LiveScript\",mime:\"text/x-livescript\",mode:\"livescript\",ext:[\"ls\"],alias:[\"ls\"]},{name:\"Lua\",mime:\"text/x-lua\",mode:\"lua\",ext:[\"lua\"]},{name:\"Markdown\",mime:\"text/x-markdown\",mode:\"markdown\",ext:[\"markdown\",\"md\",\"mkd\"]},{name:\"mIRC\",mime:\"text/mirc\",mode:\"mirc\"},{name:\"MariaDB SQL\",mime:\"text/x-mariadb\",mode:\"sql\"},{name:\"Mathematica\",mime:\"text/x-mathematica\",mode:\"mathematica\",ext:[\"m\",\"nb\",\"wl\",\"wls\"]},{name:\"Modelica\",mime:\"text/x-modelica\",mode:\"modelica\",ext:[\"mo\"]},{name:\"MUMPS\",mime:\"text/x-mumps\",mode:\"mumps\",ext:[\"mps\"]},{name:\"MS SQL\",mime:\"text/x-mssql\",mode:\"sql\"},{name:\"mbox\",mime:\"application/mbox\",mode:\"mbox\",ext:[\"mbox\"]},{name:\"MySQL\",mime:\"text/x-mysql\",mode:\"sql\"},{name:\"Nginx\",mime:\"text/x-nginx-conf\",mode:\"nginx\",file:/nginx.*\\.conf$/i},{name:\"NSIS\",mime:\"text/x-nsis\",mode:\"nsis\",ext:[\"nsh\",\"nsi\"]},{name:\"NTriples\",mimes:[\"application/n-triples\",\"application/n-quads\",\"text/n-triples\"],mode:\"ntriples\",ext:[\"nt\",\"nq\"]},{name:\"Objective-C\",mime:\"text/x-objectivec\",mode:\"clike\",ext:[\"m\"],alias:[\"objective-c\",\"objc\"]},{name:\"Objective-C++\",mime:\"text/x-objectivec++\",mode:\"clike\",ext:[\"mm\"],alias:[\"objective-c++\",\"objc++\"]},{name:\"OCaml\",mime:\"text/x-ocaml\",mode:\"mllike\",ext:[\"ml\",\"mli\",\"mll\",\"mly\"]},{name:\"Octave\",mime:\"text/x-octave\",mode:\"octave\",ext:[\"m\"]},{name:\"Oz\",mime:\"text/x-oz\",mode:\"oz\",ext:[\"oz\"]},{name:\"Pascal\",mime:\"text/x-pascal\",mode:\"pascal\",ext:[\"p\",\"pas\"]},{name:\"PEG.js\",mime:\"null\",mode:\"pegjs\",ext:[\"jsonld\"]},{name:\"Perl\",mime:\"text/x-perl\",mode:\"perl\",ext:[\"pl\",\"pm\"]},{name:\"PHP\",mimes:[\"text/x-php\",\"application/x-httpd-php\",\"application/x-httpd-php-open\"],mode:\"php\",ext:[\"php\",\"php3\",\"php4\",\"php5\",\"php7\",\"phtml\"]},{name:\"Pig\",mime:\"text/x-pig\",mode:\"pig\",ext:[\"pig\"]},{name:\"Plain Text\",mime:\"text/plain\",mode:\"null\",ext:[\"txt\",\"text\",\"conf\",\"def\",\"list\",\"log\"]},{name:\"PLSQL\",mime:\"text/x-plsql\",mode:\"sql\",ext:[\"pls\"]},{name:\"PostgreSQL\",mime:\"text/x-pgsql\",mode:\"sql\"},{name:\"PowerShell\",mime:\"application/x-powershell\",mode:\"powershell\",ext:[\"ps1\",\"psd1\",\"psm1\"]},{name:\"Properties files\",mime:\"text/x-properties\",mode:\"properties\",ext:[\"properties\",\"ini\",\"in\"],alias:[\"ini\",\"properties\"]},{name:\"ProtoBuf\",mime:\"text/x-protobuf\",mode:\"protobuf\",ext:[\"proto\"]},{name:\"Python\",mime:\"text/x-python\",mode:\"python\",ext:[\"BUILD\",\"bzl\",\"py\",\"pyw\"],file:/^(BUCK|BUILD)$/},{name:\"Puppet\",mime:\"text/x-puppet\",mode:\"puppet\",ext:[\"pp\"]},{name:\"Q\",mime:\"text/x-q\",mode:\"q\",ext:[\"q\"]},{name:\"R\",mime:\"text/x-rsrc\",mode:\"r\",ext:[\"r\",\"R\"],alias:[\"rscript\"]},{name:\"reStructuredText\",mime:\"text/x-rst\",mode:\"rst\",ext:[\"rst\"],alias:[\"rst\"]},{name:\"RPM Changes\",mime:\"text/x-rpm-changes\",mode:\"rpm\"},{name:\"RPM Spec\",mime:\"text/x-rpm-spec\",mode:\"rpm\",ext:[\"spec\"]},{name:\"Ruby\",mime:\"text/x-ruby\",mode:\"ruby\",ext:[\"rb\"],alias:[\"jruby\",\"macruby\",\"rake\",\"rb\",\"rbx\"]},{name:\"Rust\",mime:\"text/x-rustsrc\",mode:\"rust\",ext:[\"rs\"]},{name:\"SAS\",mime:\"text/x-sas\",mode:\"sas\",ext:[\"sas\"]},{name:\"Sass\",mime:\"text/x-sass\",mode:\"sass\",ext:[\"sass\"]},{name:\"Scala\",mime:\"text/x-scala\",mode:\"clike\",ext:[\"scala\"]},{name:\"Scheme\",mime:\"text/x-scheme\",mode:\"scheme\",ext:[\"scm\",\"ss\"]},{name:\"SCSS\",mime:\"text/x-scss\",mode:\"css\",ext:[\"scss\"]},{name:\"Shell\",mimes:[\"text/x-sh\",\"application/x-sh\"],mode:\"shell\",ext:[\"sh\",\"ksh\",\"bash\"],alias:[\"bash\",\"sh\",\"zsh\"],file:/^PKGBUILD$/},{name:\"Sieve\",mime:\"application/sieve\",mode:\"sieve\",ext:[\"siv\",\"sieve\"]},{name:\"Slim\",mimes:[\"text/x-slim\",\"application/x-slim\"],mode:\"slim\",ext:[\"slim\"]},{name:\"Smalltalk\",mime:\"text/x-stsrc\",mode:\"smalltalk\",ext:[\"st\"]},{name:\"Smarty\",mime:\"text/x-smarty\",mode:\"smarty\",ext:[\"tpl\"]},{name:\"Solr\",mime:\"text/x-solr\",mode:\"solr\"},{name:\"SML\",mime:\"text/x-sml\",mode:\"mllike\",ext:[\"sml\",\"sig\",\"fun\",\"smackspec\"]},{name:\"Soy\",mime:\"text/x-soy\",mode:\"soy\",ext:[\"soy\"],alias:[\"closure template\"]},{name:\"SPARQL\",mime:\"application/sparql-query\",mode:\"sparql\",ext:[\"rq\",\"sparql\"],alias:[\"sparul\"]},{name:\"Spreadsheet\",mime:\"text/x-spreadsheet\",mode:\"spreadsheet\",alias:[\"excel\",\"formula\"]},{name:\"SQL\",mime:\"text/x-sql\",mode:\"sql\",ext:[\"sql\"]},{name:\"SQLite\",mime:\"text/x-sqlite\",mode:\"sql\"},{name:\"Squirrel\",mime:\"text/x-squirrel\",mode:\"clike\",ext:[\"nut\"]},{name:\"Stylus\",mime:\"text/x-styl\",mode:\"stylus\",ext:[\"styl\"]},{name:\"Swift\",mime:\"text/x-swift\",mode:\"swift\",ext:[\"swift\"]},{name:\"sTeX\",mime:\"text/x-stex\",mode:\"stex\"},{name:\"LaTeX\",mime:\"text/x-latex\",mode:\"stex\",ext:[\"text\",\"ltx\",\"tex\"],alias:[\"tex\"]},{name:\"SystemVerilog\",mime:\"text/x-systemverilog\",mode:\"verilog\",ext:[\"v\",\"sv\",\"svh\"]},{name:\"Tcl\",mime:\"text/x-tcl\",mode:\"tcl\",ext:[\"tcl\"]},{name:\"Textile\",mime:\"text/x-textile\",mode:\"textile\",ext:[\"textile\"]},{name:\"TiddlyWiki\",mime:\"text/x-tiddlywiki\",mode:\"tiddlywiki\"},{name:\"Tiki wiki\",mime:\"text/tiki\",mode:\"tiki\"},{name:\"TOML\",mime:\"text/x-toml\",mode:\"toml\",ext:[\"toml\"]},{name:\"Tornado\",mime:\"text/x-tornado\",mode:\"tornado\"},{name:\"troff\",mime:\"text/troff\",mode:\"troff\",ext:[\"1\",\"2\",\"3\",\"4\",\"5\",\"6\",\"7\",\"8\",\"9\"]},{name:\"TTCN\",mime:\"text/x-ttcn\",mode:\"ttcn\",ext:[\"ttcn\",\"ttcn3\",\"ttcnpp\"]},{name:\"TTCN_CFG\",mime:\"text/x-ttcn-cfg\",mode:\"ttcn-cfg\",ext:[\"cfg\"]},{name:\"Turtle\",mime:\"text/turtle\",mode:\"turtle\",ext:[\"ttl\"]},{name:\"TypeScript\",mime:\"application/typescript\",mode:\"javascript\",ext:[\"ts\"],alias:[\"ts\"]},{name:\"TypeScript-JSX\",mime:\"text/typescript-jsx\",mode:\"jsx\",ext:[\"tsx\"],alias:[\"tsx\"]},{name:\"Twig\",mime:\"text/x-twig\",mode:\"twig\"},{name:\"Web IDL\",mime:\"text/x-webidl\",mode:\"webidl\",ext:[\"webidl\"]},{name:\"VB.NET\",mime:\"text/x-vb\",mode:\"vb\",ext:[\"vb\"]},{name:\"VBScript\",mime:\"text/vbscript\",mode:\"vbscript\",ext:[\"vbs\"]},{name:\"Velocity\",mime:\"text/velocity\",mode:\"velocity\",ext:[\"vtl\"]},{name:\"Verilog\",mime:\"text/x-verilog\",mode:\"verilog\",ext:[\"v\"]},{name:\"VHDL\",mime:\"text/x-vhdl\",mode:\"vhdl\",ext:[\"vhd\",\"vhdl\"]},{name:\"Vue.js Component\",mimes:[\"script/x-vue\",\"text/x-vue\"],mode:\"vue\",ext:[\"vue\"]},{name:\"XML\",mimes:[\"application/xml\",\"text/xml\"],mode:\"xml\",ext:[\"xml\",\"xsl\",\"xsd\",\"svg\"],alias:[\"rss\",\"wsdl\",\"xsd\"]},{name:\"XQuery\",mime:\"application/xquery\",mode:\"xquery\",ext:[\"xy\",\"xquery\"]},{name:\"Yacas\",mime:\"text/x-yacas\",mode:\"yacas\",ext:[\"ys\"]},{name:\"YAML\",mimes:[\"text/x-yaml\",\"text/yaml\"],mode:\"yaml\",ext:[\"yaml\",\"yml\"],alias:[\"yml\"]},{name:\"Z80\",mime:\"text/x-z80\",mode:\"z80\",ext:[\"z80\"]},{name:\"mscgen\",mime:\"text/x-mscgen\",mode:\"mscgen\",ext:[\"mscgen\",\"mscin\",\"msc\"]},{name:\"xu\",mime:\"text/x-xu\",mode:\"mscgen\",ext:[\"xu\"]},{name:\"msgenny\",mime:\"text/x-msgenny\",mode:\"mscgen\",ext:[\"msgenny\"]}];for(var m=0;m<e.modeInfo.length;m++){var t=e.modeInfo[m];t.mimes&&(t.mime=t.mimes[0])}e.findModeByMIME=function(m){m=m.toLowerCase();for(var t=0;t<e.modeInfo.length;t++){var a=e.modeInfo[t];if(a.mime==m)return a;if(a.mimes)for(var i=0;i<a.mimes.length;i++)if(a.mimes[i]==m)return a}return/\\+xml$/.test(m)?e.findModeByMIME(\"application/xml\"):/\\+json$/.test(m)?e.findModeByMIME(\"application/json\"):void 0},e.findModeByExtension=function(m){m=m.toLowerCase();for(var t=0;t<e.modeInfo.length;t++){var a=e.modeInfo[t];if(a.ext)for(var i=0;i<a.ext.length;i++)if(a.ext[i]==m)return a}},e.findModeByFileName=function(m){for(var t=0;t<e.modeInfo.length;t++){var a=e.modeInfo[t];if(a.file&&a.file.test(m))return a}var i=m.lastIndexOf(\".\"),x=i>-1&&m.substring(i+1,m.length);if(x)return e.findModeByExtension(x)},e.findModeByName=function(m){m=m.toLowerCase();for(var t=0;t<e.modeInfo.length;t++){var a=e.modeInfo[t];if(a.name.toLowerCase()==m)return a;if(a.alias)for(var i=0;i<a.alias.length;i++)if(a.alias[i].toLowerCase()==m)return a}}});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/mode/stex/stex.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/mode/stex/stex.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(t){\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],t):t(CodeMirror)}(function(t){\"use strict\";t.defineMode(\"stex\",function(t,e){function n(t,e){t.cmdState.push(e)}function r(t){return t.cmdState.length>0?t.cmdState[t.cmdState.length-1]:null}function i(t,e,n){return function(){this.name=t,this.bracketNo=0,this.style=e,this.styles=n,this.argument=null,this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null},this.openBracket=function(){return this.bracketNo++,\"bracket\"},this.closeBracket=function(){}}}var a={};function c(t,e){t.f=e}function o(t,e){var i;if(t.match(/^\\\\[a-zA-Z@]+/)){var o=t.current().slice(1);return n(e,i=new(i=a.hasOwnProperty(o)?a[o]:a.DEFAULT)),c(e,f),i.style}if(t.match(/^\\\\[$&%#{}_]/))return\"tag\";if(t.match(/^\\\\[,;!\\/\\\\]/))return\"tag\";if(t.match(\"\\\\[\"))return c(e,function(t,e){return u(t,e,\"\\\\]\")}),\"keyword\";if(t.match(\"\\\\(\"))return c(e,function(t,e){return u(t,e,\"\\\\)\")}),\"keyword\";if(t.match(\"$$\"))return c(e,function(t,e){return u(t,e,\"$$\")}),\"keyword\";if(t.match(\"$\"))return c(e,function(t,e){return u(t,e,\"$\")}),\"keyword\";var m=t.next();return\"%\"==m?(t.skipToEnd(),\"comment\"):\"}\"==m||\"]\"==m?(i=r(e))?(i.closeBracket(m),c(e,f),\"bracket\"):\"error\":\"{\"==m||\"[\"==m?(n(e,i=new(i=a.DEFAULT)),\"bracket\"):/\\d/.test(m)?(t.eatWhile(/[\\w.%]/),\"atom\"):(t.eatWhile(/[\\w\\-_]/),\"begin\"==(i=function(t){for(var e=t.cmdState,n=e.length-1;n>=0;n--){var r=e[n];if(\"DEFAULT\"!=r.name)return r}return{styleIdentifier:function(){return null}}}(e)).name&&(i.argument=t.current()),i.styleIdentifier())}function u(t,e,n){if(t.eatSpace())return null;if(n&&t.match(n))return c(e,o),\"keyword\";if(t.match(/^\\\\[a-zA-Z@]+/))return\"tag\";if(t.match(/^[a-zA-Z]+/))return\"variable-2\";if(t.match(/^\\\\[$&%#{}_]/))return\"tag\";if(t.match(/^\\\\[,;!\\/]/))return\"tag\";if(t.match(/^[\\^_&]/))return\"tag\";if(t.match(/^[+\\-<>|=,\\/@!*:;'\"`~#?]/))return null;if(t.match(/^(\\d+\\.\\d*|\\d*\\.\\d+|\\d+)/))return\"number\";var r=t.next();return\"{\"==r||\"}\"==r||\"[\"==r||\"]\"==r||\"(\"==r||\")\"==r?\"bracket\":\"%\"==r?(t.skipToEnd(),\"comment\"):\"error\"}function f(t,e){var n=t.peek();return\"{\"==n||\"[\"==n?(r(e).openBracket(n),t.eat(n),c(e,o),\"bracket\"):/[ \\t\\r]/.test(n)?(t.eat(n),null):(c(e,o),function(t){var e=t.cmdState.pop();e&&e.closeBracket()}(e),o(t,e))}return a.importmodule=i(\"importmodule\",\"tag\",[\"string\",\"builtin\"]),a.documentclass=i(\"documentclass\",\"tag\",[\"\",\"atom\"]),a.usepackage=i(\"usepackage\",\"tag\",[\"atom\"]),a.begin=i(\"begin\",\"tag\",[\"atom\"]),a.end=i(\"end\",\"tag\",[\"atom\"]),a.label=i(\"label\",\"tag\",[\"atom\"]),a.ref=i(\"ref\",\"tag\",[\"atom\"]),a.eqref=i(\"eqref\",\"tag\",[\"atom\"]),a.cite=i(\"cite\",\"tag\",[\"atom\"]),a.bibitem=i(\"bibitem\",\"tag\",[\"atom\"]),a.Bibitem=i(\"Bibitem\",\"tag\",[\"atom\"]),a.RBibitem=i(\"RBibitem\",\"tag\",[\"atom\"]),a.DEFAULT=function(){this.name=\"DEFAULT\",this.style=\"tag\",this.styleIdentifier=this.openBracket=this.closeBracket=function(){}},{startState:function(){return{cmdState:[],f:e.inMathMode?function(t,e){return u(t,e)}:o}},copyState:function(t){return{cmdState:t.cmdState.slice(),f:t.f}},token:function(t,e){return e.f(t,e)},blankLine:function(t){t.f=o,t.cmdState.length=0},lineComment:\"%\"}}),t.defineMIME(\"text/x-stex\",\"stex\"),t.defineMIME(\"text/x-latex\",\"stex\")});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/mode/xml/xml.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/mode/xml/xml.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(t){\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],t):t(CodeMirror)}(function(t){\"use strict\";var e={autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0,menuitem:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0},n={autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,allowMissingTagName:!1,caseFold:!1};t.defineMode(\"xml\",function(r,o){var a,i,l=r.indentUnit,u={},c=o.htmlMode?e:n;for(var d in c)u[d]=c[d];for(var d in o)u[d]=o[d];function s(t,e){function n(n){return e.tokenize=n,n(t,e)}var r=t.next();return\"<\"==r?t.eat(\"!\")?t.eat(\"[\")?t.match(\"CDATA[\")?n(m(\"atom\",\"]]>\")):null:t.match(\"--\")?n(m(\"comment\",\"--\\x3e\")):t.match(\"DOCTYPE\",!0,!0)?(t.eatWhile(/[\\w\\._\\-]/),n(function t(e){return function(n,r){for(var o;null!=(o=n.next());){if(\"<\"==o)return r.tokenize=t(e+1),r.tokenize(n,r);if(\">\"==o){if(1==e){r.tokenize=s;break}return r.tokenize=t(e-1),r.tokenize(n,r)}}return\"meta\"}}(1))):null:t.eat(\"?\")?(t.eatWhile(/[\\w\\._\\-]/),e.tokenize=m(\"meta\",\"?>\"),\"meta\"):(a=t.eat(\"/\")?\"closeTag\":\"openTag\",e.tokenize=f,\"tag bracket\"):\"&\"==r?(t.eat(\"#\")?t.eat(\"x\")?t.eatWhile(/[a-fA-F\\d]/)&&t.eat(\";\"):t.eatWhile(/[\\d]/)&&t.eat(\";\"):t.eatWhile(/[\\w\\.\\-:]/)&&t.eat(\";\"))?\"atom\":\"error\":(t.eatWhile(/[^&<]/),null)}function f(t,e){var n,r,o=t.next();if(\">\"==o||\"/\"==o&&t.eat(\">\"))return e.tokenize=s,a=\">\"==o?\"endTag\":\"selfcloseTag\",\"tag bracket\";if(\"=\"==o)return a=\"equals\",null;if(\"<\"==o){e.tokenize=s,e.state=x,e.tagName=e.tagStart=null;var i=e.tokenize(t,e);return i?i+\" tag error\":\"tag error\"}return/[\\'\\\"]/.test(o)?(e.tokenize=(n=o,(r=function(t,e){for(;!t.eol();)if(t.next()==n){e.tokenize=f;break}return\"string\"}).isInAttribute=!0,r),e.stringStartCol=t.column(),e.tokenize(t,e)):(t.match(/^[^\\s\\u00a0=<>\\\"\\']*[^\\s\\u00a0=<>\\\"\\'\\/]/),\"word\")}function m(t,e){return function(n,r){for(;!n.eol();){if(n.match(e)){r.tokenize=s;break}n.next()}return t}}function g(t,e,n){this.prev=t.context,this.tagName=e,this.indent=t.indented,this.startOfLine=n,(u.doNotIndent.hasOwnProperty(e)||t.context&&t.context.noIndent)&&(this.noIndent=!0)}function p(t){t.context&&(t.context=t.context.prev)}function h(t,e){for(var n;;){if(!t.context)return;if(n=t.context.tagName,!u.contextGrabbers.hasOwnProperty(n)||!u.contextGrabbers[n].hasOwnProperty(e))return;p(t)}}function x(t,e,n){return\"openTag\"==t?(n.tagStart=e.column(),b):\"closeTag\"==t?k:x}function b(t,e,n){return\"word\"==t?(n.tagName=e.current(),i=\"tag\",N):u.allowMissingTagName&&\"endTag\"==t?(i=\"tag bracket\",N(t,e,n)):(i=\"error\",b)}function k(t,e,n){if(\"word\"==t){var r=e.current();return n.context&&n.context.tagName!=r&&u.implicitlyClosed.hasOwnProperty(n.context.tagName)&&p(n),n.context&&n.context.tagName==r||!1===u.matchClosing?(i=\"tag\",w):(i=\"tag error\",v)}return u.allowMissingTagName&&\"endTag\"==t?(i=\"tag bracket\",w(t,e,n)):(i=\"error\",v)}function w(t,e,n){return\"endTag\"!=t?(i=\"error\",w):(p(n),x)}function v(t,e,n){return i=\"error\",w(t,0,n)}function N(t,e,n){if(\"word\"==t)return i=\"attribute\",T;if(\"endTag\"==t||\"selfcloseTag\"==t){var r=n.tagName,o=n.tagStart;return n.tagName=n.tagStart=null,\"selfcloseTag\"==t||u.autoSelfClosers.hasOwnProperty(r)?h(n,r):(h(n,r),n.context=new g(n,r,o==n.indented)),x}return i=\"error\",N}function T(t,e,n){return\"equals\"==t?y:(u.allowMissing||(i=\"error\"),N(t,0,n))}function y(t,e,n){return\"string\"==t?z:\"word\"==t&&u.allowUnquoted?(i=\"string\",N):(i=\"error\",N(t,0,n))}function z(t,e,n){return\"string\"==t?z:N(t,0,n)}return s.isInText=!0,{startState:function(t){var e={tokenize:s,state:x,indented:t||0,tagName:null,tagStart:null,context:null};return null!=t&&(e.baseIndent=t),e},token:function(t,e){if(!e.tagName&&t.sol()&&(e.indented=t.indentation()),t.eatSpace())return null;a=null;var n=e.tokenize(t,e);return(n||a)&&\"comment\"!=n&&(i=null,e.state=e.state(a||n,t,e),i&&(n=\"error\"==i?n+\" error\":i)),n},indent:function(e,n,r){var o=e.context;if(e.tokenize.isInAttribute)return e.tagStart==e.indented?e.stringStartCol+1:e.indented+l;if(o&&o.noIndent)return t.Pass;if(e.tokenize!=f&&e.tokenize!=s)return r?r.match(/^(\\s*)/)[0].length:0;if(e.tagName)return!1!==u.multilineTagIndentPastTag?e.tagStart+e.tagName.length+2:e.tagStart+l*(u.multilineTagIndentFactor||1);if(u.alignCDATA&&/<!\\[CDATA\\[/.test(n))return 0;var a=n&&/^<(\\/)?([\\w_:\\.-]*)/.exec(n);if(a&&a[1])for(;o;){if(o.tagName==a[2]){o=o.prev;break}if(!u.implicitlyClosed.hasOwnProperty(o.tagName))break;o=o.prev}else if(a)for(;o;){var i=u.contextGrabbers[o.tagName];if(!i||!i.hasOwnProperty(a[2]))break;o=o.prev}for(;o&&o.prev&&!o.startOfLine;)o=o.prev;return o?o.indent+l:e.baseIndent||0},electricInput:/<\\/[\\s\\w:]+>$/,blockCommentStart:\"\\x3c!--\",blockCommentEnd:\"--\\x3e\",configuration:u.htmlMode?\"html\":\"xml\",helperType:u.htmlMode?\"html\":\"xml\",skipAttribute:function(t){t.state==y&&(t.state=N)},xmlCurrentTag:function(t){return t.tagName?{name:t.tagName,close:\"closeTag\"==t.type}:null},xmlCurrentContext:function(t){for(var e=[],n=t.context;n;n=n.prev)n.tagName&&e.push(n.tagName);return e.reverse()}}}),t.defineMIME(\"text/xml\",\"xml\"),t.defineMIME(\"application/xml\",\"xml\"),t.mimeModes.hasOwnProperty(\"text/html\")||t.defineMIME(\"text/html\",{name:\"xml\",htmlMode:!0})});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/codemirror/mode/yaml/yaml.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":7,"column":66,"nodeType":"CallExpression","endLine":7,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * Minified by jsDelivr using Terser v3.14.1.\n * Original file: /npm/codemirror@5.54.0/mode/yaml/yaml.js\n *\n * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files\n */\n!function(e){\"object\"==typeof exports&&\"object\"==typeof module?e(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],e):e(CodeMirror)}(function(e){\"use strict\";e.defineMode(\"yaml\",function(){var e=new RegExp(\"\\\\b((\"+[\"true\",\"false\",\"on\",\"off\",\"yes\",\"no\"].join(\")|(\")+\"))$\",\"i\");return{token:function(i,t){var r=i.peek(),n=t.escaped;if(t.escaped=!1,\"#\"==r&&(0==i.pos||/\\s/.test(i.string.charAt(i.pos-1))))return i.skipToEnd(),\"comment\";if(i.match(/^('([^']|\\\\.)*'?|\"([^\"]|\\\\.)*\"?)/))return\"string\";if(t.literal&&i.indentation()>t.keyCol)return i.skipToEnd(),\"string\";if(t.literal&&(t.literal=!1),i.sol()){if(t.keyCol=0,t.pair=!1,t.pairStart=!1,i.match(/---/))return\"def\";if(i.match(/\\.\\.\\./))return\"def\";if(i.match(/\\s*-\\s+/))return\"meta\"}if(i.match(/^(\\{|\\}|\\[|\\])/))return\"{\"==r?t.inlinePairs++:\"}\"==r?t.inlinePairs--:\"[\"==r?t.inlineList++:t.inlineList--,\"meta\";if(t.inlineList>0&&!n&&\",\"==r)return i.next(),\"meta\";if(t.inlinePairs>0&&!n&&\",\"==r)return t.keyCol=0,t.pair=!1,t.pairStart=!1,i.next(),\"meta\";if(t.pairStart){if(i.match(/^\\s*(\\||\\>)\\s*/))return t.literal=!0,\"meta\";if(i.match(/^\\s*(\\&|\\*)[a-z0-9\\._-]+\\b/i))return\"variable-2\";if(0==t.inlinePairs&&i.match(/^\\s*-?[0-9\\.\\,]+\\s?$/))return\"number\";if(t.inlinePairs>0&&i.match(/^\\s*-?[0-9\\.\\,]+\\s?(?=(,|}))/))return\"number\";if(i.match(e))return\"keyword\"}return!t.pair&&i.match(/^\\s*(?:[,\\[\\]{}&*!|>'\"%@`][^\\s'\":]|[^,\\[\\]{}#&*!|>'\"%@`])[^#]*?(?=\\s*:($|\\s))/)?(t.pair=!0,t.keyCol=i.indentation(),\"atom\"):t.pair&&i.match(/^:\\s*/)?(t.pairStart=!0,\"meta\"):(t.pairStart=!1,t.escaped=\"\\\\\"==r,i.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},lineComment:\"#\",fold:\"indent\"}}),e.defineMIME(\"text/x-yaml\",\"yaml\"),e.defineMIME(\"text/yaml\",\"yaml\")});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/emojione/extras/js/complete-emoji.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror","line":1,"column":74,"nodeType":"CallExpression","endLine":1,"endColumn":95},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"hypermd/addon/fold-emoji","line":1,"column":96,"nodeType":"CallExpression","endLine":1,"endColumn":131},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/hint/show-hint","line":1,"column":132,"nodeType":"CallExpression","endLine":1,"endColumn":174},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"codemirror/addon/hint/show-hint.css","line":1,"column":175,"nodeType":"CallExpression","endLine":1,"endColumn":221}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"!function(e){\"object\"==typeof exports&&\"object\"==typeof module?e(exports,require(\"codemirror\"),require(\"hypermd/addon/fold-emoji\"),require(\"codemirror/addon/hint/show-hint\"),require(\"codemirror/addon/hint/show-hint.css\")):\"function\"==typeof define&&define.amd?define([\"exports\",\"codemirror\",\"hypermd/addon/fold-emoji\",\"codemirror/addon/hint/show-hint\",\"codemirror/addon/hint/show-hint.css\"],e):e(this.CompleteEmoji={},CodeMirror,HyperMD.FoldEmoji)}(function(e,o,t){e.createHintFunc=function(){var e=null,r=t.defaultDict,i=!1,n=document.createElement(\"div\");return n.setAttribute(\"class\",\"CodeMirror-hints HyperMD-complete-preview\"),function(t,i){e=t;for(var n=t.getCursor(),c=t.getLine(n.line),m=n.ch,s=n.ch;m&&/[-\\w:]/.test(c.charAt(m-1));)--m;for(;s<c.length&&/[-\\w:]/.test(c.charAt(s));)++s;if(m===s)return d(),null;var h=c.slice(m,n.ch).toLowerCase(),a=0===h.length,f=[r],u=(e.getOption(\"hmdFoldEmoji\")||{}).myEmoji;u&&f.push(u);for(var p={list:[],from:o.Pos(n.line,m),to:o.Pos(n.line,s)},y=p.list,v=0;v<f.length;v++){var j=f[v];if(j)for(var C in j)(a||C.slice(0,h.length)===h)&&y.push(C)}return o.on(p,\"select\",l),o.on(p,\"close\",d),p};function d(){i&&(document.body.removeChild(n),i=!1)}function l(o,l){var c=t.getAddon(e),m=o in c.myEmoji&&c.myEmoji[o](o)||c.emojiRenderer(o)||document.createTextNode(r[o])||null;if(m){i||(i=!0,document.body.appendChild(n));var s=n.firstChild;s&&n.removeChild(s),n.appendChild(m);var h=l.parentElement.style,a=n.style;a.left=Number.parseFloat(h.left)+l.parentElement.offsetWidth+\"px\",a.top=h.top}else d()}}});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/emojione/index.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/marked/lib/marked.min.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/show-hint/show-hint.min.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/codemirror","line":4,"column":66,"nodeType":"CallExpression","endLine":4,"endColumn":97}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// CodeMirror, copyright (c) by Marijn Haverbeke and others\n// Distributed under an MIT license: https://codemirror.net/LICENSE\n\n!function(t){\"object\"==typeof exports&&\"object\"==typeof module?t(require(\"../../lib/codemirror\")):\"function\"==typeof define&&define.amd?define([\"../../lib/codemirror\"],t):t(CodeMirror)}(function(t){\"use strict\";var i=\"CodeMirror-hint\",e=\"CodeMirror-hint-active\";function n(t,i){this.cm=t,this.options=i,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor(\"start\"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var e=this;t.on(\"cursorActivity\",this.activityFunc=function(){e.cursorActivity()})}t.showHint=function(t,i,e){if(!i)return t.showHint(e);e&&e.async&&(i.async=!0);var n={hint:i};if(e)for(var o in e)n[o]=e[o];return t.showHint(n)},t.defineExtension(\"showHint\",function(i){i=function(t,i,e){var n=t.options.hintOptions,o={};for(var s in a)o[s]=a[s];if(n)for(var s in n)void 0!==n[s]&&(o[s]=n[s]);if(e)for(var s in e)void 0!==e[s]&&(o[s]=e[s]);o.hint.resolve&&(o.hint=o.hint.resolve(t,i));return o}(this,this.getCursor(\"start\"),i);var e=this.listSelections();if(!(e.length>1)){if(this.somethingSelected()){if(!i.hint.supportsSelection)return;for(var o=0;o<e.length;o++)if(e[o].head.line!=e[o].anchor.line)return}this.state.completionActive&&this.state.completionActive.close();var s=this.state.completionActive=new n(this,i);s.options.hint&&(t.signal(this,\"startCompletion\",this),s.update(!0))}}),t.defineExtension(\"closeHint\",function(){this.state.completionActive&&this.state.completionActive.close()});var o=window.requestAnimationFrame||function(t){return setTimeout(t,1e3/60)},s=window.cancelAnimationFrame||clearTimeout;function c(t){return\"string\"==typeof t?t:t.text}function r(t,i){for(;i&&i!=t;){if(\"LI\"===i.nodeName.toUpperCase()&&i.parentNode==t)return i;i=i.parentNode}}function l(n,o){this.completion=n,this.data=o,this.picked=!1;var s=this,l=n.cm,h=l.getInputField().ownerDocument,a=h.defaultView||h.parentWindow,f=this.hints=h.createElement(\"ul\"),u=n.cm.options.theme;f.className=\"CodeMirror-hints \"+u,this.selectedHint=o.selectedHint||0;for(var p=o.list,d=0;d<p.length;++d){var m=f.appendChild(h.createElement(\"li\")),g=p[d],v=i+(d!=this.selectedHint?\"\":\" \"+e);null!=g.className&&(v=g.className+\" \"+v),m.className=v,g.render?g.render(m,o,g):m.appendChild(h.createTextNode(g.displayText||c(g))),m.hintId=d}var y=n.options.container||h.body,w=l.cursorCoords(n.options.alignWithWord?o.from:null),H=w.left,C=w.bottom,b=!0,k=0,A=0;if(y!==h.body){var x=-1!==[\"absolute\",\"relative\",\"fixed\"].indexOf(a.getComputedStyle(y).position)?y:y.offsetParent,T=x.getBoundingClientRect(),S=h.body.getBoundingClientRect();k=T.left-S.left-x.scrollLeft,A=T.top-S.top-x.scrollTop}f.style.left=H-k+\"px\",f.style.top=C-A+\"px\";var F=a.innerWidth||Math.max(h.body.offsetWidth,h.documentElement.offsetWidth),M=a.innerHeight||Math.max(h.body.offsetHeight,h.documentElement.offsetHeight);y.appendChild(f);var N=f.getBoundingClientRect(),E=N.bottom-M,O=f.scrollHeight>f.clientHeight+1,P=l.getScrollInfo();if(E>0){var W=N.bottom-N.top;if(w.top-(w.bottom-N.top)-W>0)f.style.top=(C=w.top-W-A)+\"px\",b=!1;else if(W>M){f.style.height=M-5+\"px\",f.style.top=(C=w.bottom-N.top-A)+\"px\";var I=l.getCursor();o.from.ch!=I.ch&&(w=l.cursorCoords(I),f.style.left=(H=w.left-k)+\"px\",N=f.getBoundingClientRect())}}var B,K=N.right-F;if(K>0&&(N.right-N.left>F&&(f.style.width=F-5+\"px\",K-=N.right-N.left-F),f.style.left=(H=w.left-K-k)+\"px\"),O)for(var L=f.firstChild;L;L=L.nextSibling)L.style.paddingRight=l.display.nativeBarWidth+\"px\";(l.addKeyMap(this.keyMap=function(t,i){var e={Up:function(){i.moveFocus(-1)},Down:function(){i.moveFocus(1)},PageUp:function(){i.moveFocus(1-i.menuSize(),!0)},PageDown:function(){i.moveFocus(i.menuSize()-1,!0)},Home:function(){i.setFocus(0)},End:function(){i.setFocus(i.length-1)},Enter:i.pick,Tab:i.pick,Esc:i.close};/Mac/.test(navigator.platform)&&(e[\"Ctrl-P\"]=function(){i.moveFocus(-1)},e[\"Ctrl-N\"]=function(){i.moveFocus(1)});var n=t.options.customKeys,o=n?{}:e;function s(t,n){var s;s=\"string\"!=typeof n?function(t){return n(t,i)}:e.hasOwnProperty(n)?e[n]:n,o[t]=s}if(n)for(var c in n)n.hasOwnProperty(c)&&s(c,n[c]);var r=t.options.extraKeys;if(r)for(var c in r)r.hasOwnProperty(c)&&s(c,r[c]);return o}(n,{moveFocus:function(t,i){s.changeActive(s.selectedHint+t,i)},setFocus:function(t){s.changeActive(t)},menuSize:function(){return s.screenAmount()},length:p.length,close:function(){n.close()},pick:function(){s.pick()},data:o})),n.options.closeOnUnfocus)&&(l.on(\"blur\",this.onBlur=function(){B=setTimeout(function(){n.close()},100)}),l.on(\"focus\",this.onFocus=function(){clearTimeout(B)}));return l.on(\"scroll\",this.onScroll=function(){var t=l.getScrollInfo(),i=l.getWrapperElement().getBoundingClientRect(),e=C+P.top-t.top,o=e-(a.pageYOffset||(h.documentElement||h.body).scrollTop);if(b||(o+=f.offsetHeight),o<=i.top||o>=i.bottom)return n.close();f.style.top=e+\"px\",f.style.left=H+P.left-t.left+\"px\"}),t.on(f,\"dblclick\",function(t){var i=r(f,t.target||t.srcElement);i&&null!=i.hintId&&(s.changeActive(i.hintId),s.pick())}),t.on(f,\"click\",function(t){var i=r(f,t.target||t.srcElement);i&&null!=i.hintId&&(s.changeActive(i.hintId),n.options.completeOnSingleClick&&s.pick())}),t.on(f,\"mousedown\",function(){setTimeout(function(){l.focus()},20)}),this.scrollToActive(),t.signal(o,\"select\",p[this.selectedHint],f.childNodes[this.selectedHint]),!0}function h(t,i,e,n){if(t.async)t(i,n,e);else{var o=t(i,e);o&&o.then?o.then(n):n(o)}}n.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off(\"cursorActivity\",this.activityFunc),this.widget&&this.data&&t.signal(this.data,\"close\"),this.widget&&this.widget.close(),t.signal(this.cm,\"endCompletion\",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(i,e){var n=i.list[e],o=this;this.cm.operation(function(){n.hint?n.hint(o.cm,i,n):o.cm.replaceRange(c(n),n.from||i.from,n.to||i.to,\"complete\"),t.signal(i,\"pick\",n),o.cm.scrollIntoView()}),this.close()},cursorActivity:function(){this.debounce&&(s(this.debounce),this.debounce=0);var t=this.startPos;this.data&&(t=this.data.from);var i=this.cm.getCursor(),e=this.cm.getLine(i.line);if(i.line!=this.startPos.line||e.length-i.ch!=this.startLen-this.startPos.ch||i.ch<t.ch||this.cm.somethingSelected()||!i.ch||this.options.closeCharacters.test(e.charAt(i.ch-1)))this.close();else{var n=this;this.debounce=o(function(){n.update()}),this.widget&&this.widget.disable()}},update:function(t){if(null!=this.tick){var i=this,e=++this.tick;h(this.options.hint,this.cm,this.options,function(n){i.tick==e&&i.finishUpdate(n,t)})}},finishUpdate:function(i,e){this.data&&t.signal(this.data,\"update\");var n=this.widget&&this.widget.picked||e&&this.options.completeSingle;this.widget&&this.widget.close(),this.data=i,i&&i.list.length&&(n&&1==i.list.length?this.pick(i,0):(this.widget=new l(this,i),t.signal(i,\"shown\")))}},l.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap);var t=this.completion.cm;this.completion.options.closeOnUnfocus&&(t.off(\"blur\",this.onBlur),t.off(\"focus\",this.onFocus)),t.off(\"scroll\",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var t=this;this.keyMap={Enter:function(){t.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(i,n){if(i>=this.data.list.length?i=n?this.data.list.length-1:0:i<0&&(i=n?0:this.data.list.length-1),this.selectedHint!=i){var o=this.hints.childNodes[this.selectedHint];o&&(o.className=o.className.replace(\" \"+e,\"\")),(o=this.hints.childNodes[this.selectedHint=i]).className+=\" \"+e,this.scrollToActive(),t.signal(this.data,\"select\",this.data.list[this.selectedHint],o)}},scrollToActive:function(){var t=this.hints.childNodes[this.selectedHint],i=this.hints.firstChild;t.offsetTop<this.hints.scrollTop?this.hints.scrollTop=t.offsetTop-i.offsetTop:t.offsetTop+t.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=t.offsetTop+t.offsetHeight-this.hints.clientHeight+i.offsetTop)},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},t.registerHelper(\"hint\",\"auto\",{resolve:function(i,e){var n,o=i.getHelpers(e,\"hint\");if(o.length){var s=function(t,i,e){var n=function(t,i){if(!t.somethingSelected())return i;for(var e=[],n=0;n<i.length;n++)i[n].supportsSelection&&e.push(i[n]);return e}(t,o);!function o(s){if(s==n.length)return i(null);h(n[s],t,e,function(t){t&&t.list.length>0?i(t):o(s+1)})}(0)};return s.async=!0,s.supportsSelection=!0,s}return(n=i.getHelper(i.getCursor(),\"hintWords\"))?function(i){return t.hint.fromList(i,{words:n})}:t.hint.anyword?function(i,e){return t.hint.anyword(i,e)}:function(){}}}),t.registerHelper(\"hint\",\"fromList\",function(i,e){var n,o=i.getCursor(),s=i.getTokenAt(o),c=t.Pos(o.line,s.start),r=o;s.start<o.ch&&/\\w/.test(s.string.charAt(o.ch-s.start-1))?n=s.string.substr(0,o.ch-s.start):(n=\"\",c=o);for(var l=[],h=0;h<e.words.length;h++){var a=e.words[h];a.slice(0,n.length)==n&&l.push(a)}if(l.length)return{list:l,from:c,to:r}}),t.commands.autocomplete=t.showHint;var a={hint:t.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\\s()\\[\\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};t.defineOption(\"hintOptions\",null)});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/turndown-plugin-gfm/turndown-plugin-gfm.min.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/assets/SmartEditor/turndown/turndown.min.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/FlpsFilter/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":72}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconChevronBottom, iconChevronRight } from '/js/src/icons.js';\n\n/**\n * Render a complete filter collection\n * @param {Object} model The global model object\n * @param {Object} columns The columns representing the table\n * @return {vnode} The full collection of filters accessible through dropdowns\n */\nconst filters = (model, columns) =>\n    h('.w-100.shadow-level1.p2', [\n        h('.f3.mb1', 'Filters'),\n        Object.entries(columns).reduce((accumulator, [key, column]) => {\n            if (column.filter) {\n                accumulator.push([\n                    h('.flex-row.items-center.clickable', {\n                        onclick: () => model.flps.toggleFilterExpanded(key),\n                        id: `${key}FilterToggle`,\n                    }, [\n                        h('', model.flps.isFilterExpanded(key) ? iconChevronBottom() : iconChevronRight()),\n                        h('.f4.ml1', column.name),\n                    ]),\n                    model.flps.isFilterExpanded(key) && column.filter,\n                ]);\n            }\n            return accumulator;\n        }, []),\n        h('button.btn.btn-danger.mt2', {\n            disabled: !model.flps.isAnyFilterActive(),\n            onclick: () => model.flps.resetLogsParams(),\n        }, 'Reset all filters'),\n    ]);\n\nexport default filters;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/LogsFilter/author.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Returns the author filter component\n * @param {Object} model The global model object\n * @return {vnode} A text box that lets the user look for logs with a specific author\n */\nconst authorFilter = (model) => h('input.w-75.mt1', {\n    type: 'text',\n    id: 'authorFilterText',\n    value: model.logs.getAuthorFilter(),\n    oninput: (e) => model.logs.setAuthorFilter(e.target.value),\n}, '');\n\nexport default authorFilter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/LogsFilter/created.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\nconst DATE_FORMAT = 'YYYY-MM-DD';\n\nlet today = new Date();\ntoday.setMinutes(today.getMinutes() - today.getTimezoneOffset());\n[today] = today.toISOString().split('T');\n\n/**\n * Returns the creation date filter components\n * @param {Object} model The global model object\n * @return {vnode} Two date selection boxes to control the minimum and maximum creation dates for the log filters\n */\nconst createdFilter = (model) => {\n    const createdFrom = model.logs.getCreatedFilterFrom();\n    const createdTo = model.logs.getCreatedFilterTo();\n    return h('', [\n        h('.f6', 'From:'),\n        h('input.w-75.mv1', {\n            type: 'date',\n            id: 'createdFilterFrom',\n            placeholder: DATE_FORMAT,\n            max: createdTo || today,\n            value: createdFrom,\n            onchange: (e) => model.logs.setCreatedFilter('From', e.target.value, e.target.validity.valid),\n            oninput: (e) => model.logs.setCreatedFilterWithDebounce('From', e.target.value, e.target.validity.valid),\n        }, ''),\n        h('.f6', 'To:'),\n        h('input.w-75.mv1', {\n            type: 'date',\n            id: 'createdFilterTo',\n            placeholder: DATE_FORMAT,\n            min: createdFrom,\n            max: today,\n            value: createdTo,\n            onchange: (e) => model.logs.setCreatedFilter('To', e.target.value, e.target.validity.valid),\n            oninput: (e) => model.logs.setCreatedFilterWithDebounce('To', e.target.value, e.target.validity.valid),\n        }, ''),\n    ]);\n};\n\nexport default createdFilter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/LogsFilter/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Render a complete filter collection\n * @param {Object} model The global model object\n * @param {Object} columns The columns representing the table\n * @return {vnode} The full collection of filters accessible through dropdowns\n */\nconst filters = (model, columns) =>\n    h('.w-100.shadow-level1.p2', [\n        h('.f3.mb1', 'Filters'),\n        Object.entries(columns).reduce((accumulator, [key, column]) => {\n            if (column.filter) {\n                accumulator.push([\n                    h('.flex-row.items-baseline.ph3', [\n                        h('.w-30.p1.m1.f4.ml1', column.name),\n                        h('.w-70.p1.m1', column.filter),\n                    ]),\n                    model.logs.isFilterExpanded(key) && column.filter,\n                ]);\n            }\n            return accumulator;\n        }, []),\n        h('button.btn.btn-danger.mt2', {\n            disabled: !model.logs.isAnyFilterActive(),\n            onclick: () => model.logs.resetLogsParams(),\n        }, 'Reset all filters'),\n    ]);\n\nexport default filters;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/LogsFilter/runs.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Returns the runs filter component\n * @param {Object} model The global model object\n * @return {vnode} A text box that allows the user to enter runNumbers to filter the logs\n */\nconst runsFilter = (model) => h('input.w-75.mt1', {\n    type: 'text',\n    id: 'runsFilterText',\n    value: model.logs.getRunsFilter(),\n    oninput: (e) => model.logs.setRunsFilter(e.target.value),\n}, '');\n\nexport default runsFilter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/LogsFilter/tags.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":56}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconMinus, iconPlus } from '/js/src/icons.js';\n\nconst TAGS_LIMIT = 5;\n\n/**\n * Radio button to toggle the filter operation\n * @param {Object} model The global model object\n * @return {vnode} The filter operation radio button elements\n */\nconst tagFilterOperationRadioButtons = (model) => h('.form-group-header.flex-row', ['AND', 'OR'].map((operation) =>\n    h('.form-check.mr2', [\n        h('input.form-check-input', {\n            onclick: () => model.logs.setTagFilterOperation(operation),\n            id: `tagFilterOperationRadioButton${operation}`,\n            checked: operation === model.logs.getTagFilterOperation(),\n            type: 'radio',\n            name: 'operationRadioButtons',\n        }),\n        h('label.form-check-label', {\n            for: `tagFilterOperationRadioButton${operation}`,\n        }, operation),\n    ])));\n\n/**\n * Creates checkboxes for the tag filter subcomponent\n * @param {Object} model The global model object\n * @return {vnode} A collection of checkboxes to toggle table rows by tags\n */\nconst tagsFilter = (model) => {\n    const tags = model.tags.getTags().payload;\n\n    if (tags) {\n        const checkboxes = tags.map((tag, index) => {\n            const isChecked = model.logs.isTagInFilter(tag.id);\n            return h('.form-check', [\n                h('input.form-check-input', {\n                    onclick: () => isChecked ? model.logs\n                        .removeTagFromFilter(tag.id) : model.logs.addTagToFilter(tag.id),\n                    id: `tagCheckbox${index + 1}`,\n                    type: 'checkbox',\n                    checked: isChecked,\n                }),\n                h('label.flex-row.items-center.form-check-label', {\n                    for: `tagCheckbox${index + 1}`,\n                }, tag.text),\n            ]);\n        });\n\n        if (checkboxes.length <= TAGS_LIMIT) {\n            return [tagFilterOperationRadioButtons(model), ...checkboxes];\n        } else {\n            const showMoreFilters = model.logs.shouldShowMoreTags();\n            const toggleFilters = h('button.btn.btn-primary.mv1#toggleMoreTags', {\n                onclick: () => model.logs.toggleMoreTags(),\n            }, ...showMoreFilters ? [iconMinus(), ' Less tags'] : [iconPlus(), ' More tags']);\n\n            const slicedCheckboxes = showMoreFilters ? checkboxes : checkboxes.slice(0, TAGS_LIMIT);\n            slicedCheckboxes.splice(TAGS_LIMIT, 0, toggleFilters);\n\n            return [tagFilterOperationRadioButtons(model), ...slicedCheckboxes];\n        }\n    }\n    return null;\n};\n\nexport default tagsFilter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/LogsFilter/title.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Returns the title filter component\n * @param {Object} model The global model object\n * @return {vnode} A text box that allows the user to enter a title substring to match against all logs\n */\nconst titleFilter = (model) => h('input.w-75.mt1', {\n    type: 'text',\n    id: 'titleFilterText',\n    value: model.logs.getTitleFilter(),\n    oninput: (e) => model.logs.setTitleFilter(e.target.value),\n}, '');\n\nexport default titleFilter;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Filters/RunsFilter/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":72}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconChevronBottom, iconChevronRight } from '/js/src/icons.js';\n\n/**\n * Render a complete filter collection\n * @param {Object} model The global model object\n * @param {Object} columns The columns representing the table\n * @return {vnode} The full collection of filters accessible through dropdowns\n */\nconst filters = (model, columns) =>\n    h('.w-100.shadow-level1.p2', [\n        h('.f3.mb1', 'Filters'),\n        Object.entries(columns).reduce((accumulator, [key, column]) => {\n            if (column.filter) {\n                accumulator.push([\n                    h('.flex-row.items-center.clickable', {\n                        onclick: () => model.runs.toggleFilterExpanded(key),\n                        id: `${key}FilterToggle`,\n                    }, [\n                        h('', model.runs.isFilterExpanded(key) ? iconChevronBottom() : iconChevronRight()),\n                        h('.f4.ml1', column.name),\n                    ]),\n                    model.runs.isFilterExpanded(key) && column.filter,\n                ]);\n            }\n            return accumulator;\n        }, []),\n        h('button.btn.btn-danger.mt2', {\n            disabled: !model.runs.isAnyFilterActive(),\n            onclick: () => model.runs.resetLogsParams(),\n        }, 'Reset all filters'),\n    ]);\n\nexport default filters;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/FlpRun/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * A generic generator function to create a list of custom links based on custom defined properties\n * @param {Array} links The collection of objects from which to generate links\n * @param {Function} properties A function to create link properties for a specific link\n * @param {String} textKey The object key to inherit the link's name from in an array entry\n * @return {vnode} A collection of links separated by commas\n */\nconst linksContainer = (links, properties, textKey) => links.length > 0\n    ? h('.flex-wrap', { style: 'word-break: break-all' }, links.map((link, index) => h('.flex-row', [\n        h('a', properties(link), link[textKey]),\n        index + 1 < links.length ? h('', { style: 'white-space: pre;' }, ', ') : null,\n    ])))\n    : 'None';\n\n/**\n * A collection of fields to show per flp detail, optionally with special formatting\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @return {Object} A key-value collection of all relevant fields\n */\nconst activeFields = (model) => ({\n    id: {\n        name: 'ID',\n        visible: false,\n    },\n    name: {\n        name: 'Name',\n        visible: true,\n    },\n    hostname: {\n        name: 'Hostname',\n        visible: true,\n    },\n    nTimeframes: {\n        name: '# of Subtimeframes',\n        visible: true,\n    },\n    rootFlpId: {\n        name: 'RootFlpId',\n        visible: true,\n    },\n    bytesEquipmentReadOut: {\n        name: 'ReadOut in equipment bytes',\n        visible: true,\n    },\n    bytesRecordingReadOut: {\n        name: 'ReadOut in recording bytes',\n        visible: true,\n    },\n    bytesFairMQReadOut: {\n        name: 'ReadOut in FairMQ bytes',\n        visible: true,\n    },\n    runs: {\n        name: 'Runs',\n        visible: true,\n        format: (runs) => linksContainer(runs, ({ id }) => (\n            {\n                href: `?page=run-detail&id=${id}`,\n                onclick: (e) => model.router.handleLinkEvent(e),\n            }\n        ), 'runNumber'),\n    },\n}\n);\n\n/**\n * A singular post which is part of a flp\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @return {vnode} Returns a post\n */\nconst entry = (model, post) => {\n    const postFields = activeFields(model);\n\n    return h('#Flp', Object.entries(postFields).map(([\n        key, {\n            name,\n            format,\n        },\n    ]) =>\n        h(`.w-30rem.flex-row.justify-between#Flp-${key}`, h('b', `${name}:`), format ? format(post[key]) : post[key])));\n};\n\nexport default entry;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/NavBar/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":47}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconPerson } from '/js/src/icons.js';\n\n/**\n * Generic tab button for website navigation purposes\n * @param {Object} model Pass the model to access the defined functions\n * @param {String} id The internal page to navigate to\n * @param {String} text The text to display on the tab\n * @return {vnode} The generated tab button\n */\nconst pageTab = (model, id, text) =>\n    h(`button#${id}.btn.btn-tab${model.router.params.page === id ? '.selected' : ''}`, {\n        onclick: () => {\n            model.clearDropdownMenu();\n            model.router.go(`?page=${id}`);\n        },\n    }, text);\n\n/**\n * Generic a tag for external and internal navigation purposes\n * @param {Object} model Pass the model to access the defined functions\n * @param {String} href The link to navigate to\n * @param {String} text The text to display on the link\n * @return {vnode} The generated link tag\n */\nconst pageLink = (model, href, text) =>\n    h(`a.menu-item#${text.toLowerCase().replace(/ /g, '-')}`, {\n        onclick: (e) => {\n            model.clearDropdownMenu();\n            model.router.handleLinkEvent(e);\n        },\n        href,\n    }, text);\n\n/**\n * Top header of the page\n * @param {Object} model Pass the model to access the defined functions\n * @return {vnode} Returns the navbar\n */\nconst navBar = (model) => {\n    const { page } = model.router.params;\n    return h('.flex-row.justify-between.items-center.ph4.shadow-level2.level2.bg-gray-light', {\n        style: 'min-height: 6rem;',\n    }, [\n        h('.flex-column.items-center', [\n            h('img', {\n                style: 'width: 40px',\n                src: './assets/alice.png',\n                alt: 'ALICE O2 logo',\n            }),\n            h('.f6', 'Bookkeeping'),\n        ]),\n\n        h('.btn-group', [\n            pageTab(model, 'home', 'Home'),\n            pageTab(model, 'log-overview', 'Log Entries'),\n            pageTab(model, 'run-overview', 'Run Statistics'),\n            h(`.navbar-dropdown${model.dropdownMenu === 'overview' ? '.dropdown-open' : ''}`, [\n                h('button#overviews', {\n                    class: `btn btn-tab ${page === 'tag-overview' || page === 'subsystem-overview' ? 'selected' : ''}`,\n                    onclick: () => model.toggleOverviewDropdown(),\n                }, 'Overview'),\n                h('.dropdown-menu', { style: 'width: max-content;' }, [\n                    pageLink(model, '?page=tag-overview', 'Tag Overview'),\n                    pageLink(model, '?page=subsystem-overview', 'Subsystem Overview'),\n                ]),\n            ]),\n            pageTab(model, 'about-overview', 'About'),\n        ]),\n\n        h('.navbar-dropdown', {\n            title: 'Login', class: model.dropdownMenu === 'account' ? 'dropdown-open' : '',\n        }, [\n            h('button.btn', { onclick: () => model.toggleAccountDropdown() }, iconPerson()),\n            h('.dropdown-menu', [\n                h('p.mh3.text-ellipsis', `Welcome ${model.session.name}`),\n                h('hr'),\n                pageLink(model, 'https://alice.its.cern.ch/jira/projects/O2B/summary', 'Jira'),\n                pageLink(model, 'https://github.com/AliceO2Group/Bookkeeping', 'GitHub'),\n                pageLink(model, 'https://alice-talk.web.cern.ch/c/o2/o2-bookkeeping/', 'Support Forum'),\n                h('hr'),\n                model.session.personid === 0 // Anonymous user has id 0\n                    ? h('p.mh3.gray-darker', 'This instance of the application does not require authentication.')\n                    : pageLink(model, 'https://auth.cern.ch/auth/realms/cern/protocol/openid-connect/logout', 'Logout'),\n            ]),\n        ]),\n    ]);\n};\n\nexport default navBar;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Pagination/amountSelector.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":49}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconCaretTop } from '/js/src/icons.js';\n\n/**\n * Based on controllers limits\n */\nconst PER_PAGE_LIMITS = {\n    min: 1,\n    max: 100,\n};\n\n/**\n * Validate if given amount is in per page limits bounds\n * @see PER_PAGE_LIMITS\n * @param {number} amount Per page amount\n * @returns {boolean} The validity of given amount\n */\nfunction isPerPageAmountValid(amount) {\n    return amount >= PER_PAGE_LIMITS.min && amount <= PER_PAGE_LIMITS.max;\n}\n\n/**\n * Amount input component\n * @param {Function} onblur The method to be triggered when an input is blurred\n * @param {Object} model Providing page model to save custom per page value in it\n * @returns {vnode} The view of input\n */\nconst perPageAmountInputComponent = (onblur, model) => h('input[type=number][placeholder=Custom]', {\n    style: { marginBottom: '4px' },\n    class: `form-control ${!isPerPageAmountValid(model.customPerPage) && 'border-danger danger'}`,\n    title: `from ${PER_PAGE_LIMITS.min} to ${PER_PAGE_LIMITS.max}`,\n    max: PER_PAGE_LIMITS.max,\n    min: PER_PAGE_LIMITS.min,\n    oninput: ({ target }) => {\n        model.setCustomPerPage(target.value);\n        model.notify();\n    },\n    onblur: ({ target }) => isPerPageAmountValid(target.value) && onblur(target.value),\n});\n\n/**\n * Returns a collection of buttons for the available amounts within the dropdown\n * @param {Function} onclick The method to be triggered when an item is clicked\n * @param {Array} amounts The numerical options available\n * @param {Object} model Providing page model for perPageAmountInputComponent\n * @return {Array} The individual items in the dropdown\n */\nconst mapAmounts = (onclick, amounts, model) => [\n    ...amounts.map((amount) => h('.menu-item', { onclick: () => onclick(amount) }, amount)),\n    h('.menu-item', {\n        onclick: () => onclick(Infinity),\n        title: 'Not recommended for huge amounts of rows (>1000)',\n    }, 'Infinite'),\n    h('.ph3', perPageAmountInputComponent(onclick, model)),\n];\n\n/**\n * Returns the amount selector dropdown\n * @param {Function} onclickDropdown The method to be triggered when the dropdown is clicked\n * @param {Function} onclickAmount The method to be triggered when an item in the dropdown is clicked\n * @param {Boolean} dropdownVisible Whether the dropdown menu is expanded or not\n * @param {Array} amounts The numerical options available in the dropdown menu\n * @param {Number} itemsPerPage The currently set amount of items per page for pagination\n * @param {Object} model Providing page model for perPageAmountInputComponent\n * @return {vnode} The full dropdown including all options and a display of currently set amount\n */\nconst amountSelector = (onclickDropdown, onclickAmount, dropdownVisible, amounts, itemsPerPage, model) =>\n    h('#amountSelector', {\n        class: `dropup ${model.infiniteScrollEnabled ? 'shadow-level3' : ''} ${dropdownVisible ? 'dropup-open' : ''}`,\n        style: model.infiniteScrollEnabled ? {\n            position: 'fixed',\n            bottom: '16px',\n            zIndex: 100,\n        } : null,\n    }, [\n        h('button.btn', { onclick: onclickDropdown }, `Rows per page: ${model.infiniteScrollEnabled ?\n            'Infinite' : itemsPerPage} `, iconCaretTop()),\n        h('.dropup-menu', mapAmounts(onclickAmount, amounts, model)),\n    ]);\n\nexport default amountSelector;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Pagination/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./pageSelector.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":46},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./amountSelector.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":50}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport pageSelector from './pageSelector.js';\nimport amountSelector from './amountSelector.js';\n\nexport { pageSelector, amountSelector };\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Pagination/pageSelector.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":76}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconArrowThickLeft, iconArrowThickRight } from '/js/src/icons.js';\n\nconst MAX_VISIBLE_PAGES = 5;\nlet currentScrollPosition = 0;\nlet ticking = false;\n\n/**\n * Switcher of pages\n * @param {number} scrollPos Throttled scroll position of document\n * @param {Function} onclick Function that initiates page switching\n * @param {number} selectedPage Number of current page\n * @returns {void}\n */\nfunction switchPage(scrollPos, onclick, selectedPage) {\n    const trHeight = document.querySelector('tr').clientHeight;\n    // When the height of 5 rows left, retrieve rows from the next page\n    if (scrollPos + document.documentElement.clientHeight >= document.documentElement.scrollHeight - trHeight * 5) {\n        onclick(selectedPage + 1);\n    }\n}\n\n/**\n * Render the page buttons\n * @param {Array} pages An array of the page numbers that require buttons\n * @param {Number} selectedPage The number of the currently selected page\n * @param {Function} onclick The function to be triggered when any page number is clicked\n * @return {Array} A collection of vnodes containing the individual page buttons\n */\nconst getPageButtons = (pages, selectedPage, onclick) =>\n    pages.map((page) => h(`button.btn.btn-tab.mh1${page === selectedPage ? ' selected' : ''}#page${page}`, {\n        onclick: () => onclick(page),\n    }, page));\n\n/**\n * Render the full page selector\n * @param {Function} onclick The function to be triggered when any page number is clicked\n * @param {Object} model Model of related entity\n * @return {vnode | null} The full button group containing navigation arrows and the (shortened) page buttons themselves\n */\nconst pageSelector = (onclick, model) => {\n    const pageCount = model.getTotalPages();\n\n    /**\n     * Handler of scroll events for the infinite scroll functionality\n     * @returns {void}\n     */\n    const scrollListener = () => {\n        // If reached last page, stop listening scroll events\n        if (model.getSelectedPage() >= pageCount || !model.isInfiniteScrollEnabled()) {\n            window.onscroll = null;\n            return;\n        }\n        currentScrollPosition = window.scrollY;\n\n        // Implementing throttling to optimize performance\n        if (!ticking) {\n            setTimeout(() => {\n                switchPage(currentScrollPosition, onclick, model.getSelectedPage());\n                ticking = false;\n            }, 100);\n\n            ticking = true;\n        }\n    };\n\n    if (model.isInfiniteScrollEnabled()) {\n        window.onscroll = scrollListener;\n    }\n\n    if (pageCount <= 1 || model.isInfiniteScrollEnabled()) {\n        return null;\n    }\n\n    const pages = [...Array(pageCount + 1).keys()].slice(1);\n\n    let pageButtons;\n    if (pageCount <= MAX_VISIBLE_PAGES) {\n        pageButtons = getPageButtons(pages, model.getSelectedPage(), onclick);\n    } else {\n        const frontBound =\n            Math.min(Math.max(0, model.getSelectedPage() - MAX_VISIBLE_PAGES + 2), pageCount - MAX_VISIBLE_PAGES);\n        const rearBound =\n            Math.min(Math.max(MAX_VISIBLE_PAGES, model.getSelectedPage() + MAX_VISIBLE_PAGES - 3), pageCount);\n        pageButtons = getPageButtons(pages.slice(frontBound, rearBound), model.getSelectedPage(), onclick);\n    }\n\n    return h('.btn-group#pageSelector', [\n        h('button.btn.mh1#pageMoveLeft', {\n            onclick: () => onclick(model.getSelectedPage() - 1),\n            disabled: model.getSelectedPage() === 1,\n        }, iconArrowThickLeft()),\n        ...pageButtons,\n        h('button.btn.mh1#pageMoveRight', {\n            onclick: () => onclick(model.getSelectedPage() + 1),\n            disabled: model.getSelectedPage() === pageCount,\n        }, iconArrowThickRight()),\n    ]);\n};\n\nexport default pageSelector;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Post/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * A generic generator function to create a list of custom links based on custom defined properties\n * @param {Array} links The collection of objects from which to generate links\n * @param {Function} properties A function to create link properties for a specific link\n * @param {String} textKey The object key to inherit the link's name from in an array entry\n * @return {vnode} A collection of links separated by commas\n */\nconst linksContainer = (links, properties, textKey) => links.length > 0\n    ? h('.flex-wrap', { style: 'word-break: break-all' }, links.map((link, index) => h('.flex-row', [\n        h('a', properties(link), link[textKey]),\n        index + 1 < links.length ? h('', { style: 'white-space: pre;' }, ', ') : null,\n    ])))\n    : 'None';\n\n/**\n * A collection of fields to show per log detail, optionally with special formatting\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @return {Object} A key-value collection of all relevant fields\n */\nconst activeFields = (model) => ({\n    id: {\n        name: 'ID',\n        visible: true,\n    },\n    author: {\n        name: 'Source',\n        visible: true,\n        format: (author) => author.name,\n    },\n    createdAt: {\n        name: 'Created',\n        visible: true,\n        format: (date) => new Date(date).toLocaleString(),\n    },\n    origin: {\n        name: 'Class',\n        visible: true,\n    },\n    subtype: {\n        name: 'Type',\n        visible: true,\n    },\n    tags: {\n        name: 'Tags',\n        visible: true,\n        format: (tags) => tags.length > 0 ? tags.map(({ text }) => text).join(', ') : 'None',\n    },\n    runs: {\n        name: 'Runs',\n        visible: true,\n        format: (runs) => linksContainer(runs, ({ id }) => (\n            {\n                href: `?page=run-detail&id=${id}`,\n                onclick: (e) => model.router.handleLinkEvent(e),\n            }\n        ), 'runNumber'),\n    },\n    subsystems: {\n        name: 'Subsystems',\n        visible: true,\n        format: (subsystems) => subsystems.length > 0 ? subsystems.map(({ name }) => name).join(', ') : 'None',\n    },\n    attachments: {\n        name: 'Attachments',\n        visible: true,\n        format: (attachments) => linksContainer(attachments, ({\n            id,\n            fileName,\n        }) => (\n            {\n                href: `/api/attachments/${id}`,\n                download: fileName,\n            }\n        ), 'originalName'),\n    },\n});\n\n/**\n * Returns a reply to Log button.\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @return {vnode} The reply button.\n */\nconst replyButton = (model, post) => h('a.btn.btn-primary', {\n    id: `reply-to-${post.id}`,\n    style: 'float: right;',\n    onclick: (e) => model.router.handleLinkEvent(e),\n    href: `?page=log-create&parentLogId=${post.id}`,\n}, 'Reply');\n\n/**\n * Returns a Collapse button.\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @return {vnode} The reply button.\n */\nconst collapsedButton = (model, post) => h('a.btn.btn-primary', {\n    id: `show-collapsed-${post.id}`,\n    style: 'float: right; margin-right: 5px',\n    onclick: () => {\n        model.logs.collapsePost(post.id);\n    },\n}, 'Collapse');\n\n/**\n * Returns a post text box.\n *\n * @param {Integer} index ID of the Post.\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post contents.\n * @return {vnode} The reply button.\n */\nconst textBox = (index, model, post) => h(`div#post-id${index}`, h(`textarea.w-100#post-content${index}`, {\n    oninit: () => {\n        const eventHandler = {\n            location: '',\n            name: '',\n        };\n        const readOnlyProps = {\n            isReadOnly: true,\n            textValue: post.text,\n        };\n        model.logs.clearSingleEditor();\n        model.logs.setMarkdownBox(`post-content${index}`, eventHandler, readOnlyProps, true);\n    },\n    onremove: () => {\n        const post_div = document.getElementById(`post-id${index}`);\n        if (post_div) {\n            post_div.innerHTML = '';\n        }\n        model.logs.removeMarkdownBox(`post-content${index}`);\n    },\n}, post.text));\n\n/**\n * A singular post which is part of a log\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @param {Number} index the identification index of the post\n * @param {Boolean} highlight indicator if this post should be highlighted\n * @return {vnode} Returns a post\n */\nconst entry = (model, post, index, highlight) => {\n    const postFields = activeFields(model);\n\n    return h(`#post${index}.w-100.flex-row.m1.shadow-level1`, [\n        h(`.w-20.p2.shadow-level1${highlight ? '.bg-gray-light' : ''}`, [\n            h('table', [\n                h('tbody', Object.entries(postFields)\n                    .map(([\n                        key, {\n                            name,\n                            format,\n                            visible,\n                        },\n                    ]) => visible && h(`tr#post${index}-${key}`, [\n                        h('td.text-right', { style: 'font-weight: bold' }, `${name}:`),\n                        h('td', format ? format(post[key]) : post[key]),\n                    ]))),\n            ]),\n        ]),\n        h('.w-80.p2.shadow-level1', h('div.flex-wrap.justify-between.mv1', h('h4', post.title), h('div', [\n            replyButton(model, post),\n            collapsedButton(model, post),\n        ])), textBox(index, model, post)),\n    ]);\n};\n\nexport default entry;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/PostCollapsed/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * A collection of fields to show per log detail, optionally with special formatting\n *\n * @return {Object} A key-value collection of all relevant fields\n */\nconst activeFields = () => ({\n    id: {\n        name: 'ID',\n        visible: true,\n    },\n    author: {\n        name: 'Source',\n        visible: true,\n        format: (author) => author.name,\n    },\n});\n\n/**\n * Returns a reply to Log button.\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @return {vnode} The reply button.\n */\nconst replyButton = (model, post) => h('a.btn.btn-primary', {\n    id: `reply-to-${post.id}`,\n    style: 'float: right;',\n    onclick: (e) => model.router.handleLinkEvent(e),\n    href: `?page=log-create&parentLogId=${post.id}`,\n}, 'Reply');\n\n/**\n * Returns a Show button.\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @return {vnode} The reply button.\n */\nconst showButton = (model, post) => h('a.btn.btn-primary', {\n    id: `show-collapse-${post.id}`,\n    style: 'float: right; margin-right: 5px',\n    onclick: () => {\n        model.logs.showPostDetailed(post.id);\n    },\n}, 'Show');\n\n/**\n * Returns a post text box.\n *\n * @param {Integer} index ID of the Post.\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post contents.\n * @return {vnode} The reply button.\n */\nconst textBox = (index, model, post) =>\n    h(`a#post-id${index}`, {\n        style: 'text-decoration: none; color: black',\n        onclick: () => {\n            model.logs.showPostDetailed(post.id);\n        },\n    }, h(`.text-ellipsis.w-100#post-content${index}`, post.text));\n\n/**\n * A singular post which is part of a log\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @param {Number} index the identification index of the post\n * @param {Boolean} highlight indicator if this post should be highlighted\n * @return {vnode} Returns a post\n */\nconst entry = (model, post, index, highlight) => {\n    const postFields = activeFields();\n\n    return h(`#post${index}.w-100.flex-row.m1.shadow-level1`, [\n        h(`.w-20.p2.shadow-level1${highlight ? '.bg-gray-light' : ''}`, [\n            h('table', [\n                h('tbody', Object.entries(postFields)\n                    .map(([\n                        key, {\n                            name,\n                            format,\n                            visible,\n                        },\n                    ]) => visible && h(`tr#post${index}-${key}`, [\n                        h('td.text-right', { style: 'font-weight: bold' }, `${name}:`),\n                        h('td', format ? format(post[key]) : post[key]),\n                    ]))),\n            ]),\n        ]),\n        h('.w-80.p2.shadow-level1', h('div.flex-wrap.justify-between.mv1', h('h4', post.title), h('div', [\n            replyButton(model, post),\n            showButton(model, post),\n        ])), textBox(index, model, post)),\n    ]);\n};\n\nexport default entry;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/RunDetail/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Method to retrieve the information for a specific run\n * @return {Object} A collection of data with parameters for the Run detail page.\n */\nconst activeFields = () => ({\n    id: {\n        name: 'ID',\n        visible: false,\n        primary: true,\n    },\n    runNumber: {\n        name: 'Run',\n        visible: true,\n        size: 'cell-s',\n    },\n    tags: {\n        name: 'Tags',\n        visible: true,\n        size: 'cell-l',\n        format: (tags) => tags.map(({ text }) => text).join(', '),\n    },\n    timeO2Start: {\n        name: 'O2 Start',\n        visible: true,\n        size: 'cell-l',\n        format: (date) =>\n            date ? new Date(date).toLocaleString('en-GB', { timeStyle: 'medium', dateStyle: 'short' }) : '-',\n    },\n    timeO2End: {\n        name: 'O2 Stop',\n        visible: true,\n        size: 'cell-l',\n        format: (date) =>\n            date ? new Date(date).toLocaleString('en-GB', { timeStyle: 'medium', dateStyle: 'short' }) : '-',\n    },\n    timeTrgStart: {\n        name: 'TRG Start',\n        visible: true,\n        size: 'cell-l',\n        format: (date) =>\n            date ? new Date(date).toLocaleString('en-GB', { timeStyle: 'medium', dateStyle: 'short' }) : '-',\n    },\n    timeTrgEnd: {\n        name: 'TRG Stop',\n        visible: true,\n        size: 'cell-l',\n        format: (date) =>\n            date ? new Date(date).toLocaleString('en-GB', { timeStyle: 'medium', dateStyle: 'short' }) : '-',\n    },\n    activityId: {\n        name: 'Activity Id',\n        visible: true,\n        size: 'cell-m',\n    },\n    runType: {\n        name: 'Run Type',\n        visible: true,\n        size: 'cell-l',\n    },\n    runQuality: {\n        name: 'Run Quality',\n        visible: true,\n        size: 'cell-m',\n    },\n    nDetectors: {\n        name: '# of Detector',\n        visible: true,\n        size: 'cell-s',\n    },\n    nFlps: {\n        name: '# of Flps',\n        visible: true,\n        size: 'cell-s',\n    },\n    nEpns: {\n        name: '# of Epns',\n        visible: true,\n        size: 'cell-s',\n    },\n    nSubtimeframes: {\n        name: '# of STFs',\n        visible: true,\n        size: 'cell-m',\n    },\n    bytesReadOut: {\n        name: 'Readout Data',\n        visible: true,\n        size: 'cell-m',\n    },\n});\n\n/**\n * A singular detail page which provides information about a run\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @param {Object} post all data related to the post\n * @return {vnode} Returns a post\n */\nconst entry = (model, post) => {\n    const postFields = activeFields(model);\n\n    return h('#Run', Object.entries(postFields).map(([\n        key, {\n            name,\n            format,\n        },\n    ]) =>\n        h(`.w-30rem.flex-row.justify-between#Flp-${key}`, h('b', `${name}:`), format ? format(post[key]) : post[key])));\n};\n\nexport default entry;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Table/headers.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":73}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconCaretTop, iconCaretBottom, iconX } from '/js/src/icons.js';\n\n/**\n * Renders the header row\n * @param {Object} keys The full collection of API keys and their corresponding header values\n * @param {Object} model The global model object\n * @return {vnode} An array of rows containing all given header values with specific cell sizes\n */\nconst headers = (keys, model) => h('thead', h('tr', Object.entries(keys).reduce((accumulator, [key, value]) => {\n    if (value.visible) {\n        const size = value.size || 'cell-m';\n        if (value.sortable) {\n            const columnSortingOperation = model.logs.getSortingOperation(key);\n            const columnSortingOperationPreview = model.logs.getSortingPreviewOperation(key);\n            accumulator.push(h(`th#${key}.${size}.clickable`, {\n                scope: 'col',\n                style: 'min-width: 120px',\n                onclick: () => model.logs.setSortingValues(key),\n                onmouseenter: () => model.logs.setSortingPreviewValues(key),\n                onmouseleave: () => model.logs.clearSortingPreviewValues(),\n            }, h('.flex-row.items-center', [\n                h('', value.name),\n                h(`.ml2${columnSortingOperationPreview ? '.gray-dark' : ''}`, {\n                    id: `${key}-sort${columnSortingOperationPreview ? '-preview' : ''}`,\n                }, {\n                    asc: iconCaretBottom(), desc: iconCaretTop(), none: iconX(),\n                }[columnSortingOperationPreview || columnSortingOperation]),\n            ])));\n        } else {\n            accumulator.push(h(`th.${size}`, { scope: 'col' }, value.name));\n        }\n    }\n    return accumulator;\n}, [])));\n\nexport default headers;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Table/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./headers.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./rows.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":30}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport headers from './headers.js';\nimport rows from './rows.js';\n\n/**\n * Renders the table\n * @param {Array} data An object array, with every object representing a to be rendered row\n * @param {Object} keys The full collection of API keys and their corresponding header values\n * @param {Object} model The global model object\n * @param {Function} params Additional element parameters, wrapped in a function\n * @param {String} cssClass string\n * @returns {vnode} Return the total view of the table to rendered\n */\nconst table = (data, keys, model, params = () => null, cssClass) => h('table.table.table-hover.shadow-level1', [\n    headers(keys, model),\n    rows(data, keys, model, params, cssClass),\n]);\n\nexport default table;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/Table/rows.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Renders a single cell with content\n * @param {String} key The internal identifier for the column\n * @param {Object} value The column properties potentially containing a formatter function\n * @param {String} text The content text\n * @param {String} rowId The current rowId\n * @param {Object} model The global model object\n * @param {Object} entry The specific object\n * @return {vnode} A single table cell containing (formatted) text\n */\nconst content = (key, value, text, rowId, model, entry) => {\n    const formattedText = value && value.format ? value.format(text, entry) : text;\n    let tableText = formattedText;\n    let displayToolTip = false;\n\n    if (key == 'title' && formattedText.length > 47) {\n        tableText = `${formattedText.substring(0, 47)}...`;\n        displayToolTip = true;\n    } else if (key == 'tags' && formattedText.length > 31) {\n        tableText = `${formattedText.substring(0, 25)}...`;\n        displayToolTip = true;\n    }\n\n    const columnId = `${rowId}-${key}`;\n    const canExpand = model.logs.canColumnExpand(rowId, value.name);\n\n    return h(`td.${value.size}`, {\n        id: columnId,\n        onupdate: () => {\n            // 1.25 margin is added to catch minor height miscalculations\n            if (value.expand) {\n                const element = model.document.getElementById(`${columnId}-text`);\n                const minimalHeight = model.logs.getMinimalColumnHeight(rowId, value.name);\n                const shouldCollapse =\n                    element.scrollHeight >= minimalHeight * 1.25 || element.scrollHeight >= element.offsetHeight * 1.25;\n                const shouldNotCollapse = element.scrollHeight <= minimalHeight * 1.25;\n                if (!canExpand && shouldCollapse) {\n                    model.logs.addCollapsableColumn(rowId, value.name, element.offsetHeight);\n                } else if (canExpand && shouldNotCollapse) {\n                    model.logs.disableCollapsableColumn(rowId, value.name);\n                }\n            }\n        },\n        onclick: canExpand ? (e) => e.stopPropagation() : null,\n    }, [\n        h('.flex-row.items-center', [\n            h('div.show-overflow', {\n                id: `${columnId}-text`,\n            }, !displayToolTip ? tableText : h('div.tooltip', tableText, h('span.tooltiptext', {\n                style: 'width: 250px; word-break: break-all;',\n            }, formattedText))),\n        ]),\n    ]);\n};\n\n/**\n * Renders a list of rows with content\n * @param {Array} data The full collection of API data corresponding to the keys\n * @param {Object} keys The full collection of API keys and their corresponding header values\n * @param {Object} model The global model object\n * @param {Function} params Additional element parameters, wrapped in a function\n * @param {String} cssClass string\n * @return {vnode} A filled array of rows based on the given data and keys\n */\nconst rows = (data, keys, model, params, cssClass) => {\n    const idKey = Object.keys(keys).find((key) => keys[key] && keys[key].primary);\n\n    return h('tbody', data.map((entry) => {\n        const rowId = `row${entry[idKey]}`;\n        return h(`tr#${rowId}.clickable.${cssClass}`, params(entry), Object.entries(keys).reduce((accumulator,\n            [key, value]) => {\n            if (value.visible) {\n                accumulator.push(content(key, value, entry[key], rowId, model, entry));\n            }\n            return accumulator;\n        }, []));\n    }));\n};\n\nexport default rows;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/common/errorAlert.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Generic error alert.\n *\n * @param {Object} error The JSON:API conform error object.\n * @returns {vnode} The VNode of the alert.\n */\nconst errorAlert = (error) => {\n    if (error.detail) {\n        return h('.alert.alert-danger', h('b', `${error.title}: `), error.detail);\n    } else {\n        return h('.alert.alert-danger', h('b', error.title));\n    }\n};\n\nexport default errorAlert;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/common/markdown.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/components/common/spinner.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\n\n/**\n * Generic page loading placeholder.\n *\n * @param {number} size The size of the spinner.\n * @return {vnode} The spinner.\n */\nconst spinner = ({ size = 10, absolute = true } = {}) =>\n    h(`.w-100.flex-row.justify-center.items-center${absolute ? '.absolute-fill' : ''}`, [\n        h('span.pageLoading', {\n            style: `font-size: ${size}em;`,\n        }, h('.atom-spinner', h('.spinner-inner', [\n            h('.spinner-line'),\n            h('.spinner-line'),\n            h('.spinner-line'),\n            h('.spinner-circle', h('div', '')),\n        ]))),\n    ]);\n\nexport default spinner;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/utilities/export.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/utilities/pick.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/utilities/removeElement.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/utilities/scrollTo.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/utilities/targetURL.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/view.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":50},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./components/NavBar/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":51},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Logs/Overview/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":59},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Logs/Details/index.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Logs/Create/index.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":54},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Runs/Overview/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":59},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Runs/Details/index.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Runs/Export/index.js","line":21,"column":1,"nodeType":"ImportDeclaration","endLine":21,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Subsystems/Overview/index.js","line":22,"column":1,"nodeType":"ImportDeclaration","endLine":22,"endColumn":70},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Subsystems/Details/index.js","line":23,"column":1,"nodeType":"ImportDeclaration","endLine":23,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Tags/Overview/index.js","line":24,"column":1,"nodeType":"ImportDeclaration","endLine":24,"endColumn":59},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Tags/Details/index.js","line":25,"column":1,"nodeType":"ImportDeclaration","endLine":25,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Tags/Create/index.js","line":26,"column":1,"nodeType":"ImportDeclaration","endLine":26,"endColumn":54},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Flps/Overview/index.js","line":27,"column":1,"nodeType":"ImportDeclaration","endLine":27,"endColumn":58},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/About/Overview/index.js","line":28,"column":1,"nodeType":"ImportDeclaration","endLine":28,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Flps/Details/index.js","line":29,"column":1,"nodeType":"ImportDeclaration","endLine":29,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./views/Home/Overview/index.js","line":30,"column":1,"nodeType":"ImportDeclaration","endLine":30,"endColumn":59}],"errorCount":17,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h, switchCase } from '/js/src/index.js';\nimport NavBar from './components/NavBar/index.js';\nimport LogsOverview from './views/Logs/Overview/index.js';\nimport LogDetail from './views/Logs/Details/index.js';\nimport LogCreate from './views/Logs/Create/index.js';\nimport RunsOverview from './views/Runs/Overview/index.js';\nimport RunDetail from './views/Runs/Details/index.js';\nimport RunsExport from './views/Runs/Export/index.js';\nimport SubsystemOverview from './views/Subsystems/Overview/index.js';\nimport SubsystemDetail from './views/Subsystems/Details/index.js';\nimport TagsOverview from './views/Tags/Overview/index.js';\nimport TagDetail from './views/Tags/Details/index.js';\nimport TagCreate from './views/Tags/Create/index.js';\nimport FlpOverview from './views/Flps/Overview/index.js';\nimport AboutOverview from './views/About/Overview/index.js';\nimport FlpDetail from './views/Flps/Details/index.js';\nimport HomeOverview from './views/Home/Overview/index.js';\n\n/**\n * Main view layout\n * @param {object} model - representing current application state\n * @return {vnode} application view to be drawn according to model\n */\nexport default (model) => {\n    const pages = {\n        home: HomeOverview,\n\n        'log-overview': LogsOverview,\n        'log-detail': LogDetail,\n        'log-create': LogCreate,\n\n        'run-overview': RunsOverview,\n        'run-detail': RunDetail,\n        'run-export': RunsExport,\n\n        'flp-overview': FlpOverview,\n        'flp-detail': FlpDetail,\n\n        'about-overview': AboutOverview,\n\n        'tag-overview': TagsOverview,\n        'tag-detail': TagDetail,\n        'tag-create': TagCreate,\n\n        'subsystem-overview': SubsystemOverview,\n        'subsystem-detail': SubsystemDetail,\n\n    };\n\n    return [\n        h('.flex-column.absolute-fill', { onclick: () => {\n            // eslint-disable-next-line no-undef\n            if (!window.clickedInFilters) {\n                model.logs.setShowFilters(false);\n            }\n        },\n        }, [\n            NavBar(model),\n            content(model, pages),\n        ]),\n    ];\n};\n\n/**\n * Page content\n * @param {Object} model Pass the model object to the child\n * @param {Object} pages Pass the pages to the switchcase\n * @returns {vnode} Returns a vnode to render the pages\n */\nconst content = (model, pages) =>\n    h('.p4', switchCase(model.router.params.page, pages)(model));\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/About/About.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":47}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { Observable } from '/js/src/index.js';\n\n/**\n * Model representing handlers for homePage.js\n */\nexport default class Overview extends Observable {\n    /**\n     * The constructor of the Overview model object\n     * @param {Object} model Pass the model to access the defined functions\n     * @returns {Object} Constructs the Overview model\n     */\n    constructor(model) {\n        super();\n        this.model = model;\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/About/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":56}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport table from '../../../components/Table/index.js';\n\n/**\n * Table row header\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst aboutOverview = (model) => {\n    const data = [\n        { type: 'Bookkeeping', version: '1', hostname: 'localhost', port: '4000' },\n        { type: 'NPM', version: '0.17.3', hostname: '', port: '' },\n    ];\n\n    const aboutColumns = {\n        type: { name: 'Type', size: 'cell-s', visible: true },\n        version: { name: 'Version', size: 'cell-s', visible: true },\n        hostname: { name: 'Hostname', size: 'cell-s', visible: true },\n        port: { name: 'Port', size: 'cell-s', visible: true },\n    };\n\n    return h('.flex-row.mv1', [h('.w-100', h('.w-100.flex-column.mh3', [table(data, aboutColumns, model)]))]);\n};\n\nexport default (model) => [aboutOverview(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Flps/ActiveColumns/index.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Flps/Details/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../utilities/targetURL.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/FlpRun/index.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":58}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport targetURL from '../../../utilities/targetURL.js';\nimport flpRun from '../../../components/FlpRun/index.js';\n\n/**\n * The VNode of the Flp Detail screen.\n *\n * @param {*} model Pass the model to access the defined functions.\n * @return {vnode} The VNode of the Flp Detail screen.\n */\nconst flpDetails = (model) => {\n    if (!model.router.params.id) {\n        model.router.go('?page=flp-overview');\n        return;\n    }\n\n    if (!model.router.params.panel) {\n        model.router.go(targetURL(model, 'panel', 'main'), true);\n        return;\n    }\n\n    const data = model.flps.getFlp();\n\n    if (data.isSuccess()) {\n        const activePanel = model.router.params.panel;\n\n        const panels = {\n            main: {\n                name: 'Main',\n                content: flpRun(model, data.payload),\n            },\n        };\n\n        return [\n            h('h2.mv2', { onremove: () => model.flps.clearFlps() }, `Flp #${data.payload.name}`),\n            h('.w-100', [\n                h('ul.nav.nav-tabs', Object.entries(panels).map(([id, { name }]) =>\n                    h('li.nav-item', h(`a.nav-link${activePanel === id ? '.active' : ''}`, {\n                        onclick: (e) => activePanel !== id && model.router.handleLinkEvent(e),\n                        href: targetURL(model, 'panel', id),\n                        id: `${id}-tab`,\n                    }, name)))),\n                h('.tab-content.p2', Object.entries(panels).map(([id, { content }]) =>\n                    h(`.tab-pane${activePanel === id ? '.active' : ''}`, { id: `${id}-pane` }, content))),\n            ]),\n        ];\n    } else if (data.isLoading()) {\n        return spinner();\n    } else if (data.isFailure()) {\n        return h('', [\n            data.payload.map(errorAlert),\n            h('button.btn.btn-primary.mv2', {\n                onclick: () => model.router.go('?page=flp-overview'),\n            }, 'Return to Overview'),\n        ]);\n    }\n};\n\nexport default (model) => flpDetails(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Flps/Flps.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":72}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { fetchClient, Observable, RemoteData } from '/js/src/index.js';\n\n/**\n * Model representing handlers for homePage.js\n */\nexport default class Overview extends Observable {\n    /**\n     * The constructor of the Overview model object\n     * @param {Object} model Pass the model to access the defined functions\n     * @returns {Object} Constructs the Overview model\n     */\n    constructor(model) {\n        super();\n        this.model = model;\n\n        this.clearFlp();\n        this.clearFlps();\n    }\n\n    /**\n     * Retrieve every relevant flp from the API\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchAllFlps() {\n        const params = {\n            'page[offset]': (this.selectedPage - 1) * this.flpsPerPage,\n            'page[limit]': this.flpsPerPage,\n        };\n\n        const endpoint = `/api/flps?${new URLSearchParams(params).toString()}`;\n        const response = await fetchClient(endpoint, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            if (this.isInfiniteScrollEnabled()) {\n                const payload = this.flps && this.flps.payload ? [...this.flps.payload, ...result.data] : result.data;\n                this.flps = RemoteData.success(payload);\n            } else {\n                this.flps = RemoteData.success(result.data);\n            }\n\n            this.totalPages = result.meta.page.pageCount;\n        } else {\n            this.flps = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Retrieve a specified flp from the API\n     * @param {Number} id The ID of the flp to be found\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchOneFlp(id) {\n        this.flp = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/flps/${id}`, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            this.flp = RemoteData.success(result.data);\n        } else {\n            this.flp = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n        }\n        this.notify();\n    }\n\n    /**\n     * Getter for a singular flp data\n     * @returns {RemoteData} Returns a flp\n     */\n    getFlp() {\n        return this.flp;\n    }\n\n    /**\n     * Getter for Logs data associated with a singular flp\n     * @returns {RemoteData} Returns the logs of a flp\n     */\n    getLogsOfFlp() {\n        return this.logsOfFlp;\n    }\n\n    /**\n     * Getter for all the flp data\n     * @returns {RemoteData} Returns all of the filtered flps\n     */\n    getFlps() {\n        return this.flps;\n    }\n\n    /**\n     * Getter for visible flp dropdown\n     * @returns {Number} Returns if the dropdown for choosing an amount of flps should be visible\n     */\n    isAmountDropdownVisible() {\n        return this.amountDropdownVisible;\n    }\n\n    /**\n     * Getter for flps per page\n     * @returns {Number} Returns the number of flps to show on a single page\n     */\n    getFlpsPerPage() {\n        return this.flpsPerPage;\n    }\n\n    /**\n     * Getter for the currently selected page\n     * @returns {Number} The currently selected page\n     */\n    getSelectedPage() {\n        return this.selectedPage;\n    }\n\n    /**\n     * Getter for total pages\n     * @returns {Number} Returns the total amount of pages available for the page selector\n     */\n    getTotalPages() {\n        return this.totalPages;\n    }\n\n    /**\n     * Toggles the visibility of the menu within the flp amounts dropdown\n     * @return {Boolean} The new state of the amounts dropdown\n     */\n    toggleFlpsDropdownVisible() {\n        this.amountDropdownVisible = !this.amountDropdownVisible;\n        this.notify();\n    }\n\n    /**\n     * Sets how many flps are visible per a page, in accordance with the page selector\n     * @param {Number} amount The amount of flps that should be shown per page\n     * @return {Number} The first page of the new flps, totalling the amount set by the user\n     */\n    setFlpsPerPage(amount) {\n        if (this.flpsPerPage !== amount) {\n            if (amount === Infinity) {\n                this.infiniteScrollEnabled = true;\n                // Set step for incremental loading\n                this.flpsPerPage = 19;\n            } else {\n                this.infiniteScrollEnabled = false;\n                this.flpsPerPage = amount;\n            }\n            this.selectedPage = 1;\n            this.fetchAllFlps();\n        }\n\n        this.amountDropdownVisible = false;\n        this.notify();\n    }\n\n    /**\n     * Saves custom per page value\n     * @param {Number} amount The amount of flps that should be shown per page\n     * @see perPageAmountInputComponent\n     * @return {void}\n     */\n    setCustomPerPage(amount) {\n        this.customPerPage = amount;\n    }\n\n    /**\n     * Sets the page chosen through the page selector for usage in pagination, and re-fetches data based on this\n     * @param {Number} page The chosen page number\n     * @return {Number} The chosen page number\n     */\n    setSelectedPage(page) {\n        if (this.selectedPage !== page) {\n            this.selectedPage = page;\n            this.fetchAllFlps();\n            this.notify();\n        }\n    }\n\n    /**\n     * Sets all data related to a flp to their defaults.\n     * @returns {undefined}\n     */\n    clearFlp() {\n        this.flp = RemoteData.NotAsked();\n        this.logsOfFlp = RemoteData.NotAsked();\n    }\n\n    /**\n     * Sets all data related to the flps to their defaults.\n     * @returns {undefined}\n     */\n    clearFlps() {\n        this.flps = RemoteData.NotAsked();\n        this.collapsedColumns = [];\n        this.collapsableColumns = [];\n\n        this.expandedFilters = [];\n\n        this.amountDropdownVisible = false;\n        this.flpsPerPage = 10;\n        this.selectedPage = 1;\n        this.totalPages = 1;\n        this.infiniteScrollEnabled = false;\n\n        /**\n         * Value saved from perPageAmountInputComponent\n         * @see perPageAmountInputComponent\n         * @type {number}\n         */\n        this.customPerPage = 10;\n    }\n\n    /**\n     * Returns the state of table infinite scroll mode\n     * @return {boolean} The state of table infinite scroll mode\n     */\n    isInfiniteScrollEnabled() {\n        return this.infiniteScrollEnabled;\n    }\n\n    /**\n     * Checks if any filter value has been modified from their default (empty)\n     * @returns {Boolean} If any filter is active\n     */\n    isAnyFilterActive() {\n        return false;\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Flps/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/FlpsFilter/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":71},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Pagination/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":88},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../ActiveColumns/index.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":55}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport filters from '../../../components/Filters/FlpsFilter/index.js';\nimport table from '../../../components/Table/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport { amountSelector, pageSelector } from '../../../components/Pagination/index.js';\nimport activeColumns from '../ActiveColumns/index.js';\n\nconst AVAILABLE_AMOUNTS = [5, 10, 20];\n\nlet cachedPayload = null;\n\n/**\n * Table row header\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst flpOverview = (model) => {\n    const data = model.flps.getFlps();\n    const flpsColumns = activeColumns();\n\n    const amountDropdownVisible = model.flps.isAmountDropdownVisible();\n    const flpsPerPage = model.flps.getFlpsPerPage();\n\n    if (data.isSuccess()) {\n        cachedPayload = data.payload;\n    }\n\n    const payload = data.isSuccess() ? data.payload : cachedPayload ? cachedPayload : [];\n\n    return h('', { onremove: () => model.flps.clearFlps() }, [\n        data.isLoading() && spinner(),\n        data.isFailure() && data.payload.map(errorAlert),\n        h('h2.mv2', 'Flp'),\n        h('.flex-row.mv1', [\n            h('.w-10', filters(model, flpsColumns)),\n            h('.w-90', data.isSuccess() && h('.w-100.flex-column.mh3', [\n                table(payload, flpsColumns, model, (entry) => ({\n                    onclick: () => model.router.go(`?page=flp-detail&id=${entry.id}`),\n                })),\n                h('.flex-row.justify-between.mv3', [\n                    h('.w-15', amountSelector(() =>\n                        model.flps.toggleFlpsDropdownVisible(), (amount) => model.flps\n                        .setFlpsPerPage(amount), amountDropdownVisible, AVAILABLE_AMOUNTS, flpsPerPage, model.flps)),\n                    data.isSuccess()\n                    && pageSelector((page) => model.flps.setSelectedPage(page), model.flps),\n                    h('.w-15'),\n                ]),\n            ])),\n        ]),\n    ]);\n};\n\nexport default (model) => [flpOverview(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Home/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../Logs/ActiveColumns/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":100},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../Runs/ActiveColumns/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":100},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":56}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { activeHomeOverviewColumns as activeLogsColumns } from '../../Logs/ActiveColumns/index.js';\nimport { activeHomeOverviewColumns as activeRunsColumns } from '../../Runs/ActiveColumns/index.js';\nimport table from '../../../components/Table/index.js';\n\n/**\n * Table row header\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst HomeOverviewScreen = (model) => {\n    const logs = model.logs.getLogs();\n    const logsColumns = activeLogsColumns(model);\n    const runs = model.runs.getRuns();\n    const runsColumns = activeRunsColumns(model);\n\n    logsColumns.title.size = 'cell-f';\n    logsColumns.createdAt.size = 'cell-fm';\n\n    return h('', [\n        h('.flex-row.w-100', [\n            h('.flex-column.w-50', [\n                h('h1', 'Log Entries'),\n                h('.w-90', logs.isSuccess() && h('.w-100.flex-column.mh3', [\n                    table(logs.isSuccess() ? logs.payload : [], logsColumns, model, (entry) => ({\n                        onclick: () => model.router.go(`?page=log-detail&id=${entry.id}`),\n                    }), 'home'),\n                ])),\n            ]),\n            h('.flex-column.w-50', [\n                h('h1', 'Runs'),\n                h('.w-90', runs.isSuccess() && h('.w-100.flex-column.mh3', [\n                    table(runs.isSuccess() ? runs.payload : [], runsColumns, model, (entry) => ({\n                        onclick: () => model.router.go(`?page=run-detail&id=${entry.id}`),\n                    }), 'home'),\n                ])),\n            ]),\n        ]),\n    ]);\n};\n\nexport default (model) => [HomeOverviewScreen(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Logs/ActiveColumns/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":80},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/title.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":75},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/author.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/created.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":79},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/tags.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/runs.js","line":21,"column":1,"nodeType":"ImportDeclaration","endLine":21,"endColumn":73}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconCommentSquare, iconPaperclip, iconCheck } from '/js/src/icons.js';\n\nimport titleFilter from '../../../components/Filters/LogsFilter/title.js';\nimport authorFilter from '../../../components/Filters/LogsFilter/author.js';\nimport createdFilter from '../../../components/Filters/LogsFilter/created.js';\nimport tagsFilter from '../../../components/Filters/LogsFilter/tags.js';\nimport runsFilter from '../../../components/Filters/LogsFilter/runs.js';\n\n/**\n * A method to display a small and simple number/icon collection as a column\n * @param {Number} count The number to display\n * @param {Object} icon The icon to display\n * @return {vnode} A wrapped vnode containing the specified icon and count\n */\nconst iconWithCountContainer = (count, icon) => count > 0 ? h('.flex-row.items-center.gray-darker', [\n    h('.f7', icon),\n    h('.f6.ml1', count),\n]) : '';\n\n/**\n * Method to retrieve the list of active columns for a generic table component\n * @param {Object} model The global model object\n * @return {Object} A collection of columns with parameters for the Log table\n */\nconst activeColumns = (model) => ({\n    id: {\n        name: 'Entry ID',\n        visible: false,\n        primary: true,\n    },\n    title: {\n        name: 'Title',\n        visible: true,\n        sortable: true,\n        size: 'cell-l',\n        expand: true,\n        filter: titleFilter(model),\n    },\n    author: {\n        name: 'Author',\n        visible: true,\n        sortable: true,\n        size: 'cell-m',\n        format: (author) => author.name,\n        filter: authorFilter(model),\n    },\n    createdAt: {\n        name: 'Created',\n        visible: true,\n        sortable: true,\n        size: 'cell-m',\n        format: (date) =>\n            date ? new Date(date).toLocaleString('en-GB', { timeStyle: 'medium', dateStyle: 'short' }) : '-',\n        filter: createdFilter(model),\n    },\n    tags: {\n        name: 'Tags',\n        visible: true,\n        sortable: true,\n        size: 'cell-l',\n        format: (tags) => tags.map(({ text }) => text).join(', '),\n        filter: tagsFilter(model),\n    },\n    runs: {\n        name: 'Runs',\n        visible: true,\n        sortable: true,\n        size: 'cell-l',\n        format: (runs) => runs.map(({ id }) => id).join(', '),\n        filter: runsFilter(model),\n    },\n    parentLogId: {\n        name: 'Reply',\n        visible: true,\n        size: 'cell-l',\n        format: (parentLogId, log) => parentLogId === log.id ? '' : iconCheck(),\n    },\n    replies: {\n        name: '',\n        visible: true,\n        size: 'cell-xs',\n        format: (replies) => iconWithCountContainer(replies, iconCommentSquare()),\n    },\n    attachments: {\n        name: '',\n        visible: true,\n        size: 'cell-xs',\n        format: (attachments) => iconWithCountContainer(attachments.length, iconPaperclip()),\n    },\n});\n\n/**\n * Method to retrieve the list of active columns for the logs table on the home overview page\n * @param {Object} model The global model object\n * @return {Object} A collection of columns with parameters for the Log table\n */\nexport const activeHomeOverviewColumns = (model) => ({\n    id: {\n        name: 'Entry ID',\n        visible: false,\n        primary: true,\n    },\n    title: {\n        name: 'Title',\n        visible: true,\n        sortable: true,\n        size: 'cell-l',\n        expand: true,\n        filter: titleFilter(model),\n    },\n    createdAt: {\n        name: 'Created',\n        visible: true,\n        sortable: true,\n        size: 'cell-m',\n        format: (date) =>\n            date ? new Date(date).toLocaleString('en-GB', { timeStyle: 'medium', dateStyle: 'medium' }) : '-',\n        filter: createdFilter(model),\n    },\n});\n\nexport default activeColumns;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Logs/Create/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\n\n/**\n * Render the preview component\n * @param {Object} model The model object\n * @param {String} text The text to be set to the preview\n * @returns {vnode} returns the preview node\n */\nconst mdBox = (model, text) => h('', [\n    h('textarea#text.form-control', {\n        placeholder: 'Your message...',\n        disabled: true,\n        onchange: (e) => model.logs.setText(e.target.value),\n        oninit: () => {\n            model.logs.setMarkdownBox('text', { location: 'logs', name: 'setText' }, { isReadOnly: false });\n        },\n    }, text),\n]);\n\n/**\n * A function to construct the create log screen\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the inputs\n */\nconst createLogScreen = (model) => {\n    const title = model.logs.getTitle();\n    const text = model.logs.getText();\n    const allTags = model.tags.getTags();\n    const selectedTags = model.logs.getSelectedTags();\n    const attachments = model.logs.getAttachments();\n    const runNumber = model.router.params.id;\n    let runNumbers = model.logs.getRunNumbers();\n    let runNumberText = 'One or multiple run numbers, separated by commas.';\n    const tagsAvailable = allTags.payload != 0;\n    const noTagsText = 'No tags defined, please go here to create them.';\n\n    const data = model.logs.getCreatedLog();\n\n    const disabled = !(title.length >= 3 && text.length >= 3) || data.isLoading();\n\n    if (model.router.params.parentLogId) {\n        model.logs.setParentLogId(parseInt(model.router.params.parentLogId, 10));\n    } else {\n        model.logs.setParentLogId(-1);\n    }\n\n    if (runNumber && model.logs.getRunNumbers() != runNumber) {\n        runNumbers = runNumber;\n        model.logs.setRunNumbers(runNumbers);\n        runNumberText = 'One run number.';\n    }\n\n    return h('div#create-log', [\n        data.isFailure() && data.payload.map(errorAlert),\n        h('', {\n            onremove: () => model.logs.clearAllEditors(),\n        }, [\n            h('h2', 'Create Log'),\n\n            h('label.form-check-label.f4.mt2', { for: 'title' }, 'Title'),\n            h('input#title.form-control.w-100', {\n                placeholder: 'Enter the title of the log entry...',\n                minlength: 3,\n                maxlength: 140,\n                value: title,\n                oninput: (e) => model.logs.setTitle(e.target.value),\n            }, title),\n\n            h('label.form-check-label.f4.mt2', { for: 'text' }, 'Text'),\n            h('.shadow-level2.w-100', mdBox(model, text)),\n\n            h('label.form-check-label.f4.mt2', { for: 'run-number' }, 'Run numbers (optional)'),\n            h('label.form-check-label.f6', { for: 'run-number' }, `${runNumberText}`),\n            h('input#run-number.form-control.w-100', {\n                placeholder: 'Enter the run numbers...',\n                value: runNumbers,\n                oninput: (e) => model.logs.setRunNumbers(e.target.value),\n                disabled: model.router.params.id ? true : false,\n            }),\n\n            h('label.form-check-label.f4.mt3', { for: 'tags' }, 'Tags (optional)'),\n            h('label.form-check-label.f6', { for: 'tags' }, [\n                'New tags can be created at the ',\n                h('a#tagCreateLink', {\n                    onclick: (e) => model.router.handleLinkEvent(e),\n                    href: '?page=tag-create',\n                }, 'Create Tag'),\n                ' screen.',\n            ]),\n            h('select#tags.form-control', {\n                multiple: true,\n                onchange: (e) => model.logs.setSelectedTags(e.target.selectedOptions),\n            }, !tagsAvailable ? h('option', {\n                onclick: () => model.router.go('?page=tag-create'),\n            }, h('a#tagCreateLink', {\n            }, noTagsText)) :\n                allTags.isSuccess() ? [\n                    ...allTags.payload.map((tag) => h('option', {\n                        value: tag.id,\n                        selected: selectedTags.includes(tag.id),\n                    }, tag.text)),\n                ] : h('option', { disabled: true }, 'Loading tags...')),\n            h('label.form-check-label.f4.mt2', { for: 'attachments' }, 'File attachments (optional)'),\n            h('label.form-check-label.f6', { for: 'attachments' }, 'You may select multiple files to upload.'),\n            h('.flex-row.justify-between', [\n                h('input#attachments.form-control', {\n                    type: 'file',\n                    multiple: true,\n                    onchange: (e) => model.logs.setAttachments(e.target.files),\n                }),\n                attachments.length > 0 && h('button#clearAttachments.btn.btn-danger.ml3', {\n                    onclick: () => model.logs.clearAttachments(),\n                }, 'Clear'),\n            ]),\n            h('#attachmentNames', {\n                style: 'min-height: 1.5em;',\n            }, attachments.length > 1 && [...attachments].map((attachment) => attachment.name).join(', ')),\n\n            h('button.shadow-level1.btn.btn-success.mt2#send', {\n                disabled,\n                onclick: () => model.logs.createLog(),\n            }, data.isLoading() ? 'Creating...' : 'Create'),\n        ]),\n    ]);\n};\n\nexport default (model) => createLogScreen(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Logs/Details/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/PostCollapsed/index.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":75},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Post/index.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../utilities/scrollTo.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":55}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport PostBoxCollapsed from '../../../components/PostCollapsed/index.js';\nimport PostBox from '../../../components/Post/index.js';\nimport scrollTo from '../../../utilities/scrollTo.js';\n\n/**\n * A collection of details relating to a log\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst logDetailScreen = (model) => {\n    const data = model.logs.getLogs();\n    const detailed_columns = model.logs.getDetailedPosts();\n\n    if (data.isSuccess()) {\n        const id = parseInt(model.router.params.id, 10);\n\n        // eslint-disable-next-line require-jsdoc\n        const treeItem = (item, level, is_collapsed) => h('.mw-100', {\n            style: {\n                'margin-left': `${2 * level}rem`,\n            },\n        }, is_collapsed ? PostBoxCollapsed(model, item, item.id, item.id === id) :\n            PostBox(model, item, item.id, item.id === id));\n\n        // eslint-disable-next-line require-jsdoc\n        const tree = (obj, level = 0, items = []) => {\n            if (level === 0) {\n                model.logs.addPost(obj.id);\n                items.push(treeItem(obj, level, !detailed_columns.includes(obj.id)));\n                return tree(obj, level + 1, items);\n            }\n\n            for (const child of obj.children || []) {\n                model.logs.addPost(child.id);\n                items.push(treeItem(child, level, !detailed_columns.includes(child.id)));\n                items = tree(child, level + 1, items);\n            }\n\n            return items;\n        };\n\n        return h('', [\n            h('div.mv2.flex-row.items-center', [\n                h('h2', 'Log Tree'),\n                h('button.btn.btn-primary.mh2#toggleCollapse', {\n                    onclick: () => {\n                        model.logs.toggleAllPostView();\n                    },\n                }, model.logs.isShowAll() ? 'Show all' : 'Collapse all'),\n            ]),\n            h('.w-100.flex-column', {\n                oncreate: () => scrollTo(`#post${id}`, 150),\n            }, tree(data.payload[0])),\n        ]);\n    } else if (data.isFailure()) {\n        return h('', [\n            data.payload.map(errorAlert),\n            h('button.btn.btn-primary.mv2', {\n                onclick: () => model.router.go('?page=log-overview'),\n            }, 'Return to Overview'),\n        ]);\n    } else if (data.isLoading()) {\n        return spinner();\n    }\n};\n\nexport default (model) => [logDetailScreen(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Logs/Logs.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../components/common/markdown.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":70},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../utilities/removeElement.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":66}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { fetchClient, Observable, RemoteData } from '/js/src/index.js';\nimport { setMarkDownBox } from '../../components/common/markdown.js';\nimport { removeElement } from '../../utilities/removeElement.js';\n\n/**\n * Model representing handlers for log entries page\n */\nexport default class Overview extends Observable {\n    /**\n     * The constructor of the Overview model object\n     * @param {Object} model Pass the model to access the defined functions\n     * @returns {Object} Constructs the Overview model\n     */\n    constructor(model) {\n        super();\n        this.model = model;\n\n        this.clearLogs();\n        this.resetLogsParams(false);\n\n        this.createdLog = RemoteData.NotAsked();\n        this.clearAllEditors();\n    }\n\n    /**\n     * Retrieve every relevant log from the API\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchAllLogs() {\n        if (!this.model.tags.getTags().isSuccess()) {\n            this.logs = RemoteData.loading();\n            this.notify();\n        }\n\n        if (!this.model.runs.getRuns().isSuccess()) {\n            this.logs = RemoteData.loading();\n            this.notify();\n        }\n\n        const params = {\n            ...this.titleFilterText && {\n                'filter[title]': this.titleFilterText,\n            },\n            ...this.authorFilterText && {\n                'filter[author]': this.authorFilterText,\n            },\n            ...this.createdFilterFrom && {\n                'filter[created][from]':\n                    new Date(`${this.createdFilterFrom.replace(/\\//g, '-')}T00:00:00.000`).getTime(),\n            },\n            ...this.createdFilterTo && {\n                'filter[created][to]':\n                    new Date(`${this.createdFilterTo.replace(/\\//g, '-')}T23:59:59.999`).getTime(),\n            },\n            ...this.tagFilterValues.length > 0 && {\n                'filter[tag][values]': this.tagFilterValues.join(),\n                'filter[tag][operation]': this.tagFilterOperation.toLowerCase(),\n            },\n            ...this.runFilterValues.length > 0 && {\n                'filter[run][values]': this.runFilterValues.join(),\n                'filter[run][operation]': this.runFilterOperation.toLowerCase(),\n            },\n            ...this.sortingColumn && this.sortingOperation && {\n                [`sort[${this.sortingColumn}]`]: this.sortingOperation,\n            },\n            'page[offset]': this.logs.payload && this.logsPerPage === Infinity ?\n                this.logs.payload.length : (this.selectedPage - 1) * this.logsPerPage,\n            'page[limit]': this.logsPerPage === Infinity ? this.model.INFINITE_SCROLL_CHUNK_SIZE : this.logsPerPage,\n        };\n\n        const endpoint = `/api/logs?${new URLSearchParams(params).toString()}`;\n        const response = await fetchClient(endpoint, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            if (this.isInfiniteScrollEnabled()) {\n                const payload = this.logs && this.logs.payload ? [...this.logs.payload, ...result.data] : result.data;\n                this.logs = RemoteData.success(payload);\n            } else {\n                this.logs = RemoteData.success(result.data);\n            }\n\n            this.totalPages = result.meta.page.pageCount;\n        } else {\n            this.logs = RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Retrieve a specified log from the API\n     * @param {Number} id The ID of the log to be found\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchOneLog(id) {\n        this.logs = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/logs/${id}/tree`, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            this.logs = RemoteData.success([result.data]);\n        } else {\n            this.logs = RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n        }\n        this.detailed_post_ids = [];\n        this.posts = [];\n        this.showAllPosts = true;\n        this.notify();\n    }\n\n    /**\n     * Create the log with the variables set in the model, handling errors appropriately\n     * @returns {undefined}\n     */\n    async createLog() {\n        this.createdLog = RemoteData.loading();\n        this.notify();\n\n        const title = this.getTitle();\n        const text = this.getText();\n        const tags = this.getSelectedTags();\n        const runs = this.getSelectedRuns();\n        const parentLogId = this.getParentLogId();\n        const runNumbers = this.getRunNumbers();\n\n        const body = {\n            title,\n            text,\n            ...runs.length > 0 && { runs },\n            ...parentLogId > 0 && { parentLogId },\n            ...runNumbers && { runNumbers },\n        };\n\n        const options = {\n            method: 'POST',\n            headers: { Accept: 'application/json' },\n        };\n        const attachments = this.getAttachments();\n\n        if (attachments.length > 0 || tags.length > 0) {\n            // eslint-disable-next-line no-undef\n            const formData = new FormData();\n            Object.entries(body).forEach(([key, value]) => formData.append(key, value));\n            [...tags].forEach((tags) => formData.append('tags[]', tags));\n            [...attachments].forEach((attachment, index) => formData.append(`attachments.${index}`, attachment));\n\n            options.body = formData;\n        } else {\n            options.body = JSON.stringify(body);\n            options.headers['Content-Type'] = 'application/json';\n        }\n\n        const response = await fetchClient('/api/logs', options);\n        const result = await response.json();\n\n        if (result.data) {\n            this.createdLog = RemoteData.success(result.data);\n            this.title = '';\n            this.text = '';\n            this.runNumbers = null;\n\n            await this.model.router.go(`/?page=log-detail&id=${this.createdLog.payload.id}`);\n        } else {\n            this.createdLog = RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n            this.notify();\n        }\n    }\n\n    /**\n     * Set the parent log id parameter of the current reply log being created\n     * @param {Number} id Received string from the view\n     * @returns {undefined}\n     */\n    setParentLogId(id) {\n        this.parentLogId = id;\n    }\n\n    /**\n     * Set the title parameter of the current log being created\n     * @param {String} title Received string from the view\n     * @returns {undefined}\n     */\n    setTitle(title) {\n        this.title = title;\n        this.notify();\n    }\n\n    /**\n     * Set the text parameter of the current log being created\n     * @param {String} text Received string from the view\n     * @returns {undefined}\n     */\n    setText(text) {\n        this.text = text;\n        this.notify();\n    }\n\n    /**\n     * Updates the selected tag ID array according to the HTML attributes of the options\n     * @param {HTMLCollection} selectedOptions The currently selected tags by the user, according to HTML specification\n     * @returns {undefined}\n     */\n    setSelectedTags(selectedOptions) {\n        this.tags = [...selectedOptions].map(({ value }) => parseInt(value, 10));\n        this.notify();\n    }\n\n    /**\n     * Updates the selected run ID array according to the HTML attributes of the options\n     * @param {HTMLCollection} selectedOptions The currently selected runs by the user, according to HTML specification\n     * @returns {undefined}\n     */\n    setSelectedRuns(selectedOptions) {\n        this.runs = [...selectedOptions].map(({ value }) => parseInt(value, 10));\n        this.notify();\n    }\n\n    /**\n     * Adds one or more attachments to the current log being created\n     * @param {FileList} files Received file objects from the view\n     * @returns {undefined}\n     */\n    setAttachments(files) {\n        this.attachments = files;\n        this.notify();\n    }\n\n    /**\n     * Set the runNumbers parameter of the current log being created\n     * @param {string} runNumbers Received string from the view\n     * @returns {undefined}\n     */\n    setRunNumbers(runNumbers) {\n        this.runNumbers = runNumbers;\n        this.notify();\n    }\n\n    /**\n     * Flushes all attachments of the current log being created\n     * @returns {undefined}\n     */\n    clearAttachments() {\n        this.model.document.getElementById('attachments').value = '';\n        this.attachments = [];\n        this.notify();\n    }\n\n    /**\n     * Get the parent log id of the current reply log being created, if any\n     * @returns {Number} parent log id of the current reply log\n     */\n    getParentLogId() {\n        return this.parentLogId;\n    }\n\n    /**\n     * Get the title value of the current log being created\n     * @returns {String} the title of the current log being created\n     */\n    getTitle() {\n        return this.title;\n    }\n\n    /**\n     * Get the text value of the current log being created\n     * @returns {String} the text of the current log being created\n     */\n    getText() {\n        return this.text;\n    }\n\n    /**\n     * Get the tag values of the current log being created\n     * @returns {Array} the tag objects of the current log being created\n     */\n    getSelectedTags() {\n        return this.tags;\n    }\n\n    /**\n     * Get the run values of the current log being created\n     * @returns {Array} the run objects of the current log being created\n     */\n    getSelectedRuns() {\n        return this.runs;\n    }\n\n    /**\n     * Get the attachment values of the current log being created\n     * @returns {Array} the attachments of the current log being created\n     */\n    getAttachments() {\n        return this.attachments;\n    }\n\n    /**\n     * Getter for all the data\n     * @returns {RemoteData} Returns all of the filtered logs\n     */\n    getLogs() {\n        return this.logs;\n    }\n\n    /**\n     * Getter for all the detailed log entry ids\n     * @returns {array} Returns all of the detailed log ids\n     */\n    getDetailedPosts() {\n        return this.detailed_post_ids;\n    }\n\n    /**\n     * Toggles view mode of all posts in detailed view\n     * @returns {undefined}\n     */\n    toggleAllPostView() {\n        this.detailed_post_ids = this.showAllPosts ? this.posts : [];\n        this.showAllPosts = !this.showAllPosts;\n        this.notify();\n    }\n\n    /**\n     * Getter for show/collapse all button state\n     * @returns {boolean} Button state\n     */\n    isShowAll() {\n        return this.showAllPosts;\n    }\n\n    /**\n     * Function for adding post in detailed view posts list\n     * @param {Integer} post_id ID of post to add\n     * @returns {undefined}\n     */\n    addPost(post_id) {\n        if (!(post_id in this.posts)) {\n            this.posts.push(post_id);\n        }\n    }\n\n    /**\n     * Show log entry in detailed view\n     * @param {Integer} id of log to show detailed\n     * @returns {undefined}\n     */\n    showPostDetailed(id) {\n        this.detailed_post_ids.push(id);\n        this.notify();\n    }\n\n    /**\n     * Show log entry collapsed\n     * @param {Integer} id of log to collapsed\n     * @returns {undefined}\n     */\n    collapsePost(id) {\n        const index = this.detailed_post_ids.indexOf(id, 0);\n        if (index > -1) {\n            this.detailed_post_ids.splice(index, 1);\n        }\n        this.notify();\n    }\n\n    /**\n     * Getter for the filter operation of tags\n     * @returns {String} The filter operation to be performed on the tags (AND, OR)\n     */\n    getTagFilterOperation() {\n        return this.tagFilterOperation;\n    }\n\n    /**\n     * Getter for the filter operation of runs\n     * @returns {String} The filter operation to be performed on the runs (AND, OR)\n     */\n    getRunFilterOperation() {\n        return this.runFilterOperation;\n    }\n\n    /**\n     * Getter for show more tags criteria\n     * @returns {Boolean} Returns if more tags should be shown above the predefined limit\n     */\n    shouldShowMoreTags() {\n        return this.moreTags;\n    }\n\n    /**\n     * Getter for show more runs criteria\n     * @returns {Boolean} Returns if more runs should be shown above the predefined limit\n     */\n    shouldShowMoreRuns() {\n        return this.moreRuns;\n    }\n\n    /**\n     * Getter for visible log dropdown\n     * @returns {Number} Returns if the dropdown for choosing an amount of logs should be visible\n     */\n    isAmountDropdownVisible() {\n        return this.amountDropdownVisible;\n    }\n\n    /**\n     * Getter for logs per page\n     * @returns {Number} Returns the number of logs to show on a single page\n     */\n    getLogsPerPage() {\n        return this.logsPerPage;\n    }\n\n    /**\n     * Getter for the currently selected page\n     * @returns {Number} The currently selected page\n     */\n    getSelectedPage() {\n        return this.selectedPage;\n    }\n\n    /**\n     * Getter for total pages\n     * @returns {Number} Returns the total amount of pages available for the page selector\n     */\n    getTotalPages() {\n        return this.totalPages;\n    }\n\n    /**\n     * Getter for the created log\n     * @returns {RemoteData} the log created by the Create Log screen\n     */\n    getCreatedLog() {\n        return this.createdLog;\n    }\n\n    /**\n     * Getter for log numbers\n     * @returns {string} The run numbers\n     */\n    getRunNumbers() {\n        return this.runNumbers;\n    }\n\n    /**\n     * Returns all filtering, sorting and pagination settings to their default values\n     * @param {Boolean} fetch Whether to refetch all logs after filters have been reset\n     * @return {undefined}\n     */\n    resetLogsParams(fetch = true) {\n        this.expandedFilters = [];\n        this.activeFilters = [];\n\n        this.titleFilterText = '';\n        this.titleFilterDebounce = null;\n\n        this.authorFilterText = '';\n        this.authorFilterDebounce = null;\n\n        this.createdFilterFrom = '';\n        this.createdFilterTo = '';\n        this.createdFilterDebounce = null;\n\n        this.tagFilterOperation = 'AND';\n        this.tagFilterValues = [];\n        this.moreTags = false;\n\n        this.runFilterDebounce = null;\n        this.runFilterOperation = 'AND';\n        this.runFilterValues = [];\n        this.moreRuns = false;\n\n        this.sortingColumn = '';\n        this.sortingOperation = '';\n        this.sortingPreviewColumn = '';\n        this.sortingPreviewOperation = '';\n\n        this.amountDropdownVisible = false;\n        this.logsPerPage = 10;\n        this.selectedPage = 1;\n        this.totalPages = 1;\n\n        /**\n         * Value saved from perPageAmountInputComponent\n         * @see perPageAmountInputComponent\n         * @type {number}\n         */\n        this.customPerPage = 10;\n\n        if (fetch) {\n            this.fetchAllLogs();\n        }\n    }\n\n    /**\n     * Checks if any filter value has been modified from their default (empty)\n     * @returns {Boolean} If any filter is active\n     */\n    isAnyFilterActive() {\n        return (\n            this.titleFilterText !== ''\n            || this.authorFilterText !== ''\n            || this.createdFilterFrom !== ''\n            || this.createdFilterTo !== ''\n            || this.tagFilterValues.length !== 0\n            || this.runFilterValues.length !== 0\n        );\n    }\n\n    /**\n     * Returns active filters\n     * @returns {array} array of active filters\n     */\n    getActiveFilters() {\n        this.activeFilters = [];\n\n        if (this.titleFilterText !== '') {\n            this.activeFilters.push('Title');\n        }\n        if (this.authorFilterText !== '') {\n            this.activeFilters.push('Author');\n        }\n        if (this.createdFilterFrom !== '') {\n            this.activeFilters.push('Created from');\n        }\n        if (this.createdFilterTo !== '') {\n            this.activeFilters.push('Created to');\n        }\n        if (this.tagFilterValues.length !== 0) {\n            this.activeFilters.push('Tags');\n        }\n        if (this.runFilterValues.length !== 0) {\n            this.activeFilters.push('Runs');\n        }\n\n        return this.activeFilters;\n    }\n\n    /**\n     * Toggle the expansion state (visibility) of a filter menu\n     * @param {String} targetKey The key of the filter whose visibility should be toggled\n     * @returns {undefined}\n     */\n    toggleFilterExpanded(targetKey) {\n        if (this.isFilterExpanded(targetKey)) {\n            this.expandedFilters = this.expandedFilters.filter((key) => key !== targetKey);\n        } else {\n            this.expandedFilters.push(targetKey);\n        }\n        this.notify();\n    }\n\n    /**\n     * Check if a certain filter should be expanded (visible)\n     * @param {String} targetKey The key of the filter whose visibility should be checked\n     * @returns {Boolean} Whether the provided filter is expanded or not\n     */\n    isFilterExpanded(targetKey) {\n        return this.expandedFilters.includes(targetKey);\n    }\n\n    /**\n     * Returns the current title substring filter\n     * @returns {String} The current title substring filter\n     */\n    getTitleFilter() {\n        return this.titleFilterText;\n    }\n\n    /**\n     * Sets the title substring filter if no new inputs were detected for 200 milliseconds\n     * @param {String} newTitle The title substring to apply to the filter\n     * @returns {undefined}\n     */\n    setTitleFilter(newTitle) {\n        clearTimeout(this.titleFilterDebounce);\n        this.titleFilterDebounce = setTimeout(() => {\n            this.titleFilterText = newTitle.trim();\n            this.fetchAllLogs();\n        }, 200);\n    }\n\n    /**\n     * Returns the current title substring filter\n     * @returns {String} The current title substring filter\n     */\n    getRunsFilter() {\n        return this.runFilterValues;\n    }\n\n    /**\n     * Add a run to the filter\n     * @param {string} runs The runs to be added to the filter criteria\n     * @returns {undefined}\n     */\n    setRunsFilter(runs) {\n        if (!/^[0-9,]*$/.test(runs)) {\n            return;\n        } else if (!runs.length) {\n            this.runFilterValues = [];\n            this.fetchAllLogs();\n        } else {\n            clearTimeout(this.runFilterDebounce);\n            this.runFilterDebounce = setTimeout(() => {\n                this.runFilterValues = runs.match(/\\d+/g).map(Number);\n                this.fetchAllLogs();\n            }, 500);\n        }\n    }\n\n    /**\n     * Returns the current author substring filter\n     * @returns {String} The current author substring filter\n     */\n    getAuthorFilter() {\n        return this.authorFilterText;\n    }\n\n    /**\n     * Sets the author substring filter if no new inputs were detected for 200 milliseconds\n     * @param {String} newAuthor The author substring to apply to the filter\n     * @returns {undefined}\n     */\n    setAuthorFilter(newAuthor) {\n        clearTimeout(this.authorFilterDebounce);\n        this.authorFilterDebounce = setTimeout(() => {\n            this.authorFilterText = newAuthor.trim();\n            this.fetchAllLogs();\n        }, 200);\n    }\n\n    /**\n     * Returns the current minimum creation datetime\n     * @returns {Integer} The current minimum creation datetime\n     */\n    getCreatedFilterFrom() {\n        return this.createdFilterFrom;\n    }\n\n    /**\n     * Returns the current maximum creation datetime\n     * @returns {Integer} The current maximum creation datetime\n     */\n    getCreatedFilterTo() {\n        return this.createdFilterTo;\n    }\n\n    /**\n     * Set a datetime for the creation datetime filter\n     * @param {String} key The filter value to apply the datetime to\n     * @param {Object} date The datetime to be applied to the creation datetime filter\n     * @param {Boolean} valid Whether the inserted date passes validity check\n     * @returns {undefined}\n     */\n    setCreatedFilter(key, date, valid) {\n        if (valid) {\n            this[`createdFilter${key}`] = date;\n            this.fetchAllLogs();\n        }\n    }\n\n    /**\n     * Set a datetime for the creation datetime filter, with a debounce delay\n     * @param {String} key The filter value to apply the datetime to\n     * @param {Object} date The datetime to be applied to the creation datetime filter\n     * @param {Boolean} valid Whether the inserted date passes validity check\n     * @returns {undefined}\n     */\n    setCreatedFilterWithDebounce(key, date, valid) {\n        clearTimeout(this.createdFilterDebounce);\n        this.createdFilterDebounce = setTimeout(() => this.setCreatedFilter(key, date, valid), 200);\n    }\n\n    /**\n     * Add a tag to the filter\n     * @param {string} tag The tag to be added to the filter criteria\n     * @returns {undefined}\n     */\n    addTagToFilter(tag) {\n        this.tagFilterValues = [...this.tagFilterValues, tag];\n        this.fetchAllLogs();\n    }\n\n    /**\n     * Remove a tag from the filter\n     * @param {string} targetTag The tag that should be removed\n     * @returns {undefined}\n     */\n    removeTagFromFilter(targetTag) {\n        this.tagFilterValues = this.tagFilterValues.filter((tag) => tag !== targetTag);\n        this.fetchAllLogs();\n    }\n\n    /**\n     * Remove a run from the filter\n     * @param {string} targetRun The run that should be removed\n     * @returns {undefined}\n     */\n    removeRunFromFilter(targetRun) {\n        this.runFilterValues = this.runFilterValues.filter((run) => run !== targetRun);\n        this.fetchAllLogs();\n    }\n\n    /**\n     * Checks if a tag is already defined within the user's filter criteria\n     * @param {String} tag The tag to check on\n     * @return {Boolean} Whether the tag is in the user's filter criteria\n     */\n    isTagInFilter(tag) {\n        return this.tagFilterValues.includes(tag);\n    }\n\n    /**\n     * Checks if a run is already defined within the user's filter criteria\n     * @param {String} run The run to check on\n     * @return {Boolean} Whether the run is in the user's filter criteria\n     */\n    isRunInFilter(run) {\n        return this.runFilterValues.includes(run);\n    }\n\n    /**\n     * Sets the filter operation according to the user input\n     * @param {String} operation The filter operation to be performed (AND, OR)\n     * @returns {undefined}\n     */\n    setTagFilterOperation(operation) {\n        this.tagFilterOperation = operation;\n        if (this.tagFilterValues.length > 0) {\n            this.fetchAllLogs();\n        }\n    }\n\n    /**\n     * Toggles the visibility of tag filters above the predefined limit\n     * @return {undefined}\n     */\n    toggleMoreTags() {\n        this.moreTags = !this.moreTags;\n        this.notify();\n    }\n\n    /**\n     * Toggles the visibility of run filters above the predefined limit\n     * @return {undefined}\n     */\n    toggleMoreRuns() {\n        this.moreRuns = !this.moreRuns;\n        this.notify();\n    }\n\n    /**\n     * Returns the currently set sorting operation for the given column\n     * @param {String} key The column key to check on\n     * @return {String} The sorting operation for the given column, null if this column is not selected\n     */\n    getSortingOperation(key) {\n        return key === this.sortingColumn ? this.sortingOperation : null;\n    }\n\n    /**\n     * Returns the currently set sorting preview operation for the given column\n     * @param {String} key The column key to check on\n     * @return {String} The sorting preview operation for the given column, null if this column is not hovered over\n     */\n    getSortingPreviewOperation(key) {\n        return key === this.sortingPreviewColumn ? this.sortingPreviewOperation : null;\n    }\n\n    /**\n     * Sets the sorting column and operation based on the existing values for these variables\n     * @param {String} key The column key to apply an operation to\n     * @return {undefined}\n     */\n    setSortingValues(key) {\n        if (this.sortingColumn !== key) {\n            this.sortingColumn = key;\n            this.sortingOperation = 'asc';\n        } else {\n            switch (this.sortingOperation) {\n                case '':\n                    this.sortingOperation = 'asc';\n                    break;\n                case 'asc':\n                    this.sortingOperation = 'desc';\n                    break;\n                case 'desc':\n                    this.sortingColumn = '';\n                    this.sortingOperation = '';\n                    break;\n            }\n        }\n\n        this.sortingPreviewOperation = '';\n        this.notify();\n        this.fetchAllLogs();\n    }\n\n    /**\n     * Sets the sorting preview column and operation based on the existing values for these variables\n     * @param {String} key The column key to apply an operation preview to\n     * @return {undefined}\n     */\n    setSortingPreviewValues(key) {\n        if (this.sortingPreviewColumn !== key) {\n            this.sortingPreviewColumn = key;\n            this.sortingPreviewOperation = 'asc';\n        } else {\n            switch (this.sortingOperation) {\n                case '':\n                    this.sortingPreviewOperation = 'asc';\n                    break;\n                case 'asc':\n                    this.sortingPreviewOperation = 'desc';\n                    break;\n                case 'desc':\n                    this.sortingPreviewOperation = 'none';\n                    break;\n            }\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Empties the sorting preview\n     * @return {undefined}\n     */\n    clearSortingPreviewValues() {\n        this.sortingPreviewOperation = '';\n        this.notify();\n    }\n\n    /**\n     * Toggles the visibility of the menu within the log amounts dropdown\n     * @return {Boolean} The new state of the amounts dropdown\n     */\n    toggleLogsDropdownVisible() {\n        this.amountDropdownVisible = !this.amountDropdownVisible;\n        this.notify();\n    }\n\n    /**\n     * Sets how many logs are visible per a page, in accordance with the page selector\n     * @param {Number} amount The amount of logs that should be shown per page\n     * @return {Number} The first page of the new logs, totalling the amount set by the user\n     */\n    setLogsPerPage(amount) {\n        if (this.logsPerPage !== amount) {\n            this.infiniteScrollEnabled = amount === Infinity;\n            this.logsPerPage = amount;\n            this.selectedPage = 1;\n            this.fetchAllLogs();\n        }\n\n        this.amountDropdownVisible = false;\n    }\n\n    /**\n     * Saves custom per page value\n     * @param {Number} amount The amount of logs that should be shown per page\n     * @see perPageAmountInputComponent\n     * @return {void}\n     */\n    setCustomPerPage(amount) {\n        this.customPerPage = amount;\n    }\n\n    /**\n     * Sets the page chosen through the page selector for usage in pagination, and re-fetches data based on this\n     * @param {Number} page The chosen page number\n     * @return {Number} The chosen page number\n     */\n    setSelectedPage(page) {\n        if (this.selectedPage !== page) {\n            this.selectedPage = page;\n            this.fetchAllLogs();\n        }\n    }\n\n    /**\n     * Sets all data related to the Logs to `NotAsked` and clears pagination settings.\n     * @returns {undefined}\n     */\n    clearLogs() {\n        this.logs = RemoteData.NotAsked();\n        this.collapsableColumns = [];\n        this.collapsedColumns = [];\n        this.infiniteScrollEnabled = false;\n    }\n\n    /**\n     * Clear the single editor in the model\n     * @returns {undefined}\n     */\n    clearSingleEditor() {\n        this.editor = null;\n        this.isPreviewActive = false;\n    }\n\n    /**\n     * Clear all editors in the model\n     * @returns {undefined}\n     */\n    clearAllEditors() {\n        this.isPreviewActive = false;\n        this.parentLogId = -1;\n\n        this.editor = null;\n        this.editors = {};\n\n        this.text = '';\n        this.title = '';\n        this.tags = [];\n        this.runs = [];\n        this.attachments = [];\n\n        // Remove trailing CodeMirror div(s)\n        removeElement('.CodeMirror');\n    }\n\n    /**\n     * Convert the textarea of the preview to a Markdown box\n     * @param {String} textAreaId The id of the preview box\n     * @param {Object} changeHandler The optional changehandler with 2 keys: locaiton and name to get the setter method\n     * @param {Object} readOnlyProperties Properties of the readOnlyBox\n     * @returns {undefined}\n     */\n    setMarkdownBox(textAreaId, changeHandler = {\n        location: '',\n        name: '',\n    },\n    readOnlyProperties = {\n        isReadOnly: false,\n        textValue: '',\n    }) {\n        const {\n            isReadOnly,\n            textValue,\n        } = readOnlyProperties;\n        const shouldRenderReadOnly = textValue && isReadOnly;\n        const mdBoxStyling = shouldRenderReadOnly ?\n            {\n                width: 'auto',\n                height: 'auto',\n            } : {\n                width: 'auto',\n                height: '16rem',\n            };\n\n        if (textAreaId in this.editors) {\n            this.editors[textAreaId].setValue(textValue);\n            this.notify();\n            return;\n        }\n\n        !this.isPreviewActive && setTimeout(() => {\n            this.editor = setMarkDownBox(textAreaId, this.model, changeHandler, isReadOnly, mdBoxStyling);\n        }, 40);\n\n        !this.editor && setTimeout(() => {\n            this.editor !== undefined && (this.editors[textAreaId] = this.editor);\n        }, 50);\n\n        this.isPreviewActive = !this.isPreviewActive;\n        this.notify();\n    }\n\n    /**\n     * Removes markdown box\n     * @param {String} textAreaId The id of the preview box\n     * @returns {undefined}\n     */\n    removeMarkdownBox(textAreaId) {\n        delete this.editors[textAreaId];\n        this.notify();\n    }\n\n    /**\n     * Add eligble columns for collapse to the array in the model\n     * @param {String} rowId The rowId being collapsed\n     * @param {String} name The name of the column to be collapsed\n     * @param {Integer} height Minimal height of the column\n     * @returns {undefined}\n     */\n    addCollapsableColumn(rowId, name, height) {\n        const existingColumn = this.collapsableColumns\n            .find((element) => element.rowId === rowId && element.name === name);\n        if (existingColumn) {\n            existingColumn.disabled = false;\n        } else {\n            this.collapsableColumns.push({\n                rowId,\n                name,\n                height,\n                disabled: false,\n            });\n        }\n        this.notify();\n    }\n\n    /**\n     * Remove eligble columns from the collapse array\n     * @param {String} rowId The rowId being collapsed\n     * @param {String} name The name of the column to be collapsed\n     * @returns {undefined}\n     */\n    disableCollapsableColumn(rowId, name) {\n        this.collapsableColumns\n            .find((element) => element.rowId === rowId && element.name === name).disabled = true;\n        this.notify();\n    }\n\n    /**\n     * Toggle the collapse of a column\n     * @param {String} rowId The rowId being collapsed\n     * @param {String} name The name of the column to be collapsed\n     * @returns {undefined}\n     */\n    toggleColumnCollapse(rowId, name) {\n        if (this.isColumnExpanded(rowId, name)) {\n            this.collapsedColumns = this.collapsedColumns\n                .filter((element) => !(element.rowId === rowId && element.name === name));\n        } else {\n            this.collapsedColumns.push({\n                rowId,\n                name,\n            });\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Returns wether the column should collapse or not\n     * @param {String} rowId The rowId to be checked\n     * @param {String} name The name of the column to be collapsed\n     * @returns {Boolean} Returns wether the column in the row should collapse\n     */\n    isColumnExpanded(rowId, name) {\n        return this.collapsedColumns.some((entry) => entry.rowId === rowId && entry.name === name);\n    }\n\n    /**\n     * Returns wether the column should collapse or not\n     * @param {String} rowId The rowId to be checked\n     * @param {String} name The name of the column to be collapsed\n     * @returns {Boolean} Returns wether the column in the row should collapse\n     */\n    canColumnExpand(rowId, name) {\n        return this.collapsableColumns.some((entry) => entry.rowId === rowId && entry.name === name && !entry.disabled);\n    }\n\n    /**\n     * Returns the minimal height of a column\n     * @param {String} rowId The rowId to be checked\n     * @param {String} name The name of the column\n     * @returns {Integer} The smallest known height of the specified column\n     */\n    getMinimalColumnHeight(rowId, name) {\n        const targetColumn = this.collapsableColumns.find((entry) => entry.rowId === rowId && entry.name === name);\n        return targetColumn && targetColumn.height;\n    }\n\n    /**\n     * Returns whether the filter should be shown or not\n     * @returns {Boolean} returns whether the filter should be shown\n     */\n    getShowFilters() {\n        return this.showFilters || false;\n    }\n\n    /**\n     * Sets whether the filters are shown or not\n     * @param {Boolean} showFilters Whether the filter should be shown\n     * @returns {Boolean} returns boolean\n     */\n    setShowFilters(showFilters) {\n        this.showFilters = showFilters;\n        this.notify();\n    }\n\n    /**\n     * Toggles whether the filters are shown\n     * @returns {Boolean} returns boolean\n     */\n    toggleShowFilters() {\n        this.setShowFilters(!this.getShowFilters());\n        this.notify();\n    }\n\n    /**\n     * Returns the state of table infinite scroll mode\n     * @return {boolean} The state of table infinite scroll mode\n     */\n    isInfiniteScrollEnabled() {\n        return this.infiniteScrollEnabled;\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Logs/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":71},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Pagination/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":88},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../ActiveColumns/index.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":55}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport filters from '../../../components/Filters/LogsFilter/index.js';\nimport table from '../../../components/Table/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport { amountSelector, pageSelector } from '../../../components/Pagination/index.js';\nimport activeColumns from '../ActiveColumns/index.js';\n\nconst AVAILABLE_AMOUNTS = [5, 10, 20];\n\nlet cachedPayload = null;\n\n/**\n * Table row header\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst logOverviewScreen = (model) => {\n    const data = model.logs.getLogs();\n    const logsColumns = activeColumns(model);\n\n    logsColumns.title.size = 'cell-f';\n    logsColumns.author.size = 'cell-fm';\n    logsColumns.createdAt.size = 'cell-fm';\n    logsColumns.tags.size = 'cell-fm';\n    logsColumns.replies.size = 'cell-fm';\n    logsColumns.runs.size = 'cell-fm';\n    logsColumns.attachments.size = 'cell-fm';\n\n    const amountDropdownVisible = model.logs.isAmountDropdownVisible();\n    const logsPerPage = model.logs.getLogsPerPage();\n\n    if (data.isSuccess()) {\n        cachedPayload = data.payload;\n    }\n\n    const payload = data.isSuccess() ? data.payload : cachedPayload ? cachedPayload : [];\n\n    return h('', { onremove: () => model.logs.clearLogs() }, [\n        data.isLoading() && spinner(),\n        data.isFailure() && data.payload.map(errorAlert),\n        h('.flex-row.header-container', [\n            h('h2.mv2', 'Log Entries'),\n            h('button.btn.btn-primary.mt2.ml2', {\n                onclick: () => {\n                    // eslint-disable-next-line no-undef\n                    window.clickedInFilters = true;\n                    model.logs.toggleShowFilters();\n                    setTimeout(() => {\n                        // eslint-disable-next-line no-undef\n                        window.clickedInFilters = false;\n                    }, 10);\n                },\n                id: 'openFilterToggle',\n            }, `${model.logs.getShowFilters() ? 'Close' : 'Open'} filters`),\n            h(`.w-25.filters\n            ${model.logs.getShowFilters() ? '.display-block' : '.display-none'}`, {\n                onclick: () => {\n                    // eslint-disable-next-line no-undef\n                    window.clickedInFilters = true;\n                    setTimeout(() => {\n                        // eslint-disable-next-line no-undef\n                        window.clickedInFilters = false;\n                    }, 10);\n                },\n            }, filters(model, logsColumns)),\n            h(`.w-20.filters${model.logs.isAnyFilterActive()\n            && !model.logs.getShowFilters() ? '.display-block' : '.display-none'}`, h('.f5'), `Active filters:\n            ${model.logs.getActiveFilters().join(', ')}`),\n            h('button.btn.btn-primary.w-15.h2.mlauto#create', {\n                onclick: () => model.router.go('/?page=log-create'),\n            }, 'Add Log Entries'),\n        ]),\n        h('.flex-row.mv1', [\n            h('.w-100', h('.w-100.flex-column.mh3', [\n                table(payload, logsColumns, model, (entry) => ({\n                    onclick: () => model.router.go(`?page=log-detail&id=${entry.id}`),\n                })),\n                h('.flex-row.justify-between.mv3', [\n                    h('.w-15', amountSelector(() =>\n                        model.logs.toggleLogsDropdownVisible(), (amount) => model.logs\n                        .setLogsPerPage(amount), amountDropdownVisible, AVAILABLE_AMOUNTS, logsPerPage, model.logs)),\n                    data.isSuccess()\n                    && pageSelector((page) => model.logs.setSelectedPage(page), model.logs),\n                    h('.w-15'),\n                ]),\n            ])),\n        ]),\n    ]);\n};\n\nexport default (model) => [logOverviewScreen(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Runs/ActiveColumns/index.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Runs/ActiveColumnsLogs/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/icons.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":80},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/title.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":75},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/author.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/created.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":79},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/tags.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/LogsFilter/runs.js","line":21,"column":1,"nodeType":"ImportDeclaration","endLine":21,"endColumn":73}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport { iconCommentSquare, iconPaperclip, iconCheck } from '/js/src/icons.js';\n\nimport titleFilter from '../../../components/Filters/LogsFilter/title.js';\nimport authorFilter from '../../../components/Filters/LogsFilter/author.js';\nimport createdFilter from '../../../components/Filters/LogsFilter/created.js';\nimport tagsFilter from '../../../components/Filters/LogsFilter/tags.js';\nimport runsFilter from '../../../components/Filters/LogsFilter/runs.js';\n\n/**\n * A method to display a small and simple number/icon collection as a column\n * @param {Number} count The number to display\n * @param {Object} icon The icon to display\n * @return {vnode} A wrapped vnode containing the specified icon and count\n */\nconst iconWithCountContainer = (count, icon) => count > 0 ? h('.flex-row.items-center.gray-darker', [\n    h('.f7', icon),\n    h('.f6.ml1', count),\n]) : '';\n\n/**\n * Method to retrieve the list of active columns for a generic table component\n * @param {Object} model The global model object\n * @return {Object} A collection of columns with parameters for the Log table\n */\nconst activeColumns = (model) => ({\n    id: {\n        name: 'Entry ID',\n        visible: false,\n        primary: true,\n    },\n    title: {\n        name: 'Title',\n        visible: true,\n        sortable: false,\n        size: 'cell-l',\n        expand: true,\n        filter: titleFilter(model),\n    },\n    author: {\n        name: 'Author',\n        visible: true,\n        sortable: false,\n        size: 'cell-m',\n        format: (author) => author.name,\n        filter: authorFilter(model),\n    },\n    createdAt: {\n        name: 'Created',\n        visible: true,\n        sortable: false,\n        size: 'cell-m',\n        format: (date) => new Date(date).toLocaleString(),\n        filter: createdFilter(model),\n    },\n    tags: {\n        name: 'Tags',\n        visible: true,\n        sortable: false,\n        size: 'cell-l',\n        format: (tags) => tags.map(({ text }) => text).join(', '),\n        filter: tagsFilter(model),\n    },\n    runs: {\n        name: 'Runs',\n        visible: true,\n        sortable: false,\n        size: 'cell-l',\n        format: (runs) => runs.map(({ id }) => id).join(', '),\n        filter: runsFilter(model),\n    },\n    parentLogId: {\n        name: 'Reply',\n        visible: true,\n        size: 'cell-l',\n        format: (parentLogId, log) => parentLogId === log.id ? '' : iconCheck(),\n    },\n    replies: {\n        name: '',\n        visible: true,\n        size: 'cell-xs',\n        format: (replies) => iconWithCountContainer(replies, iconCommentSquare()),\n    },\n    attachments: {\n        name: '',\n        visible: true,\n        size: 'cell-xs',\n        format: (attachments) => iconWithCountContainer(attachments.length, iconPaperclip()),\n    },\n});\n\nexport default activeColumns;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Runs/Details/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../utilities/targetURL.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../Runs/ActiveColumnsLogs/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../Flps/ActiveColumns/index.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":66},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/RunDetail/index.js","line":21,"column":1,"nodeType":"ImportDeclaration","endLine":21,"endColumn":64}],"errorCount":8,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport table from '../../../components/Table/index.js';\nimport targetURL from '../../../utilities/targetURL.js';\nimport activeColumns from '../../Runs/ActiveColumnsLogs/index.js';\nimport activeColumnsFLP from '../../Flps/ActiveColumns/index.js';\nimport runDetail from '../../../components/RunDetail/index.js';\n\n/**\n * A collection of fields to show per Run detail, optionally with special formatting\n *\n * @param {Object} model Pass the model to access the defined functions.\n * @return {Object} A key-value collection of all relevant fields\n */\nconst runDetails = (model) => {\n    if (!model.router.params.id) {\n        model.router.go('?page=run-overview');\n        return;\n    }\n\n    if (!model.router.params.panel) {\n        model.router.go(targetURL(model, 'panel', 'main'), true);\n        return;\n    }\n\n    const data = model.runs.getRun();\n    const dataLogs = model.runs.getLogsOfRun();\n    const dataFlps = model.runs.getFlpsOfRun();\n    const allTags = model.tags.getTags();\n    const tagsAvailable = allTags.payload != 0;\n    const noTagsText = 'No tags defined, please go here to create them.';\n    const selectedTags = model.runs.getSelectedTags();\n\n    if (data.isSuccess()) {\n        const activePanel = model.router.params.panel;\n\n        const panels = {\n            main: {\n                name: 'Main',\n                content: runDetail(model, data.payload),\n            },\n            logs: {\n                name: 'Log Entries',\n                content: dataLogs.match({\n                    NotAsked: () => {\n                    },\n                    Loading: () => spinner({ absolute: false }),\n                    Success: (payload) => table(payload, activeColumns(model), model, (entry) => ({\n                        style: {\n                            cursor: 'pointer',\n                        },\n                        onclick: () => model.router.go(`?page=log-detail&id=${entry.id}`),\n                    })),\n                    Failure: (payload) => payload.map((error) => h('.alert.alert-danger', error.title)),\n                }),\n            },\n            flps: {\n                name: 'FLP Statistics',\n                content: dataFlps.match({\n                    NotAsked: () => {\n                    },\n                    Loading: () => spinner({ absolute: false }),\n                    Success: (payload) => table(payload, activeColumnsFLP(model), model, (entry) => ({\n                        style: {\n                            cursor: 'pointer',\n                        },\n                        onclick: () => model.router.go(`?page=flp-detail&id=${entry.id}`),\n                    })),\n                    Failure: (payload) => payload.map((error) => h('.alert.alert-danger', error.title)),\n                }),\n            },\n        };\n\n        return [\n            h('h2.mv2', { onremove: () => model.runs.clearRun() }, `Run #${data.payload.runNumber}`),\n            h('.flex-row.mv2', [\n                h('button.btn.btn-primary.w-15.h2#create', {\n                    onclick: () => model.router.go(`/?page=log-create&id=${data.payload.runNumber}`),\n                }, 'Add Log Entries'),\n                h('button.btn.btn-success.w-15.mh2', {\n                    onclick: () => model.runs.updateRunTags(),\n                    title: 'This action will overwrite existing tags',\n                    disabled: !model.runs.selectedTagsChanged(),\n                }, 'Update tags'),\n            ]),\n            h('select#tags-control.form-control.w-30', {\n                multiple: true,\n                onchange: ({ target }) => model.runs.setSelectedTags(target.selectedOptions),\n            }, !tagsAvailable ? h('option', {\n                onclick: () => model.router.go('?page=tag-create'),\n            }, h('a#tagCreateLink', {\n            }, noTagsText)) :\n                allTags.isSuccess() ? [\n                    ...allTags.payload.map((tag) => h('option', {\n                        value: tag.id,\n                        selected: selectedTags.includes(tag.id),\n                    }, tag.text)),\n                ] : h('option', { disabled: true }, 'Loading tags...')),\n            h('.w-100', [\n                h('ul.nav.nav-tabs', Object.entries(panels).map(([id, { name }]) =>\n                    h('li.nav-item', h(`a.nav-link${activePanel === id ? '.active' : ''}`, {\n                        onclick: (e) => activePanel !== id && model.router.handleLinkEvent(e),\n                        href: targetURL(model, 'panel', id),\n                        id: `${id}-tab`,\n                    }, name)))),\n                h('.tab-content.p2', Object.entries(panels).map(([id, { content }]) =>\n                    h(`.tab-pane${activePanel === id ? '.active' : ''}`, { id: `${id}-pane` }, content))),\n            ]),\n        ];\n    } else if (data.isLoading()) {\n        return spinner();\n    } else if (data.isFailure()) {\n        return h('', [\n            data.payload.map(errorAlert),\n            h('button.btn.btn-primary.mv2', {\n                onclick: () => model.router.go('?page=run-overview'),\n            }, 'Return to Overview'),\n        ]);\n    }\n};\n\nexport default (model) => runDetails(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Runs/Export/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../ActiveColumns/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":55}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport activeColumns from '../ActiveColumns/index.js';\n\n/**\n * A function to construct the exports runs screen\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the inputs\n */\nconst exportRunsScreen = (model) => {\n    const runNumbers = model.runs.getSelectedRunNumbers() || '';\n    const runsFields = Object.keys(activeColumns());\n    const selectedRunsFields = model.runs.getSelectedRunsFields() || [];\n    const exportTypes = ['JSON', 'CSV'];\n    const selectedExportType = model.runs.getSelectedExportType() || exportTypes[0];\n    const data = model.runs.getRuns();\n    const disabled = !(runNumbers.length > 0 && selectedRunsFields.length > 0\n    && Boolean(selectedExportType)) || data.isLoading();\n\n    return h('div#export-runs', [\n        data.isFailure() && data.payload.map(errorAlert),\n\n        h('', {\n            onremove: () => model.logs.clearAllEditors(),\n        }, [\n            h('h2', 'Export Runs'),\n\n            h('label.form-check-label.f4.mt2', { for: 'run-number' }, 'Run numbers'),\n            h('label.form-check-label.f6', { for: 'run-number' }, 'Select which runs with one or multiple ' +\n                'run numbers, separated by commas.\\''),\n            h('input#run-number.form-control.w-100', {\n                placeholder: 'Enter the run numbers...',\n                value: runNumbers,\n                oninput: (e) => model.runs.setSelectedRunNumbers(e.target.value),\n                disabled: model.router.params.id ? true : false,\n            }),\n            h('label.form-check-label.f4.mt2', { for: 'run-number' }, 'Fields'),\n            h('label.form-check-label.f6', { for: 'run-number' }, 'Select which fields to be exported\\''),\n            h('select#fields.form-control', {\n                multiple: true,\n                onchange: ({ target }) => model.runs.setSelectedRunsFields(target.selectedOptions),\n            }, [\n                ...runsFields.map((name) => h('option', {\n                    value: name,\n                    selected: selectedRunsFields.length ? selectedRunsFields.includes(name) : false,\n                }, name)),\n            ]),\n            h('label.form-check-label.f4.mt2', { for: 'run-number' }, 'Export type'),\n            h('label.form-check-label.f6', { for: 'run-number' }, 'Select output format\\''),\n            h('select#fields.form-control', {\n                multiple: false,\n                onchange: ({ target }) => model.runs.setSelectedExportType(target.value),\n            }, [\n                ...exportTypes.map((exportType) => h('option', {\n                    value: exportType,\n                    selected: selectedExportType.length ? selectedExportType.includes(exportType) : false,\n                }, exportType)),\n            ]),\n\n            h('button.shadow-level1.btn.btn-success.mt2#send', {\n                disabled,\n                onclick: async () => {\n                    const filteredRuns = await model.runs.getFilteredRuns(data.payload);\n                    await model.runs.createRunsExport(filteredRuns, 'runs');\n                },\n            }, data.isLoading() ? 'Exporting...' : 'Export'),\n        ]),\n    ]);\n};\n\nexport default (model) => exportRunsScreen(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Runs/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Filters/RunsFilter/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":71},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Pagination/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":88},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../ActiveColumns/index.js","line":20,"column":1,"nodeType":"ImportDeclaration","endLine":20,"endColumn":55}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport filters from '../../../components/Filters/RunsFilter/index.js';\nimport table from '../../../components/Table/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport { amountSelector, pageSelector } from '../../../components/Pagination/index.js';\nimport activeColumns from '../ActiveColumns/index.js';\n\nconst AVAILABLE_AMOUNTS = [5, 10, 20];\n\nlet cachedPayload = null;\n\n/**\n * Table row header\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst runsOverview = (model) => {\n    const data = model.runs.getRuns();\n    const runsColumns = activeColumns();\n\n    const amountDropdownVisible = model.runs.isAmountDropdownVisible();\n    const runsPerPage = model.runs.getRunsPerPage();\n\n    if (data.isSuccess()) {\n        cachedPayload = data.payload;\n    }\n\n    const payload = data.isSuccess() ? data.payload : cachedPayload ? cachedPayload : [];\n\n    return h('', { onremove: () => model.runs.clearRuns() }, [\n        data.isLoading() && spinner(),\n        data.isFailure() && data.payload.map(errorAlert),\n        h('.flex-row.justify-between.items-center', [\n            h('h2.mv2', 'Runs'),\n            h('button.btn.btn-primary.w-15.h2#create', {\n                onclick: () => model.router.go('/?page=run-export'),\n            }, 'Export Runs'),\n        ]),\n        h('.flex-row.mv1', [\n            h('.w-10', filters(model, runsColumns)),\n            h('.w-90', h('.w-100.flex-column.mh3', [\n                table(payload, runsColumns, model, (entry) => ({\n                    onclick: () => model.router.go(`?page=run-detail&id=${entry.id}`),\n                })),\n                h('.flex-row.justify-between.mv3', [\n                    h('.w-15', amountSelector(() =>\n                        model.runs.toggleRunsDropdownVisible(), (amount) => model.runs\n                        .setRunsPerPage(amount), amountDropdownVisible, AVAILABLE_AMOUNTS, runsPerPage, model.runs)),\n                    data.isSuccess()\n                    && pageSelector((page) => model.runs.setSelectedPage(page), model.runs),\n                    h('.w-15'),\n                ]),\n            ])),\n        ]),\n    ]);\n};\n\nexport default (model) => [runsOverview(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Runs/Runs.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../utilities/pick.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":44},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../utilities/export.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":79}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { fetchClient, Observable, RemoteData } from '/js/src/index.js';\nimport pick from '../../utilities/pick.js';\nimport { createCSVExport, createJSONExport } from '../../utilities/export.js';\n\n/**\n * Model representing handlers for runs page\n */\nexport default class Overview extends Observable {\n    /**\n     * The constructor of the Overview model object\n     * @param {Object} model Pass the model to access the defined functions\n     * @returns {Object} Constructs the Overview model\n     */\n    constructor(model) {\n        super();\n        this.model = model;\n\n        this.clearRun();\n        this.clearRuns();\n        this.clearAllEditors();\n    }\n\n    /**\n     * Retrieve every relevant run from the API\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchAllRuns() {\n        const params = {\n            'page[offset]': this.runs.payload && this.isInfiniteScrollEnabled() ?\n                this.runs.payload.length : (this.selectedPage - 1) * this.runsPerPage,\n            'page[limit]': this.isInfiniteScrollEnabled() ? this.model.INFINITE_SCROLL_CHUNK_SIZE : this.runsPerPage,\n        };\n\n        const endpoint = `/api/runs?${new URLSearchParams(params).toString()}`;\n        const response = await fetchClient(endpoint, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            if (this.isInfiniteScrollEnabled()) {\n                const payload = this.runs && this.runs.payload ? [...this.runs.payload, ...result.data] : result.data;\n                this.runs = RemoteData.success(payload);\n            } else {\n                this.runs = RemoteData.success(result.data);\n            }\n\n            this.totalPages = result.meta.page.pageCount;\n        } else {\n            this.runs = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Retrieve a specified run from the API\n     * @param {Number} id The ID of the run to be found\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchOneRun(id) {\n        this.run = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/runs/${id}`, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            this.run = RemoteData.success(result.data);\n            this.tags = this.run.payload.tags.map(({ id }) => id);\n        } else {\n            this.run = RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n        }\n        this.notify();\n    }\n\n    /**\n     * Retrieve all associated logs for a specified run from the API\n     * @param {Number} id The ID of the run to be found\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchLogsOfRun(id) {\n        this.logsOfRun = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/runs/${id}/logs`, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            this.logsOfRun = RemoteData.success(result.data);\n        } else {\n            this.logsOfRun = RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n        }\n        this.notify();\n    }\n\n    /**\n     * Retrieve all associated logs for a specified run from the API\n     * @param {Number} id The ID of the run to be found\n     * @returns {undefined} Injects the data object with the response data\n     */\n    async fetchFlpsOfRun(id) {\n        this.flpsOfRun = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/runs/${id}/flps`, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            this.flpsOfRun = RemoteData.success(result.data);\n        } else {\n            this.flpsOfRun = RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n        }\n        this.notify();\n    }\n\n    /**\n     * Filter runs based on the selected run numbers and fields to prepare it for export\n     * @param {Object} runs The runs data\n     * @returns {Object} The Filtered runs data\n     */\n    async getFilteredRuns(runs) {\n        const selectedRuns = runs.filter((run) => this.getSelectedRunNumbers().includes(run.runNumber));\n        const filteredRuns = selectedRuns.map((selectedRun) => pick(selectedRun, this.getSelectedRunsFields()));\n        return filteredRuns;\n    }\n\n    /**\n     * Create the export with the variables set in the model, handling errors appropriately\n     * @param {Object} content The source content.\n     * @param {String} fileName The name of the file including the output format.\n     * @return {void}\n     */\n    async createRunsExport(content, fileName) {\n        this.getSelectedExportType() == 'CSV' ?\n            createCSVExport(content, `${fileName}.csv`, 'text/csv;charset=utf-8;')\n            : createJSONExport(content, `${fileName}.json`, 'application/json');\n    }\n\n    /**\n     * Getter for a singular run data\n     * @returns {RemoteData} Returns a run\n     */\n    getRun() {\n        return this.run;\n    }\n\n    /**\n     * Getter for Logs data associated with a singular run\n     * @returns {RemoteData} Returns the logs of a run\n     */\n    getLogsOfRun() {\n        return this.logsOfRun;\n    }\n\n    /**\n     * Getter for Logs data associated with a singular run\n     * @returns {RemoteData} Returns the logs of a run\n     */\n    getFlpsOfRun() {\n        return this.flpsOfRun;\n    }\n\n    /**\n     * Getter for all the run data\n     * @returns {RemoteData} Returns all of the filtered runs\n     */\n    getRuns() {\n        return this.runs;\n    }\n\n    /**\n     * Getter for visible run dropdown\n     * @returns {Number} Returns if the dropdown for choosing an amount of runs should be visible\n     */\n    isAmountDropdownVisible() {\n        return this.amountDropdownVisible;\n    }\n\n    /**\n     * Getter for runs per page\n     * @returns {Number} Returns the number of runs to show on a single page\n     */\n    getRunsPerPage() {\n        return this.runsPerPage;\n    }\n\n    /**\n     * Getter for run numbers\n     * @returns {string} The run numbers\n     */\n    getRunNumbers() {\n        return this.runNumbers;\n    }\n\n    /**\n     * Getter for the currently selected page\n     * @returns {Number} The currently selected page\n     */\n    getSelectedPage() {\n        return this.selectedPage;\n    }\n\n    /**\n     * Get the field values that will be exported\n     * @returns {Array} the field objects of the current export being created\n     */\n    getSelectedRunsFields() {\n        return this.selectedRunsFields;\n    }\n\n    /**\n     * Get the run numbers of the runs that will be exported\n     * @returns {Array} the field objects of the current export being created\n     */\n    getSelectedRunNumbers() {\n        return this.selectedRunNumbers;\n    }\n\n    /**\n     * Get the output format of the export\n     * @returns {Array} the field objects of the current export being created\n     */\n    getSelectedExportType() {\n        return this.selectedExportType;\n    }\n\n    /**\n     * Returns all filtering, sorting and pagination settings to their default values\n     * @param {Boolean} fetch Whether to refetch all logs after filters have been reset\n     * @return {undefined}\n     */\n    resetLogsParams(fetch = true) {\n        this.expandedFilters = [];\n\n        this.sortingColumn = '';\n        this.sortingOperation = '';\n        this.sortingPreviewColumn = '';\n        this.sortingPreviewOperation = '';\n\n        this.amountDropdownVisible = false;\n        this.logsPerPage = 10;\n        this.selectedPage = 1;\n        this.totalPages = 1;\n\n        if (fetch) {\n            this.fetchAllLogs();\n        }\n    }\n\n    /**\n     * Checks if any filter value has been modified from their default (empty)\n     * @returns {Boolean} If any filter is active\n     */\n    isAnyFilterActive() {\n        return false;\n    }\n\n    /**\n     * Toggle the expansion state (visibility) of a filter menu\n     * @param {String} targetKey The key of the filter whose visibility should be toggled\n     * @returns {undefined}\n     */\n    toggleFilterExpanded(targetKey) {\n        if (this.isFilterExpanded(targetKey)) {\n            this.expandedFilters = this.expandedFilters.filter((key) => key !== targetKey);\n        } else {\n            this.expandedFilters.push(targetKey);\n        }\n        this.notify();\n    }\n\n    /**\n     * Check if a certain filter should be expanded (visible)\n     * @param {String} targetKey The key of the filter whose visibility should be checked\n     * @returns {Boolean} Whether the provided filter is expanded or not\n     */\n    isFilterExpanded(targetKey) {\n        return this.expandedFilters.includes(targetKey);\n    }\n\n    /**\n     * Getter for total pages\n     * @returns {Number} Returns the total amount of pages available for the page selector\n     */\n    getTotalPages() {\n        return this.totalPages;\n    }\n\n    /**\n     * Toggles the visibility of the menu within the run amounts dropdown\n     * @return {Boolean} The new state of the amounts dropdown\n     */\n    toggleRunsDropdownVisible() {\n        this.amountDropdownVisible = !this.amountDropdownVisible;\n        this.notify();\n    }\n\n    /**\n     * Sets how many runs are visible per a page, in accordance with the page selector\n     * @param {Number} amount The amount of runs that should be shown per page\n     * @return {Number} The first page of the new runs, totalling the amount set by the user\n     */\n    setRunsPerPage(amount) {\n        if (this.runsPerPage !== amount) {\n            if (amount === Infinity) {\n                this.infiniteScrollEnabled = true;\n                // Set step for incremental loading\n                this.runsPerPage = 19;\n            } else {\n                this.infiniteScrollEnabled = false;\n                this.runsPerPage = amount;\n            }\n            this.selectedPage = 1;\n            this.fetchAllRuns();\n        }\n\n        this.amountDropdownVisible = false;\n    }\n\n    /**\n     * Set the runNumbers parameter of the current export being created\n     * @param {string} selectedRunNumbers Received string from the view\n     * @return {void}\n     */\n    setSelectedRunNumbers(selectedRunNumbers) {\n        this.selectedRunNumbers = selectedRunNumbers;\n        this.notify();\n    }\n\n    /**\n     * Set the export type parameter of the current export being created\n     * @param {string} selectedExportType Received string from the view\n     * @return {void}\n     */\n    setSelectedExportType(selectedExportType) {\n        this.selectedExportType = selectedExportType;\n        this.notify();\n    }\n\n    /**\n     * Saves custom per page value\n     * @param {Number} amount The amount of runs that should be shown per page\n     * @see perPageAmountInputComponent\n     * @return {void}\n     */\n    setCustomPerPage(amount) {\n        this.customPerPage = amount;\n    }\n\n    /**\n     * Sets the page chosen through the page selector for usage in pagination, and re-fetches data based on this\n     * @param {Number} page The chosen page number\n     * @return {Number} The chosen page number\n     */\n    setSelectedPage(page) {\n        if (this.selectedPage !== page) {\n            this.selectedPage = page;\n            this.fetchAllRuns();\n            this.notify();\n        }\n    }\n\n    /**\n     * Updates the selected fields ID array according to the HTML attributes of the options\n     * @param {HTMLCollection} selectedOptions The currently selected fields by the user,\n     * according to HTML specification\n     * @returns {undefined}\n     */\n    setSelectedRunsFields(selectedOptions) {\n        this.selectedRunsFields = [];\n        [...selectedOptions].map((selectedOption) =>\n            this.selectedRunsFields.push(selectedOption.value));\n        this.notify();\n    }\n\n    /**\n     * Sets all data related to a run to their defaults.\n     * @returns {undefined}\n     */\n    clearRun() {\n        this.run = RemoteData.NotAsked();\n        this.logsOfRun = RemoteData.NotAsked();\n        this.flpsOfRun = RemoteData.NotAsked();\n    }\n\n    /**\n     * Sets all data related to the runs to their defaults.\n     * @returns {undefined}\n     */\n    clearRuns() {\n        this.runs = RemoteData.NotAsked();\n        this.collapsedColumns = [];\n        this.collapsableColumns = [];\n\n        this.expandedFilters = [];\n\n        this.amountDropdownVisible = false;\n        this.runsPerPage = 10;\n        this.selectedPage = 1;\n        this.totalPages = 1;\n        this.infiniteScrollEnabled = false;\n\n        /**\n         * Value saved from perPageAmountInputComponent\n         * @see perPageAmountInputComponent\n         * @type {number}\n         */\n        this.customPerPage = 10;\n    }\n\n    /**\n     * Clear all editors in the model\n     * @returns {void}\n     */\n    clearAllEditors() {\n        this.tags = [];\n        this.tagsChanged = false;\n    }\n\n    /**\n     * Updates the selected tag ID array according to the HTML attributes of the options\n     * @param {HTMLCollection} selectedOptions The currently selected tags by the user, according to HTML specification\n     * @returns {void}\n     */\n    setSelectedTags(selectedOptions) {\n        const selectedTagsIds = Array.from(selectedOptions)\n            .map(({ value }) => parseInt(value, 10))\n            .sort((a, b) => a - b);\n        if (!selectedTagsIds.every((value, i) => value === this.tags[i])\n            || selectedTagsIds.length === 0) {\n            this.tags = selectedTagsIds;\n            this.tagsChanged = true;\n            this.notify();\n        }\n    }\n\n    /**\n     * Get the tag values of the current run being edited\n     * @returns {Array} the tag objects of the current run being edited\n     */\n    getSelectedTags() {\n        return this.tags;\n    }\n\n    /**\n     * Get the current state of tags: if they were changed by user or not\n     * @return {boolean} if tags were changed by user or not\n     */\n    selectedTagsChanged() {\n        return this.tagsChanged;\n    }\n\n    /**\n     * Update (overwrite) run tags\n     * @return {void}\n     */\n    async updateRunTags() {\n        const { id } = this.run.payload;\n        const tags = this.getSelectedTags();\n\n        this.run = RemoteData.loading();\n        this.notify();\n\n        const options = {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                tags,\n            }),\n        };\n        const response = await fetchClient(`/api/runs/${id}`, options);\n        const result = await response.json();\n\n        if (result.data) {\n            this.run = RemoteData.success(result.data);\n            this.tags = this.run.payload.tags.map(({ id }) => id);\n        } else {\n            RemoteData.failure(result.errors || [\n                {\n                    title: result.error,\n                    detail: result.message,\n                },\n            ]);\n        }\n        this.tagsChanged = false;\n        this.notify();\n    }\n\n    /**\n     * Returns the state of table infinite scroll mode\n     * @return {boolean} The state of table infinite scroll mode\n     */\n    isInfiniteScrollEnabled() {\n        return this.infiniteScrollEnabled;\n    }\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Subsystems/Details/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../utilities/targetURL.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../Logs/ActiveColumns/index.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":63}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport spinner from '../../../components/common/spinner.js';\nimport table from '../../../components/Table/index.js';\nimport targetURL from '../../../utilities/targetURL.js';\nimport activeColumns from '../../Logs/ActiveColumns/index.js';\n\n/**\n * The VNode of the Subsystem Detail screen.\n *\n * @param {*} model Pass the model to access the defined functions.\n * @return {vnode} The VNode of the Subsystem Detail screen.\n */\nconst subsystemDetails = (model) => {\n    if (!model.router.params.id) {\n        model.router.go('?page=subsystem-overview');\n        return;\n    }\n\n    if (!model.router.params.panel) {\n        model.router.go(targetURL(model, 'panel', 'main'), true);\n        return;\n    }\n\n    const data = model.subsystems.getSubsystem();\n    const dataLogs = model.subsystems.getLogsOfSubsystem();\n\n    if (data.isSuccess()) {\n        const activePanel = model.router.params.panel;\n\n        const panels = {\n            main: {\n                name: 'Main',\n                content: 'content #1',\n            },\n            logs: {\n                name: 'Logs with this subsystem',\n                content: dataLogs.match({\n                    NotAsked: () => {},\n                    Loading: () => spinner({ absolute: false }),\n                    Success: (payload) => table(payload, activeColumns(model), model, (entry) => ({\n                        style: {\n                            cursor: 'pointer',\n                        },\n                        onclick: () => model.router.go(`?page=log-detail&id=${entry.id}`),\n                    })),\n                    Failure: (payload) => payload.map((error) => h('.alert.alert-danger', error.title)),\n                }),\n            },\n        };\n\n        return [\n            h('h2.mv2', { onremove: () => model.subsystems.clearSubsystem() }, `Subsystem: ${data.payload.name}`),\n            h('.w-100', [\n                h('ul.nav.nav-tabs', Object.entries(panels).map(([id, { name }]) =>\n                    h('li.nav-item', h(`a.nav-link${activePanel === id ? '.active' : ''}`, {\n                        onclick: (e) => activePanel !== id && model.router.handleLinkEvent(e),\n                        href: targetURL(model, 'panel', id),\n                        id: `${id}-tab`,\n                    }, name)))),\n                h('.tab-content.p2', Object.entries(panels).map(([id, { content }]) =>\n                    h(`.tab-pane${activePanel === id ? '.active' : ''}`, { id: `${id}-pane` }, content))),\n            ]),\n        ];\n    } else if (data.isLoading()) {\n        return spinner();\n    } else if (data.isFailure()) {\n        return data.payload.map((error) => h('.alert.alert-danger', h('b', `${error.title}: `), error.detail));\n    }\n};\n\nexport default (model) => subsystemDetails(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Subsystems/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":56}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport spinner from '../../../components/common/spinner.js';\nimport table from '../../../components/Table/index.js';\n\nconst ACTIVE_COLUMNS = {\n    id: {\n        name: 'Entry ID',\n        visible: true,\n        size: 'cell-l',\n        primary: true,\n    },\n    name: {\n        name: 'Name',\n        visible: true,\n        size: 'cell-l',\n    },\n};\n\n/**\n * The VNode of the Subsystem Overview screen.\n *\n * @param {*} model Pass the model to access the defined functions.\n * @return {vnode} The VNode of the Subsystem Overview screen.\n */\nconst subsystemOverview = (model) => {\n    const data = model.subsystems.getSubsystems();\n\n    return [\n        h('h2.mv2', { onremove: () => model.subsystems.clearSubsystems() }, 'Subsystems'),\n        data.match({\n            NotAsked: () => {},\n            Loading: () => spinner(),\n            Success: (payload) => table(payload, ACTIVE_COLUMNS, model, (entry) => ({\n                onclick: () => model.router.go(`?page=subsystem-detail&id=${entry.id}`),\n            })),\n            Failure: (payload) => payload.map((error) => h('.alert.alert-danger', error.title)),\n        }),\n    ];\n};\n\nexport default (model) => [h('', subsystemOverview(model))];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Subsystems/Subsystems.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":13,"column":1,"nodeType":"ImportDeclaration","endLine":13,"endColumn":72}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\nimport { Observable, RemoteData, fetchClient } from '/js/src/index.js';\n\n/**\n * Subsystem model\n */\nclass SubsystemModel extends Observable {\n    /**\n     * Creates a new `Subsystem Model` instance.\n     *\n     * @param {*} model Pass the model to access the defined functions.\n     * @returns {undefined}\n     */\n    constructor(model) {\n        super();\n        this.model = model;\n\n        // Overview\n        this.clearSubsystems();\n\n        // Detail\n        this.clearSubsystem();\n    }\n\n    /**\n     * Returns the Subsystem data.\n     *\n     * @returns {RemoteData} The Subsystem data.\n     */\n    getSubsystem() {\n        return this.subsystem;\n    }\n\n    /**\n     * Returns the Logs of a subsystem.\n     *\n     * @returns {RemoteData} The Logs of a Subsystem.\n     */\n    getLogsOfSubsystem() {\n        return this.logsOfSubsystem;\n    }\n\n    /**\n     * Returns the Subsystem data.\n     *\n     * @returns {RemoteData} The Subsystems data.\n     */\n    getSubsystems() {\n        return this.subsystems;\n    }\n\n    /**\n     * Fetches all Subsystems.\n     *\n     * @returns {Promise} returns all subsystems.\n     */\n    async fetchAllSubsystems() {\n        if (this.getSubsystems().isSuccess()) {\n            // We already have this panel\n            return;\n        }\n\n        this.subsystems = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient('/api/subsystems');\n        const result = await response.json();\n\n        if (result.data) {\n            this.subsystems = RemoteData.success(result.data);\n        } else {\n            this.subsystems = RemoteData.failure(result.errors);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Fetches the Subsystems data.\n     *\n     * @param {*} subsystemId Id of the subsystem.\n     * @returns {Promise} return one subsystem.\n     */\n    async fetchOneSubsystem(subsystemId) {\n        if (this.getSubsystem().isSuccess()) {\n            // We already have this panel\n            return;\n        }\n\n        this.subsystem = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/subsystems/${subsystemId}`);\n        const result = await response.json();\n\n        if (result.data) {\n            this.subsystem = RemoteData.success(result.data);\n        } else {\n            this.subsystem = RemoteData.failure(result.errors);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Fetches the logs with provided subsystem.\n     *\n     * @param {*} subsystemId Id of the subsystem.\n     * @returns {Promise} returns the logs of a subsystem.\n     */\n    async fetchLogsOfSubsystem(subsystemId) {\n        if (this.getLogsOfSubsystem().isSuccess()) {\n            // We already have this panel\n            return;\n        }\n\n        this.logsOfSubsystem = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/subsystems/${subsystemId}/logs`);\n        const result = await response.json();\n\n        if (result.data) {\n            this.logsOfSubsystem = RemoteData.success(result.data);\n        } else {\n            this.logsOfSubsystem = RemoteData.failure(result.errors);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Sets all data related to the Subsystem to `NotAsked`.\n     *\n     * @returns {undefined}\n     */\n    clearSubsystem() {\n        this.subsystem = RemoteData.NotAsked();\n        this.logsOfSubsystem = RemoteData.NotAsked();\n    }\n\n    /**\n     * Sets all data related to the Subsystem to `NotAsked`.\n     *\n     * @returns {undefined}\n     */\n    clearSubsystems() {\n        this.subsystems = RemoteData.NotAsked();\n    }\n}\n\nexport default SubsystemModel;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Tags/ActiveColumns/index.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Tags/Create/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\n\n/**\n * A function to construct the create tag screen\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the inputs\n */\nconst createTagScreen = (model) => {\n    const text = model.tags.getText();\n    const data = model.tags.getCreatedTag();\n\n    const disabled = text.length < 3 || text.length > 20 || data.isLoading();\n\n    return h('div#create-log', [\n        data.isFailure() && data.payload.map(errorAlert),\n\n        h('', {\n            onremove: () => model.tags.clearEditor(),\n        }, [\n            h('h2', 'Create Tag'),\n\n            h('label.form-check-label.f4.mt2', { for: 'text' }, 'Text'),\n            h('input#text.form-control.w-25.mb2', {\n                placeholder: 'Enter the tag content...',\n                minlength: 3,\n                maxlength: 20,\n                value: text,\n                oninput: (e) => model.tags.setText(e.target.value),\n            }, text),\n\n            h('button.shadow-level1.btn.btn-success.mt2#send', {\n                disabled,\n                onclick: () => model.tags.createTag(),\n            }, data.isLoading() ? 'Creating...' : 'Create'),\n        ]),\n    ]);\n};\n\nexport default (model) => createTagScreen(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Tags/Details/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../utilities/targetURL.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../Runs/ActiveColumnsLogs/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":67}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport table from '../../../components/Table/index.js';\nimport targetURL from '../../../utilities/targetURL.js';\nimport activeColumns from '../../Runs/ActiveColumnsLogs/index.js';\n\n/**\n * The VNode of the Tag Detail screen.\n *\n * @param {*} model Pass the model to access the defined functions.\n * @return {vnode} The VNode of the Tag Detail screen.\n */\nconst tagDetails = (model) => {\n    if (!model.router.params.id) {\n        model.router.go('?page=tag-overview');\n        return;\n    }\n\n    if (!model.router.params.panel) {\n        model.router.go(targetURL(model, 'panel', 'main'), true);\n        return;\n    }\n\n    const data = model.tags.getTag();\n    const dataLogs = model.tags.getLogsOfTag();\n\n    if (data.isSuccess()) {\n        const activePanel = model.router.params.panel;\n\n        const panels = {\n            main: {\n                name: 'Main',\n                content: 'content #1',\n            },\n            logs: {\n                name: 'Logs with this tag',\n                content: dataLogs.match({\n                    NotAsked: () => {},\n                    Loading: () => spinner({ absolute: false }),\n                    Success: (payload) => table(payload, activeColumns(model), model, (entry) => ({\n                        style: {\n                            cursor: 'pointer',\n                        },\n                        onclick: () => model.router.go(`?page=log-detail&id=${entry.id}`),\n                    })),\n                    Failure: (payload) => payload.map(errorAlert),\n                }),\n            },\n        };\n\n        return [\n            h('h2.mv2', { onremove: () => model.tags.clearTag() }, `Tag: ${data.payload.text}`),\n            h('.w-100', [\n                h('ul.nav.nav-tabs', Object.entries(panels).map(([id, { name }]) =>\n                    h('li.nav-item', h(`a.nav-link${activePanel === id ? '.active' : ''}`, {\n                        onclick: (e) => activePanel !== id && model.router.handleLinkEvent(e),\n                        href: targetURL(model, 'panel', id),\n                        id: `${id}-tab`,\n                    }, name)))),\n                h('.tab-content.p2', Object.entries(panels).map(([id, { content }]) =>\n                    h(`.tab-pane${activePanel === id ? '.active' : ''}`, { id: `${id}-pane` }, content))),\n            ]),\n        ];\n    } else if (data.isLoading()) {\n        return spinner();\n    } else if (data.isFailure()) {\n        return data.payload.map(errorAlert);\n    }\n};\n\nexport default (model) => tagDetails(model);\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Tags/Overview/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":38},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Table/index.js","line":15,"column":1,"nodeType":"ImportDeclaration","endLine":15,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/errorAlert.js","line":16,"column":1,"nodeType":"ImportDeclaration","endLine":16,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/common/spinner.js","line":17,"column":1,"nodeType":"ImportDeclaration","endLine":17,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../components/Pagination/index.js","line":18,"column":1,"nodeType":"ImportDeclaration","endLine":18,"endColumn":88},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../ActiveColumns/index.js","line":19,"column":1,"nodeType":"ImportDeclaration","endLine":19,"endColumn":55}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { h } from '/js/src/index.js';\nimport table from '../../../components/Table/index.js';\nimport errorAlert from '../../../components/common/errorAlert.js';\nimport spinner from '../../../components/common/spinner.js';\nimport { amountSelector, pageSelector } from '../../../components/Pagination/index.js';\nimport activeColumns from '../ActiveColumns/index.js';\n\nconst AVAILABLE_AMOUNTS = [5, 10, 20];\n\nlet cachedPayload = null;\n\n/**\n * Table row header\n * @param {object} model Pass the model to access the defined functions\n * @return {vnode} Return the view of the table with the filtering options\n */\nconst tagOverview = (model) => {\n    const data = model.tags.getTags();\n    const tagsColumns = activeColumns();\n\n    const amountDropdownVisible = model.tags.isAmountDropdownVisible();\n    const tagsPerPage = model.tags.getTagsPerPage();\n\n    if (data.isSuccess()) {\n        cachedPayload = data.payload;\n    }\n\n    const payload = data.isSuccess() ? data.payload : cachedPayload ? cachedPayload : [];\n\n    return h('', { onremove: () => model.tags.cleartags() }, [\n        data.isLoading() && spinner(),\n        data.isFailure() && data.payload.map(errorAlert),\n        h('.flex-row.justify-between.items-center', [\n            h('h2.mv2', 'Tags'),\n            h('button.btn.btn-primary.w-15.h2#create', {\n                onclick: () => model.router.go('/?page=tag-create'),\n            }, 'Create tag'),\n        ]),\n        h('.flex-row.mv1', [\n            h('.w-90', h('.w-100.flex-column.mh3', [\n                table(payload, tagsColumns, model, (entry) => ({\n                    onclick: () => model.router.go(`?page=tag-detail&id=${entry.id}`),\n                })),\n                h('.flex-row.justify-between.mv3', [\n                    h('.w-15', amountSelector(() =>\n                        model.tags.toggleTagsDropdownVisible(), (amount) => model.tags\n                        .setTagsPerPage(amount), amountDropdownVisible, AVAILABLE_AMOUNTS, tagsPerPage, model.tags)),\n                    data.isSuccess()\n                    && pageSelector((page) => model.tags.setSelectedPage(page), model.tags),\n                    h('.w-15'),\n                ]),\n            ])),\n        ]),\n    ]);\n};\n\nexport default (model) => [tagOverview(model)];\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/public/views/Tags/Tags.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"/js/src/index.js","line":14,"column":1,"nodeType":"ImportDeclaration","endLine":14,"endColumn":72}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nimport { Observable, RemoteData, fetchClient } from '/js/src/index.js';\n\n/**\n * Tag model\n */\nclass TagModel extends Observable {\n    /**\n     * Creates a new `Tag Model` instance.\n     *\n     * @param {*} model Pass the model to access the defined functions.\n     * @returns {undefined}\n     */\n    constructor(model) {\n        super();\n        this.model = model;\n\n        // Overview\n        this.clearTags();\n\n        // Detail\n        this.clearTag();\n\n        // Create\n        this.clearEditor();\n    }\n\n    /**\n     * Returns the Tag data.\n     *\n     * @returns {RemoteData} The Tag data.\n     */\n    getTag() {\n        return this.tag;\n    }\n\n    /**\n     * Returns the Logs of a tag.\n     *\n     * @returns {RemoteData} The Logs of a Tag.\n     */\n    getLogsOfTag() {\n        return this.logsOfTag;\n    }\n\n    /**\n     * Returns the Tags data.\n     *\n     * @returns {RemoteData} The Tags data.\n     */\n    getTags() {\n        return this.tags;\n    }\n\n    /**\n     * Returns the currently inserted text from the tag creation screen.\n     *\n     * @returns {String} The text currently inserted in the tag creation screen.\n     */\n    getText() {\n        return this.text;\n    }\n\n    /**\n     * Returns the recently created tag, if any, from the tag creation screen.\n     *\n     * @returns {RemoteData} The recently created tag.\n     */\n    getCreatedTag() {\n        return this.createdTag;\n    }\n\n    /**\n     * Fetches all Tags.\n     *\n     * @returns {undefined}\n     */\n    async fetchAllTags() {\n        const params = {\n            'page[offset]': this.tags.payload && this.tagsPerPage === Infinity ?\n                this.tags.payload.length : (this.selectedPage - 1) * this.tagsPerPage,\n            'page[limit]': this.tagsPerPage === Infinity ? this.model.INFINITE_SCROLL_CHUNK_SIZE : this.tagsPerPage,\n        };\n\n        const endpoint = `/api/tags?${new URLSearchParams(params).toString()}`;\n        const response = await fetchClient(endpoint, { method: 'GET' });\n        const result = await response.json();\n\n        if (result.data) {\n            if (this.isInfiniteScrollEnabled()) {\n                const payload = this.tags && this.tags.payload ? [...this.tags.payload, ...result.data] : result.data;\n                this.tags = RemoteData.success(payload);\n            } else {\n                this.tags = RemoteData.success(result.data);\n            }\n\n            this.totalPages = result.meta.page.pageCount;\n        } else {\n            this.tags = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n        }\n        this.notify();\n    }\n\n    /**\n     * Fetches the Tag data.\n     *\n     * @param {*} tagId Id of the tag.\n     * @returns {undefined}\n     */\n    async fetchOneTag(tagId) {\n        this.tag = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/tags/${tagId}`);\n        const result = await response.json();\n\n        if (result.data) {\n            this.tag = RemoteData.success(result.data);\n        } else {\n            this.tag = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Fetches the logs with provided tag.\n     *\n     * @param {*} tagId Id of the tag.\n     * @returns {undefined}\n     */\n    async fetchLogsOfTag(tagId) {\n        this.logsOfTag = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient(`/api/tags/${tagId}/logs`);\n        const result = await response.json();\n\n        if (result.data) {\n            this.logsOfTag = RemoteData.success(result.data);\n        } else {\n            this.logsOfTag = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n        }\n\n        this.notify();\n    }\n\n    /**\n     * Create the log with the variables set in the model, handling errors appropriately\n     * @returns {undefined}\n     */\n    async createTag() {\n        this.createdTag = RemoteData.loading();\n        this.notify();\n\n        const response = await fetchClient('/api/tags', {\n            method: 'POST',\n            headers: {\n                Accept: 'application/json',\n                'Content-Type': 'application/json',\n            },\n            body: JSON.stringify({\n                text: this.getText(),\n            }),\n        });\n        const result = await response.json();\n\n        if (result.data) {\n            this.clearEditor();\n            await this.model.router.go(`/?page=tag-detail&id=${result.data.id}`);\n        } else {\n            this.createdTag = RemoteData.failure(result.errors || [{ title: result.error, detail: result.message }]);\n            this.notify();\n        }\n    }\n\n    /**\n     * Sets the text for the tag creation screen to a newly provided text.\n     *\n     * @param {String} text The newly inserted text.\n     * @returns {undefined}\n     */\n    setText(text) {\n        this.text = text;\n        this.notify();\n    }\n\n    /**\n     * Sets all data related to the Tag to `NotAsked`.\n     *\n     * @returns {undefined}\n     */\n    clearTag() {\n        this.tag = RemoteData.NotAsked();\n        this.logsOfTag = RemoteData.NotAsked();\n    }\n\n    /**\n     * Sets all data related to the Tags to `NotAsked`.\n     *\n     * @returns {undefined}\n     */\n    clearTags() {\n        this.tags = RemoteData.NotAsked();\n        this.collapsedColumns = [];\n        this.collapsableColumns = [];\n\n        this.expandedFilters = [];\n\n        this.amountDropdownVisible = false;\n        this.tagsPerPage = 10;\n        this.selectedPage = 1;\n        this.totalPages = 1;\n        this.infiniteScrollEnabled = false;\n\n        /**\n         * Value saved from perPageAmountInputComponent\n         * @see perPageAmountInputComponent\n         * @type {number}\n         */\n        this.customPerPage = 10;\n    }\n\n    /**\n     * Sets all data related to the Tag creation screen to a default value.\n     *\n     * @returns {undefined}\n     */\n    clearEditor() {\n        this.text = '';\n        this.createdTag = RemoteData.NotAsked();\n    }\n\n    /**\n     * Getter for visible tag dropdown\n     * @returns {Number} Returns if the dropdown for choosing an amount of tags should be visible\n     */\n    isAmountDropdownVisible() {\n        return this.amountDropdownVisible;\n    }\n\n    /**\n     * Getter for tags per page\n     * @returns {Number} Returns the number of tags to show on a single page\n     */\n    getTagsPerPage() {\n        return this.tagsPerPage;\n    }\n\n    /**\n     * Getter for total pages\n     * @returns {Number} Returns the total amount of pages available for the page selector\n     */\n    getTotalPages() {\n        return this.totalPages;\n    }\n\n    /**\n     * Getter for the currently selected page\n     * @returns {Number} The currently selected page\n     */\n    getSelectedPage() {\n        return this.selectedPage;\n    }\n\n    /**\n     * Returns the state of table infinite scroll mode\n     * @return {boolean} The state of table infinite scroll mode\n     */\n    isInfiniteScrollEnabled() {\n        return this.infiniteScrollEnabled;\n    }\n\n    /**\n     * Toggles the visibility of the menu within the log amounts dropdown\n     * @return {Boolean} The new state of the amounts dropdown\n     */\n    toggleTagsDropdownVisible() {\n        this.amountDropdownVisible = !this.amountDropdownVisible;\n        this.notify();\n    }\n\n    /**\n     * Sets how many tags are visible per a page, in accordance with the page selector\n     * @param {Number} amount The amount of tags that should be shown per page\n     * @return {Number} The first page of the new tags, totalling the amount set by the user\n     */\n    setTagsPerPage(amount) {\n        if (this.tagsPerPage !== amount) {\n            this.infiniteScrollEnabled = amount === Infinity;\n            this.tagsPerPage = amount;\n            this.selectedPage = 1;\n            this.fetchAllTags();\n        }\n\n        this.amountDropdownVisible = false;\n    }\n\n    /**\n     * Sets the page chosen through the page selector for usage in pagination, and re-fetches data based on this\n     * @param {Number} page The chosen page number\n     * @return {Number} The chosen page number\n     */\n    setSelectedPage(page) {\n        if (this.selectedPage !== page) {\n            this.selectedPage = page;\n            this.fetchAllTags();\n        }\n    }\n}\n\nexport default TagModel;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/attachments.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":13,"column":75,"nodeType":"CallExpression","endLine":13,"endColumn":100},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":14,"column":61,"nodeType":"CallExpression","endLine":14,"endColumn":84},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":15,"column":26,"nodeType":"CallExpression","endLine":15,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\nconst { attachment: { CreateAttachmentUseCase, GetAttachmentUseCase } } = require('../../usecases');\nconst { dtos: { CreateAttachmentDto, GetAttachmentDto } } = require('../../domain');\nconst { dtoValidator } = require('../utilities');\n\n/**\n * Create new attachment on log\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst createAttachment = async (request, response, next) => {\n    const value = await dtoValidator(CreateAttachmentDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const attachment = await new CreateAttachmentUseCase()\n        .execute(value);\n\n    response.status(201).json({\n        data: attachment,\n    });\n};\n\n/**\n * Find all Attachments that belong to a certain log item\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst readAttachment = async (request, response, next) => {\n    const value = await dtoValidator(GetAttachmentDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { attachment } = await new GetAttachmentUseCase()\n        .execute(value);\n    if (!attachment) {\n        response.status(400).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Attachment with this id (${request.params.attachmentId}) could not be found`,\n                },\n            ],\n        });\n        return;\n    }\n    response.status(200).sendFile(attachment.path);\n};\n\nmodule.exports = {\n    createAttachment,\n    readAttachment,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/auth.controller.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/createpdf.controller.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/flp.controller.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/flps.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":30,"column":5,"nodeType":"CallExpression","endLine":30,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":31,"column":26,"nodeType":"CallExpression","endLine":31,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    flp: {\n        GetAllFlpsUseCase,\n        GetFlpUseCase,\n        GetLogsByFlpUseCase,\n        CreateFlpUseCase,\n        UpdateFlpUseCase,\n    },\n} = require('../../usecases');\nconst {\n    dtos: {\n        GetAllFlpsDto,\n        GetFlpDto,\n        CreateFlpDto,\n        UpdateFlpDto,\n    },\n} = require('../../domain');\nconst { dtoValidator } = require('../utilities');\n\n/**\n * Get all flps.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst listFlps = async (request, response, next) => {\n    const value = await dtoValidator(GetAllFlpsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { count, flps } = await new GetAllFlpsUseCase()\n        .execute(value);\n\n    const { query: { page: { limit = 100 } = {} } } = value;\n    const totalPages = Math.ceil(count / limit);\n\n    response.status(200).json({\n        data: flps,\n        meta: {\n            page: {\n                pageCount: totalPages,\n                totalCount: count,\n            },\n        },\n    });\n};\n\n/**\n * Get flp.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getFlpById = async (request, response, next) => {\n    const value = await dtoValidator(GetFlpDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const flp = await new GetFlpUseCase()\n        .execute(value);\n\n    if (flp === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Flp with this id (${value.params.flpId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: flp,\n        });\n    }\n};\n\n/**\n * Get all logs with flp.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getLogsByFlpId = async (request, response, next) => {\n    const value = await dtoValidator(GetFlpDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const logs = await new GetLogsByFlpUseCase()\n        .execute(value);\n\n    if (logs === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Flp with this id (${value.params.flpId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: logs,\n        });\n    }\n};\n\n/**\n * Create a new flp.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst create = async (request, response, next) => {\n    const value = await dtoValidator(CreateFlpDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { result, error } = await new CreateFlpUseCase()\n        .execute(value);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n    } else {\n        response.status(201).json({ data: result });\n    }\n};\n\n/**\n * Update flp.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst update = async (request, response, next) => {\n    const value = await dtoValidator(UpdateFlpDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { result, error } = await new UpdateFlpUseCase()\n        .execute(value);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n    } else {\n        response.status(201).json({ data: result });\n    }\n};\n\nmodule.exports = {\n    getFlpById,\n    listFlps,\n    getLogsByFlpId,\n    create,\n    update,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/home.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":14,"column":82,"nodeType":"CallExpression","endLine":14,"endColumn":107}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { server: { GetDeployInformationUseCase, GetServerInformationUseCase } } = require('../../usecases');\n\n/**\n * Basic api information controller.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getServerInfo = async (request, response, next) => {\n    const serverInfo = await new GetServerInformationUseCase().execute();\n    response.status(200).json(serverInfo);\n};\n\n/**\n * Basic deploy information controller.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getDeployInfo = async (request, response, next) => {\n    const deployInfo = await new GetDeployInformationUseCase().execute();\n    response.status(200).json(deployInfo);\n};\n\nmodule.exports = {\n    getDeployInfo,\n    getServerInfo,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./attachments.controller","line":14,"column":31,"nodeType":"CallExpression","endLine":14,"endColumn":66},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./auth.controller","line":15,"column":24,"nodeType":"CallExpression","endLine":15,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./createpdf.controller","line":16,"column":29,"nodeType":"CallExpression","endLine":16,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flps.controller","line":17,"column":24,"nodeType":"CallExpression","endLine":17,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./home.controller","line":18,"column":24,"nodeType":"CallExpression","endLine":18,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./logs.controller","line":19,"column":24,"nodeType":"CallExpression","endLine":19,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overviews.controller","line":20,"column":29,"nodeType":"CallExpression","endLine":20,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./runs.controller","line":21,"column":24,"nodeType":"CallExpression","endLine":21,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./settings.controller","line":22,"column":28,"nodeType":"CallExpression","endLine":22,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystems.controller","line":23,"column":30,"nodeType":"CallExpression","endLine":23,"endColumn":64},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tags.controller","line":24,"column":24,"nodeType":"CallExpression","endLine":24,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./users.controller","line":25,"column":25,"nodeType":"CallExpression","endLine":25,"endColumn":54}],"errorCount":12,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst AttachmentsController = require('./attachments.controller');\nconst AuthController = require('./auth.controller');\nconst CreatepdfController = require('./createpdf.controller');\nconst FlpsController = require('./flps.controller');\nconst HomeController = require('./home.controller');\nconst LogsController = require('./logs.controller');\nconst OverviewsController = require('./overviews.controller');\nconst RunsController = require('./runs.controller');\nconst SettingsController = require('./settings.controller');\nconst SubsystemsController = require('./subsystems.controller');\nconst TagsController = require('./tags.controller');\nconst UsersController = require('./users.controller');\n\nmodule.exports = {\n    AttachmentsController,\n    AuthController,\n    CreatepdfController,\n    FlpsController,\n    HomeController,\n    LogsController,\n    OverviewsController,\n    RunsController,\n    SettingsController,\n    SubsystemsController,\n    TagsController,\n    UsersController,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/logs.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":22,"column":11,"nodeType":"CallExpression","endLine":22,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":30,"column":11,"nodeType":"CallExpression","endLine":30,"endColumn":34},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":31,"column":26,"nodeType":"CallExpression","endLine":31,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    log: {\n        CreateLogUseCase,\n        GetAllLogsUseCase,\n        GetAllLogAttachmentsUseCase,\n        GetLogAttachmentUseCase,\n        GetLogUseCase,\n        GetLogTreeUseCase,\n    } } = require('../../usecases');\nconst {\n    dtos: {\n        CreateLogDto,\n        GetAllLogsDto,\n        GetAllLogAttachmentsDto,\n        GetLogAttachmentDto,\n        GetLogDto,\n    } } = require('../../domain');\nconst { dtoValidator } = require('../utilities');\n\n/**\n * Create a new log\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst createLog = async (request, response, next) => {\n    const value = await dtoValidator(CreateLogDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { result, error } = await new CreateLogUseCase()\n        .execute(value);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n    } else {\n        response.status(201).json({ data: result });\n    }\n};\n\n/**\n * Get all attachments from log\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getAllAttachments = async (request, response, next) => {\n    const value = await dtoValidator(GetAllLogAttachmentsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const attachments = await new GetAllLogAttachmentsUseCase()\n        .execute(value);\n\n    if (attachments) {\n        response.json({ data: attachments });\n    } else {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Log with this id (${request.params.logId}) could not be found`,\n                },\n            ],\n        });\n    }\n};\n\n/**\n * Get attachment from log\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getAttachment = async (request, response, next) => {\n    const dto = await dtoValidator(GetLogAttachmentDto, request, response);\n    if (!dto) {\n        return;\n    }\n\n    const { result, error } = await new GetLogAttachmentUseCase()\n        .execute(dto);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n        return;\n    }\n\n    response.status(200).sendFile(result.path);\n};\n\n/**\n * Get all logs.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst listLogs = async (request, response, next) => {\n    const value = await dtoValidator(GetAllLogsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { count, logs } = await new GetAllLogsUseCase()\n        .execute(value);\n\n    const { query: { page: { limit = 100 } = {} } } = value;\n    const totalPages = Math.ceil(count / limit);\n\n    response.status(200).json({\n        data: logs,\n        meta: {\n            page: {\n                pageCount: totalPages,\n                totalCount: count,\n            },\n        },\n    });\n};\n\n/**\n * Get the Log tree for a given Log.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getLogTree = async (request, response, next) => {\n    const value = await dtoValidator(GetLogDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const log = await new GetLogTreeUseCase()\n        .execute(value);\n\n    if (log === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Log with this id (${request.params.logId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: log,\n        });\n    }\n};\n\n/**\n * Lists all tags associated with a log.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst listTagsByLogId = async (request, response, next) => {\n    const value = await dtoValidator(GetLogDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const log = await new GetLogUseCase()\n        .execute(value);\n\n    if (log === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Log with this id (${request.params.logId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: log.tags,\n        });\n    }\n};\n\n/**\n * Patch run on log.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst patchRun = (request, response, next) => {\n    response.status(501).json({\n        errors: [\n            {\n                status: '501',\n                title: 'Not implemented',\n            },\n        ],\n    });\n};\n\n/**\n * Get log.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getLogById = async (request, response, next) => {\n    const value = await dtoValidator(GetLogDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const log = await new GetLogUseCase()\n        .execute(value);\n\n    if (log === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Log with this id (${value.params.logId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: log,\n        });\n    }\n};\n\nmodule.exports = {\n    createLog,\n    getAllAttachments,\n    getAttachment,\n    listLogs,\n    listTagsByLogId,\n    getLogById,\n    getLogTree,\n    patchRun,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/overviews.controller.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/runs.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":24,"column":5,"nodeType":"CallExpression","endLine":24,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":33,"column":5,"nodeType":"CallExpression","endLine":33,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":34,"column":26,"nodeType":"CallExpression","endLine":34,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    run: {\n        GetAllRunsUseCase,\n        GetRunUseCase,\n        GetLogsByRunUseCase,\n        StartRunUseCase,\n        EndRunUseCase,\n        GetFlpsByRunUseCase,\n        UpdateRunTagsUseCase,\n    },\n} = require('../../usecases');\nconst {\n    dtos: {\n        GetAllRunsDto,\n        GetRunDto,\n        UpdateRunTagsDto,\n        StartRunDto,\n        EndRunDto,\n    },\n} = require('../../domain');\nconst { dtoValidator } = require('../utilities');\n\n/**\n * Get all runs.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst listRuns = async (request, response, next) => {\n    const value = await dtoValidator(GetAllRunsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { count, runs } = await new GetAllRunsUseCase()\n        .execute(value);\n\n    const { query: { page: { limit = 100 } = {} } } = value;\n    const totalPages = Math.ceil(count / limit);\n\n    response.status(200).json({\n        data: runs,\n        meta: {\n            page: {\n                pageCount: totalPages,\n                totalCount: count,\n            },\n        },\n    });\n};\n\n/**\n * Get run.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getRunById = async (request, response, next) => {\n    const value = await dtoValidator(GetRunDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const run = await new GetRunUseCase()\n        .execute(value);\n\n    if (run === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Run with this id (${value.params.runId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: run,\n        });\n    }\n};\n\n/**\n * Get all logs with run.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getLogsByRunId = async (request, response, next) => {\n    const value = await dtoValidator(GetRunDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const logs = await new GetLogsByRunUseCase()\n        .execute(value);\n\n    if (logs === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Run with this id (${value.params.runId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: logs,\n        });\n    }\n};\n\n/**\n * Get all logs with run.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getFlpsByRunId = async (request, response, next) => {\n    const value = await dtoValidator(GetRunDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const flps = await new GetFlpsByRunUseCase()\n        .execute(value);\n\n    if (flps === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Run with this id (${value.params.runId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: flps,\n        });\n    }\n};\n\n/**\n * Update (overwrite) tags of specified run\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {void}\n */\nconst updateRunTags = async (request, response, next) => {\n    const value = await dtoValidator(UpdateRunTagsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { result, error } = await new UpdateRunTagsUseCase().execute(value);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n    } else {\n        response.status(200).json({ data: result });\n    }\n};\n\n/**\n * Create a new Run\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst startRun = async (request, response, next) => {\n    const value = await dtoValidator(StartRunDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { result, error } = await new StartRunUseCase()\n        .execute(value);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n    } else {\n        response.status(201).json({ data: result });\n    }\n};\n\n/**\n * Edit end time of a run\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst endRun = async (request, response, next) => {\n    const value = await dtoValidator(EndRunDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { result, error } = await new EndRunUseCase()\n        .execute(value);\n\n    if (error) {\n        response.status(Number(error.status)).json({ errors: [error] });\n    } else {\n        response.status(201).json({ data: result });\n    }\n};\n\nmodule.exports = {\n    getRunById,\n    listRuns,\n    getLogsByRunId,\n    getFlpsByRunId,\n    startRun,\n    endRun,\n    updateRunTags,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/settings.controller.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/subsystems.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":29,"column":5,"nodeType":"CallExpression","endLine":29,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":30,"column":26,"nodeType":"CallExpression","endLine":30,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    subsystem: {\n        CreateSubsystemUseCase,\n        DeleteSubsystemUseCase,\n        GetAllSubsystemsUseCase,\n        GetLogsBySubsystemUseCase,\n        GetSubsystemUseCase,\n    },\n} = require('../../usecases');\nconst {\n    dtos: {\n        CreateSubsystemDto,\n        GetAllSubsystemsDto,\n        GetSubsystemDto,\n    },\n} = require('../../domain');\nconst { dtoValidator } = require('../utilities');\n\n/**\n * Get all subsystems.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst index = async (request, response, next) => {\n    const value = await dtoValidator(GetAllSubsystemsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { count, subsystems } = await new GetAllSubsystemsUseCase()\n        .execute(value);\n\n    const { query: { page: { limit = 100 } = {} } } = value;\n    const totalPages = Math.ceil(count / limit);\n\n    response.status(200).json({\n        data: subsystems,\n        meta: {\n            page: {\n                pageCount: totalPages,\n                totalCount: count,\n            },\n        },\n    });\n};\n\n/**\n * Get subsystem.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst read = async (request, response, next) => {\n    const value = await dtoValidator(GetSubsystemDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const subsystem = await new GetSubsystemUseCase()\n        .execute(value);\n\n    if (subsystem) {\n        response.status(200).json({\n            data: subsystem,\n        });\n    } else {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Subsystem with this id (${value.params.subsystemId}) could not be found`,\n                },\n            ],\n        });\n    }\n};\n\n/**\n * Create subsystem.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst create = async (request, response, next) => {\n    const value = await dtoValidator(CreateSubsystemDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const subsystem = await new CreateSubsystemUseCase()\n        .execute(value);\n\n    if (subsystem) {\n        response.status(201).json({\n            data: subsystem,\n        });\n    } else {\n        response.status(409).json({\n            errors: [\n                {\n                    status: '409',\n                    source: { pointer: '/data/attributes/body/text' },\n                    title: 'Conflict',\n                    detail: 'The provided entity already exists',\n                },\n            ],\n        });\n    }\n};\n\n/**\n * Delete subsystem.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst deleteSubsystem = async (request, response, next) => {\n    const value = await dtoValidator(GetSubsystemDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const subsystem = await new DeleteSubsystemUseCase()\n        .execute(value);\n\n    if (subsystem) {\n        response.status(200).json({\n            data: subsystem,\n        });\n    } else {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Subsystem with this id (${value.params.subsystemId}) could not be found`,\n                },\n            ],\n        });\n    }\n};\n\n/**\n * Get all logs with subsystem.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getLogsBySubsystemId = async (request, response, next) => {\n    const value = await dtoValidator(GetSubsystemDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const logs = await new GetLogsBySubsystemUseCase()\n        .execute(value);\n\n    if (logs === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Subsystem with this id (${value.params.subsystemId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: logs,\n        });\n    }\n};\n\nmodule.exports = {\n    create,\n    deleteSubsystem,\n    getLogsBySubsystemId,\n    index,\n    read,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/tags.controller.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../usecases","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":23,"column":62,"nodeType":"CallExpression","endLine":23,"endColumn":85},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":24,"column":26,"nodeType":"CallExpression","endLine":24,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    tag: {\n        CreateTagUseCase,\n        DeleteTagUseCase,\n        GetAllTagsUseCase,\n        GetLogsByTagUseCase,\n        GetTagUseCase,\n    },\n} = require('../../usecases');\nconst { dtos: { CreateTagDto, GetAllTagsDto, GetTagDto } } = require('../../domain');\nconst { dtoValidator } = require('../utilities');\n\n/**\n * Create a new tag.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst createTag = async (request, response, next) => {\n    const value = await dtoValidator(CreateTagDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const tag = await new CreateTagUseCase()\n        .execute(value);\n\n    if (tag) {\n        response.status(201).json({\n            data: tag,\n        });\n    } else {\n        response.status(409).json({\n            errors: [\n                {\n                    status: '409',\n                    source: { pointer: '/data/attributes/body/text' },\n                    title: 'Conflict',\n                    detail: 'The provided entity already exists',\n                },\n            ],\n        });\n    }\n};\n\n/**\n * Delete tag.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst deleteTag = async (request, response, next) => {\n    const value = await dtoValidator(GetTagDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const tag = await new DeleteTagUseCase()\n        .execute(value);\n\n    if (tag === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Tag with this id (${value.params.tagId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: tag,\n        });\n    }\n};\n\n/**\n * Get all logs with tag.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getLogsByTagId = async (request, response, next) => {\n    const value = await dtoValidator(GetTagDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const logs = await new GetLogsByTagUseCase()\n        .execute(value);\n\n    if (logs === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Tag with this id (${value.params.tagId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: logs,\n        });\n    }\n};\n\n/**\n * Get all Runs with tag.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getRuns = (request, response, next) => {\n    response.status(501).json({\n        errors: [\n            {\n                status: '501',\n                title: 'Not implemented',\n            },\n        ],\n    });\n};\n\n/**\n * Get all tags.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst listTags = async (request, response, next) => {\n    const value = await dtoValidator(GetAllTagsDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const { count, tags } = await new GetAllTagsUseCase()\n        .execute(value);\n\n    const { query: { page: { limit = 100 } = {} } } = value;\n    const totalPages = Math.ceil(count / limit);\n\n    response.status(200).json({\n        data: tags,\n        meta: {\n            page: {\n                pageCount: totalPages,\n                totalCount: count,\n            },\n        },\n    });\n};\n\n/**\n * Patch tag on log.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst patchLog = (request, response, next) => {\n    response.status(501).json({\n        errors: [\n            {\n                status: '501',\n                title: 'Not implemented',\n            },\n        ],\n    });\n};\n\n/**\n * Get tag.\n *\n * @param {Object} request The *request* object represents the HTTP request and has properties for the request query\n *                         string, parameters, body, HTTP headers, and so on.\n * @param {Object} response The *response* object represents the HTTP response that an Express app sends when it gets an\n *                          HTTP request.\n * @param {Function} next The *next* object represents the next middleware function which is used to pass control to the\n *                        next middleware function.\n * @returns {undefined}\n */\nconst getTagById = async (request, response, next) => {\n    const value = await dtoValidator(GetTagDto, request, response);\n    if (!value) {\n        return;\n    }\n\n    const tag = await new GetTagUseCase()\n        .execute(value);\n\n    if (tag === null) {\n        response.status(404).json({\n            errors: [\n                {\n                    status: '404',\n                    title: `Tag with this id (${value.params.tagId}) could not be found`,\n                },\n            ],\n        });\n    } else {\n        response.status(200).json({\n            data: tag,\n        });\n    }\n};\n\nmodule.exports = {\n    createTag,\n    deleteTag,\n    getLogsByTagId,\n    getRuns,\n    getTagById,\n    listTags,\n    patchLog,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/controllers/users.controller.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"@aliceo2/web-ui","line":15,"column":24,"nodeType":"CallExpression","endLine":15,"endColumn":50},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./routers","line":16,"column":24,"nodeType":"CallExpression","endLine":16,"endColumn":44},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../config","line":17,"column":37,"nodeType":"CallExpression","endLine":17,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":18,"column":20,"nodeType":"CallExpression","endLine":18,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../usecases","line":23,"column":5,"nodeType":"CallExpression","endLine":23,"endColumn":27}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst { HttpServer } = require('@aliceo2/web-ui');\nconst buildEndpoints = require('./routers');\nconst { JwtConfig, OpenIdConfig } = require('../config');\nconst { Logger } = require('../utilities');\nconst {\n    user: {\n        CreateOrUpdateUser,\n    },\n} = require('../usecases');\n\n/**\n * WebUI implementation of the Server.\n */\nclass WebUiServer {\n    /**\n     * Creates a new `WebUi Server` instance.\n     */\n    constructor() {\n        this.logger = Logger('HTTP');\n\n        if (!OpenIdConfig.isValid()) {\n            this.logger.info('Missing OpenID configuration');\n        }\n\n        this.http = new HttpServer({\n            port: 4000,\n            autoListen: false,\n        }, JwtConfig, OpenIdConfig.isValid() ? OpenIdConfig : null);\n\n        [this.http.router, this.http.routerPublic, this.http.routerStatics].forEach((router) => {\n            router.use(async (request, response, next) => {\n                if (process.env.NODE_ENV === 'test') {\n                    request.session = {\n                        personid: 1,\n                        id: 1,\n                        name: 'John Doe',\n                    };\n                }\n\n                if (!request.session || isNaN(request.session.personid) || request.session.personid === 0) {\n                    next();\n                    return;\n                }\n\n                const user = await new CreateOrUpdateUser().execute(request.session);\n                request.session = user;\n\n                next();\n            });\n        });\n\n        this.http.addStaticPath(path.resolve(__dirname, '..', 'public'));\n        buildEndpoints(this.http);\n    }\n\n    /**\n     * Returns the bound address, the address family name, and port of the server.\n     *\n     * @returns {Object} Object represents the bound address, the address family name, and port of the server.\n     */\n    address() {\n        return this.http.address();\n    }\n\n    /**\n     * Stops the server from accepting new connections and keeps existing connections.\n     *\n     * @returns {Promise} Promise object represents ...\n     */\n    async close() {\n        this.logger.info('Stopping...');\n\n        try {\n            await this.http.close();\n        } catch (error) {\n            this.logger.error(`Error while stopping: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Stopped');\n    }\n\n    /**\n     * Start a server listening for connections.\n     *\n     * @returns {Promise} Promise object represents ...\n     */\n    async listen() {\n        this.logger.info('Starting...');\n\n        try {\n            await this.http.listen();\n        } catch (error) {\n            this.logger.error(`Error while starting: ${error}`);\n            return Promise.reject(error);\n        }\n\n        this.logger.info('Started');\n    }\n}\n\nmodule.exports = new WebUiServer();\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/middleware/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./multer.middleware","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":56}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst multerMiddleware = require('./multer.middleware');\n\nmodule.exports = {\n    multerMiddleware,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/middleware/multer.middleware.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"multer","line":14,"column":16,"nodeType":"CallExpression","endLine":14,"endColumn":33}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst multer = require('multer');\n\nconst attachmentStorage = multer.diskStorage({\n    destination: (request, file, callback) => {\n        callback(null, '/var/storage');\n    },\n\n    filename: (request, file, callback) => {\n        callback(null, `${Date.now()}_${file.originalname}`);\n    },\n});\n\nconst attachmentMiddleware = multer({ storage: attachmentStorage }).any('attachments');\n\nmodule.exports = {\n    attachmentMiddleware,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/attachments.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":35,"nodeType":"CallExpression","endLine":14,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../middleware","line":15,"column":56,"nodeType":"CallExpression","endLine":15,"endColumn":80}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { AttachmentsController } = require('../controllers');\nconst { multerMiddleware: { attachmentMiddleware } } = require('../middleware');\n\nmodule.exports = {\n    method: 'post',\n    path: 'attachments',\n    controller: [attachmentMiddleware, AttachmentsController.createAttachment],\n    args: { public: true },\n    children: [\n        {\n            method: 'get',\n            path: ':attachmentId',\n            controller: AttachmentsController.readAttachment,\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/auth.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":53}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { AuthController } = require('../controllers');\n\nmodule.exports = {\n    children: [\n        {\n            method: 'get',\n            path: 'auth',\n            controller: AuthController.authenticate,\n            args: { pubilc: true },\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/createpdf.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":33,"nodeType":"CallExpression","endLine":14,"endColumn":58}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { CreatepdfController } = require('../controllers');\n\nmodule.exports = {\n    path: '/createpdf',\n    args: { public: false },\n    children: [\n        {\n            method: 'get',\n            path: 'getlog',\n            controller: CreatepdfController.getLog,\n        },\n        {\n            method: 'get',\n            path: 'getrunconf',\n            controller: CreatepdfController.getRunConf,\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/flps.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":53}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { FlpsController } = require('../controllers');\n\nmodule.exports = {\n    method: 'get',\n    path: '/flps',\n    controller: FlpsController.listFlps,\n    args: { public: false },\n    children: [\n        {\n            method: 'get',\n            path: ':flpId',\n            controller: FlpsController.getFlpById,\n            children: [\n                {\n                    method: 'get',\n                    path: 'logs',\n                    controller: FlpsController.getLogsByFlpId,\n                },\n            ],\n        },\n        {\n            method: 'post',\n            controller: FlpsController.create,\n        },\n        {\n            method: 'patch',\n            path: ':flpName/runs/:runNumber',\n            controller: FlpsController.update,\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/home.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":53}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { HomeController } = require('../controllers');\n\nmodule.exports = {\n    method: 'get',\n    path: '/',\n    controller: HomeController.getServerInfo,\n    args: { public: true },\n    children: [\n        {\n            method: 'get',\n            path: 'status',\n            controller: HomeController.getDeployInfo,\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./attachments.router","line":13,"column":25,"nodeType":"CallExpression","endLine":13,"endColumn":56},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./auth.router","line":14,"column":19,"nodeType":"CallExpression","endLine":14,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./createpdf.router","line":15,"column":24,"nodeType":"CallExpression","endLine":15,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flps.router","line":16,"column":19,"nodeType":"CallExpression","endLine":16,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./home.router","line":17,"column":19,"nodeType":"CallExpression","endLine":17,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./logs.router","line":18,"column":18,"nodeType":"CallExpression","endLine":18,"endColumn":42},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overviews.router","line":19,"column":23,"nodeType":"CallExpression","endLine":19,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./runs.router","line":20,"column":19,"nodeType":"CallExpression","endLine":20,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./settings.router","line":21,"column":23,"nodeType":"CallExpression","endLine":21,"endColumn":51},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystems.router","line":22,"column":25,"nodeType":"CallExpression","endLine":22,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tags.router","line":23,"column":19,"nodeType":"CallExpression","endLine":23,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./users.router","line":24,"column":20,"nodeType":"CallExpression","endLine":24,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../utilities","line":25,"column":24,"nodeType":"CallExpression","endLine":25,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../utilities","line":26,"column":34,"nodeType":"CallExpression","endLine":26,"endColumn":60}],"errorCount":14,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\nconst attachmentRoute = require('./attachments.router');\nconst authRoute = require('./auth.router');\nconst createpdfRoute = require('./createpdf.router');\nconst flpsRoute = require('./flps.router');\nconst homeRoute = require('./home.router');\nconst logRoute = require('./logs.router');\nconst overviewRoute = require('./overviews.router');\nconst runsRoute = require('./runs.router');\nconst settingsRoute = require('./settings.router');\nconst subsystemsRoute = require('./subsystems.router');\nconst tagsRoute = require('./tags.router');\nconst usersRoute = require('./users.router');\nconst { appendPath } = require('../utilities');\nconst { deepmerge, isPromise } = require('../../utilities');\n\nconst routes = [\n    attachmentRoute,\n    authRoute,\n    createpdfRoute,\n    flpsRoute,\n    homeRoute,\n    logRoute,\n    overviewRoute,\n    runsRoute,\n    settingsRoute,\n    subsystemsRoute,\n    tagsRoute,\n    usersRoute,\n];\n\n/**\n * Makes the child object inherit the args of the parent object, but keeps the overwrites.\n *\n * @param {Object} parent parent who's args will be inherited\n * @param {Object} child child who will inherit the args\n * @returns {undefined}\n */\nconst inheritArgs = (parent, child) => {\n    child.args = deepmerge(parent.args || {}, child.args || {});\n};\n\n/**\n * Route binder, used to bind routes to the httpServer.\n *\n * @param {Object} http httpServer that the routes should be bound on\n * @param {Object} route the route that should be bound\n * @param {String} [parentPath=''] the base path of the route\n * @returns {undefined}\n */\nconst bindRoute = (http, route, parentPath = '') => {\n    const localPath = appendPath(parentPath, route.path, route.pathOption);\n    if (route.method && route.controller) {\n        if (process.env.NODE_ENV === 'test') {\n            route.args.public = true;\n        }\n\n        http[route.method](localPath, ...(Array.isArray(route.controller) ? route.controller : [route.controller])\n            .map((controller) => async (...args) => {\n                const callable = controller;\n                if (isPromise(callable)) {\n                    await callable(...args).catch(args[args.length - 1]);\n                    return;\n                }\n\n                try {\n                    callable(...args);\n                } catch (error) {\n                    args[args.length - 1](error);\n                }\n            }), route.args);\n    }\n\n    if (route.children) {\n        route.children.forEach((child) => {\n            inheritArgs(route, child);\n            bindRoute(http, child, localPath);\n        });\n    }\n};\n\nmodule.exports = (http) => {\n    routes.forEach((route) => {\n        bindRoute(http, route);\n    });\n};\n\nmodule.exports.getRoutesAsList = () => {\n    const resolvedRoutes = [];\n\n    // eslint-disable-next-line require-jsdoc\n    function resolve(route, parentPath = '') {\n        const localPath = appendPath(parentPath, route.path, route.pathOption);\n\n        if (route.method && route.controller) {\n            resolvedRoutes.push({\n                method: route.method,\n                path: localPath,\n            });\n        }\n\n        if (route.children) {\n            route.children.forEach((child) => {\n                inheritArgs(route, child);\n                resolve(child, localPath);\n            });\n        }\n    }\n\n    routes.forEach((route) => resolve(route));\n\n    return resolvedRoutes;\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/logs.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../middleware","line":15,"column":56,"nodeType":"CallExpression","endLine":15,"endColumn":80}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { LogsController } = require('../controllers');\nconst { multerMiddleware: { attachmentMiddleware } } = require('../middleware');\n\nmodule.exports = {\n    method: 'get',\n    path: '/logs',\n    controller: LogsController.listLogs,\n    args: { public: false },\n    children: [\n        {\n            method: 'post',\n            controller: [attachmentMiddleware, LogsController.createLog],\n        },\n        {\n            method: 'get',\n            path: ':logId',\n            controller: LogsController.getLogById,\n            children: [\n                {\n                    method: 'get',\n                    path: 'attachments',\n                    controller: LogsController.getAllAttachments,\n                    children: [\n                        {\n                            method: 'get',\n                            path: ':attachmentId',\n                            controller: LogsController.getAttachment,\n                        },\n                    ],\n                },\n                {\n                    method: 'patch',\n                    path: 'runs',\n                    controller: LogsController.patchRun,\n                },\n                {\n                    method: 'get',\n                    path: 'tags',\n                    controller: LogsController.listTagsByLogId,\n                },\n                {\n                    method: 'get',\n                    path: 'tree',\n                    controller: LogsController.getLogTree,\n                },\n            ],\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/overviews.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":33,"nodeType":"CallExpression","endLine":14,"endColumn":58}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { OverviewsController } = require('../controllers');\n\nmodule.exports = {\n    method: 'get',\n    path: '/overviews',\n    controller: OverviewsController.index,\n    args: { public: false },\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/runs.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":53}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { RunsController } = require('../controllers');\n\nmodule.exports = {\n    path: '/runs',\n    args: { public: false },\n    children: [\n        {\n            method: 'get',\n            controller: RunsController.listRuns,\n        },\n        {\n            path: ':runId',\n            children: [\n                {\n                    method: 'get',\n                    controller: RunsController.getRunById,\n                },\n                {\n                    method: 'post',\n                    controller: RunsController.updateRunTags,\n                },\n                {\n                    method: 'get',\n                    path: 'logs',\n                    controller: RunsController.getLogsByRunId,\n                },\n                {\n                    method: 'get',\n                    path: 'flps',\n                    controller: RunsController.getFlpsByRunId,\n                },\n            ],\n        },\n        {\n            method: 'post',\n            controller: RunsController.startRun,\n        },\n        {\n            path: ':runId',\n            method: 'patch',\n            controller: RunsController.endRun,\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/settings.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":32,"nodeType":"CallExpression","endLine":14,"endColumn":57}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { SettingsController } = require('../controllers');\n\nmodule.exports = {\n    method: 'get',\n    path: '/settings',\n    controller: SettingsController.index,\n    args: { public: false },\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/subsystems.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":34,"nodeType":"CallExpression","endLine":14,"endColumn":59}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { SubsystemsController } = require('../controllers');\n\nmodule.exports = {\n    path: 'subsystems',\n    args: { public: false },\n    children: [\n        {\n            method: 'get',\n            controller: SubsystemsController.index,\n        },\n        {\n            method: 'post',\n            controller: SubsystemsController.create,\n        },\n        {\n            method: 'get',\n            path: ':subsystemId',\n            controller: SubsystemsController.read,\n            children: [\n                {\n                    method: 'delete',\n                    controller: SubsystemsController.deleteSubsystem,\n                },\n                {\n                    method: 'get',\n                    path: 'logs',\n                    controller: SubsystemsController.getLogsBySubsystemId,\n                },\n            ],\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/tags.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":53}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { TagsController } = require('../controllers');\n\nmodule.exports = {\n    path: '/tags',\n    args: { public: false },\n    children: [\n        {\n            method: 'get',\n            controller: TagsController.listTags,\n        },\n        {\n            method: 'post',\n            controller: TagsController.createTag,\n        },\n        {\n            method: 'get',\n            path: ':tagId',\n            controller: TagsController.getTagById,\n            children: [\n                {\n                    method: 'get',\n                    path: '/runs',\n                    controller: TagsController.getRuns,\n                },\n                {\n                    method: 'get',\n                    path: '/logs',\n                    controller: TagsController.getLogsByTagId,\n                },\n                {\n                    method: 'get',\n                    path: '/runs',\n                    controller: TagsController.patchRun,\n                },\n                {\n                    method: 'get',\n                    path: '/log',\n                    controller: TagsController.patchLog,\n                },\n                {\n                    method: 'delete',\n                    path: '',\n                    controller: TagsController.deleteTag,\n                },\n            ],\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/routers/users.router.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../controllers","line":14,"column":29,"nodeType":"CallExpression","endLine":14,"endColumn":54}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { UsersController } = require('../controllers');\n\nmodule.exports = {\n    method: 'get',\n    path: '/users',\n    controller: UsersController.index,\n    args: { public: false },\n    children: [\n        {\n            method: 'get',\n            path: 'profile',\n            controller: UsersController.profile,\n        },\n        {\n            method: 'get',\n            path: ':id',\n            controller: UsersController.read,\n            children: [\n                {\n                    method: 'get',\n                    path: 'tokens',\n                    controller: UsersController.getTokens,\n                },\n                {\n                    method: 'post',\n                    path: 'tokens',\n                    controller: UsersController.postTokens,\n                },\n                {\n                    method: 'get',\n                    path: 'logs',\n                    controller: UsersController.getLogs,\n                },\n            ],\n        },\n    ],\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/utilities/appendPath.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/utilities/dtoValidator.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/server/utilities/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./appendPath","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./dtoValidator","line":15,"column":22,"nodeType":"CallExpression","endLine":15,"endColumn":47}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst appendPath = require('./appendPath');\nconst dtoValidator = require('./dtoValidator');\n\nmodule.exports = {\n    appendPath,\n    dtoValidator,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/attachment/CreateAttachmentUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":30}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        AttachmentRepository,\n    },\n    utilities: {\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * CreateAttachmentUseCase\n */\nclass CreateAttachmentUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The CreateLogDto containing all data.\n     * @returns {Promise}  Promise object represents the result of this use case.\n     */\n    execute(dto) {\n        const { files, body } = dto;\n        TransactionHelper.provide(() => AttachmentRepository.insert({ ...files[0], log: body.log }));\n    }\n}\n\nmodule.exports = CreateAttachmentUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/attachment/GetAttachmentUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        AttachmentRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetAttachment\n */\nclass GetAttachment {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The CreateLogDto containing all data.\n     * @returns {Promise}  Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const queryBuilder = new QueryBuilder();\n        const { params } = dto;\n        const { attachmentId } = params;\n\n        queryBuilder.where('id').is(attachmentId);\n\n        return TransactionHelper\n            .provide(async () => ({ attachment: await AttachmentRepository.findOne(queryBuilder) }));\n    }\n}\n\nmodule.exports = GetAttachment;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/attachment/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateAttachmentUseCase","line":14,"column":33,"nodeType":"CallExpression","endLine":14,"endColumn":69},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAttachmentUseCase","line":15,"column":30,"nodeType":"CallExpression","endLine":15,"endColumn":63}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateAttachmentUseCase = require('./CreateAttachmentUseCase');\nconst GetAttachmentUseCase = require('./GetAttachmentUseCase');\n\nmodule.exports = {\n    CreateAttachmentUseCase,\n    GetAttachmentUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/flp/CreateFlpUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetFlpUseCase","line":29,"column":23,"nodeType":"CallExpression","endLine":29,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database/repositories/FlpRunNumberRepository","line":30,"column":32,"nodeType":"CallExpression","endLine":30,"endColumn":93},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../run/GetRunByRunNumberUseCase","line":31,"column":34,"nodeType":"CallExpression","endLine":31,"endColumn":76}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        FlpRepository,\n    },\n    utilities: {\n        TransactionHelper,\n    },\n} = require('../../database');\n\nconst {\n    adapters: {\n        FlpAdapter,\n    },\n} = require('../../domain');\n\nconst GetFlpUseCase = require('./GetFlpUseCase');\nconst FlpRunNumberRepository = require('../../database/repositories/FlpRunNumberRepository');\nconst GetRunByRunNumberUseCase = require('../run/GetRunByRunNumberUseCase');\n\n/**\n * CreateFlpUseCase\n */\nclass CreateFlpUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The CreateFlpDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body } = dto;\n        const { runNumber } = body;\n\n        const flp = await TransactionHelper.provide(async () => {\n            body.userId = dto.session.id || null;\n\n            if (runNumber) {\n                /**\n                 * Check if, for each runNumber, there is a run present in the DB with that runNumber\n                 * Add the run's id to runIds if there is.\n                 */\n                const run = await new GetRunByRunNumberUseCase()\n                    .execute({ params: { runNumber } });\n\n                if (!run) {\n                    return {\n                        error: {\n                            status: '400',\n                            title: `Run with run number '${runNumber}' could not be found`,\n                        },\n                    };\n                }\n                body.runIds = [run.id];\n            }\n\n            return FlpRepository.insert(FlpAdapter.toDatabase(body));\n        });\n\n        if (flp.error) {\n            return flp;\n        }\n\n        if (!flp.error && runNumber) {\n            await TransactionHelper\n                .provide(() => FlpRunNumberRepository\n                    .bulkInsert(body.runIds.map((runId) => ({ runId, flpRoleId: flp.id }))));\n        }\n\n        const result = await new GetFlpUseCase().execute({ params: { flpRoleId: flp.id } });\n        return { result };\n    }\n}\n\nmodule.exports = CreateFlpUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/flp/GetAllFlpsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database/adapters","line":23,"column":24,"nodeType":"CallExpression","endLine":23,"endColumn":58}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        FlpRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\nconst { FlpAdapter } = require('../../database/adapters');\n\n/**\n * GetAllFlpsUseCase\n */\nclass GetAllFlpsUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllFlps DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const queryBuilder = new QueryBuilder();\n        const { query = {} } = dto;\n        const { page = {}, sort = { name: 'desc' } } = query;\n\n        const { limit = 100, offset = 0 } = page;\n        queryBuilder.limit(limit);\n        queryBuilder.offset(offset);\n\n        Object.keys(sort).forEach((s) => queryBuilder.orderBy(s, sort[s]));\n\n        const {\n            count,\n            rows,\n        } = await await TransactionHelper.provide(async () => FlpRepository.findAndCountAll(queryBuilder));\n\n        return {\n            count,\n            flps: rows.map(FlpAdapter.toEntity),\n        };\n    }\n}\n\nmodule.exports = GetAllFlpsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/flp/GetFlpUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        FlpAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        FlpRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetFlpUseCase\n */\nclass GetFlpUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetFlpDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { flpId } = params;\n\n        const queryBuilder = new QueryBuilder()\n            .include('runs')\n            .where('id').is(flpId);\n\n        const flp = await TransactionHelper.provide(() => FlpRepository.findOne(queryBuilder));\n        return flp ? FlpAdapter.toEntity(flp) : null;\n    }\n}\n\nmodule.exports = GetFlpUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/flp/GetLogsByFlpUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":28,"column":5,"nodeType":"CallExpression","endLine":28,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        LogAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        LogRepository,\n        FlpRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetLogsByFlpUseCase\n */\nclass GetLogsByFlpUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetFlpDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const queryBuilder = new QueryBuilder();\n        const { params } = dto;\n        const { flpId } = params;\n\n        queryBuilder.where('id').is(flpId);\n        const logs = await TransactionHelper.provide(async () => {\n            const flp = await FlpRepository.findOne(queryBuilder);\n            return flp ? LogRepository.findAllByFlpId(flp.id) : null;\n        });\n\n        if (logs) {\n            const logsWithReplies = await LogRepository.addChildrenCountByRootLog(logs);\n            return logsWithReplies.map(LogAdapter.toEntity);\n        } else {\n            return null;\n        }\n    }\n}\n\nmodule.exports = GetLogsByFlpUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/flp/UpdateFlpUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":28,"column":5,"nodeType":"CallExpression","endLine":28,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":34,"column":5,"nodeType":"CallExpression","endLine":34,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../run/GetRunByRunNumberUseCase","line":36,"column":34,"nodeType":"CallExpression","endLine":36,"endColumn":76}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        FlpRepository,\n    },\n    utilities: {\n        TransactionHelper,\n        QueryBuilder,\n    },\n} = require('../../database');\n\nconst {\n    models: {\n        FlpRoles,\n    },\n} = require('../../database');\n\nconst {\n    adapters: {\n        FlpAdapter,\n    },\n} = require('../../domain');\n\nconst GetRunByRunNumberUseCase = require('../run/GetRunByRunNumberUseCase');\n\n/**\n * UpdateFlpUseCase\n */\nclass UpdateFlpUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The UpdateFlpUseCase containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body, params } = dto;\n        const { flpName, runNumber } = params;\n        const { nTimeframes, bytesProcessed, bytesEquipmentReadOut, bytesRecordingReadOut, bytesFairMQReadOut } = body;\n\n        return await TransactionHelper.provide(async () => {\n            body.userId = dto.session.id || null;\n\n            const runId = await new GetRunByRunNumberUseCase()\n                .execute({ params: { runNumber } });\n\n            const queryBuilder = new QueryBuilder()\n                .setModel(FlpRoles)\n                .include('runs')\n                .whereAssociation('runs', 'id').is(runId.id)\n                .where('name').is(flpName);\n\n            const flpEntity = await FlpRepository.findOne(queryBuilder);\n\n            if (flpEntity) {\n                flpEntity.nTimeframes = nTimeframes;\n                flpEntity.bytesProcessed = bytesProcessed;\n                flpEntity.bytesEquipmentReadOut = bytesEquipmentReadOut;\n                flpEntity.bytesRecordingReadOut = bytesRecordingReadOut;\n                flpEntity.bytesFairMQReadOut = bytesFairMQReadOut;\n\n                await flpEntity.save();\n            } else {\n                return {\n                    error: {\n                        status: '400',\n                        title: `flp with name (${flpName}) and the runNumber (${runNumber}) could not be found`,\n                    },\n                };\n            }\n\n            return FlpAdapter.toEntity(flpEntity);\n        });\n    }\n}\n\nmodule.exports = UpdateFlpUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/flp/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllFlpsUseCase","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetFlpUseCase","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogsByFlpUseCase","line":16,"column":29,"nodeType":"CallExpression","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateFlpUseCase","line":17,"column":26,"nodeType":"CallExpression","endLine":17,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./UpdateFlpUseCase","line":18,"column":26,"nodeType":"CallExpression","endLine":18,"endColumn":55}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst GetAllFlpsUseCase = require('./GetAllFlpsUseCase');\nconst GetFlpUseCase = require('./GetFlpUseCase');\nconst GetLogsByFlpUseCase = require('./GetLogsByFlpUseCase');\nconst CreateFlpUseCase = require('./CreateFlpUseCase');\nconst UpdateFlpUseCase = require('./UpdateFlpUseCase');\n\nmodule.exports = {\n    GetAllFlpsUseCase,\n    GetFlpUseCase,\n    GetLogsByFlpUseCase,\n    CreateFlpUseCase,\n    UpdateFlpUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./attachment","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":43},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./log","line":15,"column":13,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./run","line":16,"column":13,"nodeType":"CallExpression","endLine":16,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flp","line":17,"column":13,"nodeType":"CallExpression","endLine":17,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./server","line":18,"column":16,"nodeType":"CallExpression","endLine":18,"endColumn":35},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystem","line":19,"column":19,"nodeType":"CallExpression","endLine":19,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tag","line":20,"column":13,"nodeType":"CallExpression","endLine":20,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./user","line":21,"column":14,"nodeType":"CallExpression","endLine":21,"endColumn":31}],"errorCount":8,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst attachment = require('./attachment');\nconst log = require('./log');\nconst run = require('./run');\nconst flp = require('./flp');\nconst server = require('./server');\nconst subsystem = require('./subsystem');\nconst tag = require('./tag');\nconst user = require('./user');\n\nmodule.exports = {\n    attachment,\n    log,\n    run,\n    flp,\n    server,\n    subsystem,\n    tag,\n    user,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/CreateLogUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":23,"column":5,"nodeType":"CallExpression","endLine":23,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":29,"column":5,"nodeType":"CallExpression","endLine":29,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogUseCase","line":31,"column":23,"nodeType":"CallExpression","endLine":31,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../tag/GetAllTagsUseCase","line":32,"column":27,"nodeType":"CallExpression","endLine":32,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database/repositories/LogRunNumberRepository","line":33,"column":32,"nodeType":"CallExpression","endLine":33,"endColumn":93},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../run/GetRunByRunNumberUseCase","line":34,"column":34,"nodeType":"CallExpression","endLine":34,"endColumn":76}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        AttachmentRepository,\n        LogRepository,\n        LogTagsRepository,\n    },\n    utilities: {\n        TransactionHelper,\n    },\n} = require('../../database');\n\nconst {\n    adapters: {\n        LogAdapter,\n    },\n} = require('../../domain');\n\nconst GetLogUseCase = require('./GetLogUseCase');\nconst GetAllTagsUseCase = require('../tag/GetAllTagsUseCase');\nconst LogRunNumberRepository = require('../../database/repositories/LogRunNumberRepository');\nconst GetRunByRunNumberUseCase = require('../run/GetRunByRunNumberUseCase');\n\n/**\n * CreateLogUseCase\n */\nclass CreateLogUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The CreateLogDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body, files } = dto;\n        const { parentLogId, tags, runNumbers } = body;\n\n        const log = await TransactionHelper.provide(async () => {\n            body.userId = dto.session.id || null;\n\n            if (parentLogId) {\n                const parentLog = await new GetLogUseCase().execute({ params: { logId: parentLogId } });\n                if (!parentLog) {\n                    return {\n                        error: {\n                            status: '400',\n                            title: `Parent log with this id (${parentLogId}) could not be found`,\n                        },\n                    };\n                }\n\n                body.rootLogId = parentLog.rootLogId || parentLog.id;\n            }\n\n            if (tags) {\n                const existingTags = await new GetAllTagsUseCase()\n                    .execute({ query: { page: { filter: { ids: tags } } } });\n                const missingTags = tags.reduce((accumulator, tag) => {\n                    if (!existingTags.tags.find(({ id }) => id === tag)) {\n                        accumulator.push(tag);\n                    }\n                    return accumulator;\n                }, []);\n\n                if (missingTags.length > 0) {\n                    return {\n                        error: {\n                            status: '400',\n                            title: `Tags with these ids (${missingTags.join(', ')}) could not be found`,\n                        },\n                    };\n                }\n            }\n\n            if (runNumbers) {\n                // Parse comma-separated string to array of numbers\n                const numbers = runNumbers.split(',')\n                    .map((x) => x.trim())\n                    .map((x) => parseInt(x, 10));\n\n                // Error out if any value is NaN\n                if (numbers.some(Number.isNaN)) {\n                    return {\n                        error: {\n                            status: '400',\n                            title: 'Run numbers should be comma-separated, and should only contain numbers',\n                        },\n                    };\n                }\n\n                /**\n                 * Check if, for each runNumber, there is a run present in the DB with that runNumber\n                 * Add the run's id to runIds if there is.\n                 */\n                const runIds = [];\n                for (const runNumber of numbers) {\n                    const run = await new GetRunByRunNumberUseCase()\n                        .execute({ params: { runNumber } });\n\n                    if (!run) {\n                        return {\n                            error: {\n                                status: '400',\n                                title: `Run with run number '${runNumber}' could not be found`,\n                            },\n                        };\n                    }\n\n                    runIds.push(run.id);\n                }\n\n                body.runIds = runIds;\n            }\n\n            return LogRepository.insert(LogAdapter.toDatabase(body));\n        });\n\n        if (log.error) {\n            return log;\n        }\n\n        if (!log.error && tags) {\n            await TransactionHelper\n                .provide(() => LogTagsRepository.bulkInsert(tags.map((tag) => ({ logId: log.id, tagId: tag }))));\n        }\n\n        if (!log.error && files && files.length > 0) {\n            await TransactionHelper\n                .provide(() => AttachmentRepository.bulkInsert(files.map((file) => ({ ...file, logId: log.id }))));\n        }\n\n        if (!log.error && body.runIds && body.runIds.length > 0) {\n            await TransactionHelper\n                .provide(() => LogRunNumberRepository\n                    .bulkInsert(body.runIds.map((runId) => ({ runId, logId: log.id }))));\n        }\n\n        const result = await new GetLogUseCase().execute({ params: { logId: log.id } });\n        return { result };\n    }\n}\n\nmodule.exports = CreateLogUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/GetAllLogAttachmentsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":23,"column":5,"nodeType":"CallExpression","endLine":23,"endColumn":30}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        AttachmentRepository,\n        LogRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetAllLogAttachmentUseCase\n */\nclass GetAllLogAttachmentsUseCase {\n    /**\n     * Execute the use case.\n     *\n     * @param {Object} dto The GetAllLogAttachment DTO which contains all the request data.\n     * @returns {Promise} Promise object representing the result of the use case\n     */\n    async execute(dto = {}) {\n        const queryBuilder = new QueryBuilder();\n        const { params, query = {} } = dto;\n        const { logId } = params;\n        const { mimetype } = query;\n        queryBuilder.where('logId').is(logId);\n\n        if (query) {\n            if (mimetype) {\n                if (mimetype.includes('/')) {\n                    queryBuilder.where('mime_type').is(mimetype);\n                } else {\n                    queryBuilder.where('mime_type').startsWith(mimetype);\n                }\n            }\n        }\n\n        return TransactionHelper.provide(async () => {\n            const log = await LogRepository.findOne(new QueryBuilder().where('id').is(logId));\n            if (!log) {\n                return null;\n            }\n\n            return await AttachmentRepository.findAll(queryBuilder);\n        });\n    }\n}\n\nmodule.exports = GetAllLogAttachmentsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/GetAllLogsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":25,"column":5,"nodeType":"CallExpression","endLine":25,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database/adapters","line":26,"column":24,"nodeType":"CallExpression","endLine":26,"endColumn":58}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        LogRepository,\n        UserRepository,\n        LogTagsRepository,\n        LogRunsRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\nconst { LogAdapter } = require('../../database/adapters');\n\n/**\n * GetAllLogsUseCase\n */\nclass GetAllLogsUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllLogs DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const queryBuilder = new QueryBuilder();\n        const { query = {} } = dto;\n        const { filter, sort = { id: 'desc' }, page = {} } = query;\n\n        queryBuilder.include('user');\n        queryBuilder.include('tags');\n        queryBuilder.include('runs');\n        queryBuilder.include('subsystems');\n        queryBuilder.include('attachments');\n\n        if (filter) {\n            const { title, author, created, origin, parentLog, rootLog } = filter;\n\n            if (title) {\n                queryBuilder.where('title').substring(title);\n            }\n\n            if (author) {\n                const userQueryBuilder = new QueryBuilder();\n                userQueryBuilder.where('name').substring(author);\n                const userResults = await UserRepository.findAll(userQueryBuilder);\n                const userIds = userResults.length > 0 ? userResults.map((user) => user.id) : [0];\n                queryBuilder.where('userId').oneOf(...userIds);\n            }\n\n            if (created) {\n                const from = created.from !== undefined ? created.from : 0;\n                const to = created.to !== undefined ? created.to : new Date().getTime();\n                queryBuilder.where('createdAt').between(from, to);\n            }\n\n            if (origin) {\n                queryBuilder.where('origin').is(origin);\n            }\n\n            if (parentLog) {\n                queryBuilder.where('parentLogId').is(parentLog);\n            }\n\n            if (rootLog) {\n                queryBuilder.where('rootLogId').is(rootLog);\n            }\n        }\n\n        if (sort) {\n            const { id, title, author, createdAt, tags, runs } = sort;\n\n            if (id) {\n                queryBuilder.orderBy('id', sort.id);\n            }\n\n            if (title) {\n                queryBuilder.orderBy('title', sort.title);\n            }\n\n            if (author) {\n                queryBuilder.orderBy('name', sort.author, 'user');\n            }\n\n            if (createdAt) {\n                queryBuilder.orderBy('createdAt', sort.createdAt);\n            }\n\n            if (tags) {\n                queryBuilder.orderBy('text', sort.tags, 'tags');\n            }\n\n            if (runs) {\n                queryBuilder.orderBy('id', sort.runs, 'runs');\n            }\n        }\n\n        const { limit = 100, offset = 0 } = page;\n        queryBuilder.limit(limit);\n        queryBuilder.offset(offset);\n\n        const {\n            count,\n            rows,\n        } = await TransactionHelper.provide(async () => {\n            if (filter && filter.tag) {\n                const tagQueryBuilder = new QueryBuilder();\n                tagQueryBuilder.where('tagId').oneOf(...filter.tag.values).orderBy('logId', 'asc');\n\n                let logTags;\n                switch (filter.tag.operation) {\n                    case 'and':\n                        logTags = await LogTagsRepository\n                            .findAllAndGroup(tagQueryBuilder);\n                        logTags = logTags\n                            .filter((logTag) => filter.tag.values.every((tagId) => logTag.tagIds.includes(tagId)));\n                        break;\n                    case 'or':\n                        logTags = await LogTagsRepository\n                            .findAll(tagQueryBuilder);\n                        break;\n                }\n\n                const logIds = logTags.map((logTag) => logTag.logId);\n                queryBuilder.where('id').oneOf(...logIds);\n            }\n\n            if (filter && filter.run) {\n                const runQueryBuilder = new QueryBuilder();\n                runQueryBuilder.where('runId').oneOf(...filter.run.values).orderBy('logId', 'asc');\n\n                let logRuns;\n                switch (filter.run.operation) {\n                    case 'and':\n                        logRuns = await LogRunsRepository\n                            .findAllAndGroup(runQueryBuilder);\n                        logRuns = logRuns\n                            .filter((logRun) => filter.run.values.every((runId) => logRun.runIds.includes(runId)));\n                        break;\n                    case 'or':\n                        logRuns = await LogRunsRepository\n                            .findAll(runQueryBuilder);\n                        break;\n                }\n\n                const logIds = logRuns.map((logRun) => logRun.logId);\n                queryBuilder.where('id').oneOf(...logIds);\n            }\n\n            return LogRepository.findAndCountAll(queryBuilder);\n        });\n\n        const rowsWithReplies = await LogRepository.addChildrenCountByRootLog(rows);\n\n        return {\n            count,\n            logs: rowsWithReplies.map(LogAdapter.toEntity),\n        };\n    }\n}\n\nmodule.exports = GetAllLogsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/GetLogAttachmentUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        AttachmentRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetLogAttachmentUseCase\n */\nclass GetLogAttachmentUseCase {\n    /**\n     * Execute the use case.\n     *\n     * @param {Object} dto The GetLogAttachment DTO which contains all the request data.\n     * @returns {Promise} Promise object representing the result of the use case\n     */\n    async execute(dto) {\n        const queryBuilder = new QueryBuilder();\n        const { params } = dto;\n        const { attachmentId, logId } = params;\n        queryBuilder\n            .where('id').is(attachmentId);\n\n        const result = await TransactionHelper.provide(() => AttachmentRepository.findOne(queryBuilder));\n        if (!result) {\n            return {\n                error: {\n                    status: '404',\n                    title: `Attachment with this id (${attachmentId}) could not be found`,\n                },\n            };\n        }\n        if (result.logId !== logId) {\n            return {\n                error: {\n                    status: '400',\n                    title: `Log with this id (${logId}) does not have Attachment with this id (${attachmentId})`,\n                },\n            };\n        }\n        return { result };\n    }\n}\n\nmodule.exports = GetLogAttachmentUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/GetLogTreeUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllLogsUseCase","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogUseCase","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../presentation","line":20,"column":5,"nodeType":"CallExpression","endLine":20,"endColumn":34}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst GetAllLogsUseCase = require('./GetAllLogsUseCase');\nconst GetLogUseCase = require('./GetLogUseCase');\nconst {\n    log: {\n        toTreeView,\n    },\n} = require('../../presentation');\n\n/**\n * GetLogTreeUseCase\n */\nclass GetLogTreeUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetLogDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { logId } = params;\n\n        const log = await new GetLogUseCase()\n            .execute({ params: { logId } });\n        if (log === null) {\n            return null;\n        }\n\n        let rootLog;\n        if (log.id === log.rootLogId) {\n            rootLog = log;\n        } else {\n            rootLog = await new GetLogUseCase()\n                .execute({ params: { logId: log.rootLogId } });\n        }\n\n        const logs = await new GetAllLogsUseCase()\n            .execute({ query: { filter: { rootLog: rootLog.id }, sort: { id: 'asc' } } });\n\n        return toTreeView(rootLog, logs.logs);\n    }\n}\n\nmodule.exports = GetLogTreeUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/GetLogUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        LogAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        LogRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetLogUseCase\n */\nclass GetLogUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetLogDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { logId } = params;\n\n        const queryBuilder = new QueryBuilder()\n            .include('user')\n            .include('tags')\n            .include('runs')\n            .include('subsystems')\n            .include('attachments')\n            .where('id').is(logId);\n\n        const log = await TransactionHelper.provide(() => LogRepository.findOne(queryBuilder));\n        return log ? LogAdapter.toEntity(log) : null;\n    }\n}\n\nmodule.exports = GetLogUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/log/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateLogUseCase","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllLogsUseCase","line":15,"column":27,"nodeType":"CallExpression","endLine":15,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllLogAttachmentsUseCase","line":16,"column":37,"nodeType":"CallExpression","endLine":16,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogAttachmentUseCase","line":17,"column":33,"nodeType":"CallExpression","endLine":17,"endColumn":69},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogTreeUseCase","line":18,"column":27,"nodeType":"CallExpression","endLine":18,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogUseCase","line":19,"column":23,"nodeType":"CallExpression","endLine":19,"endColumn":49}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateLogUseCase = require('./CreateLogUseCase');\nconst GetAllLogsUseCase = require('./GetAllLogsUseCase');\nconst GetAllLogAttachmentsUseCase = require('./GetAllLogAttachmentsUseCase');\nconst GetLogAttachmentUseCase = require('./GetLogAttachmentUseCase');\nconst GetLogTreeUseCase = require('./GetLogTreeUseCase');\nconst GetLogUseCase = require('./GetLogUseCase');\n\nmodule.exports = {\n    CreateLogUseCase,\n    GetAllLogsUseCase,\n    GetAllLogAttachmentsUseCase,\n    GetLogAttachmentUseCase,\n    GetLogTreeUseCase,\n    GetLogUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/EndRunUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":28,"column":5,"nodeType":"CallExpression","endLine":28,"endColumn":28}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        RunRepository,\n    },\n    utilities: {\n        TransactionHelper,\n        QueryBuilder,\n    },\n} = require('../../database');\n\nconst {\n    adapters: {\n        RunAdapter,\n    },\n} = require('../../domain');\n\n/**\n * EndRunUseCase\n */\nclass EndRunUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The EndRunDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body, params } = dto;\n        const { runId } = params;\n        const { timeO2End, timeTrgEnd, runQuality } = body;\n\n        return await TransactionHelper.provide(async () => {\n            body.userId = dto.session.id || null;\n\n            const queryBuilder = new QueryBuilder().where('runNumber').is(runId);\n\n            const runEntity = await RunRepository.findOne(queryBuilder);\n\n            if (runEntity) {\n                runEntity.timeO2End = timeO2End;\n                runEntity.timeTrgEnd = timeTrgEnd;\n                runEntity.runQuality = runQuality;\n                await runEntity.save();\n            } else {\n                return {\n                    error: {\n                        status: '400',\n                        title: `run with this runNumber (${runId}) could not be found`,\n                    },\n                };\n            }\n\n            return RunAdapter.toEntity(runEntity);\n        });\n    }\n}\n\nmodule.exports = EndRunUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/GetAllRunsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database/adapters","line":23,"column":24,"nodeType":"CallExpression","endLine":23,"endColumn":58}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        RunRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\nconst { RunAdapter } = require('../../database/adapters');\n\n/**\n * GetAllRunsUseCase\n */\nclass GetAllRunsUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllRuns DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const queryBuilder = new QueryBuilder();\n        const { query = {} } = dto;\n        const { page = {}, sort = { runNumber: 'desc' } } = query;\n\n        const { limit = 100, offset = 0 } = page;\n        queryBuilder.include('tags');\n        queryBuilder.limit(limit);\n        queryBuilder.offset(offset);\n\n        Object.keys(sort).forEach((s) => queryBuilder.orderBy(s, sort[s]));\n\n        const {\n            count,\n            rows,\n        } = await await TransactionHelper.provide(async () => RunRepository.findAndCountAll(queryBuilder));\n\n        return {\n            count,\n            runs: rows.map(RunAdapter.toEntity),\n        };\n    }\n}\n\nmodule.exports = GetAllRunsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/GetFlpsByRunUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":23,"column":5,"nodeType":"CallExpression","endLine":23,"endColumn":30}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        FlpRepository,\n        RunRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetFlpsByRunUseCase\n */\nclass GetFlpsByRunUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetRunDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const queryBuilder = new QueryBuilder();\n        const { params } = dto;\n        const { runId } = params;\n\n        queryBuilder.where('id').is(runId);\n        return await TransactionHelper.provide(async () => {\n            const run = await RunRepository.findOne(queryBuilder);\n            return run ? FlpRepository.findAllByRunId(run.id) : null;\n        });\n    }\n}\n\nmodule.exports = GetFlpsByRunUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/GetLogsByRunUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":28,"column":5,"nodeType":"CallExpression","endLine":28,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        LogAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        LogRepository,\n        RunRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetLogsByRunUseCase\n */\nclass GetLogsByRunUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetRunDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const queryBuilder = new QueryBuilder();\n        const { params } = dto;\n        const { runId } = params;\n\n        queryBuilder.where('id').is(runId);\n        const logs = await TransactionHelper.provide(async () => {\n            const run = await RunRepository.findOne(queryBuilder);\n            return run ? LogRepository.findAllByRunId(run.id) : null;\n        });\n\n        if (logs) {\n            const logsWithReplies = await LogRepository.addChildrenCountByRootLog(logs);\n            return logsWithReplies.map(LogAdapter.toEntity);\n        } else {\n            return null;\n        }\n    }\n}\n\nmodule.exports = GetLogsByRunUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/GetRunByRunNumberUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        RunAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        RunRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetRunByRunNumberUseCase\n */\nclass GetRunByRunNumberUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetRunDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { runNumber } = params;\n\n        const queryBuilder = new QueryBuilder()\n            .where('run_number').is(runNumber);\n\n        const run = await TransactionHelper.provide(() => RunRepository.findOne(queryBuilder));\n        return run ? RunAdapter.toEntity(run) : null;\n    }\n}\n\nmodule.exports = GetRunByRunNumberUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/GetRunUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        RunAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        RunRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetRunUseCase\n */\nclass GetRunUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetRunDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { runId } = params;\n\n        const queryBuilder = new QueryBuilder()\n            .include('tags')\n            .where('id').is(runId);\n\n        const run = await TransactionHelper.provide(() => RunRepository.findOne(queryBuilder));\n\n        return run ? RunAdapter.toEntity(run) : null;\n    }\n}\n\nmodule.exports = GetRunUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/StartRunUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../run/GetRunUseCase","line":29,"column":23,"nodeType":"CallExpression","endLine":29,"endColumn":54}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        RunRepository,\n    },\n    utilities: {\n        TransactionHelper,\n    },\n} = require('../../database');\n\nconst {\n    adapters: {\n        RunAdapter,\n    },\n} = require('../../domain');\n\nconst GetRunUseCase = require('../run/GetRunUseCase');\n\n/**\n * StartRunUseCase\n */\nclass StartRunUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The StartRunDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body } = dto;\n        const run = await TransactionHelper.provide(async () => {\n            body.userId = dto.session.id || null;\n\n            return RunRepository.insert(RunAdapter.toDatabase(body));\n        });\n\n        if (run.error) {\n            return run;\n        }\n\n        const result = await new GetRunUseCase().execute({ params: { runId: run.id } });\n        return { result };\n    }\n}\n\nmodule.exports = StartRunUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/UpdateRunTagsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../tag/GetAllTagsUseCase","line":23,"column":27,"nodeType":"CallExpression","endLine":23,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetRunUseCase","line":24,"column":23,"nodeType":"CallExpression","endLine":24,"endColumn":49}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        RunTagsRepository,\n    },\n    utilities: {\n        TransactionHelper,\n    },\n} = require('../../database');\n\nconst GetAllTagsUseCase = require('../tag/GetAllTagsUseCase');\nconst GetRunUseCase = require('./GetRunUseCase');\n\n/**\n * UpdateRunTagsUseCase\n */\nclass UpdateRunTagsUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {UpdateRunTagsDto} dto The UpdateRunTagsDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body, params } = dto;\n        const { tags } = body;\n        const { runId } = params;\n\n        const run = await TransactionHelper.provide(async () => {\n            if (tags) {\n                const existingTags = await new GetAllTagsUseCase()\n                    .execute({ query: { page: { filter: { ids: tags } } } });\n                const missingTags = tags.reduce((accumulator, tag) => {\n                    if (!existingTags.tags.find(({ id }) => id === tag)) {\n                        accumulator.push(tag);\n                    }\n                    return accumulator;\n                }, []);\n\n                if (missingTags.length > 0) {\n                    return {\n                        error: {\n                            status: '400',\n                            title: `Tags with these ids (${missingTags.join(', ')}) could not be found`,\n                        },\n                    };\n                }\n            }\n\n            // Remove existing tags of the run and insert new ones\n            return await RunTagsRepository.removeById(runId)\n                .then(() => RunTagsRepository.updateMany(tags.map((tag) => ({\n                    runId,\n                    tagId: tag,\n                }))));\n        });\n\n        if (run.error) {\n            return run;\n        }\n\n        const result = await new GetRunUseCase().execute({ params: { runId } });\n        return { result };\n    }\n}\n\nmodule.exports = UpdateRunTagsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/run/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllRunsUseCase","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetRunUseCase","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogsByRunUseCase","line":16,"column":29,"nodeType":"CallExpression","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./StartRunUseCase","line":17,"column":25,"nodeType":"CallExpression","endLine":17,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./EndRunUseCase","line":18,"column":23,"nodeType":"CallExpression","endLine":18,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetFlpsByRunUseCase","line":19,"column":29,"nodeType":"CallExpression","endLine":19,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../run/UpdateRunTagsUseCase","line":20,"column":30,"nodeType":"CallExpression","endLine":20,"endColumn":68}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst GetAllRunsUseCase = require('./GetAllRunsUseCase');\nconst GetRunUseCase = require('./GetRunUseCase');\nconst GetLogsByRunUseCase = require('./GetLogsByRunUseCase');\nconst StartRunUseCase = require('./StartRunUseCase');\nconst EndRunUseCase = require('./EndRunUseCase');\nconst GetFlpsByRunUseCase = require('./GetFlpsByRunUseCase');\nconst UpdateRunTagsUseCase = require('../run/UpdateRunTagsUseCase');\n\nmodule.exports = {\n    GetAllRunsUseCase,\n    GetRunUseCase,\n    GetLogsByRunUseCase,\n    StartRunUseCase,\n    EndRunUseCase,\n    GetFlpsByRunUseCase,\n    UpdateRunTagsUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/server/GetDeployInformationUseCase.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/server/GetServerInformationUseCase.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/server/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetDeployInformationUseCase","line":14,"column":37,"nodeType":"CallExpression","endLine":14,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetServerInformationUseCase","line":15,"column":37,"nodeType":"CallExpression","endLine":15,"endColumn":77}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst GetDeployInformationUseCase = require('./GetDeployInformationUseCase');\nconst GetServerInformationUseCase = require('./GetServerInformationUseCase');\n\nmodule.exports = {\n    GetDeployInformationUseCase,\n    GetServerInformationUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/subsystem/CreateSubsystemUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        SubsystemAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        SubsystemRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * CreateSubsystemUseCase\n */\nclass CreateSubsystemUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The CreateSubsystemDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body } = dto;\n\n        const subsystem = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('name').is(body.name);\n            const subsystem = await SubsystemRepository.findOne(queryBuilder);\n            if (subsystem) {\n                return null;\n            }\n\n            return SubsystemRepository.insert(SubsystemAdapter.toDatabase(body));\n        });\n\n        return subsystem ? SubsystemAdapter.toEntity(subsystem) : null;\n    }\n}\n\nmodule.exports = CreateSubsystemUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/subsystem/DeleteSubsystemUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        SubsystemAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        SubsystemRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * DeleteSubsystemUseCase\n */\nclass DeleteSubsystemUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllSubsystems DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const { params } = dto;\n        const { subsystemId } = params;\n\n        const subsystem = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('id').is(subsystemId);\n\n            return SubsystemRepository.removeOne(queryBuilder);\n        });\n\n        return subsystem ? SubsystemAdapter.toEntity(subsystem) : null;\n    }\n}\n\nmodule.exports = DeleteSubsystemUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/subsystem/GetAllSubsystemsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        SubsystemAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        SubsystemRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetAllSubsystemsUseCase\n */\nclass GetAllSubsystemsUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllSubsystems DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const { query = {} } = dto;\n        const { page = {} } = query;\n        const { limit = 100, offset = 0 } = page;\n\n        const { count, rows } = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .limit(limit)\n                .offset(offset);\n\n            return SubsystemRepository.findAndCountAll(queryBuilder);\n        });\n\n        return {\n            count,\n            subsystems: rows.map(SubsystemAdapter.toEntity),\n        };\n    }\n}\n\nmodule.exports = GetAllSubsystemsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/subsystem/GetLogsBySubsystemUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":28,"column":5,"nodeType":"CallExpression","endLine":28,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        LogAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        LogRepository,\n        SubsystemRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetLogsBySubsystemUseCase\n */\nclass GetLogsBySubsystemUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetSubsystemDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const queryBuilder = new QueryBuilder();\n        const { params } = dto;\n        const { subsystemId } = params;\n\n        queryBuilder.where('id').is(subsystemId);\n        const logs = await TransactionHelper.provide(async () => {\n            const subsystem = await SubsystemRepository.findOne(queryBuilder);\n            return subsystem ? LogRepository.findAllBySubsystemId(subsystem.id) : null;\n        });\n\n        if (logs) {\n            const logsWithReplies = await LogRepository.addChildrenCountByRootLog(logs);\n            return logsWithReplies.map(LogAdapter.toEntity);\n        } else {\n            return null;\n        }\n    }\n}\n\nmodule.exports = GetLogsBySubsystemUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/subsystem/GetSubsystemUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        SubsystemAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        SubsystemRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetSubsystemUseCase\n */\nclass GetSubsystemUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetLogDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { subsystemId } = params;\n\n        const subsystem = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('id').is(subsystemId);\n\n            return SubsystemRepository.findOne(queryBuilder);\n        });\n\n        return subsystem ? SubsystemAdapter.toEntity(subsystem) : null;\n    }\n}\n\nmodule.exports = GetSubsystemUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/subsystem/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateSubsystemUseCase","line":13,"column":32,"nodeType":"CallExpression","endLine":13,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./DeleteSubsystemUseCase","line":14,"column":32,"nodeType":"CallExpression","endLine":14,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllSubsystemsUseCase","line":15,"column":33,"nodeType":"CallExpression","endLine":15,"endColumn":69},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetSubsystemUseCase","line":16,"column":29,"nodeType":"CallExpression","endLine":16,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogsBySubsystemUseCase","line":17,"column":35,"nodeType":"CallExpression","endLine":17,"endColumn":73}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\nconst CreateSubsystemUseCase = require('./CreateSubsystemUseCase');\nconst DeleteSubsystemUseCase = require('./DeleteSubsystemUseCase');\nconst GetAllSubsystemsUseCase = require('./GetAllSubsystemsUseCase');\nconst GetSubsystemUseCase = require('./GetSubsystemUseCase');\nconst GetLogsBySubsystemUseCase = require('./GetLogsBySubsystemUseCase');\n\nmodule.exports = {\n    CreateSubsystemUseCase,\n    DeleteSubsystemUseCase,\n    GetAllSubsystemsUseCase,\n    GetSubsystemUseCase,\n    GetLogsBySubsystemUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/tag/CreateTagUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        TagAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        TagRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * CreateTagUseCase\n */\nclass CreateTagUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The CreateTagDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { body } = dto;\n\n        const tag = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('text').is(body.text);\n            const tag = await TagRepository.findOne(queryBuilder);\n            if (tag) {\n                return null;\n            }\n\n            return TagRepository.insert(TagAdapter.toDatabase(body));\n        });\n\n        return tag ? TagAdapter.toEntity(tag) : null;\n    }\n}\n\nmodule.exports = CreateTagUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/tag/DeleteTagUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        TagAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        TagRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * DeleteTagUseCase\n */\nclass DeleteTagUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllLogs DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const { params } = dto;\n        const { tagId } = params;\n\n        const tag = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('id').is(tagId);\n\n            return TagRepository.removeOne(queryBuilder);\n        });\n\n        return tag ? TagAdapter.toEntity(tag) : null;\n    }\n}\n\nmodule.exports = DeleteTagUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/tag/GetAllTagsUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":28,"column":5,"nodeType":"CallExpression","endLine":28,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        TagAdapter,\n    },\n} = require('../../domain');\n\nconst {\n    repositories: {\n        TagRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetAllTagsUseCase\n */\nclass GetAllTagsUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetAllLogs DTO which contains all request data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto = {}) {\n        const queryBuilder = new QueryBuilder();\n        const { query = {} } = dto;\n        const { page = {} } = query;\n        const { filter, limit = 100, offset = 0 } = page;\n\n        queryBuilder.limit(limit);\n        queryBuilder.offset(offset);\n\n        const {\n            count,\n            rows,\n        } = await TransactionHelper.provide(async () => {\n            if (filter && filter.ids) {\n                queryBuilder.where('id').oneOf(...filter.ids);\n            }\n\n            return TagRepository.findAndCountAll(queryBuilder);\n        });\n\n        return {\n            count,\n            tags: rows.map(TagAdapter.toEntity),\n        };\n    }\n}\n\nmodule.exports = GetAllTagsUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/tag/GetLogsByTagUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":23,"column":5,"nodeType":"CallExpression","endLine":23,"endColumn":30},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../log","line":25,"column":31,"nodeType":"CallExpression","endLine":25,"endColumn":48}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        LogRepository,\n        TagRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\nconst { GetAllLogsUseCase } = require('../log');\n\n/**\n * GetLogsByTagUseCase\n */\nclass GetLogsByTagUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetTagDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { tagId } = params;\n\n        const logs = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('id').is(tagId);\n            const tag = await TagRepository.findOne(queryBuilder);\n            if (!tag) {\n                return null;\n            }\n\n            const dto = { query: { filter: { tag: { values: [tagId], operation: 'or' } } } };\n            const { logs } = await new GetAllLogsUseCase().execute(dto);\n            const logsWithReplies = await LogRepository.addChildrenCountByRootLog(logs);\n\n            return logsWithReplies;\n        });\n\n        return logs;\n    }\n}\n\nmodule.exports = GetLogsByTagUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/tag/GetTagUseCase.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        TagAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        TagRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n/**\n * GetTagUseCase\n */\nclass GetTagUseCase {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetTagDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { params } = dto;\n        const { tagId } = params;\n\n        const tag = await TransactionHelper.provide(async () => {\n            const queryBuilder = new QueryBuilder()\n                .where('id').is(tagId);\n\n            return TagRepository.findOne(queryBuilder);\n        });\n\n        return tag ? TagAdapter.toEntity(tag) : null;\n    }\n}\n\nmodule.exports = GetTagUseCase;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/tag/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateTagUseCase","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./DeleteTagUseCase","line":15,"column":26,"nodeType":"CallExpression","endLine":15,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllTagsUseCase","line":16,"column":27,"nodeType":"CallExpression","endLine":16,"endColumn":57},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogsByTagUseCase","line":17,"column":29,"nodeType":"CallExpression","endLine":17,"endColumn":61},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetTagUseCase","line":18,"column":23,"nodeType":"CallExpression","endLine":18,"endColumn":49}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateTagUseCase = require('./CreateTagUseCase');\nconst DeleteTagUseCase = require('./DeleteTagUseCase');\nconst GetAllTagsUseCase = require('./GetAllTagsUseCase');\nconst GetLogsByTagUseCase = require('./GetLogsByTagUseCase');\nconst GetTagUseCase = require('./GetTagUseCase');\n\nmodule.exports = {\n    CreateTagUseCase,\n    DeleteTagUseCase,\n    GetAllTagsUseCase,\n    GetLogsByTagUseCase,\n    GetTagUseCase,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/user/CreateOrUpdateUser.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../domain","line":18,"column":5,"nodeType":"CallExpression","endLine":18,"endColumn":28},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../database","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":30}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    adapters: {\n        UserAdapter,\n    },\n} = require('../../domain');\nconst {\n    repositories: {\n        UserRepository,\n    },\n    utilities: {\n        QueryBuilder,\n        TransactionHelper,\n    },\n} = require('../../database');\n\n// The in-memory caching\nconst lastSeen = {};\nconst userMap = {};\n\n/**\n * CreateOrUpdateUser\n */\nclass CreateOrUpdateUser {\n    /**\n     * Executes this use case.\n     *\n     * @param {Object} dto The GetTagDto containing all data.\n     * @returns {Promise} Promise object represents the result of this use case.\n     */\n    async execute(dto) {\n        const { personid, name } = dto;\n\n        const _1_MIN = 1 * 60 * 1000;\n        if (lastSeen[personid] && lastSeen[personid] > Date.now() - _1_MIN) {\n            return userMap[personid];\n        }\n\n        lastSeen[personid] = Date.now();\n\n        const queryBuilder = new QueryBuilder()\n            .where('externalId').is(personid);\n\n        const user = await TransactionHelper.provide(async () => {\n            let user;\n\n            user = await UserRepository.findOne(queryBuilder);\n            if (user) {\n                let changed = false;\n                if (user.name !== name) {\n                    user.name = name;\n                    changed = true;\n                }\n\n                if (changed) {\n                    await user.save();\n                }\n            } else {\n                user = await UserRepository.insert({\n                    externalId: personid,\n                    name: name,\n                });\n            }\n\n            return UserAdapter.toEntity(user);\n        });\n\n        userMap[personid] = user;\n        return user;\n    }\n}\n\nmodule.exports = CreateOrUpdateUser;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/usecases/user/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateOrUpdateUser","line":14,"column":28,"nodeType":"CallExpression","endLine":14,"endColumn":59}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateOrUpdateUser = require('./CreateOrUpdateUser');\n\nmodule.exports = {\n    CreateOrUpdateUser,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/utilities/Logger.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"@aliceo2/web-ui","line":14,"column":17,"nodeType":"CallExpression","endLine":14,"endColumn":43}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { Log } = require('@aliceo2/web-ui');\n\nmodule.exports = (name) => {\n    /**\n     * WebUI implementation of the Logger.\n     */\n    class WebUiLogger {\n        /**\n         * Creates a new `WebUi Logger` instance.\n         */\n        constructor() {\n            this.logger = new Log(name);\n            if (process.env.NODE_ENV !== 'development') {\n                Log.configure({ winston: { consoleLvl: 'info' } });\n            }\n        }\n\n        /**\n         * Log a message with debug log level.\n         *\n         * @param {Object} message log this message\n         * @returns {undefined}\n         */\n        debug(message) {\n            this.logger.debug(message);\n        }\n\n        /**\n         * Log a message with error log level.\n         *\n         * @param {Object} message log this message\n         * @returns {undefined}\n         */\n        error(message) {\n            this.logger.error(message);\n        }\n\n        /**\n         * Log a message with info log level.\n         *\n         * @param {Object} message log this message\n         * @returns {undefined}\n         */\n        info(message) {\n            this.logger.info(message);\n        }\n\n        /**\n         * Log a message with trace log level.\n         *\n         * @param {Object} message log this message\n         * @returns {undefined}\n         */\n        trace(message) {\n            this.logger.trace(message);\n        }\n\n        /**\n         * Log a message with warn log level.\n         *\n         * @param {Object} message log this message\n         * @returns {undefined}\n         */\n        warn(message) {\n            this.logger.warn(message);\n        }\n    }\n\n    return new WebUiLogger(name);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/utilities/deepmerge.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"deepmerge","line":14,"column":19,"nodeType":"CallExpression","endLine":14,"endColumn":39}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst deepmerge = require('deepmerge');\n\n/**\n * Merges two given objects.\n *\n * @param {Object} base Base object to use.\n * @param {Object[]} targets Object(s) to override with.\n * @returns {Object} Merged of *base* and all *targets*.\n */\nconst merge = (base, ...targets) => {\n    if (!targets || targets.length === 0) {\n        return base;\n    }\n\n    if (targets.length === 1) {\n        return deepmerge(base, targets[0]);\n    }\n\n    return merge(merge(base, targets.shift()), ...targets);\n};\n\nmodule.exports = merge;\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/utilities/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./deepmerge","line":14,"column":19,"nodeType":"CallExpression","endLine":14,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./isPromise","line":15,"column":19,"nodeType":"CallExpression","endLine":15,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./Logger","line":16,"column":16,"nodeType":"CallExpression","endLine":16,"endColumn":35}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst deepmerge = require('./deepmerge');\nconst isPromise = require('./isPromise');\nconst Logger = require('./Logger');\n\nmodule.exports = {\n    deepmerge,\n    isPromise,\n    Logger,\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/lib/utilities/isPromise.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/spec/convert.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"fs","line":14,"column":12,"nodeType":"CallExpression","endLine":14,"endColumn":25},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"js-yaml","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":32},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"deepmerge","line":17,"column":15,"nodeType":"CallExpression","endLine":17,"endColumn":35}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst fs = require('fs');\nconst path = require('path');\nconst yaml = require('js-yaml');\nconst merge = require('deepmerge');\n\nconst swaggerDocumentPath = path.resolve(__dirname, 'openapi-source.yaml');\nconst swaggerGeneratedDocumentPath = path.resolve(__dirname, 'openapi.yaml');\n\nconst swaggerDocument = yaml.safeLoad(fs.readFileSync(swaggerDocumentPath));\n\n// eslint-disable-next-line require-jsdoc\nconst arraysEqual = (a, b) => {\n    // Are the lengths the same?\n    let i = a.length;\n    if (i !== b.length) {\n        return false;\n    }\n\n    // Are all the values the same?\n    while (i --) {\n        if (a[i] !== b[i]) {\n            return false;\n        }\n    }\n\n    return true;\n};\n\n// eslint-disable-next-line require-jsdoc\nconst convert = (obj) => {\n    const spec = merge({}, obj);\n    let changed = false;\n\n    // eslint-disable-next-line require-jsdoc\n    const traverse = (obj, parent = []) => {\n        if (typeof obj === 'object') {\n            Object.keys(obj).forEach((item) => traverse(obj[item], [item, ...parent]));\n        }\n\n        if (parent[0] === 'allOf') {\n            let merged = {};\n\n            for (const iterator of obj) {\n                let item = {};\n                if (iterator['$ref']) {\n                    const path = obj[0]['$ref'].split('/');\n                    item = spec[parent[3]][parent[2]][path[path.length - 1]];\n                } else {\n                    item = iterator;\n                }\n\n                merged = merge(merged, item);\n            }\n\n            spec[parent[3]][parent[2]][parent[1]] = merged;\n            changed = true;\n        }\n\n        if (parent[0] === 'responses' && parent[3] === 'paths') {\n            if (!Object.keys(obj).includes('default')) {\n                obj['default'] = { $ref: '#/components/responses/UnexpectedError' };\n                changed = true;\n            }\n\n            spec[parent[3]][parent[2]][parent[1]][parent[0]] = obj;\n        }\n\n        if (parent[1] === 'responses' && parent[4] === 'paths') {\n            switch (parent[0]) {\n                case 'default':\n                    if (Object.keys(obj).length !== 1 || obj['$ref'] !== '#/components/responses/UnexpectedError') {\n                        obj = { $ref: '#/components/responses/UnexpectedError' };\n                        changed = true;\n                    }\n                    break;\n            }\n\n            spec[parent[4]][parent[3]][parent[2]][parent[1]][parent[0]] = obj;\n        }\n\n        if (parent[0] === 'required' && parent[2] === 'schemas' && parent[3] === 'components') {\n            const unsorted = spec[parent[3]][parent[2]][parent[1]][parent[0]];\n            const sorted = spec[parent[3]][parent[2]][parent[1]][parent[0]].sort();\n            if (!arraysEqual(unsorted, sorted)) {\n                spec[parent[3]][parent[2]][parent[1]][parent[0]] = sorted;\n                changed = true;\n            }\n        }\n\n        if (parent[0] === 'properties' && parent[2] === 'schemas' && parent[3] === 'components') {\n            const unsorted = Object.keys(spec[parent[3]][parent[2]][parent[1]][parent[0]]);\n            const sorted = Object.keys(spec[parent[3]][parent[2]][parent[1]][parent[0]]).sort();\n\n            if (!arraysEqual(unsorted, sorted)) {\n                const obj = {};\n                for (const key of sorted) {\n                    obj[key] = spec[parent[3]][parent[2]][parent[1]][parent[0]][key];\n                }\n\n                spec[parent[3]][parent[2]][parent[1]][parent[0]] = obj;\n                changed = true;\n            }\n        }\n    };\n\n    do {\n        changed = false;\n        traverse(spec);\n    } while (changed);\n\n    return spec;\n};\n\n// eslint-disable-next-line require-jsdoc\nconst dumpYaml = (loc, obj) => {\n    fs.writeFileSync(loc, yaml.safeDump(obj, {\n        indent: 2,\n        lineWidth: 80,\n        sortKeys: false,\n    }));\n};\n\n// eslint-disable-next-line require-jsdoc\nconst addGeneratedHeader = (loc) => {\n    const header = `# Generated on ${new Date().toUTCString()}`;\n    const data = `${header}\\n\\n${fs.readFileSync(loc)}`;\n    fs.writeFileSync(loc, data, () => {});\n};\n\ndumpYaml(swaggerDocumentPath, swaggerDocument);\n\nconst swaggerGeneratedDocument = convert(swaggerDocument);\nconst oldSwaggerGeneratedDocument = yaml.safeLoad(fs.readFileSync(swaggerGeneratedDocumentPath));\nif (JSON.stringify(oldSwaggerGeneratedDocument) !== JSON.stringify(swaggerGeneratedDocument)) {\n    dumpYaml(swaggerGeneratedDocumentPath, swaggerGeneratedDocument);\n    addGeneratedHeader(swaggerGeneratedDocumentPath);\n}\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/database/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./utilities","line":14,"column":24,"nodeType":"CallExpression","endLine":14,"endColumn":46}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst UtilitiesSuite = require('./utilities');\n\nmodule.exports = () => {\n    describe('Utilities', UtilitiesSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/database/utilities/QueryBuilder.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":21,"column":5,"nodeType":"CallExpression","endLine":21,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":22,"column":14,"nodeType":"CallExpression","endLine":22,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    repositories: {\n        LogRepository,\n    },\n    utilities: {\n        QueryBuilder,\n    },\n} = require('../../../lib/database');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    describe('WhereQueryBuilder', () => {\n        describe('not', () => {\n            it('should return a single entity which does not have the provided id', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').not().is('1');\n\n                const result = await LogRepository.findOne(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result.id).to.equal(2);\n            });\n\n            it('should return entities not with the id in the provided range', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').not().between(1, 3);\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result).to.have.lengthOf(116);\n                expect(result[0].id).to.equal(4);\n                expect(result[1].id).to.equal(5);\n            });\n\n            it('should return a single entity with the provided id', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').not().oneOf('1', 2);\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findOne(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result.id).to.equal(3);\n            });\n\n            it('should return a single entity with the provided id', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').not().allOf('1', 2);\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findOne(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result.id).to.equal(3);\n            });\n        });\n\n        describe('between', () => {\n            it('should return entities with the id in the provided range', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').between(1, '3');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result).to.have.lengthOf(3);\n                expect(result[0].id).to.equal(1);\n                expect(result[1].id).to.equal(2);\n                expect(result[2].id).to.equal(3);\n            });\n        });\n\n        describe('is', () => {\n            it('should return a single entity with the provided id', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').is('1');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result).to.have.lengthOf(1);\n                expect(result[0].id).to.equal(1);\n            });\n        });\n\n        describe('allOf', () => {\n            it('should return no entities', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').allOf(1, 2);\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result).to.have.lengthOf(0);\n            });\n        });\n\n        describe('oneOf', () => {\n            it('should return entities with the provided id', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('id').oneOf('1', 2);\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                expect(result).to.have.lengthOf(2);\n                expect(result[0].id).to.equal(1);\n                expect(result[1].id).to.equal(2);\n            });\n        });\n\n        describe('startsWith', () => {\n            it('should return only entities starting with \"First\"', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('title').startsWith('First');\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                result.forEach(({ title }) => {\n                    expect(title.startsWith('First')).to.be.true;\n                });\n            });\n\n            it('should return only entities not starting with \"First\"', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('title').not().startsWith('First');\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                result.forEach(({ title }) => {\n                    expect(title.startsWith('First')).to.be.false;\n                });\n            });\n        });\n\n        describe('endsWith', () => {\n            it('should return only entities ending with \"entry\"', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('title').endsWith('entry');\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                result.forEach(({ title }) => {\n                    expect(title.endsWith('entry')).to.be.true;\n                });\n            });\n\n            it('should return only entities not ending with \"entry\"', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('title').not().endsWith('entry');\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                result.forEach(({ title }) => {\n                    expect(title.endsWith('entry')).to.be.false;\n                });\n            });\n        });\n\n        describe('substring', () => {\n            it('should return only entities containing \"entr\"', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('title').substring('entr');\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                result.forEach(({ title }) => {\n                    expect(title.includes('entr')).to.be.true;\n                });\n            });\n\n            it('should return only entities not containing \"og\"', async () => {\n                const queryBuilder = new QueryBuilder();\n                queryBuilder.where('title').not().substring('entr');\n                queryBuilder.orderBy('id', 'asc');\n\n                const result = await LogRepository.findAll(queryBuilder);\n                expect(result).to.not.be.null;\n                result.forEach(({ title }) => {\n                    expect(title.includes('entr')).to.be.false;\n                });\n            });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/database/utilities/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./QueryBuilder.test","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":57}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst QueryBuilderSuite = require('./QueryBuilder.test');\n\nmodule.exports = () => {\n    describe('QueryBuilder', QueryBuilderSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/attachments.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":22,"column":24,"nodeType":"CallExpression","endLine":22,"endColumn":56}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    const { server } = require('../../lib/application');\n\n    describe('POST /api/attachments', () => {\n        it('should return 200', (done) => {\n            request(server)\n                .post('/api/attachments')\n                .set('log', '1')\n                .attach('attachments', path.resolve(__dirname, '..', 'assets', '1200px-CERN_logo.png'))\n                .expect(201)\n                .end((err, _res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/attachments/:attachmentId', () => {\n        it('should return 200', (done) => {\n            request(server)\n                .get('/api/attachments/1')\n                .expect(200)\n                .end((err, _res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/flps.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/database","line":18,"column":45,"nodeType":"CallExpression","endLine":18,"endColumn":74},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":25,"column":24,"nodeType":"CallExpression","endLine":25,"endColumn":56}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\nconst { repositories: { FlpRepository } } = require('../../lib/database');\n\nconst { expect } = chai;\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    const { server } = require('../../lib/application');\n\n    describe('GET /api/flps', () => {\n        it('should return an array', (done) => {\n            request(server)\n                .get('/api/flps')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 0 and limit 1', (done) => {\n            request(server)\n                .get('/api/flps?page[offset]=0&page[limit]=1&sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(1);\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 1 and limit 1', (done) => {\n            request(server)\n                .get('/api/flps?page[offset]=1&page[limit]=1&sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(2);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the limit is below 1', (done) => {\n            request(server)\n                .get('/api/flps?page[offset]=0&page[limit]=0')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/query/page/limit');\n                    expect(titleError.detail).to.equal('\"query.page.limit\" must be larger than or equal to 1');\n\n                    done();\n                });\n        });\n\n        it('should return the correct number of pages', (done) => {\n            request(server)\n                .get('/api/flps?page[offset]=0&page[limit]=2')\n                .expect(200)\n                .end(async (err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const totalNumber = await FlpRepository.count();\n\n                    expect(res.body.data).to.have.lengthOf(2);\n                    expect(res.body.meta.page.pageCount).to.equal(Math.ceil(totalNumber / 2));\n                    expect(res.body.meta.page.totalCount).to.equal(totalNumber);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, name DESC', (done) => {\n            request(server)\n                .get('/api/flps?sort[name]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[0].name).to.be.greaterThan(data[1].name);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, name ASC', (done) => {\n            request(server)\n                .get('/api/flps?sort[name]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[1].name).to.be.greaterThan(data[0].name);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/flps/:flpId', () => {\n        it('should return 400 if the flp id is not a number', (done) => {\n            request(server)\n                .get('/api/flps/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/flpId');\n                    expect(titleError.detail).to.equal('\"params.flpId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the flp id is not positive', (done) => {\n            request(server)\n                .get('/api/flps/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/flpId');\n                    expect(titleError.detail).to.equal('\"params.flpId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the flp id is not a whole number', (done) => {\n            request(server)\n                .get('/api/flps/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/flpId');\n                    expect(titleError.detail).to.equal('\"params.flpId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the flp could not be found', (done) => {\n            request(server)\n                .get('/api/flps/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Flp with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/flps/1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(1);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/flps/:flpId/logs', () => {\n        it('should return 400 if the flp id is not a number', (done) => {\n            request(server)\n                .get('/api/flps/abc/logs')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/flpId');\n                    expect(titleError.detail).to.equal('\"params.flpId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the flp could not be found', (done) => {\n            request(server)\n                .get('/api/flps/999999999/logs')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Flp with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/flps/1/logs')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data).to.have.lengthOf(4);\n\n                    expect(res.body.data[0].id).to.equal(1);\n                    expect(res.body.data[0].flps).to.deep.equal([\n                        {\n                            id: 1,\n                        },\n                    ]);\n                    done();\n                });\n        });\n    });\n\n    describe('POST api/flps', () => {\n        it('should return 400 if no name or hostname is provided', (done) => {\n            request(server)\n                .post('/api/flps')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const nameError = errors.find((err) => err.source.pointer === '/data/attributes/body/name');\n                    expect(nameError.detail).to.equal('\"body.name\" is required');\n\n                    const hostnameError = errors.find((err) => err.source.pointer === '/data/attributes/body/hostname');\n                    expect(hostnameError.detail).to.equal('\"body.hostname\" is required');\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body was sent', (done) => {\n            request(server)\n                .post('/api/flps')\n                .send({\n                    name: 'FLPIEE',\n                    hostname: 'www.home.cern',\n                })\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.name).to.equal('FLPIEE');\n                    expect(res.body.data.hostname).to.equal('www.home.cern');\n\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/home.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":25,"column":28,"nodeType":"CallExpression","endLine":25,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":43,"column":28,"nodeType":"CallExpression","endLine":43,"endColumn":60}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\n\nconst { expect } = chai;\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    describe('GET /api/', () => {\n        const { server } = require('../../lib/application');\n\n        it('should satisfy OpenAPI spec', (done) => {\n            request(server)\n                .get('/api/')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        return done(err);\n                    }\n\n                    expect(res).to.satisfyApiSpec;\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/status', () => {\n        const { server } = require('../../lib/application');\n\n        it('should satisfy OpenAPI spec', (done) => {\n            request(server)\n                .get('/api/status')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        return done(err);\n                    }\n\n                    expect(res).to.satisfyApiSpec;\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./attachments.test","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":55},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./home.test","line":15,"column":19,"nodeType":"CallExpression","endLine":15,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./logs.test","line":16,"column":19,"nodeType":"CallExpression","endLine":16,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystems.test","line":17,"column":25,"nodeType":"CallExpression","endLine":17,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tags.test","line":18,"column":19,"nodeType":"CallExpression","endLine":18,"endColumn":41}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst AttachmentsSuite = require('./attachments.test');\nconst HomeSuite = require('./home.test');\nconst LogsSuite = require('./logs.test');\nconst SubsystemsSuite = require('./subsystems.test');\nconst TagsSuite = require('./tags.test');\n\nmodule.exports = () => {\n    describe('Home', HomeSuite);\n    describe('Logs', LogsSuite);\n    describe('Subsystems', SubsystemsSuite);\n    describe('Tags', TagsSuite);\n    describe('Attachments', AttachmentsSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/logs.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/database","line":18,"column":45,"nodeType":"CallExpression","endLine":18,"endColumn":74},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":25,"column":24,"nodeType":"CallExpression","endLine":25,"endColumn":56}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\nconst { repositories: { LogRepository } } = require('../../lib/database');\n\nconst { expect } = chai;\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    const { server } = require('../../lib/application');\n\n    let logWithAttachmentsId = 0;\n    let attachmentId = 0;\n\n    describe('GET /api/logs', () => {\n        it('should return an array', (done) => {\n            request(server)\n                .get('/api/logs')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n\n                    done();\n                });\n        });\n\n        it('should support filtering by title', (done) => {\n            request(server)\n                .get('/api/logs?filter[title]=Third')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data.length).to.equal(1);\n                    expect(res.body.data[0].title).to.include('Third');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the title filter is left empty', (done) => {\n            request(server)\n                .get('/api/logs?filter[title]= ')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to.equal('\"query.filter.title\" is not allowed to be empty');\n\n                    done();\n                });\n        });\n\n        it('should support filtering by author', (done) => {\n            request(server)\n                .get('/api/logs?filter[author]=John')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data.length).to.be.greaterThan(1);\n                    expect(res.body.data[0].author.name).to.include('John');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the author filter is left empty', (done) => {\n            request(server)\n                .get('/api/logs?filter[author]= ')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to.equal('\"query.filter.author\" is not allowed to be empty');\n\n                    done();\n                });\n        });\n\n        it('should support filtering by creation time', (done) => {\n            const timeFrom = 946684800000;\n            request(server)\n                .get(`/api/logs?filter[created][from]=${timeFrom}`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data.length).to.be.greaterThan(1);\n                    expect(res.body.data[0].createdAt).to.be.gte(timeFrom);\n\n                    done();\n                });\n        });\n\n        it('should support filtering by creation time', (done) => {\n            const timeFrom = 946684800000;\n            const timeTo = 1577833200000;\n            request(server)\n                .get(`/api/logs?filter[created][from]=${timeFrom}&filter[created][to]=${timeTo}`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data.length).to.equal(100);\n                    expect(res.body.data[0].createdAt).to.be.gte(timeFrom);\n                    expect(res.body.data[0].createdAt).to.be.lte(timeTo);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if given date is invalid', (done) => {\n            request(server)\n                .get('/api/logs?filter[created][from]=NaN')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to\n                        .equal('Creation date must be a real date and in format YYYY-MM-DD or YYYY/MM/DD');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if filtering in the future', (done) => {\n            request(server)\n                .get('/api/logs?filter[created][to]=4102531200000')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    let today = new Date();\n                    today.setMinutes(today.getMinutes() - today.getTimezoneOffset());\n                    [today] = today.toISOString().split('T');\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to\n                        .equal(`Creation date must be today (${today}T23:59:59.999Z) or earlier`);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if minimum is larger than maximum', (done) => {\n            request(server)\n                .get('/api/logs?filter[created][from]=946771200000&filter[created][to]=946684800000')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to\n                        .equal('Creation date \"to\" cannot be before the \"from\" date');\n\n                    done();\n                });\n        });\n\n        it('should support filtering by tag', (done) => {\n            request(server)\n                .get('/api/logs?filter[tag][values]=1&filter[tag][operation]=and')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data\n                        .every((log) => log.tags.length > 0 && log.tags.some((tag) => tag.id === 1)))\n                        .to.be.true;\n\n                    done();\n                });\n        });\n\n        it('should support filtering by tag', (done) => {\n            request(server)\n                .get('/api/logs?filter[tag][values]=2,5&filter[tag][operation]=and')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data\n                        .every((log) => log.tags.length > 0 && log.tags.some((tag) => tag.id === 2)\n                        && log.tags.some((tag) => tag.id === 5)))\n                        .to.be.true;\n\n                    done();\n                });\n        });\n\n        it('should support filtering by tag', (done) => {\n            request(server)\n                .get('/api/logs?filter[tag][values]=5,6&filter[tag][operation]=or')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data\n                        .every((log) => log.tags.length > 0 && log.tags.some((tag) => tag.id === 5 || tag.id === 6)))\n                        .to.be.true;\n\n                    done();\n                });\n        });\n\n        it('should support filtering by parent log', (done) => {\n            request(server)\n                .get('/api/logs?filter[parentLog]=2')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data).to.have.lengthOf(2);\n\n                    done();\n                });\n        });\n\n        it('should return 400 for an invalid parent log', (done) => {\n            request(server)\n                .get('/api/logs?filter[parentLog]=-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to.equal('\"query.filter.parentLog\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should support filtering by root log', (done) => {\n            request(server)\n                .get('/api/logs?filter[rootLog]=1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data).to.have.lengthOf(4);\n\n                    done();\n                });\n        });\n\n        it('should return 400 for an invalid root log', (done) => {\n            request(server)\n                .get('/api/logs?filter[rootLog]=-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail).to.equal('\"query.filter.rootLog\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should support filtering by origin (process)', (done) => {\n            request(server)\n                .get('/api/logs?filter[origin]=process')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    for (const log of res.body.data) {\n                        expect(log.origin).to.equal('process');\n                    }\n\n                    done();\n                });\n        });\n\n        it('should support filtering by origin (human)', (done) => {\n            request(server)\n                .get('/api/logs?filter[origin]=human')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    for (const log of res.body.data) {\n                        expect(log.origin).to.equal('human');\n                    }\n\n                    done();\n                });\n        });\n\n        it('should return 400 for an unknown origin filter', (done) => {\n            request(server)\n                .get('/api/logs?filter[origin]=_')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const [titleError] = res.body.errors;\n                    expect(titleError.detail).to.equal('\"query.filter.origin\" must be one of [human, process]');\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 0 and limit 1', (done) => {\n            request(server)\n                .get('/api/logs?page[offset]=0&page[limit]=1&sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(1);\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 1 and limit 1', (done) => {\n            request(server)\n                .get('/api/logs?page[offset]=1&page[limit]=1&sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(2);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the limit is below 1', (done) => {\n            request(server)\n                .get('/api/logs?page[offset]=0&page[limit]=0')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/query/page/limit');\n                    expect(titleError.detail).to.equal('\"query.page.limit\" must be larger than or equal to 1');\n\n                    done();\n                });\n        });\n\n        it('should return the correct number of pages', (done) => {\n            request(server)\n                .get('/api/logs?page[offset]=0&page[limit]=2')\n                .expect(200)\n                .end(async (err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const totalNumber = await LogRepository.count();\n\n                    expect(res.body.data).to.have.lengthOf(2);\n                    expect(res.body.meta.page.pageCount).to.equal(Math.ceil(totalNumber / 2));\n                    expect(res.body.meta.page.totalCount).to.equal(totalNumber);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, id DESC', (done) => {\n            request(server)\n                .get('/api/logs?sort[id]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[0].id).to.be.greaterThan(data[1].id);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, id ASC', (done) => {\n            request(server)\n                .get('/api/logs?sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[1].id).to.be.greaterThan(data[0].id);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, title DESC', (done) => {\n            request(server)\n                .get('/api/logs?sort[title]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect([data[0].title, data[1].title])\n                        .to.deep.equal([data[0].title, data[1].title].sort((a, b) => b.localeCompare(a)));\n\n                    done();\n                });\n        });\n\n        it('should support sorting, title ASC', (done) => {\n            request(server)\n                .get('/api/logs?sort[title]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect([data[0].title, data[1].title])\n                        .to.deep.equal([data[0].title, data[1].title].sort());\n\n                    done();\n                });\n        });\n\n        it('should support sorting, author DESC', (done) => {\n            request(server)\n                .get('/api/logs?sort[author]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect([data[0].author.name, data[1].author.name])\n                        .to.deep.equal([data[0].author.name, data[1].author.name].sort((a, b) => b.localeCompare(a)));\n\n                    done();\n                });\n        });\n\n        it('should support sorting, author ASC', (done) => {\n            request(server)\n                .get('/api/logs?sort[author]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect([data[0].author.name, data[1].author.name])\n                        .to.deep.equal([data[0].author.name, data[1].author.name].sort());\n\n                    done();\n                });\n        });\n\n        it('should support sorting, createdAt DESC', (done) => {\n            request(server)\n                .get('/api/logs?sort[createdAt]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[0].createdAt).to.be.greaterThan(data[1].createdAt);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, createdAt ASC', (done) => {\n            request(server)\n                .get('/api/logs?sort[createdAt]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[1].createdAt).to.be.greaterThan(data[0].createdAt);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, tags DESC', (done) => {\n            request(server)\n                .get('/api/logs?sort[tags]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    const dataWithTags = data.filter(({ tags }) => tags.length > 0);\n                    const firstAndLastTags =\n                        [dataWithTags[0].tags[0].text, dataWithTags[dataWithTags.length - 1].tags[0].text];\n                    expect(data[0].tags.length).to.be.greaterThan(0);\n                    expect(firstAndLastTags).to.deep.equal(firstAndLastTags.sort((a, b) => b.localeCompare(a)));\n\n                    done();\n                });\n        });\n\n        it('should support sorting, tags ASC', (done) => {\n            request(server)\n                .get('/api/logs?sort[tags]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    const dataWithTags = data.filter(({ tags }) => tags.length > 0);\n                    const firstAndLastTags =\n                        [dataWithTags[0].tags[0].text, dataWithTags[dataWithTags.length - 1].tags[0].text];\n                    expect(data[data.length - 1].tags.length).to.be.greaterThan(0);\n                    expect(firstAndLastTags).to.deep.equal(firstAndLastTags.sort());\n\n                    done();\n                });\n        });\n\n        it('should not allow sorting on multiple columns at once', (done) => {\n            request(server)\n                .get('/api/logs?sort[title]=asc&sort[createdAt]=desc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    expect(errors[0].detail\n                        .startsWith('\"query.sort\" contains a conflict between exclusive peers')).to.be.true;\n\n                    done();\n                });\n        });\n    });\n\n    describe('POST /api/logs', () => {\n        it('should return 400 if no title is provided', (done) => {\n            request(server)\n                .post('/api/logs')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/title');\n                    expect(titleError.detail).to.equal('\"body.title\" is required');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the title is too short', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'A',\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/title');\n                    expect(titleError.detail).to.equal('\"body.title\" length must be at least 3 characters long');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the title is too long', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: `\n                        ABCDEFGHIJKLMNOPQRSTUVWXYZ\n                        ABCDEFGHIJKLMNOPQRSTUVWXYZ\n                        ABCDEFGHIJKLMNOPQRSTUVWXYZ\n                        ABCDEFGHIJKLMNOPQRSTUVWXYZ\n                        ABCDEFGHIJKLMNOPQRSTUVWXYZ\n                        ABCDEFGHIJKLMNOPQRSTUVWXYZ\n                    `,\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/title');\n                    expect(titleError.detail)\n                        .to.equal('\"body.title\" length must be less than or equal to 140 characters long');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if no text is provided', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const textError = errors.find((err) => err.source.pointer === '/data/attributes/body/text');\n                    expect(textError.detail).to.equal('\"body.text\" is required');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the text is too short', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'A',\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const textError = errors.find((err) => err.source.pointer === '/data/attributes/body/text');\n                    expect(textError.detail).to.equal('\"body.text\" length must be at least 3 characters long');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if an unknown parent log was provided', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'Text of yet another run',\n                    parentLogId: 999,\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Parent log with this id (999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if at least one non-existent tag was provided', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'Text of yet another run',\n                    tags: [1, 3, 10000, 1666],\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Tags with these ids (10000, 1666) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if an invalid run number was provided', (done) => {\n            const runNumbers = '1234567890';\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'Text of yet another run',\n                    runNumbers,\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal(`Run with run number '${runNumbers}' could not be found`);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if an invalid run number string was provided', (done) => {\n            const runNumbers = 'This should only allow (comma-separated) numbers';\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'Text of yet another run',\n                    runNumbers,\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const expectedErrorMsg = 'Run numbers should be comma-separated, and should only contain numbers';\n                    expect(res.body.errors[0].title).to.equal(expectedErrorMsg);\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body was sent', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'Text of yet another run',\n                })\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.title).to.equal('Yet another run');\n                    expect(res.body.data.text).to.equal('Text of yet another run');\n                    expect(res.body.data.rootLogId).to.equal(res.body.data.id);\n                    expect(res.body.data.parentLogId).to.equal(res.body.data.id);\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body was sent', (done) => {\n            request(server)\n                .post('/api/logs')\n                .send({\n                    title: 'Yet another run',\n                    text: 'Text of yet another run',\n                    tags: [1, 2],\n                    parentLogId: 2,\n                })\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.title).to.equal('Yet another run');\n                    expect(res.body.data.text).to.equal('Text of yet another run');\n                    expect(res.body.data.tags).to.deep.equal([\n                        {\n                            id: 1,\n                            text: 'FOOD',\n                        },\n                        {\n                            id: 2,\n                            text: 'RUN',\n                        },\n                    ]);\n                    expect(res.body.data.rootLogId).to.equal(1);\n                    expect(res.body.data.parentLogId).to.equal(2);\n\n                    done();\n                });\n        });\n\n        // 'send' and 'attach' are incompatible so we use 'field' instead\n        it('should return 201 if a proper body with file attachments was sent', (done) => {\n            request(server)\n                .post('/api/logs')\n                .field('title', 'Yet another run')\n                .field('text', 'Text of yet another run')\n                .attach('attachments.0', path.resolve(__dirname, '..', 'assets', '1200px-CERN_logo.png'))\n                .attach('attachments.1', path.resolve(__dirname, '..', 'assets', 'hadron_collider.jpg'))\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.attachments[0].originalName).to.equal('1200px-CERN_logo.png');\n                    expect(res.body.data.attachments[1].originalName).to.equal('hadron_collider.jpg');\n\n                    logWithAttachmentsId = res.body.data.id;\n                    attachmentId = res.body.data.attachments[0].id;\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body with run number was sent', (done) => {\n            request(server)\n                .post('/api/logs')\n                .field('title', 'Yet another run')\n                .field('text', 'Text of yet another run')\n                .field('runNumbers', '1')\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.runs).to.deep.include({ id: 1, runNumber: 1 });\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body with multiple run numbers was sent', (done) => {\n            request(server)\n                .post('/api/logs')\n                .field('title', 'Yet another run')\n                .field('text', 'Text of yet another run')\n                .field('runNumbers', '1, 2')\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.runs).to.deep.include({ id: 1, runNumber: 1 });\n                    expect(res.body.data.runs).to.deep.include({ id: 2, runNumber: 2 });\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/logs/:logId', () => {\n        it('should return 400 if the log id is not a number', (done) => {\n            request(server)\n                .get('/api/logs/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/logId');\n                    expect(titleError.detail).to.equal('\"params.logId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the log id is not positive', (done) => {\n            request(server)\n                .get('/api/logs/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/logId');\n                    expect(titleError.detail).to.equal('\"params.logId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the log id is not a whole number', (done) => {\n            request(server)\n                .get('/api/logs/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/logId');\n                    expect(titleError.detail).to.equal('\"params.logId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the log could not be found', (done) => {\n            request(server)\n                .get('/api/logs/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Log with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/logs/1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(1);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/logs/:logId/tags', () => {\n        it('should return 400 if the log id is not a number', (done) => {\n            request(server)\n                .get('/api/logs/abc/tags')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/logId');\n                    expect(titleError.detail).to.equal('\"params.logId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the log could not be found', (done) => {\n            request(server)\n                .get('/api/logs/999999999/tags')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Log with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/logs/1/tags')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/logs/:logId/tree', () => {\n        it('should return 400 if the log id is not a number', (done) => {\n            request(server)\n                .get('/api/logs/abc/tree')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/logId');\n                    expect(titleError.detail).to.equal('\"params.logId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the log could not be found', (done) => {\n            request(server)\n                .get('/api/logs/999999999/tree')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Log with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        let tree;\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/logs/1/tree')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    tree = res.body.data;\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/logs/2/tree')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.deep.equal(tree);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/logs/:logId/attachments', () => {\n        it('should return an array', (done) => {\n            request(server)\n                .get(`/api/logs/${logWithAttachmentsId}/attachments`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    expect(res.body.data).to.be.an('array');\n                    done();\n                });\n        });\n\n        it('should return an array of attachments of specific mime-type', (done) => {\n            request(server)\n                .get(`/api/logs/${logWithAttachmentsId}/attachments?mimetype=image/png`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data.length).to.equal(1);\n                    expect(res.body.data[0].mimeType).to.equal('image/png');\n                    done();\n                });\n        });\n\n        it('should return an array of attachments of specific mime-type group', (done) => {\n            request(server)\n                .get(`/api/logs/${logWithAttachmentsId}/attachments?mimetype=image`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data.length).to.equal(2);\n                    expect(res.body.data).to.satisfy((files) =>\n                        files.every((file) => file.mimeType.match(/^image\\//)));\n                    done();\n                });\n        });\n\n        it('should return 404 if log does not exist', (done) => {\n            request(server)\n                .get('/api/logs/999/attachments')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    /*\n                     * Response must satisfy the OpenAPI specification\n                     * expect(res).to.satisfyApiSpec;\n                     */\n\n                    expect(res.body.errors[0].title).to.equal('Log with this id (999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if there is an disallowed query parameter', (done) => {\n            request(server)\n                .get(`/api/logs/${logWithAttachmentsId}/attachments?mayI=no`)\n                .expect(400)\n                .end((err, _res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    /*\n                     * Response must satisfy the OpenAPI specification\n                     * expect(res).to.satisfyApiSpec;\n                     */\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/logs/:logId/attachments/:attachmentId', () => {\n        it('should return an attachment', (done) => {\n            request(server)\n                .get(`/api/logs/${logWithAttachmentsId}/attachments/${attachmentId}`)\n                .expect(200)\n                .end((err) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    /*\n                     * Response must satisfy the OpenAPI specification\n                     * expect(res).to.satisfyApiSpec;\n                     */\n                    done();\n                });\n        });\n\n        it('should return 404 if log can not be found', (done) => {\n            request(server)\n                .get('/api/logs/999/attachments/1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    /*\n                     * Response must satisfy the OpenAPI specification\n                     * expect(res).to.satisfyApiSpec;\n                     */\n\n                    const { errors } = res.body;\n                    expect(errors[0].title).to\n                        .equal('Log with this id (999) does not have Attachment with this id (1)');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if log does not have attachment with given id', (done) => {\n            request(server)\n                .get(`/api/logs/${logWithAttachmentsId}/attachments/999`)\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    /*\n                     * Response must satisfy the OpenAPI specification\n                     * expect(res).to.satisfyApiSpec;\n                     */\n\n                    const { errors } = res.body;\n                    expect(errors[0].title).to\n                        .equal('Attachment with this id (999) could not be found');\n\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/runs.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/database","line":18,"column":45,"nodeType":"CallExpression","endLine":18,"endColumn":74},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":25,"column":24,"nodeType":"CallExpression","endLine":25,"endColumn":56}],"errorCount":6,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\nconst { repositories: { RunRepository } } = require('../../lib/database');\n\nconst { expect } = chai;\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    const { server } = require('../../lib/application');\n\n    describe('GET /api/runs', () => {\n        it('should return an array', (done) => {\n            request(server)\n                .get('/api/runs')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 0 and limit 1', (done) => {\n            request(server)\n                .get('/api/runs?page[offset]=0&page[limit]=1&sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(1);\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 1 and limit 1', (done) => {\n            request(server)\n                .get('/api/runs?page[offset]=1&page[limit]=1&sort[id]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(2);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the limit is below 1', (done) => {\n            request(server)\n                .get('/api/runs?page[offset]=0&page[limit]=0')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/query/page/limit');\n                    expect(titleError.detail).to.equal('\"query.page.limit\" must be larger than or equal to 1');\n\n                    done();\n                });\n        });\n\n        it('should return the correct number of pages', (done) => {\n            request(server)\n                .get('/api/runs?page[offset]=0&page[limit]=2')\n                .expect(200)\n                .end(async (err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const totalNumber = await RunRepository.count();\n\n                    expect(res.body.data).to.have.lengthOf(2);\n                    expect(res.body.meta.page.pageCount).to.equal(Math.ceil(totalNumber / 2));\n                    expect(res.body.meta.page.totalCount).to.equal(totalNumber);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, runNumber DESC', (done) => {\n            request(server)\n                .get('/api/runs?sort[runNumber]=desc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[0].runNumber).to.be.greaterThan(data[1].runNumber);\n\n                    done();\n                });\n        });\n\n        it('should support sorting, runNumber ASC', (done) => {\n            request(server)\n                .get('/api/runs?sort[runNumber]=asc')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { data } = res.body;\n                    expect(data[1].runNumber).to.be.greaterThan(data[0].runNumber);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/runs/:runId', () => {\n        it('should return 400 if the run id is not a number', (done) => {\n            request(server)\n                .get('/api/runs/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/runId');\n                    expect(titleError.detail).to.equal('\"params.runId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the run id is not positive', (done) => {\n            request(server)\n                .get('/api/runs/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/runId');\n                    expect(titleError.detail).to.equal('\"params.runId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the run id is not a whole number', (done) => {\n            request(server)\n                .get('/api/runs/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/runId');\n                    expect(titleError.detail).to.equal('\"params.runId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the run could not be found', (done) => {\n            request(server)\n                .get('/api/runs/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Run with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/runs/1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(1);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/runs/:runId/logs', () => {\n        it('should return 400 if the run id is not a number', (done) => {\n            request(server)\n                .get('/api/runs/abc/logs')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/runId');\n                    expect(titleError.detail).to.equal('\"params.runId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the run could not be found', (done) => {\n            request(server)\n                .get('/api/runs/999999999/logs')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Run with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/runs/1/logs')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data).to.have.lengthOf(4);\n\n                    expect(res.body.data[0].id).to.equal(1);\n                    expect(res.body.data[0].runs).to.deep.equal([\n                        {\n                            id: 1,\n                            runNumber: 1,\n                        },\n                    ]);\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/subsystems.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/domain","line":22,"column":5,"nodeType":"CallExpression","endLine":22,"endColumn":32},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/usecases","line":27,"column":5,"nodeType":"CallExpression","endLine":27,"endColumn":34},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":34,"column":24,"nodeType":"CallExpression","endLine":34,"endColumn":56}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\nconst {\n    dtos: {\n        CreateSubsystemDto,\n    },\n} = require('../../lib/domain');\nconst {\n    subsystem: {\n        CreateSubsystemUseCase,\n    },\n} = require('../../lib/usecases');\n\nconst { expect } = chai;\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    const { server } = require('../../lib/application');\n\n    describe('GET /api/subsystems', () => {\n        it('should return an array', (done) => {\n            request(server)\n                .get('/api/subsystems')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 0 and limit 1', (done) => {\n            request(server)\n                .get('/api/subsystems?page[offset]=0&page[limit]=1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(1);\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 1 and limit 1', (done) => {\n            request(server)\n                .get('/api/subsystems?page[offset]=1&page[limit]=1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(2);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the limit is below 1', (done) => {\n            request(server)\n                .get('/api/subsystems?page[offset]=0&page[limit]=0')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/query/page/limit');\n                    expect(titleError.detail).to.equal('\"query.page.limit\" must be larger than or equal to 1');\n\n                    done();\n                });\n        });\n    });\n\n    describe('POST /api/subsystems', () => {\n        it('should return 400 if no name is provided', (done) => {\n            request(server)\n                .post('/api/subsystems')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/name');\n                    expect(titleError.detail).to.equal('\"body.name\" is required');\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body was sent', (done) => {\n            const expectedName = `UNIX:${new Date().getTime()}`;\n            request(server)\n                .post('/api/subsystems')\n                .send({\n                    name: expectedName,\n                })\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.name).to.equal(expectedName);\n\n                    done();\n                });\n        });\n\n        it('should return 409 if we are creating the same subsystem again', (done) => {\n            request(server)\n                .post('/api/subsystems')\n                .send({\n                    name: 'Subsystem Plant #1',\n                })\n                .expect(409)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].detail).to.equal('The provided entity already exists');\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/subsystems/:subsystemId', () => {\n        it('should return 400 if the subsystem id is not a number', (done) => {\n            request(server)\n                .get('/api/subsystems/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError =\n                        errors.find((err) => err.source.pointer === '/data/attributes/params/subsystemId');\n                    expect(titleError.detail).to.equal('\"params.subsystemId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the subsystem id is not positive', (done) => {\n            request(server)\n                .get('/api/subsystems/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const error = errors.find((err) => err.source.pointer === '/data/attributes/params/subsystemId');\n                    expect(error.detail).to.equal('\"params.subsystemId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the subsystem id is not a whole number', (done) => {\n            request(server)\n                .get('/api/subsystems/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const error = errors.find((err) => err.source.pointer === '/data/attributes/params/subsystemId');\n                    expect(error.detail).to.equal('\"params.subsystemId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the subsystem could not be found', (done) => {\n            request(server)\n                .get('/api/subsystems/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Subsystem with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/subsystems/1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(1);\n\n                    done();\n                });\n        });\n    });\n\n    describe('DELETE /api/subsystems/:subsystemId', () => {\n        let createdSubsystem;\n\n        beforeEach(async () => {\n            const createSubsystemDto = await CreateSubsystemDto.validateAsync({\n                body: {\n                    name: `SUBSYSTEM#${new Date().getTime()}`,\n                },\n            });\n\n            createdSubsystem = await new CreateSubsystemUseCase()\n                .execute(createSubsystemDto);\n        });\n\n        it('should return 400 if the subsystem id is not a number', (done) => {\n            request(server)\n                .delete('/api/subsystems/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const error = errors.find((err) => err.source.pointer === '/data/attributes/params/subsystemId');\n                    expect(error.detail).to.equal('\"params.subsystemId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the subsystem id is not positive', (done) => {\n            request(server)\n                .delete('/api/subsystems/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const error = errors.find((err) => err.source.pointer === '/data/attributes/params/subsystemId');\n                    expect(error.detail).to.equal('\"params.subsystemId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the subsystem id is not a whole number', (done) => {\n            request(server)\n                .delete('/api/subsystems/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const error = errors.find((err) => err.source.pointer === '/data/attributes/params/subsystemId');\n                    expect(error.detail).to.equal('\"params.subsystemId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the subsystem could not be found', (done) => {\n            request(server)\n                .delete('/api/subsystems/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Subsystem with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .delete(`/api/subsystems/${createdSubsystem.id}`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(createdSubsystem.id);\n                    expect(res.body.data.name).to.equal(createdSubsystem.name);\n\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/e2e/tags.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"supertest","line":16,"column":17,"nodeType":"CallExpression","endLine":16,"endColumn":37},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai-openapi-response-validator","line":17,"column":31,"nodeType":"CallExpression","endLine":17,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/usecases","line":18,"column":39,"nodeType":"CallExpression","endLine":18,"endColumn":68},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/domain","line":19,"column":36,"nodeType":"CallExpression","endLine":19,"endColumn":63},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":26,"column":24,"nodeType":"CallExpression","endLine":26,"endColumn":56}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst chai = require('chai');\nconst request = require('supertest');\nconst chaiResponseValidator = require('chai-openapi-response-validator');\nconst { tag: { CreateTagUseCase } } = require('../../lib/usecases');\nconst { dtos: { CreateTagDto } } = require('../../lib/domain');\n\nconst { expect } = chai;\n\nchai.use(chaiResponseValidator(path.resolve(__dirname, '..', '..', 'spec', 'openapi.yaml')));\n\nmodule.exports = () => {\n    const { server } = require('../../lib/application');\n\n    describe('GET /api/tags', () => {\n        it('should return an array', (done) => {\n            request(server)\n                .get('/api/tags')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 0 and limit 1', (done) => {\n            request(server)\n                .get('/api/tags?page[offset]=0&page[limit]=1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(1);\n\n                    done();\n                });\n        });\n\n        it('should support pagination, offset 1 and limit 1', (done) => {\n            request(server)\n                .get('/api/tags?page[offset]=1&page[limit]=1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.have.lengthOf(1);\n                    expect(res.body.data[0].id).to.equal(2);\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the limit is below 1', (done) => {\n            request(server)\n                .get('/api/tags?page[offset]=0&page[limit]=0')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/query/page/limit');\n                    expect(titleError.detail).to.equal('\"query.page.limit\" must be larger than or equal to 1');\n\n                    done();\n                });\n        });\n    });\n\n    describe('POST /api/tags', () => {\n        it('should return 400 if no text is provided', (done) => {\n            request(server)\n                .post('/api/tags')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/text');\n                    expect(titleError.detail).to.equal('\"body.text\" is required');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the title is too short', (done) => {\n            request(server)\n                .post('/api/tags')\n                .send({\n                    text: 'A',\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/text');\n                    expect(titleError.detail).to.equal('\"body.text\" length must be at least 3 characters long');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the title is too long', (done) => {\n            request(server)\n                .post('/api/tags')\n                .send({\n                    text: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ',\n                })\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/body/text');\n                    expect(titleError.detail)\n                        .to.equal('\"body.text\" length must be less than or equal to 20 characters long');\n\n                    done();\n                });\n        });\n\n        it('should return 201 if a proper body was sent', (done) => {\n            const expectedText = `UNIX:${new Date().getTime()}`;\n            request(server)\n                .post('/api/tags')\n                .send({\n                    text: expectedText,\n                })\n                .expect(201)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.text).to.equal(expectedText);\n\n                    done();\n                });\n        });\n\n        it('should return 409 if we are creating the same tag again', (done) => {\n            request(server)\n                .post('/api/tags')\n                .send({\n                    text: 'FOOD',\n                })\n                .expect(409)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].detail).to.equal('The provided entity already exists');\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/tags/:tagId', () => {\n        it('should return 400 if the tag id is not a number', (done) => {\n            request(server)\n                .get('/api/tags/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the tag id is not positive', (done) => {\n            request(server)\n                .get('/api/tags/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the tag id is not a whole number', (done) => {\n            request(server)\n                .get('/api/tags/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the tag could not be found', (done) => {\n            request(server)\n                .get('/api/tags/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Tag with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/tags/1')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(1);\n\n                    done();\n                });\n        });\n    });\n\n    describe('DELETE /api/tags/:tagId', () => {\n        let createdTag;\n\n        beforeEach(async () => {\n            const createTagDto = await CreateTagDto.validateAsync({\n                body: {\n                    text: `TAG#${new Date().getTime()}`,\n                },\n            });\n\n            createdTag = await new CreateTagUseCase()\n                .execute(createTagDto);\n        });\n\n        it('should return 400 if the tag id is not a number', (done) => {\n            request(server)\n                .delete('/api/tags/abc')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the tag id is not positive', (done) => {\n            request(server)\n                .delete('/api/tags/-1')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be a positive number');\n\n                    done();\n                });\n        });\n\n        it('should return 400 if the tag id is not a whole number', (done) => {\n            request(server)\n                .delete('/api/tags/0.5')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be an integer');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the tag could not be found', (done) => {\n            request(server)\n                .delete('/api/tags/999999999')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Tag with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .delete(`/api/tags/${createdTag.id}`)\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data.id).to.equal(createdTag.id);\n                    expect(res.body.data.text).to.equal(createdTag.text);\n\n                    done();\n                });\n        });\n    });\n\n    describe('GET /api/tags/:tagId/logs', () => {\n        it('should return 400 if the tag id is not a number', (done) => {\n            request(server)\n                .get('/api/tags/abc/logs')\n                .expect(400)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    const { errors } = res.body;\n                    const titleError = errors.find((err) => err.source.pointer === '/data/attributes/params/tagId');\n                    expect(titleError.detail).to.equal('\"params.tagId\" must be a number');\n\n                    done();\n                });\n        });\n\n        it('should return 404 if the tag could not be found', (done) => {\n            request(server)\n                .get('/api/tags/999999999/logs')\n                .expect(404)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.errors[0].title).to.equal('Tag with this id (999999999) could not be found');\n\n                    done();\n                });\n        });\n\n        it('should return 200 in all other cases', (done) => {\n            request(server)\n                .get('/api/tags/1/logs')\n                .expect(200)\n                .end((err, res) => {\n                    if (err) {\n                        done(err);\n                        return;\n                    }\n\n                    // Response must satisfy the OpenAPI specification\n                    expect(res).to.satisfyApiSpec;\n\n                    expect(res.body.data).to.be.an('array');\n                    expect(res.body.data\n                        .every((log) => log.tags.length > 0 && log.tags.some((tag) => tag.id === 1)))\n                        .to.be.true;\n\n                    done();\n                });\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./database","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":44},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./e2e","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":39},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./presentation","line":16,"column":27,"nodeType":"CallExpression","endLine":16,"endColumn":52},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./public","line":17,"column":21,"nodeType":"CallExpression","endLine":17,"endColumn":40},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./server","line":18,"column":21,"nodeType":"CallExpression","endLine":18,"endColumn":40},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./usecases","line":19,"column":23,"nodeType":"CallExpression","endLine":19,"endColumn":44},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./utilities","line":20,"column":24,"nodeType":"CallExpression","endLine":20,"endColumn":46},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./openapi.test","line":21,"column":22,"nodeType":"CallExpression","endLine":21,"endColumn":47},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../lib/application","line":24,"column":25,"nodeType":"CallExpression","endLine":24,"endColumn":54}],"errorCount":9,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst DatabaseSuite = require('./database');\nconst EndToEndSuite = require('./e2e');\nconst PresentationSuite = require('./presentation');\nconst PublicSuite = require('./public');\nconst ServerSuite = require('./server');\nconst UseCasesSuite = require('./usecases');\nconst UtilitiesSuite = require('./utilities');\nconst OpenApiSuite = require('./openapi.test');\n\ndescribe('Bookkeeping', () => {\n    const application = require('../lib/application');\n\n    before(async () => {\n        await application.run();\n    });\n\n    after(async () => {\n        await application.stop(true);\n    });\n\n    describe('Unit Suite', () => {\n        describe('Database', DatabaseSuite);\n        describe('Presentation', PresentationSuite);\n        describe('Server', ServerSuite);\n        describe('Use Cases', UseCasesSuite);\n        describe('Utilities', UtilitiesSuite);\n        describe('OpenAPI Specification', OpenApiSuite);\n    });\n\n    describe('Integration Suite', () => {\n        describe('UI', PublicSuite);\n        describe('API', EndToEndSuite);\n    });\n});\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/openapi.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":20,"nodeType":"CallExpression","endLine":15,"endColumn":35},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"js-yaml","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":32},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"fs","line":17,"column":12,"nodeType":"CallExpression","endLine":17,"endColumn":25},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../lib/server/routers","line":18,"column":29,"nodeType":"CallExpression","endLine":18,"endColumn":61}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst path = require('path');\nconst { expect } = require('chai');\nconst yaml = require('js-yaml');\nconst fs = require('fs');\nconst { getRoutesAsList } = require('../lib/server/routers');\n\nmodule.exports = () => {\n    it.allowFail = (title, callback) => {\n        it(title, async function () {\n            try {\n                await Promise.resolve();\n                return callback.apply(this, arguments);\n            } catch (e) {\n                this.skip();\n            }\n        });\n    };\n\n    const routes = getRoutesAsList();\n\n    const spec = yaml.safeLoad(fs.readFileSync(path.resolve(__dirname, '..', 'spec', 'openapi.yaml'), 'utf8'));\n\n    const expectedRoutes = [];\n    Object.keys(spec.paths).forEach((specPath) => {\n        Object.keys(spec.paths[specPath]).forEach((specPathMethod) => {\n            if (specPathMethod === 'parameters') {\n                return;\n            }\n\n            const expectedMethod = specPathMethod.toUpperCase();\n            const expectedPath = specPath.split('/').map((sub) => sub.replace(/{([^}]+)}/, ':$1')).join('/');\n\n            expectedRoutes.push(`${expectedMethod} ${expectedPath}`);\n        });\n    });\n\n    const foundRoutes = [];\n    routes.forEach((route) => {\n        const { method, path } = route;\n        describe(`${method.toUpperCase()} ${path}`, () => {\n            foundRoutes.push(`${method.toUpperCase()} ${path}`);\n\n            it.allowFail('should be defined in the OpenAPI spec', () => {\n                const specPath = path.split('/').map((sub) => sub.replace(/:(.*)/, '{$1}')).join('/');\n                const specRoute = spec.paths[specPath];\n\n                expect(specRoute).to.not.be.undefined;\n                expect(specRoute).to.not.be.null;\n\n                expect(specRoute).to.haveOwnProperty(method.toLowerCase());\n            });\n        });\n    });\n\n    /*\n     * It('should have tested all routes defined in the spec', () => {\n     *     expect(foundRoutes).to.include.members(expectedRoutes);\n     * });\n     */\n\n    it.allowFail('should have defined all tested routes in the spec', () => {\n        expect(expectedRoutes).to.include.members(foundRoutes);\n    });\n\n    describe('Validator', () => {\n        // eslint-disable-next-line require-jsdoc\n        function traverse(parent, path = []) {\n            const keys = typeof parent === 'object' ? Object.keys(parent) : [];\n            for (let i = 0; i < keys.length; i++) {\n                const element = keys[i];\n                describe(element, () => {\n                    traverse(parent[element], [element, ...path]);\n                });\n            }\n\n            if (path[0] === 'paths' || path[1] === 'components') {\n                let prevItem;\n                it('should have sorted all keys alphabetically', () => {\n                    for (const item of Object.keys(parent)) {\n                        expect(prevItem > item, `Expected ${item} to be before ${prevItem}`).to.be.false;\n                        prevItem = item;\n                    }\n                });\n            }\n\n            if (keys.includes('type') && parent['type'] === 'object' && path[0] !== 'Entity') {\n                it('should have set the additionalProperties to false', () => {\n                    expect(keys).to.include('additionalProperties');\n                    expect(parent['additionalProperties']).to.be.false;\n                });\n            }\n\n            if (path[2] === 'paths' && path[0] !== 'parameters') {\n                it('should have an operationId', () => {\n                    expect(keys).to.include('operationId');\n                    expect(keys[0]).to.equal('operationId');\n                });\n\n                it('should have an summary', () => {\n                    expect(keys).to.include('summary');\n                    expect(keys[1]).to.equal('summary');\n                });\n            }\n\n            if (path[3] === 'paths' && path[0] === 'tags') {\n                it('should have a single tag', () => {\n                    expect(keys).to.have.lengthOf(1);\n                });\n            }\n\n            if (path[0] === 'description') {\n                it('should start with a capital letter', () => {\n                    expect(parent).to.match(/^[A-Z].*$/);\n                });\n\n                it.allowFail('should end with a period', () => {\n                    expect(parent).to.match(/^.*\\.$/);\n                });\n            }\n\n            if (path[3] === 'paths' && path[0] === 'responses') {\n                it('should have a default response', () => {\n                    expect(keys).to.include('default');\n                    expect(keys[keys.length - 1]).to.equal('default');\n                });\n            }\n\n            if (path[2] === 'paths' && path[0] === 'post') {\n                it('should have a request body', () => {\n                    expect(keys).to.include('requestBody');\n                    expect(keys[2]).to.equal('requestBody');\n                });\n            }\n\n            if (path[0] === 'schema') {\n                it.allowFail('should have a $ref', () => {\n                    expect(keys).to.have.lengthOf(1);\n                    expect(keys[0]).to.equal('$ref');\n                });\n            }\n        }\n\n        traverse(spec);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/presentation/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./log","line":14,"column":18,"nodeType":"CallExpression","endLine":14,"endColumn":34}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst LogSuite = require('./log');\n\nmodule.exports = () => {\n    describe('Log', LogSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/presentation/log/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./toTreeView.test","line":14,"column":25,"nodeType":"CallExpression","endLine":14,"endColumn":53}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst toTreeViewSuite = require('./toTreeView.test');\n\nmodule.exports = () => {\n    describe('toTreeView', toTreeViewSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/presentation/log/toTreeView.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/presentation","line":19,"column":5,"nodeType":"CallExpression","endLine":19,"endColumn":41},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":20,"column":14,"nodeType":"CallExpression","endLine":20,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3),\n *copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst {\n    log: {\n        toTreeView,\n    },\n} = require('../../../lib/presentation');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should work', () => {\n        const root = {\n            id: 1,\n            authorId: 'John Doe',\n            title: 'First entry',\n            createdAt: 1591219115000,\n            tags: [\n                {\n                    id: 3,\n                    text: 'MAINTENANCE',\n                },\n            ],\n            text: 'Power interruption due to unplugged wire.',\n            origin: 'human',\n            subtype: 'run',\n            rootLogId: 1,\n            parentLogId: 1,\n        };\n\n        const children = [\n            {\n                id: 2,\n                authorId: 'John Doe',\n                title: 'Second entry',\n                createdAt: 1591219115000,\n                tags: [\n                    {\n                        id: 2,\n                        text: 'RUN',\n                    },\n                    {\n                        id: 5,\n                        text: 'TEST',\n                    },\n                ],\n                text: 'Detected particle ABC123',\n                origin: 'process',\n                subtype: 'subsystem',\n                rootLogId: 1,\n                parentLogId: 1,\n            },\n            {\n                id: 3,\n                authorId: 'John Doe',\n                title: 'Third entry',\n                createdAt: 1591219115000,\n                tags: [\n                    {\n                        id: 1,\n                        text: 'FOOD',\n                    },\n                    {\n                        id: 4,\n                        text: 'GLOBAL',\n                    },\n                    {\n                        id: 6,\n                        text: 'OTHER',\n                    },\n                ],\n                text: 'Cake at the particle accelerator!',\n                origin: 'human',\n                subtype: 'announcement',\n                rootLogId: 1,\n                parentLogId: 1,\n            },\n            {\n                id: 4,\n                authorId: 'John Doe',\n                title: 'Fourth entry',\n                createdAt: 1591219115000,\n                tags: [],\n                text: 'The cake is a lie!',\n                origin: 'human',\n                subtype: 'comment',\n                rootLogId: 1,\n                parentLogId: 2,\n            },\n            {\n                id: 14,\n                authorId: 'John Doe',\n                title: 'test on third',\n                createdAt: 1591446994000,\n                tags: [],\n                text: 'text',\n                origin: 'process',\n                subtype: 'run',\n                rootLogId: 1,\n                parentLogId: 3,\n            },\n            {\n                id: 15,\n                authorId: 'John Doe',\n                title: 'depth',\n                createdAt: 1591450185000,\n                tags: [],\n                text: '4444',\n                origin: 'process',\n                subtype: 'run',\n                rootLogId: 1,\n                parentLogId: 14,\n            },\n        ];\n\n        expect(toTreeView(root, children)).to.deep.equal({\n            id: 1,\n            authorId: 'John Doe',\n            title: 'First entry',\n            createdAt: 1591219115000,\n            tags: [\n                {\n                    id: 3,\n                    text: 'MAINTENANCE',\n                },\n            ],\n            text: 'Power interruption due to unplugged wire.',\n            origin: 'human',\n            subtype: 'run',\n            rootLogId: 1,\n            parentLogId: 1,\n            children: [\n                {\n                    id: 2,\n                    authorId: 'John Doe',\n                    title: 'Second entry',\n                    createdAt: 1591219115000,\n                    tags: [\n                        {\n                            id: 2,\n                            text: 'RUN',\n                        },\n                        {\n                            id: 5,\n                            text: 'TEST',\n                        },\n                    ],\n                    text: 'Detected particle ABC123',\n                    origin: 'process',\n                    subtype: 'subsystem',\n                    rootLogId: 1,\n                    parentLogId: 1,\n                    children: [\n                        {\n                            id: 4,\n                            authorId: 'John Doe',\n                            title: 'Fourth entry',\n                            createdAt: 1591219115000,\n                            tags: [],\n                            text: 'The cake is a lie!',\n                            origin: 'human',\n                            subtype: 'comment',\n                            rootLogId: 1,\n                            parentLogId: 2,\n                            children: [],\n                        },\n                    ],\n                },\n                {\n                    id: 3,\n                    authorId: 'John Doe',\n                    title: 'Third entry',\n                    createdAt: 1591219115000,\n                    tags: [\n                        {\n                            id: 1,\n                            text: 'FOOD',\n                        },\n                        {\n                            id: 4,\n                            text: 'GLOBAL',\n                        },\n                        {\n                            id: 6,\n                            text: 'OTHER',\n                        },\n                    ],\n                    text: 'Cake at the particle accelerator!',\n                    origin: 'human',\n                    subtype: 'announcement',\n                    rootLogId: 1,\n                    parentLogId: 1,\n                    children: [\n                        {\n                            id: 14,\n                            authorId: 'John Doe',\n                            title: 'test on third',\n                            createdAt: 1591446994000,\n                            tags: [],\n                            text: 'text',\n                            origin: 'process',\n                            subtype: 'run',\n                            rootLogId: 1,\n                            parentLogId: 3,\n                            children: [\n                                {\n                                    id: 15,\n                                    authorId: 'John Doe',\n                                    title: 'depth',\n                                    createdAt: 1591450185000,\n                                    tags: [],\n                                    text: '4444',\n                                    origin: 'process',\n                                    subtype: 'run',\n                                    rootLogId: 1,\n                                    parentLogId: 14,\n                                    children: [],\n                                },\n                            ],\n                        },\n                    ],\n                },\n            ],\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/about/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/about/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":68,"nodeType":"CallExpression","endLine":15,"endColumn":90}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n        await page.setViewport({\n            width: 700,\n            height: 720,\n            deviceScaleFactor: 1,\n        });\n    });\n\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=about-overview`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('Can find table', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // We expect to find a table\n        await pressElement(page, `#${firstRowId}`);\n        expect(firstRowId).to.equal('rowundefined');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/defaults.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"puppeteer","line":15,"column":19,"nodeType":"CallExpression","endLine":15,"endColumn":39},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"puppeteer-to-istanbul","line":16,"column":13,"nodeType":"CallExpression","endLine":16,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/application","line":17,"column":20,"nodeType":"CallExpression","endLine":17,"endColumn":52}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst puppeteer = require('puppeteer');\nconst pti = require('puppeteer-to-istanbul');\nconst { server } = require('../../lib/application');\n\nconst { expect } = chai;\n\n/**\n * Returns the URL with correct port postfixed.\n * @returns {String} URL specific to the port specified by user/host.\n */\nconst getUrl = ()=> `http://localhost:${server.address().port}`;\n\n/**\n * Constructor to build elements before tests start.\n * @param {Object} page Puppeteer page object\n * @param {Object} browser Browser object to run tests on\n * @returns {Array} Array of multiple objects, consisting of Page, Browser and Url.\n */\nmodule.exports.defaultBefore = async (page, browser) => {\n    browser = await puppeteer.launch({ args: ['--no-sandbox'] });\n    page = await browser.newPage();\n    await Promise.all([\n        page.coverage.startJSCoverage({ resetOnNavigation: false }),\n        page.coverage.startCSSCoverage(),\n    ]);\n\n    return [page, browser, getUrl()];\n};\n\n/**\n * Destructor to cleanup after tests are finished.\n * @param {Object} page Puppeteer page object\n * @param {Object} browser Browser object to run tests on\n * @returns {Array} Array of multiple objects, consisting of Page and Browser.\n */\nmodule.exports.defaultAfter = async (page, browser) => {\n    const [jsCoverage, cssCoverage] = await Promise.all([\n        page.coverage.stopJSCoverage(),\n        page.coverage.stopCSSCoverage(),\n    ]);\n\n    pti.write([...jsCoverage, ...cssCoverage].filter(({ url = '' } = {}) => url.match(/\\.(js|css)$/)), {\n        includeHostname: false,\n        storagePath: './.nyc_output/lib/public',\n    });\n    await browser.close();\n\n    return [page, browser];\n};\n\n/**\n * Wait till selector is visible, then search for innertext on page.\n * @param {Object} page Puppeteer page object.\n * @param {String} selector Css selector.\n * @param {String} innerText Text to search for.\n * @returns {Boolean} Whether the text was found on the page or not.\n */\nmodule.exports.expectInnerText = async (page, selector, innerText) => {\n    await page.waitForSelector(selector);\n    const elementInnerText = await page.$eval(selector, (element) => element.innerText);\n    expect(elementInnerText).to.equal(innerText);\n};\n\n/**\n * Waits till selector is visible and then clicks element.\n * @param {Object} page Puppeteer page object.\n * @param {String} selector Css selector.\n * @returns {Promise} Whether the element was clickable or not.\n */\nmodule.exports.pressElement = async (page, selector) => await Promise.all([\n    await page.waitForSelector(selector),\n    page.click(selector),\n]);\n\n/**\n * Goes to a specific page and waits until everything is loaded.\n * @param {Object} page Puppeteer page object.\n * @param {String} pageText Value of pageText in: URL/?page={pageText}&...\n * @returns {String} Switches the user to the correct page.\n */\nmodule.exports.goToPage = (page, pageText) => page.goto(`${getUrl()}/?page=${pageText}`, { waitUntil: 'networkidle0' });\n\n/**\n * Validates if selector is present and returns the element.\n * @param {Object} page Puppeteer page object.\n * @param {String} selector Css selector.\n * @returns {Object} Element matching the selector.\n */\nmodule.exports.validateElement = async (page, selector) => {\n    await page.waitForSelector(selector);\n    const element = page.$(selector);\n    expect(Boolean(element)).to.be.true;\n    return element;\n};\n\n/**\n * Debug helper function\n * This function takes a screenshot of the current screen the page is at, and saves it to\n * database/storage/screenshot.png\n * @param {*} page Puppeteer page object.\n * @param {String} name Name of the screenshot taken. Useful when taking multiple in a row.\n * @returns {*} None\n */\nmodule.exports.takeScreenshot = async (page, name = 'screenshot') => {\n    await page.setViewport({ width: 1920, height: 1080 });\n    await page.screenshot({\n        path: `/var/storage/${name}.png`,\n        type: 'png',\n        fullPage: true,\n    });\n};\n\n/**\n * Validates if selector is present and returns the element.\n * @param {Object} page Puppeteer page object.\n * @param {String} selector Css selector.\n * @param {Object} value value that is expected at the Css selector element.\n * @returns {Object} Element matching the selector\n */\nmodule.exports.validateElementEqualTo = async (page, selector, value) => {\n    await page.waitForSelector(selector);\n    const element = await page.$$(selector);\n    expect(Boolean(element)).to.be.true;\n    expect(element.length).to.equal(value);\n    return element;\n};\n\n/**\n * Special method built due to Puppeteer limitations: looks for the first row matching an ID in a table\n * @param {Object} table An HTML element representing the entire run table\n * @param {Object} page An object representing the browser page being used by Puppeteer\n * @return {Promise<String>} The ID of the first matching row with data\n */\nmodule.exports.getFirstRow = async (table, page) => {\n    for await (const child of table) {\n        const id = await page.evaluate((element) => element.id, child);\n        if (id.startsWith('row')) {\n            return id;\n        }\n    }\n};\n\n/**\n * Special method built to gather all currently visible table entities from a specific column into an array\n * @param {Object} page An object representing the browser page being used by Puppeteer\n * @param {String} key The key for the column to gather entities of\n * @return {Promise<Array>} An array containing all table entities of a column, in the order displayed by the browser\n */\nmodule.exports.getAllDataFields = async (page, key) => {\n    const allData = await page.$$('td');\n    return await allData.reduce(async (accumulator, data) => {\n        const id = await page.evaluate((element) => element.id, data);\n        if (id.endsWith(`-${key}`)) {\n            const text = await page.evaluate((element) => element.innerText, data);\n            (await accumulator).push(text);\n        }\n        return accumulator;\n    }, []);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/flps/detail.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":72,"nodeType":"CallExpression","endLine":15,"endColumn":94}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('flp detail loads correctly', async () => {\n        await page.goto(`${url}/?page=flp-detail&id=1`, { waitUntil: 'networkidle0' });\n        await expectInnerText(page, 'h2', 'Flp #FLP-TPC-1');\n    });\n\n    /*\n     * It('can navigate to the log panel', async () => {\n     *     await pressElement(page, '#logs-tab');\n     *     await page.waitForTimeout(100);\n     *     const redirectedUrl = await page.url();\n     *     expect(String(redirectedUrl).startsWith(`${url}/?page=flp-detail&id=1&panel=logs`)).to.be.true;\n     * });\n     */\n\n    it('can navigate to the main panel', async () => {\n        await pressElement(page, '#main-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=flp-detail&id=1&panel=main`)).to.be.true;\n    });\n\n    /*\n     * It('can navigate to the log panel', async () => {\n     *     await pressElement(page, '#logs-tab');\n     *     await page.waitForTimeout(100);\n     *     const redirectedUrl = await page.url();\n     *     expect(String(redirectedUrl).startsWith(`${url}/?page=flp-detail&id=1&panel=logs`)).to.be.true;\n     * });\n     */\n\n    /*\n     * It('can navigate to a log detail page', async () => {\n     *     table = await page.$$('tr');\n     *     firstRowId = await getFirstRow(table, page);\n     */\n\n    /*\n     *     // We expect the entry page to have the same id as the id from the flp overview\n     *     await pressElement(page, `#${firstRowId}`);\n     *     await page.waitForTimeout(100);\n     *     const redirectedUrl = await page.url();\n     *     expect(String(redirectedUrl).startsWith(`${url}/?page=log-detail&id=1`)).to.be.true;\n     * });\n     */\n\n    it('notifies if a specified flp id is invalid', async () => {\n        // Navigate to a flp detail view with an id that cannot exist\n        await page.goto(`${url}/?page=flp-detail&id=abc`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        await expectInnerText(page, '.alert', 'Invalid Attribute: \"params.flpId\" must be a number');\n    });\n\n    it('notifies if a specified flp id is not found', async () => {\n        // Navigate to a flp detail view with an id that cannot exist\n        await page.goto(`${url}/?page=flp-detail&id=999`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        await expectInnerText(page, '.alert', 'Flp with this id (999) could not be found');\n    });\n\n    it('allows navigating to an associated run', async () => {\n        const flpRoleId = 1;\n        const runId = 1;\n\n        // Navigate to a flp detail view\n        await page.goto(`${url}/?page=flp-detail&id=${flpRoleId}`, { waitUntil: 'networkidle0' });\n        // We expect the correct associated runs to be shown\n        const runField = await page.$('#Flp-runs');\n        const runText = await page.evaluate((element) => element.innerText, runField);\n        expect(runText).to.equal(`Runs:\\n${runId}`);\n\n        // We expect the associated runs to be clickable with a valid link\n        const runLink = await page.$('#Flp-runs a');\n        await runLink.click();\n        await page.waitForTimeout(1000);\n\n        // We expect the link to navigate to the correct run detail page\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=run-detail&id=${runId}&panel=main`);\n    });\n\n    /*\n     * It('can return to the overview page if an error occurred', async () => {\n     *     await page.goto(`${url}/?page=flp-detail&id=1`, { waitUntil: 'networkidle0' });\n     *     // We expect there to be a button to return to the overview page\n     *     await expectInnerText(page, '.btn-primary', 'Return to Overview');\n     */\n\n    /*\n     *     // We expect the button to return the user to the overview page when pressed\n     *     await pressElement(page, '.btn-primary');\n     *     await page.waitForTimeout(100);\n     *     expect(page.url()).to.equal(`${url}/?page=flp-overview`);\n     * });\n     */\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/flps/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./detail.test","line":16,"column":21,"nodeType":"CallExpression","endLine":16,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\n// eslint-disable-next-line capitalized-comments\nconst DetailSuite = require('./detail.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n    // eslint-disable-next-line capitalized-comments\n    describe('Detail Page', DetailSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/flps/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":85,"nodeType":"CallExpression","endLine":15,"endColumn":107}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n        await page.setViewport({\n            width: 700,\n            height: 720,\n            deviceScaleFactor: 1,\n        });\n    });\n\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=flp-overview`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('shows correct datatypes in respective columns', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // Expectations of header texts being of a certain datatype\n        const headerDatatypes = {\n            name: (string) => typeof string == 'string',\n            hostname: (string) => typeof string == 'string',\n            nTimeframes: (number) => typeof number == 'number',\n            bytesProcessed: (number) => typeof number == 'number',\n            bytesEquipmentReadOut: (number) => typeof number == 'number',\n            bytesRecordingReadOut: (number) => typeof number == 'number',\n            bytesFairMQReadOut: (number) => typeof number == 'number',\n        };\n\n        // We find the headers matching the datatype keys\n        const headers = await page.$$('th');\n        const headerIndices = {};\n        for (const [index, header] of headers.entries()) {\n            const headerContent = await page.evaluate((element) => element.id, header);\n            const matchingDatatype = Object.keys(headerDatatypes).find((key) => headerContent === key);\n            if (matchingDatatype !== undefined) {\n                headerIndices[index] = matchingDatatype;\n            }\n        }\n\n        // We expect every value of a header matching a datatype key to actually be of that datatype\n        const firstRowCells = await page.$$(`#${firstRowId} td`);\n        for (const [index, cell] of firstRowCells.entries()) {\n            if (Object.keys(headerIndices).includes(index)) {\n                const cellContent = await page.evaluate((element) => element.innerText, cell);\n                const expectedDatatype = headerDatatypes[headerIndices[index]](cellContent);\n                expect(expectedDatatype).to.be.true;\n            }\n        }\n    });\n\n    it('can switch to infinite mode in amountSelector', async () => {\n        const amountSelectorButton = await page.$('#amountSelector button');\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$('#amountSelector .dropup-menu');\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        const menuItems = await page.$$('#amountSelector .dropup-menu .menu-item');\n        await menuItems[menuItems.length - 1].evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        await page.evaluate(() => {\n            window.scrollBy(0, window.innerHeight);\n        });\n        await page.waitForTimeout(400);\n        const tableRows = await page.$$('table tr');\n\n        expect(tableRows.length > 20).to.be.true;\n    });\n\n    it('can set how many flps are available per page', async () => {\n        // Expect the amount selector to currently be set to Infinite (after the previous test)\n        const amountSelectorId = '#amountSelector';\n        const amountSelectorButton = await page.$(`${amountSelectorId} button`);\n        const amountSelectorButtonText = await page.evaluate((element) => element.innerText, amountSelectorButton);\n        expect(amountSelectorButtonText.endsWith('Infinite ')).to.be.true;\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$(`${amountSelectorId} .dropup-menu`);\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        // Expect the amount of visible flps to reduce when the first option (5) is selected\n        const menuItem = await page.$(`${amountSelectorId} .dropup-menu .menu-item`);\n        await menuItem.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        const tableRows = await page.$$('table tr');\n        expect(tableRows.length - 1).to.equal(5);\n    });\n\n    it('can switch between pages of flps', async () => {\n        // Expect the page selector to be available with two pages\n        const pageSelectorId = '#amountSelector';\n        const pageSelector = await page.$(pageSelectorId);\n        expect(Boolean(pageSelector)).to.be.true;\n        const pageSelectorButtons = await page.$$('#pageSelector .btn-tab');\n        expect(pageSelectorButtons.length).to.equal(5);\n\n        // Expect the table rows to change upon page navigation\n        const oldFirstRowId = await getFirstRow(table, page);\n        const secondPage = await page.$('#page2');\n        await secondPage.evaluate((button) => button.click());\n        await page.waitForTimeout(500);\n        table = await page.$$('tr');\n        const newFirstRowId = await getFirstRow(table, page);\n        expect(oldFirstRowId).to.not.equal(newFirstRowId);\n\n        // Expect us to be able to do the same with the page arrows\n        const prevPage = await page.$('#pageMoveLeft');\n        await prevPage.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const oldFirstPageButton = await page.$('#page1');\n        const oldFirstPageButtonClass = await page.evaluate((element) => element.className, oldFirstPageButton);\n        expect(oldFirstPageButtonClass).to.include('selected');\n\n        // The same, but for the other (right) arrow\n        const nextPage = await page.$('#pageMoveRight');\n        await nextPage.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const newFirstPageButton = await page.$('#page1');\n        const newFirstPageButtonClass = await page.evaluate((element) => element.className, newFirstPageButton);\n        expect(newFirstPageButtonClass).to.not.include('selected');\n    });\n\n    it('dynamically switches between visible pages in the page selector', async () => {\n        // Override the amount of flps visible per page manually\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.flps.setFlpsPerPage(1);\n        });\n        await page.waitForTimeout(100);\n\n        // Expect the page five button to now be visible, but no more than that\n        const pageFiveButton = await page.$('#page5');\n        expect(Boolean(pageFiveButton)).to.be.true;\n        const pageSixButton = await page.$('#page6');\n        expect(Boolean(pageSixButton)).to.be.false;\n\n        // Expect the page one button to have fallen away when clicking on page five button\n        await pressElement(page, '#page5');\n        await page.waitForTimeout(100);\n        const pageOneButton = await page.$('#page1');\n        expect(Boolean(pageOneButton)).to.be.false;\n    });\n\n    it('notifies if table loading returned an error', async () => {\n        /*\n         * As an example, override the amount of flps visible per page manually\n         * We know the limit is 100 as specified by the Dto\n         */\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.flps.setFlpsPerPage(200);\n        });\n        await page.waitForTimeout(100);\n\n        // We expect there to be a fitting error message\n        const expectedMessage = 'Invalid Attribute: \"query.page.limit\" must be less than or equal to 100';\n        await expectInnerText(page, '.alert-danger', expectedMessage);\n\n        // Revert changes for next test\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.flps.setFlpsPerPage(10);\n        });\n        await page.waitForTimeout(100);\n    });\n\n    /*\n     * It('can navigate to a flp detail page', async () => {\n     *  table = await page.$$('tr');\n     *  firstRowId = await getFirstRow(table, page);\n     *  const parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n     *\n     *  // We expect the entry page to have the same id as the id from the flp overview\n     *  await pressElement(page, `#${firstRowId}`);\n     *  await page.waitForTimeout(100);\n     *  const redirectedUrl = await page.url();\n     *  expect(String(redirectedUrl).startsWith(`${url}/?page=flp-detail&id=${parsedFirstRowId}`)).to.be.true;\n     * });\n     */\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/home/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/home/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":19,"column":5,"nodeType":"CallExpression","endLine":19,"endColumn":27}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst {\n    defaultBefore,\n    defaultAfter,\n    getFirstRow,\n} = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=home`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('Can find table', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // We expect to find a table\n        expect(firstRowId).to.equal('row129');\n    });\n\n    it('shows correct datatypes in respective columns', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // Expectations of header texts being of a certain datatype\n        const headerDatatypes = {\n            runNumber: (number) => typeof number == 'number',\n            timeO2Start: (date) => !isNaN(Date.parse(date)),\n            timeO2End: (date) => !isNaN(Date.parse(date)),\n        };\n\n        // We find the headers matching the datatype keys\n        const headers = await page.$$('th');\n        const headerIndices = {};\n        for (const [index, header] of headers.entries()) {\n            const headerContent = await page.evaluate((element) => element.id, header);\n            const matchingDatatype = Object.keys(headerDatatypes).find((key) => headerContent === key);\n            if (matchingDatatype !== undefined) {\n                headerIndices[index] = matchingDatatype;\n            }\n        }\n\n        // We expect every value of a header matching a datatype key to actually be of that datatype\n        const firstRowCells = await page.$$(`#${firstRowId} td`);\n        for (const [index, cell] of firstRowCells.entries()) {\n            if (Object.keys(headerIndices).includes(index)) {\n                const cellContent = await page.evaluate((element) => element.innerText, cell);\n                const expectedDatatype = headerDatatypes[headerIndices[index]](cellContent);\n                expect(expectedDatatype).to.be.true;\n            }\n        }\n    });\n\n    it('can navigate to a detail page', async () => {\n        const firstRow = await page.$('tr.clickable');\n        const parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n\n        // We expect the entry page to have the same id as the id from the log overview\n        await firstRow.evaluate((row) => row.click());\n        await page.waitForTimeout(500);\n\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=log-detail&id=${parsedFirstRowId}`);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./logs","line":14,"column":19,"nodeType":"CallExpression","endLine":14,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./runs","line":15,"column":19,"nodeType":"CallExpression","endLine":15,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystems","line":16,"column":25,"nodeType":"CallExpression","endLine":16,"endColumn":48},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tags","line":17,"column":19,"nodeType":"CallExpression","endLine":17,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flps","line":18,"column":19,"nodeType":"CallExpression","endLine":18,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./home","line":19,"column":19,"nodeType":"CallExpression","endLine":19,"endColumn":36},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./about","line":20,"column":20,"nodeType":"CallExpression","endLine":20,"endColumn":38}],"errorCount":7,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst LogsSuite = require('./logs');\nconst RunsSuite = require('./runs');\nconst SubsystemsSuite = require('./subsystems');\nconst TagsSuite = require('./tags');\nconst FlpsSuite = require('./flps');\nconst HomeSuite = require('./home');\nconst AboutSuite = require('./about');\n\nmodule.exports = () => {\n    describe('Logs', LogsSuite);\n    describe('Runs', RunsSuite);\n    describe('Subsystems', SubsystemsSuite);\n    describe('Tags', TagsSuite);\n    describe('Flps', FlpsSuite);\n    describe('Home', HomeSuite);\n    describe('About', AboutSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/logs/create.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":64,"nodeType":"CallExpression","endLine":15,"endColumn":86},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"path","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, goToPage, getFirstRow } = require('../defaults');\nconst path = require('path');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n        await page.setViewport({\n            width: 700,\n            height: 720,\n            deviceScaleFactor: 1,\n        });\n    });\n\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('correctly loads the log creation page', async () => {\n        await goToPage(page, 'log-create');\n\n        // We expect the log creation screen to be shown correctly\n        const header = await page.$('h2');\n        expect(Boolean(header)).to.be.true;\n        const headerText = await page.evaluate((element) => element.innerText, header);\n        expect(headerText).to.equal('Create Log');\n    });\n\n    it('can create a log', async () => {\n        const title = 'A very long title that should be collapsed in t...';\n        const text = 'Sample Text';\n\n        // Select the boxes and send the values of the title and text to it\n        await page.type('#title', title);\n        // eslint-disable-next-line no-undef\n        await page.evaluate((text) => model.logs.editor.setValue(text), text);\n\n        // Verify that the text from the first matches with the text posted and correct working of the redirect\n        // eslint-disable-next-line no-undef\n        const doesContentMatch = JSON.stringify(await page.evaluate(() => model.logs.editors['text'].getValue()))\n            .includes(text);\n        expect(doesContentMatch).to.equal(true);\n\n        // Create the new log\n        const buttonSend = await page.$('button#send');\n        await buttonSend.evaluate((button) => button.click());\n        await page.waitForTimeout(250);\n\n        // Return the page to home\n        await goToPage(page, 'log-overview');\n\n        // Ensure you are at the overview page again\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=log-overview`);\n\n        // Get the latest post and verify the title of the log we posted\n        const table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const firstRowTitle = await page.$(`#${firstRowId}-title-text`);\n        const titleText = await firstRowTitle.evaluate((element) => element.innerText);\n        expect(titleText).to.equal(title);\n        await page.waitForTimeout(500);\n    });\n\n    it('can collapse and expand logs with long titles', async () => {\n        /*\n         * Collapse and de-collapse the opened title and verify the rendered height\n         * Ideally, this test would be in the overview suite, unfortunately we cannot relay data between suites\n         * Here, we are certain we have a log with a long title, and therefore the test can succeed\n         */\n        /*\n         * Await goToPage(page, \"log-overview\");\n         * await page.waitForSelector(`#${firstRowId}-title-plus`);\n         * const expandButton = await page.$(`#${firstRowId}-title-plus`);\n         * expect(Boolean(expandButton)).to.be.true;\n         */\n\n        // Await expandButton.evaluate((button) => button.click());\n\n        /*\n         * Const expandedTitle = await page.$(`#${firstRowId}-title`);\n         * const expandedTitleHeight = await page.evaluate((element) => element.clientHeight, expandedTitle);\n         */\n\n        /*\n         * Const collapseButton = await page.$(`#${firstRowId}-title-minus`);\n         * expect(Boolean(collapseButton)).to.be.true;\n         * await collapseButton.evaluate((button) => button.click());\n         */\n\n        /*\n         * Const collapsedTitle = await page.$(`#${firstRowId}-title`);\n         * const collapsedTitleHeight = await page.evaluate((element) => element.clientHeight, collapsedTitle);\n         * expect(expandedTitleHeight).to.be.greaterThan(collapsedTitleHeight);\n         */\n    });\n\n    it('can create a log with linked tags', async () => {\n        const title = 'A short title';\n        const text = 'Sample Text';\n        const tags = ['FOOD', 'OTHER'];\n\n        // Return to the creation page\n        await goToPage(page, 'log-create');\n\n        // Select the boxes and send the values of the title and text to it\n        await page.type('#title', title);\n        // eslint-disable-next-line no-undef\n        await page.evaluate((text) => model.logs.editor.setValue(text), text);\n\n        // Find the selection options corresponding to the tag texts\n        const optionsToSelect = [];\n        const tagOptions = await page.$$('option');\n        for (const _option of tagOptions) {\n            const option = await _option;\n            const optionText = await page.evaluate((element) => element.innerText, option);\n            if (tags.includes(optionText)) {\n                const optionValue = await page.evaluate((element) => element.value, option);\n                optionsToSelect.push(optionValue);\n            }\n        }\n\n        // Select the collection of tags to be linked to the log\n        await page.select('select#tags', ...optionsToSelect);\n\n        // Expect to have selected two options\n        const tagSelection = await page.$('select#tags');\n        const tagSelectedOptions = await page.evaluate((element) => element.selectedOptions, tagSelection);\n        expect(Object.keys(tagSelectedOptions).length).to.equal(2);\n\n        // Create the new log\n        const buttonSend = await page.$('button#send');\n        await buttonSend.evaluate((button) => button.click());\n        await page.waitForTimeout(250);\n\n        // Return the page to home\n        await goToPage(page, 'log-overview');\n\n        // Get the latest post and verify that the selected tags correspond to the posted tags\n        const table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const firstRowTags = await page.$(`#${firstRowId}-tags-text`);\n        const tagsText = await page.evaluate((element) => element.innerText, firstRowTags);\n        expect(tagsText).to.equal(tags.join(', '));\n    });\n\n    it('can navigate to tag creation screen', async () => {\n        // Return to the creation page\n        await goToPage(page, 'log-create');\n\n        // Expect the user to be at the tag creation screen when the URL is clicked on\n        const tagCreationLink = await page.$('#tagCreateLink');\n        await page.evaluate((button) => button.click(), tagCreationLink);\n        await page.waitForTimeout(500);\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=tag-create`);\n    });\n\n    it('can create a log with file attachments', async () => {\n        const title = 'Shorter';\n        const text = 'Sample Text';\n        const file1 = '1200px-CERN_logo.png';\n        const file2 = 'hadron_collider.jpg';\n\n        // Return to the creation page\n        await goToPage(page, 'log-create');\n\n        // Select the boxes and send the values of the title and text to it\n        await page.type('#title', title);\n        // eslint-disable-next-line no-undef\n        await page.evaluate((text) => model.logs.editor.setValue(text), text);\n\n        // Add both the file attachments to the input field\n        const attachmentsInput = await page.$('#attachments');\n        const file1Path = path.resolve(__dirname, '../..', 'assets', file1);\n        const file2Path = path.resolve(__dirname, '../..', 'assets', file2);\n        attachmentsInput.uploadFile(file1Path, file2Path);\n        await page.waitForTimeout(500);\n\n        // Ensure that both file attachments were received\n        const attachmentNames = await page.$('#attachmentNames');\n        const attachmentNamesText = await page.evaluate((element) => element.innerText, attachmentNames);\n        expect(attachmentNamesText).to.equal(`${file1}, ${file2}`);\n\n        // Create the new log\n        const buttonSend = await page.$('button#send');\n        await buttonSend.evaluate((button) => button.click());\n        // Sizable delay to allow for file uploading\n        await page.waitForTimeout(2500);\n\n        // Return the page to home\n        await goToPage(page, 'log-overview');\n\n        // Get the latest post and verify the title of the log we posted\n        const table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const firstRowTitle = await page.$(`#${firstRowId}-title-text`);\n        const titleText = await page.evaluate((element) => element.innerText, firstRowTitle);\n        expect(titleText).to.equal(title);\n\n        // Verify that this log has two attachments, as was submitted\n        const firstRowAttachmentsCount = await page.$(`#${firstRowId}-attachments-text`);\n        const attachmentsCountText = await page.evaluate((element) => element.innerText, firstRowAttachmentsCount);\n        expect(attachmentsCountText).to.equal('2');\n\n        // Go to the log detail page\n        const row = await page.$(`tr#${firstRowId}`);\n        await row.evaluate((row) => row.click());\n        await page.waitForTimeout(500);\n        // Click on \"Show all\" button\n        const showAllButton = await page.$('#toggleCollapse');\n        await showAllButton.click();\n        await page.waitForTimeout(500);\n        // Verify that the attachment names match the ones we uploaded\n        const parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n        const attachmentsField = await page.$(`#post${parsedFirstRowId}-attachments`);\n        const attachmentsText = await page.evaluate((element) => element.innerText, attachmentsField);\n        expect(attachmentsText).to.equal(`Attachments:\\t\\n${file1}\\n, \\n${file2}`);\n    }).timeout(10000);\n\n    it('can clear the file attachment input if at least one is submitted', async () => {\n        // Return to the creation page\n        await goToPage(page, 'log-create');\n\n        // We expect the clear button to not be visible yet\n        let clearButton = await page.$('#clearAttachments');\n        expect(Boolean(clearButton)).to.be.false;\n\n        // Add a single file attachment to the input field\n        const attachmentsInput = await page.$('#attachments');\n        attachmentsInput.uploadFile(path.resolve(__dirname, '../..', 'assets', '1200px-CERN_logo.png'));\n        await page.waitForTimeout(500);\n\n        // We expect the clear button to appear\n        clearButton = await page.$('#clearAttachments');\n        expect(Boolean(clearButton)).to.be.true;\n\n        // We expect that clicking the clear button resets the attachment input\n        const uploadedAttachments = await page.evaluate((element) => element.value, attachmentsInput);\n        expect(uploadedAttachments.endsWith('1200px-CERN_logo.png')).to.be.true;\n\n        await clearButton.evaluate((clearButton) => clearButton.click());\n        await page.waitForTimeout(100);\n        const newUploadedAttachments = await page.evaluate((element) => element.value, attachmentsInput);\n        expect(newUploadedAttachments).to.equal('');\n    });\n\n    it('can create a log with a run number', async () => {\n        const title = 'Single run number test';\n        const text = 'Sample Text';\n        const runNumbersStr = '1';\n\n        // Return to the creation page\n        await goToPage(page, 'log-create');\n\n        // Select the boxes and send the values of the title and text to it\n        await page.type('#title', title);\n        // eslint-disable-next-line no-undef\n        await page.evaluate((text) => model.logs.editor.setValue(text), text);\n\n        // Send the value of the run numbers string to the input\n        await page.type('#run-number', runNumbersStr);\n\n        // Create the new log\n        const buttonSend = await page.$('button#send');\n        await buttonSend.evaluate((button) => button.click());\n        await goToPage(page, 'log-overview');\n        await page.waitForFunction('document.querySelector(\"body\").innerText.includes(\"Single run number test\")');\n\n        // Find the created log\n        const table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const firstRowTitle = await page.$(`#${firstRowId}-title-text`);\n        const titleText = await page.evaluate((element) => element.innerText, firstRowTitle);\n        expect(titleText).to.equal(title);\n\n        // Go to the log detail page\n        const rowId = parseInt(firstRowId.replace(/\\D/g, ''), 10);\n        await goToPage(page, `log-detail&id=${rowId}`);\n        // Click on \"Show all\" button\n        const showAllButton = await page.$('#toggleCollapse');\n        await showAllButton.click();\n        await page.waitForTimeout(1000);\n        const runsField = await page.$(`#post${rowId}-runs`);\n        const runsText = await page.evaluate((element) => element.innerText, runsField);\n        expect(runsText).to.equal(`Runs:\\t\\n${runNumbersStr}`);\n    }).timeout(10000);\n\n    it('can create a log with multiple run numbers', async () => {\n        const title = 'Multiple run numbers test';\n        const text = 'Sample Text';\n        const runNumbers = [1, 2];\n        const runNumbersStr = runNumbers.join(',');\n\n        // Return to the creation page\n        await goToPage(page, 'log-create');\n\n        // Select the boxes and send the values of the title and text to it\n        await page.type('#title', title);\n        // eslint-disable-next-line no-undef\n        await page.evaluate((text) => model.logs.editor.setValue(text), text);\n\n        // Send the value of the run numbers string to the input\n        await page.type('#run-number', runNumbersStr);\n\n        // Create the new log\n        const buttonSend = await page.$('button#send');\n        await buttonSend.evaluate((button) => button.click());\n        await page.goto(`${url}/?page=log-overview`, { waitUntil: 'load' });\n        await page.waitForFunction('document.querySelector(\"body\").innerText.includes(\"Multiple run numbers test\")');\n\n        // Find the created log\n        const table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const firstRowTitle = await page.$(`#${firstRowId}-title-text`);\n        const titleText = await page.evaluate((element) => element.innerText, firstRowTitle);\n        expect(titleText).to.equal(title);\n\n        // Go to the log detail page\n        const rowId = parseInt(firstRowId.replace(/\\D/g, ''), 10);\n        await page.goto(`${url}/?page=log-detail&id=${rowId}`, { waitUntil: 'networkidle0' });\n        // Click on \"Show all\" button\n        const showAllButton = await page.$('#toggleCollapse');\n        await showAllButton.click();\n        await page.waitForTimeout(1000);\n        const runsField = await page.$(`#post${rowId}-runs`);\n        const runsText = await page.evaluate((element) => element.innerText, runsField);\n        for (const runNumber of runNumbers) {\n            expect(runsText).to.include(runNumber);\n        }\n    }).timeout(10000);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/logs/detail.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":72,"nodeType":"CallExpression","endLine":15,"endColumn":94}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('log detail loads correctly', async () => {\n        await page.goto(`${url}/?page=log-detail&id=1`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be at least one post in this log entry\n        const postExists = await page.$('#post1');\n        expect(Boolean(postExists)).to.be.true;\n    });\n\n    it('notifies if a specified log id is invalid', async () => {\n        // Navigate to a log detail view with an id that cannot exist\n        await page.goto(`${url}/?page=log-detail&id=99999999`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        const expectedMessage = 'Log with this id (99999999) could not be found';\n        await expectInnerText(page, '.alert-danger', expectedMessage);\n    });\n\n    it('allows navigating to an associated run', async () => {\n        const logId = 1;\n        const runId = 1;\n\n        // Navigate to a log detail view\n        await page.goto(`${url}/?page=log-detail&id=${logId}`, { waitUntil: 'networkidle0' });\n        const showAllButton = await page.$('#toggleCollapse');\n        await showAllButton.click();\n        await page.waitForTimeout(1000);\n        // We expect the correct associated runs to be shown\n        const runField = await page.$(`#post${logId}-runs`);\n        const runText = await page.evaluate((element) => element.innerText, runField);\n        expect(runText).to.equal(`Runs:\\t\\n${runId}`);\n\n        // We expect the associated runs to be clickable with a valid link\n        const runLink = await page.$(`#post${logId}-runs a`);\n        await runLink.click();\n        await page.waitForTimeout(1000);\n\n        // We expect the link to navigate to the correct run detail page\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=run-detail&id=${runId}&panel=main`);\n    });\n\n    it('should have a button to reply on a entry', async () => {\n        const parentLogId = 2;\n        await page.goto(`${url}/?page=log-detail&id=${parentLogId}`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be at least one post in this log entry\n        await pressElement(page, `#reply-to-${parentLogId}`);\n        await page.waitForTimeout(1000);\n\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=log-create&parentLogId=${parentLogId}`);\n\n        const title = 'Test the reply button';\n        const text = 'Test the reply button';\n\n        await page.type('#title', title);\n        // eslint-disable-next-line no-undef\n        await page.evaluate((text) => model.logs.editor.setValue(text), text);\n        await page.waitForTimeout(250);\n\n        // Create the new log\n        const button = await page.$('button#send');\n        await button.evaluate((button) => button.click());\n        await page.waitForTimeout(1000);\n\n        // Expect to be redirected to the new log\n        const postSendUrl = await page.url();\n        expect(postSendUrl.startsWith(`${url}/?page=log-detail`)).to.be.true;\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/logs/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./create.test","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./detail.test","line":16,"column":21,"nodeType":"CallExpression","endLine":16,"endColumn":45}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\nconst CreateSuite = require('./create.test');\nconst DetailSuite = require('./detail.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n    describe('Create Page', CreateSuite);\n    describe('Detail Page', DetailSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/logs/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":16,"column":5,"nodeType":"CallExpression","endLine":16,"endColumn":27}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, goToPage, getFirstRow, getAllDataFields,\n} = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let originalNumberOfRows;\n    let table;\n    let firstRowId;\n    let parsedFirstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n        await page.setViewport({\n            width: 700,\n            height: 720,\n            deviceScaleFactor: 1,\n        });\n    });\n\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=log-overview`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('can filter by log title', async () => {\n        // Expect the page to have loaded enough rows to be able to test the filtering\n        const originalRows = await page.$$('table tr');\n        originalNumberOfRows = originalRows.length - 1;\n        await page.waitForTimeout(200);\n        expect(originalNumberOfRows).to.be.greaterThan(1);\n\n        // Open the filters\n        await pressElement(page, '#openFilterToggle');\n        await page.waitForTimeout(200);\n\n        // Insert some text into the filter\n        await page.type('#titleFilterText', 'first');\n        await page.waitForTimeout(500);\n\n        // Expect the (new) total number of rows to be less than the original number of rows\n        const firstFilteredRows = await page.$$('table tr');\n        const firstFilteredNumberOfRows = firstFilteredRows.length - 1;\n        expect(firstFilteredNumberOfRows).to.be.lessThan(originalNumberOfRows);\n\n        // Insert some other text into the filter\n        await page.type('#titleFilterText', ' bogusbogusbogus');\n        await page.waitForTimeout(500);\n\n        // Expect the table to be empty\n        const secondFilteredRows = await page.$$('table tr');\n        const secondFilteredNumberOfRows = secondFilteredRows.length - 1;\n        expect(secondFilteredNumberOfRows).to.equal(0);\n\n        // Clear the filters\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.resetLogsParams();\n        });\n        await page.waitForTimeout(100);\n\n        // Expect the total number of rows to once more equal the original total\n        const unfilteredRows = await page.$$('table tr');\n        const unfilteredNumberOfRows = unfilteredRows.length - 1;\n        expect(unfilteredNumberOfRows).to.equal(originalNumberOfRows);\n    });\n\n    it('can filter by log author', async () => {\n        // Expect the page to have loaded enough rows to be able to test the filtering\n        const originalRows = await page.$$('table tr');\n        originalNumberOfRows = originalRows.length - 1;\n        await page.waitForTimeout(200);\n        expect(originalNumberOfRows).to.be.greaterThan(1);\n\n        // Insert some text into the filter\n        await page.type('#authorFilterText', 'John');\n        await page.waitForTimeout(500);\n\n        // Expect the (new) total number of rows to be less than the original number of rows\n        const firstFilteredRows = await page.$$('table tr');\n        const firstFilteredNumberOfRows = firstFilteredRows.length - 1;\n        expect(firstFilteredNumberOfRows).to.be.lessThan(originalNumberOfRows);\n\n        // Insert some other text into the filter\n        await page.type('#authorFilterText', ' DoesNotExist');\n        await page.waitForTimeout(500);\n\n        // Expect the table to be empty\n        const secondFilteredRows = await page.$$('table tr');\n        const secondFilteredNumberOfRows = secondFilteredRows.length - 1;\n        expect(secondFilteredNumberOfRows).to.equal(0);\n\n        // Clear the filters\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.resetLogsParams();\n        });\n        await page.waitForTimeout(100);\n\n        // Expect the total number of rows to once more equal the original total\n        const unfilteredRows = await page.$$('table tr');\n        const unfilteredNumberOfRows = unfilteredRows.length - 1;\n        expect(unfilteredNumberOfRows).to.equal(originalNumberOfRows);\n    });\n\n    it('can filter by creation date', async () => {\n        await page.waitForTimeout(200);\n\n        // Insert a minimum date into the filter\n        await page.focus('#createdFilterFrom');\n        await page.waitForTimeout(100);\n        await page.type('#createdFilterFrom', '01012020');\n        await page.waitForTimeout(100);\n\n        // Expect the (new) total number of rows to be less than the original number of rows\n        const firstFilteredRows = await page.$$('table tr');\n        const firstFilteredNumberOfRows = firstFilteredRows.length - 1;\n        expect(firstFilteredNumberOfRows).to.be.lessThan(originalNumberOfRows);\n\n        // Insert a maximum date into the filter\n        await page.focus('#createdFilterTo');\n        await page.waitForTimeout(100);\n        await page.type('#createdFilterTo', '01022020');\n        await page.waitForTimeout(100);\n\n        // Expect the table to be empty\n        const secondFilteredRows = await page.$$('table tr');\n        const secondFilteredNumberOfRows = secondFilteredRows.length - 1;\n        expect(secondFilteredNumberOfRows).to.equal(0);\n\n        // Insert a maximum date into the filter that is invalid\n        await page.focus('#createdFilterTo');\n        await page.waitForTimeout(100);\n        await page.type('#createdFilterTo', '01012000');\n        await page.waitForTimeout(100);\n\n        // Do not expect anything to change, as this maximum is below the minimum, therefore the API is not called\n        const thirdFilteredRows = await page.$$('table tr');\n        const thirdFilteredNumberOfRows = thirdFilteredRows.length - 1;\n        expect(thirdFilteredNumberOfRows).to.equal(secondFilteredNumberOfRows);\n\n        // Clear the filters\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.resetLogsParams();\n        });\n        await page.waitForTimeout(100);\n    });\n\n    it('can filter by tags', async () => {\n        await page.waitForTimeout(200);\n\n        // Select the first available filter and wait for the changes to be processed\n        const firstCheckboxId = 'tagCheckbox1';\n        await pressElement(page, `#${firstCheckboxId}`);\n        await page.waitForTimeout(100);\n\n        // Expect the (new) total number of rows to be less than the original number of rows\n        const firstFilteredRows = await page.$$('table tr');\n        const firstFilteredNumberOfRows = firstFilteredRows.length - 1;\n        expect(firstFilteredNumberOfRows).to.be.lessThan(originalNumberOfRows);\n\n        // Deselect the filter and wait for the changes to process\n        await pressElement(page, `#${firstCheckboxId}`);\n        await page.waitForTimeout(100);\n\n        // Expect the total number of rows to equal the original total\n        const firstUnfilteredRows = await page.$$('table tr');\n        expect(firstUnfilteredRows.length - 1).to.equal(originalNumberOfRows);\n\n        // Select the first two available filters at once\n        const secondCheckboxId = 'tagCheckbox2';\n        await pressElement(page, `#${firstCheckboxId}`);\n        await page.waitForTimeout(100);\n        await pressElement(page, `#${secondCheckboxId}`);\n        await page.waitForTimeout(100);\n\n        // Expect the table to be empty\n        const secondFilteredRows = await page.$$('table tr');\n        const secondFilteredNumberOfRows = secondFilteredRows.length - 1;\n        expect(secondFilteredNumberOfRows).to.equal(0);\n\n        // Set the filter operation to \"OR\"\n        await pressElement(page, '#tagFilterOperationRadioButtonOR');\n        await page.waitForTimeout(100);\n\n        // Expect there now to be more rows than both the previous table and the table with only one filter\n        const thirdFilteredRows = await page.$$('table tr');\n        const thirdFilteredNumberOfRows = thirdFilteredRows.length - 1;\n        expect(thirdFilteredNumberOfRows).to.be.greaterThan(firstFilteredNumberOfRows);\n        expect(thirdFilteredNumberOfRows).to.be.greaterThan(secondFilteredNumberOfRows);\n\n        // Clear the filters\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.resetLogsParams();\n        });\n    });\n\n    it('can show and hide extra tags if available', async () => {\n        const TAGS_LIMIT = 5;\n        const buttonId = '#toggleMoreTags';\n\n        await page.waitForTimeout(200);\n\n        // Expect the page to have a button allowing for showing more tags\n        const toggleFiltersButton = await page.$(buttonId);\n        let buttonText = await page.evaluate((element) => element.innerText, toggleFiltersButton);\n        expect(buttonText.trim()).to.equal('More tags');\n\n        // Expect the button to show at least one extra tag when clicked\n        await pressElement(page, buttonId);\n        await page.waitForTimeout(100);\n        let extraTagFilter = await page.$(`#tagCheckbox${TAGS_LIMIT + 1}`);\n        expect(Boolean(extraTagFilter)).to.be.true;\n\n        // Expect the text to change to reflect the newly shown tags\n        buttonText = await page.evaluate((element) => element.innerText, toggleFiltersButton);\n        expect(buttonText.trim()).to.equal('Less tags');\n\n        // Expect the button to remove the extra tag when clicked again\n        await pressElement(page, buttonId);\n        await page.waitForTimeout(100);\n        extraTagFilter = await page.$(`#tagCheckbox${TAGS_LIMIT + 1}`);\n        expect(Boolean(extraTagFilter)).to.be.false;\n    });\n\n    it('can sort by columns in ascending and descending manners', async () => {\n        // Expect a sorting preview to appear when hovering over a column header\n        await page.hover('th#title');\n        await page.waitForTimeout(100);\n        const sortingPreviewIndicator = await page.$('#title-sort-preview');\n        expect(Boolean(sortingPreviewIndicator)).to.be.true;\n\n        await page.waitForTimeout(200);\n        // Sort by log title in an ascending manner\n        const titleHeader = await page.$('th#title');\n        await page.waitForTimeout(200);\n        await titleHeader.evaluate((button) => button.click());\n        await page.waitForTimeout(200);\n\n        // Expect the log titles to be in alphabetical order\n        const firstTitles = await getAllDataFields(page, 'title');\n        expect(firstTitles).to.deep.equal(firstTitles.sort());\n        await page.waitForTimeout(100);\n        const sortingIndicator = await page.$('#title-sort');\n        expect(Boolean(sortingIndicator)).to.be.true;\n\n        // Toggle to sort this towards reverse alphabetical order\n        await titleHeader.evaluate((button) => button.click());\n        await page.waitForTimeout(200);\n\n        // Expect the log titles to be in reverse alphabetical order\n        const secondTitles = await getAllDataFields(page, 'title');\n        expect(secondTitles).to.deep.equal(secondTitles.sort((a, b) => b.localeCompare(a)));\n\n        // Toggle to clear this sorting\n        await titleHeader.evaluate((button) => button.click());\n        await page.waitForTimeout(200);\n\n        // Expect the log titles to no longer be sorted in any way\n        const thirdTitles = await getAllDataFields(page, 'title');\n        expect(thirdTitles).to.not.deep.equal(firstTitles);\n        expect(thirdTitles).to.not.deep.equal(secondTitles);\n\n        // Sort by log author in ascending manner\n        const authorHeader = await page.$('th#author');\n        await authorHeader.evaluate((button) => button.click());\n        await page.waitForTimeout(200);\n\n        // Expect the authors to be in alphabetical order\n        const firstAuthors = await getAllDataFields(page, 'author');\n        expect(firstAuthors).to.deep.equal(firstAuthors.sort());\n\n        // Sort by creation date in ascending manner\n        const createdAtHeader = await page.$('th#createdAt');\n        await createdAtHeader.evaluate((button) => button.click());\n        await page.waitForTimeout(200);\n\n        // Expect the log author column to be unsorted\n        const secondAuthors = await getAllDataFields(page, 'author');\n        expect(secondAuthors).to.not.deep.equal(firstAuthors);\n    });\n\n    it('shows correct datatypes in respective columns', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // Expectations of header texts being of a certain datatype\n        const headerDatatypes = {\n            title: (title) => typeof title === 'string',\n            author: (authorName) => typeof authorName === 'string',\n            createdAt: (date) => !isNaN(Date.parse(date)),\n            tags: (tags) => typeof tags === 'string' && tags === tags.toUpperCase(),\n            replies: (replyCount) => typeof replyCount === 'number' || replyCount === '',\n        };\n\n        // We find the headers matching the datatype keys\n        const headers = await page.$$('th');\n        const headerIndices = {};\n        for (const [index, header] of headers.entries()) {\n            const headerContent = await page.evaluate((element) => element.id, header);\n            const matchingDatatype = Object.keys(headerDatatypes).find((key) => headerContent === key);\n            if (matchingDatatype !== undefined) {\n                headerIndices[index] = matchingDatatype;\n            }\n        }\n\n        // We expect every value of a header matching a datatype key to actually be of that datatype\n        const firstRowCells = await page.$$(`#${firstRowId} td`);\n        for (const [index, cell] of firstRowCells.entries()) {\n            if (Object.keys(headerIndices).includes(index)) {\n                const cellContent = await page.evaluate((element) => element.innerText, cell);\n                const expectedDatatype = headerDatatypes[headerIndices[index]](cellContent);\n                expect(expectedDatatype).to.be.true;\n            }\n        }\n    });\n\n    it('can switch to infinite mode in amountSelector', async () => {\n        const amountSelectorButton = await page.$('#amountSelector button');\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$('#amountSelector .dropup-menu');\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        const menuItems = await page.$$('#amountSelector .dropup-menu .menu-item');\n        await menuItems[menuItems.length - 1].evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        const amountSelectorButtonText = await page.evaluate((element) => element.innerText, amountSelectorButton);\n        expect(amountSelectorButtonText.endsWith('Infinite ')).to.be.true;\n\n        await page.evaluate(() => {\n            window.scrollBy(0, window.innerHeight);\n        });\n        await page.waitForTimeout(400);\n        const tableRows = await page.$$('table tr');\n\n        expect(tableRows.length > 20).to.be.true;\n    });\n\n    it('can set how many logs are available per page', async () => {\n        await page.waitForTimeout(500);\n        // Expect the amount selector to currently be set to Infinite (after the previous test)\n        const amountSelectorId = '#amountSelector';\n        await page.waitForTimeout(500);\n        const amountSelectorButton = await page.$(`${amountSelectorId} button`);\n        const amountSelectorButtonText = await page.evaluate((element) => element.innerText, amountSelectorButton);\n        expect(amountSelectorButtonText.endsWith('Infinite ')).to.be.true;\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$(`${amountSelectorId} .dropup-menu`);\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        // Expect the amount of visible logs to reduce when the first option (5) is selected\n        const menuItem = await page.$(`${amountSelectorId} .dropup-menu .menu-item`);\n        await menuItem.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        const tableRows = await page.$$('table tr');\n        expect(tableRows.length - 1).to.equal(5);\n    });\n\n    it('can switch between pages of logs', async () => {\n        // Expect the page selector to be available with two pages\n        await page.waitForTimeout(300);\n        const pageSelectorId = '#amountSelector';\n        const pageSelector = await page.$(pageSelectorId);\n        await page.waitForTimeout(300);\n        expect(Boolean(pageSelector)).to.be.true;\n        await page.waitForTimeout(300);\n        const pageSelectorButtons = await page.$$('#pageSelector .btn-tab');\n        expect(pageSelectorButtons.length).to.equal(5);\n\n        // Expect the table rows to change upon page navigation\n        const oldFirstRowId = await getFirstRow(table, page);\n        const secondPage = await page.$('#page2');\n        await secondPage.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        table = await page.$$('tr');\n        const newFirstRowId = await getFirstRow(table, page);\n        expect(oldFirstRowId).to.not.equal(newFirstRowId);\n\n        // Expect us to be able to do the same with the page arrows\n        const prevPage = await page.$('#pageMoveLeft');\n        await prevPage.evaluate((button) => button.click());\n        await page.waitForTimeout(300);\n        const oldFirstPageButton = await page.$('#page1');\n        const oldFirstPageButtonClass = await page.evaluate((element) => element.className, oldFirstPageButton);\n        expect(oldFirstPageButtonClass).to.include('selected');\n\n        // The same, but for the other (right) arrow\n        const nextPage = await page.$('#pageMoveRight');\n        await nextPage.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const newFirstPageButton = await page.$('#page1');\n        const newFirstPageButtonClass = await page.evaluate((element) => element.className, newFirstPageButton);\n        expect(newFirstPageButtonClass).to.not.include('selected');\n    });\n\n    it('dynamically switches between visible pages in the page selector', async () => {\n        // Override the amount of logs visible per page manually\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.setLogsPerPage(1);\n        });\n        await page.waitForTimeout(100);\n\n        // Expect the page five button to now be visible, but no more than that\n        const pageFiveButton = await page.$('#page5');\n        expect(Boolean(pageFiveButton)).to.be.true;\n        const pageSixButton = await page.$('#page6');\n        expect(Boolean(pageSixButton)).to.be.false;\n\n        // Expect the page one button to have fallen away when clicking on page five button\n        await page.waitForTimeout(500);\n        await page.waitForSelector('#page5');\n        await pressElement(page, '#page5');\n        await page.waitForTimeout(500);\n        const pageOneButton = await page.$('#page1');\n        expect(Boolean(pageOneButton)).to.be.false;\n\n        // Revert changes for next test\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.setLogsPerPage(10);\n        });\n    });\n\n    it('can navigate to the log creation page', async () => {\n        // Click on the button to start creating a new log\n        await goToPage(page, 'log-create');\n\n        // Expect the page to be the log creation page at this point\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=log-create`);\n    });\n\n    it('notifies if table loading returned an error', async () => {\n        // Go back to the home page\n        await goToPage(page, 'log-overview');\n\n        /*\n         * As an example, override the amount of logs visible per page manually\n         * We know the limit is 100 as specified by the Dto\n         */\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.setLogsPerPage(200);\n        });\n        await page.waitForTimeout(100);\n\n        // We expect there to be a fitting error message\n        const expectedMessage = 'Invalid Attribute: \"query.page.limit\" must be less than or equal to 100';\n        await expectInnerText(page, '.alert-danger', expectedMessage);\n\n        // Revert changes for next test\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.setLogsPerPage(10);\n        });\n        await page.waitForTimeout(100);\n    });\n\n    it('can navigate to a log detail page', async () => {\n        // Go back to the home page\n        await goToPage(page, 'log-overview');\n\n        const firstRow = await page.$('tr.clickable');\n        const firstRowId = await firstRow.evaluate((row) => row.id);\n        parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n\n        // We expect the entry page to have the same id as the id from the log overview\n        await firstRow.evaluate((row) => row.click());\n        await page.waitForTimeout(500);\n\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=log-detail&id=${parsedFirstRowId}`);\n    });\n\n    it('does not reset pagination filters when navigating away', async () => {\n        // Go back to the home page\n        await goToPage(page, 'log-overview');\n\n        // Override the amount of logs visible per page manually\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.logs.setLogsPerPage(1);\n        });\n        await page.waitForTimeout(100);\n\n        // Go to the second page of \"logs\"\n        const secondPageButton = await page.$('#page2');\n        await secondPageButton.evaluate((button) => button.click());\n        await page.waitForTimeout(500);\n\n        // Navigate to a log detail page\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const row = await page.$(`tr#${firstRowId}`);\n        await row.evaluate((row) => row.click());\n        await page.waitForTimeout(500);\n\n        // Go back to the home page again\n        await page.goBack();\n        await page.waitForTimeout(100);\n\n        // Expect the pagination to still be on page two\n        const firstPageButton = await page.$('#page1');\n        const firstPageButtonClass = await page.evaluate((element) => element.className, firstPageButton);\n        const secondPageButtonClass = await page.evaluate((element) => element.className, secondPageButton);\n        expect(firstPageButtonClass).to.not.include('selected');\n        expect(secondPageButtonClass).to.include('selected');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/runs/detail.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":85,"nodeType":"CallExpression","endLine":15,"endColumn":107}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('run detail loads correctly', async () => {\n        await page.goto(`${url}/?page=run-detail&id=1`, { waitUntil: 'networkidle0' });\n        await expectInnerText(page, 'h2', 'Run #1');\n    });\n\n    it('can change run tags', async () => {\n        await pressElement(page, '#tags-control option[value=\"1\"]');\n        await page.waitForTimeout(100);\n        await pressElement(page, '.btn-success');\n        await page.waitForTimeout(100);\n        expect(await page.$eval('#tags-control option[value=\"1\"]', (elem)=>elem.selected)).to.be.true;\n    });\n\n    it('can navigate to the log panel', async () => {\n        await pressElement(page, '#logs-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=run-detail&id=1&panel=logs`)).to.be.true;\n    });\n\n    it('can navigate to the main panel', async () => {\n        await pressElement(page, '#main-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=run-detail&id=1&panel=main`)).to.be.true;\n    });\n\n    it('can navigate to the log panel', async () => {\n        await pressElement(page, '#logs-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=run-detail&id=1&panel=logs`)).to.be.true;\n    });\n\n    it('can navigate to a log detail page', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // We expect the entry page to have the same id as the id from the run overview\n        await pressElement(page, `#${firstRowId}`);\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=log-detail&id=1`)).to.be.true;\n    });\n\n    it('notifies if a specified run id is invalid', async () => {\n        // Navigate to a run detail view with an id that cannot exist\n        await page.goto(`${url}/?page=run-detail&id=abc`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        await expectInnerText(page, '.alert', 'Invalid Attribute: \"params.runId\" must be a number');\n    });\n\n    it('notifies if a specified run id is not found', async () => {\n        // Navigate to a run detail view with an id that cannot exist\n        await page.goto(`${url}/?page=run-detail&id=999`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        await expectInnerText(page, '.alert', 'Run with this id (999) could not be found');\n    });\n\n    it('can return to the overview page if an error occurred', async () => {\n        // We expect there to be a button to return to the overview page\n        await expectInnerText(page, '.btn-primary', 'Return to Overview');\n\n        // We expect the button to return the user to the overview page when pressed\n        await pressElement(page, '.btn-primary');\n        await page.waitForTimeout(100);\n        expect(page.url()).to.equal(`${url}/?page=run-overview`);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/runs/export.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":41,"nodeType":"CallExpression","endLine":15,"endColumn":63}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('run export loads correctly', async () => {\n        await page.goto(`${url}/?page=run-export`, { waitUntil: 'networkidle0' });\n\n        // We expect the log creation screen to be shown correctly\n        const header = await page.$('h2');\n        expect(Boolean(header)).to.be.true;\n        const headerText = await page.evaluate((element) => element.innerText, header);\n        expect(headerText).to.equal('Export Runs');\n    });\n\n    it('can create a export with a run number and fields', async () => {\n        const runNumbersStr = '1';\n        const runsFields = ['id', 'runNumber'];\n\n        // Send the value of the run numbers string to the input\n        await page.type('#run-number', runNumbersStr);\n\n        const optionsToSelect = [];\n        const runsFieldsOptions = await page.$$('runs-fields-option');\n        for (const _option of runsFieldsOptions) {\n            const option = await _option;\n            const optionText = await page.evaluate((element) => element.innerText, option);\n            if (runsFields.includes(optionText)) {\n                const optionValue = await page.evaluate((element) => element.value, option);\n                optionsToSelect.push(optionValue);\n            }\n        }\n\n        // Select the collection of runs fields\n        await page.select('select#fields', ...optionsToSelect);\n\n        /*\n         *\n         * Expect to have selected two options\n         */\n\n        /*\n         * Const runsFieldsSelection = await page.$('select#fields');\n         * const runsFieldsSelectedOptions =\n         *     await page.evaluate((element) => element.selectedOptions, runsFieldsSelection);\n         * expect(Object.keys(runsFieldsSelectedOptions).length).to.equal(14);\n         */\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/runs/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./detail.test","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./export.test","line":16,"column":21,"nodeType":"CallExpression","endLine":16,"endColumn":45}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\nconst DetailSuite = require('./detail.test');\nconst CreateSuite = require('./export.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n    describe('Detail Page', DetailSuite);\n    describe('Export page', CreateSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/runs/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":85,"nodeType":"CallExpression","endLine":15,"endColumn":107}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n        await page.setViewport({\n            width: 700,\n            height: 720,\n            deviceScaleFactor: 1,\n        });\n    });\n\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=run-overview`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('shows correct datatypes in respective columns', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // Expectations of header texts being of a certain datatype\n        const headerDatatypes = {\n            runNumber: (number) => typeof number == 'number',\n            timeO2Start: (date) => !isNaN(Date.parse(date)),\n            timeO2End: (date) => !isNaN(Date.parse(date)),\n            timeTrgStart: (date) => !isNaN(Date.parse(date)),\n            timeTrgEnd: (date) => !isNaN(Date.parse(date)),\n            activityId: (number) => typeof number == 'number',\n            runType: (string) => typeof string == 'string',\n            runQuality: (string) => typeof string == 'string',\n            nDetectors: (number) => typeof number == 'number',\n            nFlps: (number) => typeof number == 'number',\n            nEpns: (number) => typeof number == 'number',\n            nSubtimeframes: (number) => typeof number == 'number',\n            bytesReadOut: (number) => typeof number == 'number',\n        };\n\n        // We find the headers matching the datatype keys\n        const headers = await page.$$('th');\n        const headerIndices = {};\n        for (const [index, header] of headers.entries()) {\n            const headerContent = await page.evaluate((element) => element.id, header);\n            const matchingDatatype = Object.keys(headerDatatypes).find((key) => headerContent === key);\n            if (matchingDatatype !== undefined) {\n                headerIndices[index] = matchingDatatype;\n            }\n        }\n\n        // We expect every value of a header matching a datatype key to actually be of that datatype\n        const firstRowCells = await page.$$(`#${firstRowId} td`);\n        for (const [index, cell] of firstRowCells.entries()) {\n            if (Object.keys(headerIndices).includes(index)) {\n                const cellContent = await page.evaluate((element) => element.innerText, cell);\n                const expectedDatatype = headerDatatypes[headerIndices[index]](cellContent);\n                expect(expectedDatatype).to.be.true;\n            }\n        }\n    });\n\n    it('can switch to infinite mode in amountSelector', async () => {\n        const amountSelectorButton = await page.$('#amountSelector button');\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$('#amountSelector .dropup-menu');\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        const menuItems = await page.$$('#amountSelector .dropup-menu .menu-item');\n        await menuItems[menuItems.length - 1].evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        await page.evaluate(() => {\n            window.scrollBy(0, window.innerHeight);\n        });\n        await page.waitForTimeout(400);\n        const tableRows = await page.$$('table tr');\n        expect(tableRows.length > 20).to.be.true;\n    });\n\n    it('can set how many runs are available per page', async () => {\n        await page.waitForTimeout(300);\n        // Expect the amount selector to currently be set to Infinite (after the previous test)\n        const amountSelectorId = '#amountSelector';\n        const amountSelectorButton = await page.$(`${amountSelectorId} button`);\n        const amountSelectorButtonText = await page.evaluate((element) => element.innerText, amountSelectorButton);\n        await page.waitForTimeout(300);\n        expect(amountSelectorButtonText.endsWith('Infinite ')).to.be.true;\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$(`${amountSelectorId} .dropup-menu`);\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        // Expect the amount of visible runs to reduce when the first option (5) is selected\n        const menuItem = await page.$(`${amountSelectorId} .dropup-menu .menu-item`);\n        await menuItem.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        const tableRows = await page.$$('table tr');\n        expect(tableRows.length - 1).to.equal(5);\n\n        // Expect the custom per page input to have red border and text color if wrong value typed\n        const customPerPageInput = await page.$(`${amountSelectorId} input[type=number]`);\n        await customPerPageInput.evaluate((input) => input.focus());\n        await page.$eval(`${amountSelectorId} input[type=number]`, (el) => {\n            el.value = '111';\n            el.dispatchEvent(new Event('input'));\n        });\n        await page.waitForTimeout(100);\n        expect(Boolean(await page.$(`${amountSelectorId} .danger`))).to.be.true;\n    });\n\n    /*\n     * Todo: implement without waitForTimeout (tip: use screenshot function to see where it's going wrong).\n     * it('can switch between pages of runs', async () => {\n     *     await page.waitForTimeout(300);\n     *     // Expect the page selector to be available with two pages\n     *     const pageSelectorId = '#amountSelector';\n     *     const pageSelector = await page.$(pageSelectorId);\n     *     await page.waitForTimeout(300);\n     *     expect(Boolean(pageSelector)).to.be.true;\n     *     await page.waitForTimeout(300);\n     *     const pageSelectorButtons = await page.$$('#pageSelector .btn-tab');\n     *     expect(pageSelectorButtons.length).to.equal(5);\n     */\n\n    /*\n     *     Const oldFirstRowId = await getFirstRow(table, page);\n     *     // Works correctly if this line is uncommented\n     *     // takeScreenshot(page);\n     *     pressElement(page, '#page2');\n     *     await page.waitForFunction('document.querySelector(\"#page2\").classList.contains(\"selected\")');\n     *     table = await page.$$('tr');\n     *     const newFirstRowId = await getFirstRow(table, page);\n     *     expect(oldFirstRowId).to.not.equal(newFirstRowId);\n     */\n\n    /*\n     *     // Expect us to be able to do the same with the page arrows\n     *     const prevPage = await page.$('#pageMoveLeft');\n     *     await prevPage.evaluate((button) => button.click());\n     *     await page.waitForTimeout(100);\n     *     const oldFirstPageButton = await page.$('#page1');\n     *     const oldFirstPageButtonClass = await page.evaluate((element) => element.className, oldFirstPageButton);\n     *     expect(oldFirstPageButtonClass).to.include('selected');\n     *     console.log(\"here5\");\n     */\n\n    /*\n     *     // The same, but for the other (right) arrow\n     *     const nextPage = await page.$('#pageMoveRight');\n     *     await nextPage.evaluate((button) => button.click());\n     *     await page.waitForTimeout(100);\n     *     const newFirstPageButton = await page.$('#page1');\n     *     const newFirstPageButtonClass = await page.evaluate((element) => element.className, newFirstPageButton);\n     *     expect(newFirstPageButtonClass).to.not.include('selected');\n     * }).timeout(15000);\n     */\n\n    it('dynamically switches between visible pages in the page selector', async () => {\n        // Override the amount of runs visible per page manually\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.runs.setRunsPerPage(1);\n        });\n        await page.waitForTimeout(100);\n\n        // Expect the page five button to now be visible, but no more than that\n        const pageFiveButton = await page.$('#page5');\n        expect(Boolean(pageFiveButton)).to.be.true;\n        const pageSixButton = await page.$('#page6');\n        expect(Boolean(pageSixButton)).to.be.false;\n\n        // Expect the page one button to have fallen away when clicking on page five button\n        await pressElement(page, '#page5');\n        await page.waitForTimeout(100);\n        const pageOneButton = await page.$('#page1');\n        expect(Boolean(pageOneButton)).to.be.false;\n    });\n\n    it('notifies if table loading returned an error', async () => {\n        /*\n         * As an example, override the amount of runs visible per page manually\n         * We know the limit is 100 as specified by the Dto\n         */\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.runs.setRunsPerPage(200);\n        });\n        await page.waitForTimeout(100);\n\n        // We expect there to be a fitting error message\n        const expectedMessage = 'Invalid Attribute: \"query.page.limit\" must be less than or equal to 100';\n        await expectInnerText(page, '.alert-danger', expectedMessage);\n\n        // Revert changes for next test\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.runs.setRunsPerPage(10);\n        });\n        await page.waitForTimeout(100);\n    });\n\n    it('can navigate to a run detail page', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n\n        // We expect the entry page to have the same id as the id from the run overview\n        await pressElement(page, `#${firstRowId}`);\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=run-detail&id=${parsedFirstRowId}`)).to.be.true;\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/subsystems/detail.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":85,"nodeType":"CallExpression","endLine":15,"endColumn":107}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('subsystem detail loads correctly', async () => {\n        await page.goto(`${url}/?page=subsystem-detail&id=1`, { waitUntil: 'networkidle0' });\n        await expectInnerText(page, 'h2', 'Subsystem: Subsystem Plant #1');\n    });\n\n    it('can navigate to the log panel', async () => {\n        await pressElement(page, '#logs-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=subsystem-detail&id=1&panel=logs`)).to.be.true;\n    });\n\n    it('can navigate to the main panel', async () => {\n        await pressElement(page, '#main-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=subsystem-detail&id=1&panel=main`)).to.be.true;\n    });\n\n    it('can navigate to the log panel', async () => {\n        await pressElement(page, '#logs-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=subsystem-detail&id=1&panel=logs`)).to.be.true;\n    });\n\n    it('can navigate to a log detail page', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n\n        // We expect the entry page to have the same id as the id from the subsystem overview\n        await pressElement(page, `#${firstRowId}`);\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=log-detail&id=3`)).to.be.true;\n    });\n\n    it('notifies if a specified subsystem id is invalid', async () => {\n        // Navigate to a subsystem detail view with an id that cannot exist\n        await page.goto(`${url}/?page=subsystem-detail&id=abc`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        await expectInnerText(page, '.alert', 'Invalid Attribute: \"params.subsystemId\" must be a number');\n    });\n\n    it('notifies if a specified subsystem id is not found', async () => {\n        // Navigate to a subsystem detail view with an id that cannot exist\n        await page.goto(`${url}/?page=subsystem-detail&id=999`, { waitUntil: 'networkidle0' });\n\n        // We expect there to be an error message\n        await expectInnerText(page, '.alert', 'Subsystem with this id (999) could not be found:');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/subsystems/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./detail.test","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\nconst DetailSuite = require('./detail.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n    describe('Detail Page', DetailSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/subsystems/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":68,"nodeType":"CallExpression","endLine":15,"endColumn":90}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n    let parsedFirstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=subsystem-overview`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('can navigate to a subsystem detail page', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n\n        // We expect the entry page to have the same id as the id from the subsystem overview\n        await pressElement(page, `#${firstRowId}`);\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=subsystem-detail&id=${parsedFirstRowId}`)).to.be.true;\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/tags/create.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":14,"column":82,"nodeType":"CallExpression","endLine":14,"endColumn":104}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, goToPage } = require('../defaults');\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('can create a tag', async () => {\n        const text = 'EXAMPLE';\n        await page.goto(`${url}/?page=tag-create`, { waitUntil: 'networkidle0' });\n\n        // Enter the text value\n        await page.waitForSelector('#text');\n        await page.type('#text', text);\n\n        // Create the new tag\n        await pressElement(page, 'button#send');\n\n        // Verify the title of the page\n        await expectInnerText(page, '.mv2', `Tag: ${text}`);\n\n        // Return the page to the tag overview\n        await page.goto(`${url}/?page=tag-overview`, { waitUntil: 'networkidle0' });\n    });\n\n    it('shows an error message if tag creation failed', async () => {\n        const text = 'EXAMPLE';\n\n        // Go to the tag creation page\n        await goToPage(page, 'tag-create');\n\n        // Enter the duplicate text value\n        await page.waitForSelector('#text');\n        await page.type('#text', text);\n\n        // Create the new tag\n        await pressElement(page, 'button#send');\n\n        // Because this tag already exists, we expect an error message to appear\n        await expectInnerText(page, '.alert', 'Conflict: The provided entity already exists');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/tags/detail.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":85,"nodeType":"CallExpression","endLine":15,"endColumn":107}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, expectInnerText, pressElement, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('tag detail loads correctly', async () => {\n        await page.goto(`${url}/?page=tag-detail&id=1`, { waitUntil: 'networkidle0' });\n        await expectInnerText(page, 'h2', 'Tag: FOOD');\n    });\n\n    it('can navigate to the log panel', async () => {\n        await pressElement(page, '#logs-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=tag-detail&id=1&panel=logs`)).to.be.true;\n    });\n\n    it('can navigate to the main panel', async () => {\n        await pressElement(page, '#main-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=tag-detail&id=1&panel=main`)).to.be.true;\n    });\n\n    it('can navigate to the log panel', async () => {\n        await pressElement(page, '#logs-tab');\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=tag-detail&id=1&panel=logs`)).to.be.true;\n    });\n\n    it('can navigate to a log detail page', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        const parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n\n        // We expect the entry page to have the same id as the id from the tag overview\n        await pressElement(page, `#${firstRowId}`);\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=log-detail&id=${parsedFirstRowId}`)).to.be.true;\n    });\n\n    it('notifies if a specified tag id is invalid', async () => {\n        // Navigate to a tag detail view with an id that cannot exist\n        await page.goto(`${url}/?page=tag-detail&id=abc`, { waitUntil: 'networkidle0' });\n\n        // Because this tag id is invalid, we expect an error message to appear\n        await expectInnerText(page, '.alert', 'Invalid Attribute: \"params.tagId\" must be a number');\n    });\n\n    it('notifies if a specified tag id is not found', async () => {\n        // Navigate to a tag detail view with an id that cannot exist\n        await page.goto(`${url}/?page=tag-detail&id=999`, { waitUntil: 'networkidle0' });\n\n        // Because this tag does not exist, we expect an error message to appear\n        await expectInnerText(page, '.alert', 'Tag with this id (999) could not be found');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/tags/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./overview.test","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":49},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./detail.test","line":15,"column":21,"nodeType":"CallExpression","endLine":15,"endColumn":45},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./create.test","line":16,"column":21,"nodeType":"CallExpression","endLine":16,"endColumn":45}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst OverviewSuite = require('./overview.test');\nconst DetailSuite = require('./detail.test');\nconst CreateSuite = require('./create.test');\n\nmodule.exports = () => {\n    describe('Overview Page', OverviewSuite);\n    describe('Detail Page', DetailSuite);\n    describe('Create Page', CreateSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/public/tags/overview.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":14,"column":14,"nodeType":"CallExpression","endLine":14,"endColumn":29},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../defaults","line":15,"column":78,"nodeType":"CallExpression","endLine":15,"endColumn":100}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst chai = require('chai');\nconst { defaultBefore, defaultAfter, pressElement, goToPage, getFirstRow } = require('../defaults');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let page;\n    let browser;\n    let url;\n\n    let table;\n    let firstRowId;\n    let parsedFirstRowId;\n\n    before(async () => {\n        [page, browser, url] = await defaultBefore(page, browser);\n        await page.setViewport({\n            width: 700,\n            height: 720,\n            deviceScaleFactor: 1,\n        });\n    });\n    after(async () => {\n        [page, browser] = await defaultAfter(page, browser);\n    });\n\n    it('loads the page successfully', async () => {\n        const response = await page.goto(`${url}?page=tag-overview`, { waitUntil: 'networkidle0' });\n\n        // We expect the page to return the correct status code, making sure the server is running properly\n        expect(response.status()).to.equal(200);\n\n        // We expect the page to return the correct title, making sure there isn't another server running on this port\n        const title = await page.title();\n        expect(title).to.equal('AliceO2 Bookkeeping 2020');\n    });\n\n    it('can navigate to a tag detail page', async () => {\n        table = await page.$$('tr');\n        firstRowId = await getFirstRow(table, page);\n        parsedFirstRowId = parseInt(firstRowId.slice('row'.length, firstRowId.length), 10);\n\n        // We expect the entry page to have the same id as the id from the tag overview\n        await pressElement(page, `#${firstRowId}`);\n        await page.waitForTimeout(100);\n        const redirectedUrl = await page.url();\n        expect(String(redirectedUrl).startsWith(`${url}/?page=tag-detail&id=${parsedFirstRowId}`)).to.be.true;\n    });\n\n    it('can navigate to the tag creation page', async () => {\n        // Click on the button to start creating a new tag\n        await goToPage(page, 'tag-create');\n\n        // Expect the page to be the tag creation page at this point\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=tag-create`);\n    });\n\n    it('can navigate to the tag overview page', async () => {\n        // Click on the button to start creating a new tag\n        await goToPage(page, 'tag-overview');\n\n        // Expect the page to be the tag creation page at this point\n        const redirectedUrl = await page.url();\n        expect(redirectedUrl).to.equal(`${url}/?page=tag-overview`);\n    });\n\n    it('can switch to infinite mode in amountSelector', async () => {\n        const amountSelectorButton = await page.$('#amountSelector button');\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$('#amountSelector .dropup-menu');\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        const menuItems = await page.$$('#amountSelector .dropup-menu .menu-item');\n        await menuItems[menuItems.length - 1].evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        const amountSelectorButtonText = await page.evaluate((element) => element.innerText, amountSelectorButton);\n        expect(amountSelectorButtonText.endsWith('Infinite ')).to.be.true;\n\n        await page.evaluate(() => {\n            window.scrollBy(0, window.innerHeight);\n        });\n        await page.waitForTimeout(400);\n        const tableRows = await page.$$('table tr');\n\n        expect(tableRows.length > 20).to.be.true;\n    });\n\n    it('can set how many tags are available per page', async () => {\n        await page.waitForTimeout(500);\n        // Expect the amount selector to currently be set to Infinite (after the previous test)\n        const amountSelectorId = '#amountSelector';\n        await page.waitForTimeout(500);\n        const amountSelectorButton = await page.$(`${amountSelectorId} button`);\n        const amountSelectorButtonText = await page.evaluate((element) => element.innerText, amountSelectorButton);\n        expect(amountSelectorButtonText.endsWith('Infinite ')).to.be.true;\n\n        // Expect the dropdown options to be visible when it is selected\n        await amountSelectorButton.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n        const amountSelectorDropdown = await page.$(`${amountSelectorId} .dropup-menu`);\n        expect(Boolean(amountSelectorDropdown)).to.be.true;\n\n        // Expect the amount of visible tags to reduce when the first option (5) is selected\n        const menuItem = await page.$(`${amountSelectorId} .dropup-menu .menu-item`);\n        await menuItem.evaluate((button) => button.click());\n        await page.waitForTimeout(100);\n\n        const tableRows = await page.$$('table tr');\n        expect(tableRows.length - 1).to.equal(5);\n    });\n\n    it('dynamically switches between visible pages in the page selector', async () => {\n        // Override the amount of Tags visible per page manually\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.tags.setTagsPerPage(1);\n        });\n        await page.waitForTimeout(100);\n\n        // Expect the page five button to now be visible, but no more than that\n        const pageFiveButton = await page.$('#page5');\n        expect(Boolean(pageFiveButton)).to.be.true;\n        const pageSixButton = await page.$('#page6');\n        expect(Boolean(pageSixButton)).to.be.false;\n\n        // Expect the page one button to have fallen away when clicking on page five button\n        await page.waitForTimeout(500);\n        await page.waitForSelector('#page5');\n        await pressElement(page, '#page5');\n        await page.waitForTimeout(500);\n        const pageOneButton = await page.$('#page1');\n        expect(Boolean(pageOneButton)).to.be.false;\n\n        // Revert changes for next test\n        await page.evaluate(() => {\n            // eslint-disable-next-line no-undef\n            model.tags.setTagsPerPage(10);\n        });\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/server/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./utilities","line":14,"column":24,"nodeType":"CallExpression","endLine":14,"endColumn":46}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst UtilitiesSuite = require('./utilities');\n\nmodule.exports = () => {\n    describe('Utilities', UtilitiesSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/server/utilities/appendPath.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/server/utilities","line":14,"column":24,"nodeType":"CallExpression","endLine":14,"endColumn":64},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { appendPath } = require('../../../lib/server/utilities');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should handle no slashes', () => {\n        const base = 'base';\n        const appendix = 'appendix';\n        expect(appendPath(base, appendix)).to.equal('/base/appendix');\n    });\n\n    it('should handle a slash only at the base', () => {\n        const base = 'base/';\n        const appendix = 'appendix';\n        expect(appendPath(base, appendix)).to.equal('/base/appendix');\n    });\n\n    it('should handle a slash only at the appendix', () => {\n        const base = 'base';\n        const appendix = '/appendix';\n        expect(appendPath(base, appendix)).to.equal('/base/appendix');\n    });\n\n    it('should handle slashes at both the base and appendix', () => {\n        const base = 'base/';\n        const appendix = '/appendix';\n        expect(appendPath(base, appendix)).to.equal('/base/appendix');\n    });\n\n    it('should remove unneeded slashes', () => {\n        const base = '//base///';\n        const appendix = '////appendix///';\n        expect(appendPath(base, appendix)).to.equal('/base/appendix');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/server/utilities/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./appendPath.test","line":14,"column":20,"nodeType":"CallExpression","endLine":14,"endColumn":48}],"errorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst appendPath = require('./appendPath.test');\n\nmodule.exports = () => {\n    describe('appendPath', appendPath);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/flp/CreateFlpUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":45,"nodeType":"CallExpression","endLine":14,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":39,"nodeType":"CallExpression","endLine":15,"endColumn":71},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":36,"nodeType":"CallExpression","endLine":16,"endColumn":66},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { FlpRepository } } = require('../../../lib/database');\nconst { flp: { CreateFlpUseCase } } = require('../../../lib/usecases');\nconst { dtos: { CreateFlpDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let createFlpDto;\n\n    beforeEach(async () => {\n        createFlpDto = await CreateFlpDto.validateAsync({\n            body: {\n                name: 'FlpTest',\n                hostname: 'TestFlp',\n            },\n        });\n        createFlpDto.session = {\n            personid: 1,\n            id: 1,\n            name: 'John Doe',\n        };\n    });\n\n    it('should insert a new Flp', async () => {\n        const nFlpsBefore = await FlpRepository.count();\n\n        await new CreateFlpUseCase()\n            .execute(createFlpDto);\n\n        const nFlpsAfter = await FlpRepository.count();\n        expect(nFlpsAfter).to.be.greaterThan(nFlpsBefore);\n    });\n\n    /*\n     * It('should insert a new Flp with the same hostname as provided', async () => {\n     *     const expectedName = 'FlpTest';\n     */\n\n    /*\n     *     CreateFlpDto.body.name = expectedName;\n     *     const { result } = await new CreateFlpUseCase()\n     *         .execute(createFlpDto);\n     */\n\n    /*\n     *     Expect(result.name).to.equal(expectedName);\n     * });\n     */\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/flp/GetAllFlpsUseCase.test.js","messages":[],"errorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/flp/GetFlpUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":36,"nodeType":"CallExpression","endLine":14,"endColumn":68},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":33,"nodeType":"CallExpression","endLine":15,"endColumn":63},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { flp: { GetFlpUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetFlpDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getFlpDto;\n\n    beforeEach(async () => {\n        getFlpDto = await GetFlpDto.validateAsync({\n            params: {\n                flpId: 1,\n            },\n        });\n    });\n\n    it('should return an object that has the `id` property', async () => {\n        const result = await new GetFlpUseCase()\n            .execute(getFlpDto);\n\n        expect(result).to.have.ownProperty('id');\n        expect(result.id).to.equal(1);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/flp/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateFlpUseCase.test","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllFlpsUseCase.test","line":15,"column":27,"nodeType":"CallExpression","endLine":15,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetFlpUseCase.test","line":16,"column":23,"nodeType":"CallExpression","endLine":16,"endColumn":54}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateFlpUseCase = require('./CreateFlpUseCase.test');\nconst GetAllFlpsUseCase = require('./GetAllFlpsUseCase.test');\nconst GetFlpUseCase = require('./GetFlpUseCase.test');\n\nmodule.exports = () => {\n    describe('CreateFlpUseCase', CreateFlpUseCase);\n    describe('GetAllFlpsUseCase', GetAllFlpsUseCase);\n    describe('GetFlpUseCase', GetFlpUseCase);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./log","line":14,"column":18,"nodeType":"CallExpression","endLine":14,"endColumn":34},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./flp","line":15,"column":18,"nodeType":"CallExpression","endLine":15,"endColumn":34},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./server","line":16,"column":21,"nodeType":"CallExpression","endLine":16,"endColumn":40},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./subsystem","line":17,"column":24,"nodeType":"CallExpression","endLine":17,"endColumn":46},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./tag","line":18,"column":18,"nodeType":"CallExpression","endLine":18,"endColumn":34}],"errorCount":5,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst LogSuite = require('./log');\nconst FlpSuite = require('./flp');\nconst ServerSuite = require('./server');\nconst SubsystemSuite = require('./subsystem');\nconst TagSuite = require('./tag');\n\nmodule.exports = () => {\n    describe('Log', LogSuite);\n    describe('Flp', FlpSuite);\n    describe('Server', ServerSuite);\n    describe('Subsystem', SubsystemSuite);\n    describe('Tag', TagSuite);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/log/CreateLogUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":45,"nodeType":"CallExpression","endLine":14,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":39,"nodeType":"CallExpression","endLine":15,"endColumn":71},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":36,"nodeType":"CallExpression","endLine":16,"endColumn":66},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { LogRepository } } = require('../../../lib/database');\nconst { log: { CreateLogUseCase } } = require('../../../lib/usecases');\nconst { dtos: { CreateLogDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let createLogDto;\n\n    beforeEach(async () => {\n        createLogDto = await CreateLogDto.validateAsync({\n            body: {\n                title: 'Yet another log',\n                text: 'This is the text field of yet another log.',\n                tags: [],\n            },\n        });\n        createLogDto.session = {\n            personid: 1,\n            id: 1,\n            name: 'John Doe',\n        };\n    });\n\n    it('should insert a new Log', async () => {\n        const nLogsBefore = await LogRepository.count();\n\n        await new CreateLogUseCase()\n            .execute(createLogDto);\n\n        const nLogsAfter = await LogRepository.count();\n        expect(nLogsAfter).to.be.greaterThan(nLogsBefore);\n    });\n\n    it('should insert a new Log with the same title as provided', async () => {\n        const expectedTitle = `Log #${Math.round(Math.random() * 1000)}`;\n\n        createLogDto.body.title = expectedTitle;\n        const { result } = await new CreateLogUseCase()\n            .execute(createLogDto);\n\n        expect(result.title).to.equal(expectedTitle);\n    });\n\n    it('should insert a new Log with the text title as provided', async () => {\n        const expectedText = `Random content: ${Math.round(Math.random() * 1000)}`;\n\n        createLogDto.body.text = expectedText;\n        const { result } = await new CreateLogUseCase()\n            .execute(createLogDto);\n\n        expect(result.text).to.equal(expectedText);\n    });\n\n    it('should insert a new Log with the tags as provided', async () => {\n        const expectedTagIds = [1, 3];\n\n        createLogDto.body.tags = expectedTagIds;\n        const { result } = await new CreateLogUseCase()\n            .execute(createLogDto);\n\n        expect(result.tags.map(({ id }) => id)).to.deep.equal(expectedTagIds);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/log/GetAllLogsUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":45,"nodeType":"CallExpression","endLine":14,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":40,"nodeType":"CallExpression","endLine":15,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":37,"nodeType":"CallExpression","endLine":16,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { LogRepository } } = require('../../../lib/database');\nconst { log: { GetAllLogsUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetAllLogsDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getAllLogsDto;\n\n    beforeEach(async () => {\n        getAllLogsDto = await GetAllLogsDto.validateAsync({});\n    });\n\n    it('should return an array', async () => {\n        const { logs } = await new GetAllLogsUseCase()\n            .execute();\n\n        expect(logs).to.be.an('array');\n    });\n\n    it('should return an array, only containing human originated logs', async () => {\n        getAllLogsDto.query = { filter: { origin: 'human' } };\n        const { logs } = await new GetAllLogsUseCase()\n            .execute(getAllLogsDto);\n\n        expect(logs).to.be.an('array');\n        for (const log of logs) {\n            expect(log.origin).to.equal('human');\n        }\n    });\n\n    it('should return logs with a full tag collection regardless of filter', async () => {\n        getAllLogsDto.query = { filter: { tag: { values: [1], operation: 'or' } } };\n\n        const filteredResult = await new GetAllLogsUseCase()\n            .execute(getAllLogsDto);\n        expect(filteredResult.logs.length).to.be.greaterThan(0);\n        const [firstFilteredLog] = filteredResult.logs;\n\n        const unfilteredResult = await new GetAllLogsUseCase()\n            .execute();\n        const firstUnfilteredLog = unfilteredResult.logs.find((log) => log.id === firstFilteredLog.id);\n\n        expect(firstUnfilteredLog.tags).to.deep.equal(firstFilteredLog.tags);\n    });\n\n    it('should return a reply count if applicable', async () => {\n        const rootLogId = 117;\n        getAllLogsDto.query = { filter: { rootLog: rootLogId } };\n\n        const filteredResult = await new GetAllLogsUseCase()\n            .execute(getAllLogsDto);\n        for (const log of filteredResult.logs) {\n            expect(log).to.not.have.property('replies');\n        }\n\n        const unfilteredResult = await new GetAllLogsUseCase()\n            .execute();\n        const rootLog = unfilteredResult.logs.find((log) => log.id === rootLogId);\n        expect(filteredResult.count).to.equal(rootLog.replies);\n    });\n\n    it('should return a count that is the same as the count method of the repository', async () => {\n        const expectedCount = await LogRepository.count();\n\n        const { count } = await new GetAllLogsUseCase()\n            .execute(getAllLogsDto);\n\n        expect(count).to.equal(expectedCount);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/log/GetLogUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":36,"nodeType":"CallExpression","endLine":14,"endColumn":68},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":33,"nodeType":"CallExpression","endLine":15,"endColumn":63},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { log: { GetLogUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetLogDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getLogDto;\n\n    beforeEach(async () => {\n        getLogDto = await GetLogDto.validateAsync({\n            params: {\n                logId: 1,\n            },\n        });\n    });\n\n    it('should return an object that has the `id` property', async () => {\n        const result = await new GetLogUseCase()\n            .execute(getLogDto);\n\n        expect(result).to.have.ownProperty('id');\n        expect(result.id).to.equal(1);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/log/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateLogUseCase.test","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllLogsUseCase.test","line":15,"column":27,"nodeType":"CallExpression","endLine":15,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetLogUseCase.test","line":16,"column":23,"nodeType":"CallExpression","endLine":16,"endColumn":54}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateLogUseCase = require('./CreateLogUseCase.test');\nconst GetAllLogsUseCase = require('./GetAllLogsUseCase.test');\nconst GetLogUseCase = require('./GetLogUseCase.test');\n\nmodule.exports = () => {\n    describe('CreateLogUseCase', CreateLogUseCase);\n    describe('GetAllLogsUseCase', GetAllLogsUseCase);\n    describe('GetLogUseCase', GetLogUseCase);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/run/GetAllRunsUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":40,"nodeType":"CallExpression","endLine":14,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":37,"nodeType":"CallExpression","endLine":15,"endColumn":67},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { run: { GetAllRunsUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetAllRunsDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getAllRunsDto;\n\n    beforeEach(async () => {\n        getAllRunsDto = await GetAllRunsDto.validateAsync({});\n    });\n\n    it('should return an array', async () => {\n        const { runs } = await new GetAllRunsUseCase()\n            .execute();\n\n        expect(runs).to.be.an('array');\n    });\n\n    it('should return an array, only containing human originated runs', async () => {\n        getAllRunsDto.query = { filter: { origin: 'human' } };\n        const { runs } = await new GetAllRunsUseCase()\n            .execute(getAllRunsDto);\n\n        expect(runs).to.be.an('array');\n        for (const run of runs) {\n            expect(run.origin).to.equal('human');\n        }\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/run/GetRunUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":36,"nodeType":"CallExpression","endLine":14,"endColumn":68},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":33,"nodeType":"CallExpression","endLine":15,"endColumn":63},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { run: { GetRunUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetRunDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getRunDto;\n\n    beforeEach(async () => {\n        getRunDto = await GetRunDto.validateAsync({\n            params: {\n                runId: 1,\n            },\n        });\n    });\n\n    it('should return an object that has the `id` property', async () => {\n        const result = await new GetRunUseCase()\n            .execute(getRunDto);\n\n        expect(result).to.have.ownProperty('id');\n        expect(result.id).to.equal(1);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/run/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllRunsUseCase.test","line":14,"column":27,"nodeType":"CallExpression","endLine":14,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetRunUseCase.test","line":15,"column":23,"nodeType":"CallExpression","endLine":15,"endColumn":54}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst GetAllRunsUseCase = require('./GetAllRunsUseCase.test');\nconst GetRunUseCase = require('./GetRunUseCase.test');\n\nmodule.exports = () => {\n    describe('GetAllRunsUseCase', GetAllRunsUseCase);\n    describe('GetRunUseCase', GetRunUseCase);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/server/GetDeployInformationUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":53,"nodeType":"CallExpression","endLine":14,"endColumn":85},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { server: { GetDeployInformationUseCase } } = require('../../../lib/usecases');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should return an object that has the `age` property', async () => {\n        // Arrange\n        const usecase = new GetDeployInformationUseCase();\n\n        // Act\n        const result = await usecase.execute();\n\n        // Assert\n        expect(result).to.have.ownProperty('age');\n    });\n\n    it('should return an object that has the `start` property', async () => {\n        // Arrange\n        const usecase = new GetDeployInformationUseCase();\n\n        // Act\n        const result = await usecase.execute();\n\n        // Assert\n        expect(result).to.have.ownProperty('start');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/server/GetServerInformationUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":53,"nodeType":"CallExpression","endLine":14,"endColumn":85},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { server: { GetServerInformationUseCase } } = require('../../../lib/usecases');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should return an object that has the `version` property', async () => {\n        // Arrange\n        const usecase = new GetServerInformationUseCase();\n\n        // Act\n        const result = await usecase.execute();\n\n        // Assert\n        expect(result).to.have.ownProperty('version');\n    });\n\n    it('should return an object that has the `name` property', async () => {\n        // Arrange\n        const usecase = new GetServerInformationUseCase();\n\n        // Act\n        const result = await usecase.execute();\n\n        // Assert\n        expect(result).to.have.ownProperty('name');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/server/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetDeployInformationUseCase.test","line":14,"column":37,"nodeType":"CallExpression","endLine":14,"endColumn":82},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetServerInformationUseCase.test","line":15,"column":37,"nodeType":"CallExpression","endLine":15,"endColumn":82}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst GetDeployInformationUseCase = require('./GetDeployInformationUseCase.test');\nconst GetServerInformationUseCase = require('./GetServerInformationUseCase.test');\n\nmodule.exports = () => {\n    describe('GetDeployInformationUseCase', GetDeployInformationUseCase);\n    describe('GetServerInformationUseCase', GetServerInformationUseCase);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/subsystem/CreateSubsystemUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":51,"nodeType":"CallExpression","endLine":14,"endColumn":83},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":51,"nodeType":"CallExpression","endLine":15,"endColumn":83},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":42,"nodeType":"CallExpression","endLine":16,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { SubsystemRepository } } = require('../../../lib/database');\nconst { subsystem: { CreateSubsystemUseCase } } = require('../../../lib/usecases');\nconst { dtos: { CreateSubsystemDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let createSubsystemDto;\n\n    beforeEach(async () => {\n        createSubsystemDto = await CreateSubsystemDto.validateAsync({\n            body: {\n                name: `SYSTEM#${new Date().getTime()}`,\n            },\n        });\n    });\n\n    it('should insert a new Subsystem', async () => {\n        const nSubsystemsBefore = await SubsystemRepository.count();\n\n        await new CreateSubsystemUseCase()\n            .execute(createSubsystemDto);\n\n        const nSubsystemsAfter = await SubsystemRepository.count();\n        expect(nSubsystemsAfter).to.be.greaterThan(nSubsystemsBefore);\n    });\n\n    it('should insert a new Subsystem with the same name as provided', async () => {\n        const expectedName = `Subsystem #${Math.round(Math.random() * 1000)}`;\n\n        createSubsystemDto.body.name = expectedName;\n        const result = await new CreateSubsystemUseCase()\n            .execute(createSubsystemDto);\n\n        expect(result.name).to.equal(expectedName);\n    });\n\n    it('should return null if we are trying to create the same subsystem again', async () => {\n        const nSubsystemsBefore = await SubsystemRepository.count();\n\n        await new CreateSubsystemUseCase()\n            .execute(createSubsystemDto);\n\n        const nSubsystemsAfter = await SubsystemRepository.count();\n        expect(nSubsystemsAfter).to.be.greaterThan(nSubsystemsBefore);\n\n        const result = await new CreateSubsystemUseCase()\n            .execute(createSubsystemDto);\n\n        expect(result).to.be.null;\n        expect(await SubsystemRepository.count()).to.equal(nSubsystemsAfter);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/subsystem/DeleteSubsystemUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":51,"nodeType":"CallExpression","endLine":14,"endColumn":83},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":75,"nodeType":"CallExpression","endLine":15,"endColumn":107},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":42,"nodeType":"CallExpression","endLine":16,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { SubsystemRepository } } = require('../../../lib/database');\nconst { subsystem: { CreateSubsystemUseCase, DeleteSubsystemUseCase } } = require('../../../lib/usecases');\nconst { dtos: { CreateSubsystemDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let createdSubsystem;\n\n    beforeEach(async () => {\n        const createSubsystemDto = await CreateSubsystemDto.validateAsync({\n            body: {\n                name: `SYSTEM#${new Date().getTime()}`,\n            },\n        });\n\n        createdSubsystem = await new CreateSubsystemUseCase()\n            .execute(createSubsystemDto);\n    });\n\n    it('should remove a subsystem', async () => {\n        const nSubsystemsBefore = await SubsystemRepository.count();\n\n        await new DeleteSubsystemUseCase()\n            .execute({\n                params: {\n                    subsystemId: createdSubsystem.id,\n                },\n            });\n\n        const nSubsystemsAfter = await SubsystemRepository.count();\n        expect(nSubsystemsAfter).to.be.lessThan(nSubsystemsBefore);\n    });\n\n    it('should return the removed subsystem', async () => {\n        const nSubsystemsBefore = await SubsystemRepository.count();\n\n        const result = await new DeleteSubsystemUseCase()\n            .execute({\n                params: {\n                    subsystemId: createdSubsystem.id,\n                },\n            });\n\n        const nSubsystemsAfter = await SubsystemRepository.count();\n        expect(nSubsystemsAfter).to.be.lessThan(nSubsystemsBefore);\n\n        expect(result.id).to.equal(createdSubsystem.id);\n        expect(result.name).to.equal(createdSubsystem.name);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/subsystem/GetAllSubsystemsUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":51,"nodeType":"CallExpression","endLine":14,"endColumn":83},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":43,"nodeType":"CallExpression","endLine":15,"endColumn":73},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":16,"column":52,"nodeType":"CallExpression","endLine":16,"endColumn":84},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { SubsystemRepository } } = require('../../../lib/database');\nconst { dtos: { GetAllSubsystemsDto } } = require('../../../lib/domain');\nconst { subsystem: { GetAllSubsystemsUseCase } } = require('../../../lib/usecases');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getAllSubsystemsDto;\n\n    beforeEach(async () => {\n        getAllSubsystemsDto = await GetAllSubsystemsDto.validateAsync({});\n    });\n\n    it('should return an array', async () => {\n        const { subsystems } = await new GetAllSubsystemsUseCase()\n            .execute();\n\n        expect(subsystems).to.be.an('array');\n    });\n\n    it('should return a count that is the same as the count method of the repository', async () => {\n        const expectedCount = await SubsystemRepository.count();\n\n        const { count } = await new GetAllSubsystemsUseCase()\n            .execute(getAllSubsystemsDto);\n\n        expect(count).to.equal(expectedCount);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/subsystem/GetSubsystemUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":48,"nodeType":"CallExpression","endLine":14,"endColumn":80},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":39,"nodeType":"CallExpression","endLine":15,"endColumn":69},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { subsystem: { GetSubsystemUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetSubsystemDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getSubsystemDto;\n\n    beforeEach(async () => {\n        getSubsystemDto = await GetSubsystemDto.validateAsync({\n            params: {\n                subsystemId: 1,\n            },\n        });\n    });\n\n    it('should return an object that has the `id` property', async () => {\n        const result = await new GetSubsystemUseCase()\n            .execute(getSubsystemDto);\n\n        expect(result).to.have.ownProperty('id');\n        expect(result.id).to.equal(1);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/subsystem/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateSubsystemUseCase.test","line":14,"column":32,"nodeType":"CallExpression","endLine":14,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./DeleteSubsystemUseCase.test","line":15,"column":32,"nodeType":"CallExpression","endLine":15,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllSubsystemsUseCase.test","line":16,"column":33,"nodeType":"CallExpression","endLine":16,"endColumn":74},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetSubsystemUseCase.test","line":17,"column":29,"nodeType":"CallExpression","endLine":17,"endColumn":66}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateSubsystemUseCase = require('./CreateSubsystemUseCase.test');\nconst DeleteSubsystemUseCase = require('./DeleteSubsystemUseCase.test');\nconst GetAllSubsystemsUseCase = require('./GetAllSubsystemsUseCase.test');\nconst GetSubsystemUseCase = require('./GetSubsystemUseCase.test');\n\nmodule.exports = () => {\n    describe('CreateSubsystemUseCase', CreateSubsystemUseCase);\n    describe('DeleteSubsystemUseCase', DeleteSubsystemUseCase);\n    describe('GetAllSubsystemsUseCase', GetAllSubsystemsUseCase);\n    describe('GetSubsystemUseCase', GetSubsystemUseCase);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/tag/CreateTagUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":45,"nodeType":"CallExpression","endLine":14,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":39,"nodeType":"CallExpression","endLine":15,"endColumn":71},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":36,"nodeType":"CallExpression","endLine":16,"endColumn":66},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { TagRepository } } = require('../../../lib/database');\nconst { tag: { CreateTagUseCase } } = require('../../../lib/usecases');\nconst { dtos: { CreateTagDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let createTagDto;\n\n    beforeEach(async () => {\n        createTagDto = await CreateTagDto.validateAsync({\n            body: {\n                text: `TAG#${new Date().getTime()}`,\n            },\n        });\n    });\n\n    it('should insert a new Tag', async () => {\n        const nTagsBefore = await TagRepository.count();\n\n        await new CreateTagUseCase()\n            .execute(createTagDto);\n\n        const nTagsAfter = await TagRepository.count();\n        expect(nTagsAfter).to.be.greaterThan(nTagsBefore);\n    });\n\n    it('should insert a new Tag with the same title as provided', async () => {\n        const expectedTitle = `Tag #${Math.round(Math.random() * 1000)}`;\n\n        createTagDto.body.text = expectedTitle;\n        const result = await new CreateTagUseCase()\n            .execute(createTagDto);\n\n        expect(result.text).to.equal(expectedTitle);\n    });\n\n    it('should return null if we are trying to create the same tag again', async () => {\n        const nTagsBefore = await TagRepository.count();\n\n        await new CreateTagUseCase()\n            .execute(createTagDto);\n\n        const nTagsAfter = await TagRepository.count();\n        expect(nTagsAfter).to.be.greaterThan(nTagsBefore);\n\n        const result = await new CreateTagUseCase()\n            .execute(createTagDto);\n\n        expect(result).to.be.null;\n        expect(await TagRepository.count()).to.equal(nTagsAfter);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/tag/DeleteTagUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/database","line":14,"column":45,"nodeType":"CallExpression","endLine":14,"endColumn":77},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":15,"column":57,"nodeType":"CallExpression","endLine":15,"endColumn":89},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":16,"column":36,"nodeType":"CallExpression","endLine":16,"endColumn":66},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":17,"column":14,"nodeType":"CallExpression","endLine":17,"endColumn":29}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { repositories: { TagRepository } } = require('../../../lib/database');\nconst { tag: { CreateTagUseCase, DeleteTagUseCase } } = require('../../../lib/usecases');\nconst { dtos: { CreateTagDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let createdTag;\n\n    beforeEach(async () => {\n        const createTagDto = await CreateTagDto.validateAsync({\n            body: {\n                text: `TAG#${new Date().getTime()}`,\n            },\n        });\n\n        createdTag = await new CreateTagUseCase()\n            .execute(createTagDto);\n    });\n\n    it('should remove a tag', async () => {\n        const nTagsBefore = await TagRepository.count();\n\n        await new DeleteTagUseCase()\n            .execute({\n                params: {\n                    tagId: createdTag.id,\n                },\n            });\n\n        const nTagsAfter = await TagRepository.count();\n        expect(nTagsAfter).to.be.lessThan(nTagsBefore);\n    });\n\n    it('should return the removed tag', async () => {\n        const nTagsBefore = await TagRepository.count();\n\n        const result = await new DeleteTagUseCase()\n            .execute({\n                params: {\n                    tagId: createdTag.id,\n                },\n            });\n\n        const nTagsAfter = await TagRepository.count();\n        expect(nTagsAfter).to.be.lessThan(nTagsBefore);\n\n        expect(result.id).to.equal(createdTag.id);\n        expect(result.text).to.equal(createdTag.text);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/tag/GetAllTagsUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":40,"nodeType":"CallExpression","endLine":14,"endColumn":72},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { tag: { GetAllTagsUseCase } } = require('../../../lib/usecases');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should return an array', async () => {\n        const { tags } = await new GetAllTagsUseCase()\n            .execute();\n\n        expect(tags).to.be.an('array');\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/tag/GetTagUseCase.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/usecases","line":14,"column":36,"nodeType":"CallExpression","endLine":14,"endColumn":68},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../../lib/domain","line":15,"column":33,"nodeType":"CallExpression","endLine":15,"endColumn":63},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":16,"column":14,"nodeType":"CallExpression","endLine":16,"endColumn":29}],"errorCount":3,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { tag: { GetTagUseCase } } = require('../../../lib/usecases');\nconst { dtos: { GetTagDto } } = require('../../../lib/domain');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    let getLogDto;\n\n    beforeEach(async () => {\n        getLogDto = await GetTagDto.validateAsync({\n            params: {\n                tagId: 1,\n            },\n        });\n    });\n\n    it('should return an object that has the `id` property', async () => {\n        const result = await new GetTagUseCase()\n            .execute(getLogDto);\n\n        expect(result).to.have.ownProperty('id');\n        expect(result.id).to.equal(1);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/usecases/tag/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./CreateTagUseCase.test","line":14,"column":26,"nodeType":"CallExpression","endLine":14,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./DeleteTagUseCase.test","line":15,"column":26,"nodeType":"CallExpression","endLine":15,"endColumn":60},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetAllTagsUseCase.test","line":16,"column":27,"nodeType":"CallExpression","endLine":16,"endColumn":62},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./GetTagUseCase.test","line":17,"column":23,"nodeType":"CallExpression","endLine":17,"endColumn":54}],"errorCount":4,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst CreateTagUseCase = require('./CreateTagUseCase.test');\nconst DeleteTagUseCase = require('./DeleteTagUseCase.test');\nconst GetAllTagsUseCase = require('./GetAllTagsUseCase.test');\nconst GetTagUseCase = require('./GetTagUseCase.test');\n\nmodule.exports = () => {\n    describe('CreateTagUseCase', CreateTagUseCase);\n    describe('DeleteTagUseCase', DeleteTagUseCase);\n    describe('GetAllTagsUseCase', GetAllTagsUseCase);\n    describe('GetTagUseCase', GetTagUseCase);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/utilities/deepmerge.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/utilities","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { deepmerge } = require('../../lib/utilities');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should merge two objects recursively', () => {\n        const source = {\n            a: 1,\n            b: 2,\n            moreLetters: {\n                x: 42,\n                y: null,\n            },\n        };\n        const overwrite = {\n            c: 4,\n            moreLetters: {\n                y: 'Not a Number',\n                z: 123,\n            },\n        };\n\n        const expectedResult = {\n            a: 1,\n            b: 2,\n            c: 4,\n            moreLetters: {\n                x: 42,\n                y: 'Not a Number',\n                z: 123,\n            },\n        };\n\n        expect(deepmerge(source, overwrite)).to.deep.include(expectedResult);\n    });\n\n    it('should merge two objects recursively', () => {\n        const source = {\n            a: 1,\n            b: 2,\n            moreLetters: {\n                x: 42,\n                y: null,\n            },\n        };\n\n        const overwrite = {\n            c: 4,\n            moreLetters: {\n                y: 'Not a Number',\n                z: 123,\n            },\n        };\n\n        const yetAnotherOverwrite = {\n            c: 6,\n            moreLetters: {\n                y: 'Not a String',\n            },\n        };\n\n        const expectedResult = {\n            a: 1,\n            b: 2,\n            c: 6,\n            moreLetters: {\n                x: 42,\n                y: 'Not a String',\n                z: 123,\n            },\n        };\n\n        expect(deepmerge(source, overwrite, yetAnotherOverwrite)).to.deep.include(expectedResult);\n    });\n\n    it('should return the base object if no targets are provided', () => {\n        const base = {\n            id: 1,\n            values: [1, '2', 3],\n        };\n\n        expect(deepmerge(base)).to.deep.equal(base);\n    });\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/utilities/index.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./deepmerge.test","line":14,"column":19,"nodeType":"CallExpression","endLine":14,"endColumn":46},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"./isPromise.test","line":15,"column":19,"nodeType":"CallExpression","endLine":15,"endColumn":46}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst deepmerge = require('./deepmerge.test');\nconst isPromise = require('./isPromise.test');\n\nmodule.exports = () => {\n    describe('deepmerge', deepmerge);\n    describe('isPromise', isPromise);\n};\n","usedDeprecatedRules":[]},{"filePath":"/home/skander/Projects/R/bookkeeping-analysis/repository/Bookkeeping/test/utilities/isPromise.test.js","messages":[{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"../../lib/utilities","line":14,"column":23,"nodeType":"CallExpression","endLine":14,"endColumn":53},{"ruleId":"bookkeeping-metrics/coupling","severity":2,"message":"chai","line":15,"column":14,"nodeType":"CallExpression","endLine":15,"endColumn":29}],"errorCount":2,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"/**\n * @license\n * Copyright CERN and copyright holders of ALICE O2. This software is\n * distributed under the terms of the GNU General Public License v3 (GPL\n * Version 3), copied verbatim in the file \"COPYING\".\n *\n * See http://alice-o2.web.cern.ch/license for full licensing information.\n *\n * In applying this license CERN does not waive the privileges and immunities\n * granted to it by virtue of its status as an Intergovernmental Organization\n * or submit itself to any jurisdiction.\n */\n\nconst { isPromise } = require('../../lib/utilities');\nconst chai = require('chai');\n\nconst { expect } = chai;\n\nmodule.exports = () => {\n    it('should return true', () => {\n        expect(isPromise(Promise.resolve())).to.be.true;\n        expect(isPromise(Promise.reject())).to.be.true;\n    });\n\n    it('should return false', () => {\n        expect(isPromise()).to.be.false;\n        expect(isPromise(null)).to.be.false;\n        expect(isPromise(undefined)).to.be.false;\n        expect(isPromise('Promise')).to.be.false;\n    });\n};\n","usedDeprecatedRules":[]}]